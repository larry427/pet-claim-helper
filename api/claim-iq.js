module.exports = (req, res) => {
  const html = "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>Pet Claim IQ - Free Coverage Calculator | Pet Claim Helper</title>\n\n  <meta name=\"description\" content=\"Find out if your vet bill will be covered BEFORE you file. Free coverage analysis tool from Pet Claim Helper.\">\n  <meta property=\"og:title\" content=\"Pet Claim IQ - Will Your Vet Bill Be Covered?\">\n  <meta property=\"og:description\" content=\"Upload your vet bill and get instant coverage analysis. Free tool from Pet Claim Helper.\">\n\n  <script src=\"https://cdn.tailwindcss.com\"></script>\n  <script crossorigin src=\"https://unpkg.com/react@18/umd/react.production.min.js\"></script>\n  <script crossorigin src=\"https://unpkg.com/react-dom@18/umd/react-dom.production.min.js\"></script>\n  <script src=\"https://unpkg.com/@babel/standalone/babel.min.js\"></script>\n\n  <script>\n    tailwind.config = {\n      theme: {\n        extend: {\n          colors: {\n            'pch-teal': '#1abc9c',\n            'pch-teal-dark': '#16a085',\n            'pch-orange': '#f39c12',\n            'pch-blue': '#3498db',\n          }\n        }\n      }\n    }\n  </script>\n\n  <style>\n    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');\n\n    body {\n      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n      margin: 0;\n      padding: 0;\n      background: #f8f9fa;\n    }\n\n    .card-hover {\n      transition: all 0.2s ease;\n    }\n\n    .card-hover:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 8px 24px rgba(26, 188, 156, 0.15);\n    }\n\n    .pch-gradient {\n      background: linear-gradient(135deg, #1abc9c 0%, #16a085 100%);\n    }\n  </style>\n</head>\n<body>\n  <div id=\"root\"></div>\n\n  <script type=\"text/babel\">\n    const { useState } = React;\n    const { createRoot } = ReactDOM;\n\n    // Icons\n    const Upload = ({ className }) => (\n      <svg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n        <path d=\"M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12\"/>\n      </svg>\n    );\n\n    const Check = ({ className }) => (\n      <svg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n        <path d=\"M20 6L9 17l-5-5\"/>\n      </svg>\n    );\n\n    const X = ({ className }) => (\n      <svg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n        <path d=\"M18 6L6 18M6 6l12 12\"/>\n      </svg>\n    );\n\n    const FileText = ({ className }) => (\n      <svg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n        <path d=\"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z\"/>\n        <path d=\"M14 2v6h6M16 13H8M16 17H8M10 9H8\"/>\n      </svg>\n    );\n\n    const DollarSign = ({ className }) => (\n      <svg className={className} fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" viewBox=\"0 0 24 24\">\n        <path d=\"M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6\"/>\n      </svg>\n    );\n\n    const INSURANCE_RULES = {\n      'healthy-paws': {\n        name: 'Healthy Paws',\n        excludes: ['Veterinary examination fees', 'Preventive care', 'Pre-existing conditions'],\n        waitingPeriods: { accident: 15, illness: 15, hipDysplasia: 365 }\n      }\n    };\n\n    function PetClaimIQ() {\n      const [step, setStep] = useState('upload');\n      const [vetBill, setVetBill] = useState(null);\n      const [policyInput, setPolicyInput] = useState('select');\n\n      const [billData, setBillData] = useState({\n        petName: '', date: '', clinic: '', lineItems: [], total: 0\n      });\n\n      const [policyData, setPolicyData] = useState({\n        insurance: 'healthy-paws',\n        reimbursement: 80,\n        deductible: 500,\n        policyStart: '',\n        deductibleMet: 0\n      });\n\n      const [results, setResults] = useState(null);\n      const [isAnalyzing, setIsAnalyzing] = useState(false);\n\n      const handleVetBillUpload = (e) => {\n        const file = e.target.files[0];\n        if (!file) return;\n        setVetBill(file);\n        setIsAnalyzing(true);\n\n        setTimeout(() => {\n          setBillData({\n            petName: 'Trinity',\n            date: '2026-02-04',\n            clinic: 'East Chapman Veterinary Center',\n            lineItems: [\n              { description: 'Examination', amount: 76.00, category: 'exam' },\n              { description: 'Dexamethasone injection', amount: 52.02, category: 'medication' },\n              { description: 'Cerenia injection', amount: 52.02, category: 'medication' },\n              { description: 'Prednisone tablets', amount: 15.50, category: 'medication' },\n              { description: 'Hydroxyzine tablets', amount: 15.50, category: 'medication' }\n            ],\n            total: 211.04\n          });\n          setIsAnalyzing(false);\n          setStep('validate');\n        }, 2000);\n      };\n\n      const validateExtraction = () => {\n        const calculatedTotal = billData.lineItems.reduce((sum, item) => sum + item.amount, 0);\n        return Math.abs(calculatedTotal - billData.total) < 0.01;\n      };\n\n      const analyzeCoverage = () => {\n        if (!policyData.policyStart) {\n          alert('Please enter your policy start date');\n          return;\n        }\n\n        setIsAnalyzing(true);\n\n        setTimeout(() => {\n          const rules = INSURANCE_RULES[policyData.insurance];\n          const policyStartDate = new Date(policyData.policyStart);\n          const billDate = new Date(billData.date);\n\n          const daysSincePolicyStart = Math.floor((billDate - policyStartDate) / (1000 * 60 * 60 * 24));\n          const pastWaitingPeriod = daysSincePolicyStart >= rules.waitingPeriods.illness;\n\n          const analyzedItems = billData.lineItems.map(item => {\n            let covered = true;\n            let reason = '';\n\n            if (item.category === 'exam') {\n              covered = false;\n              reason = 'Exam fees excluded by policy';\n            } else if (!pastWaitingPeriod) {\n              covered = false;\n              reason = `Within ${rules.waitingPeriods.illness}-day waiting period`;\n            }\n\n            return { ...item, covered, reason };\n          });\n\n          const totalCovered = analyzedItems.filter(item => item.covered).reduce((sum, item) => sum + item.amount, 0);\n          const totalNotCovered = analyzedItems.filter(item => !item.covered).reduce((sum, item) => sum + item.amount, 0);\n\n          const reimbursementAmount = totalCovered * (policyData.reimbursement / 100);\n          const remainingDeductible = Math.max(0, policyData.deductible - policyData.deductibleMet);\n          const finalReimbursement = Math.max(0, reimbursementAmount - remainingDeductible);\n          const deductibleUsed = Math.min(remainingDeductible, reimbursementAmount);\n\n          setResults({\n            pastWaitingPeriod,\n            analyzedItems,\n            totalCovered,\n            totalNotCovered,\n            reimbursementAmount,\n            deductibleUsed,\n            finalReimbursement,\n            newDeductibleMet: policyData.deductibleMet + deductibleUsed\n          });\n\n          setIsAnalyzing(false);\n          setStep('results');\n        }, 1500);\n      };\n\n      // Header Component\n      const Header = () => (\n        <div className=\"bg-white border-b border-gray-200\">\n          <div className=\"max-w-6xl mx-auto px-6 py-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-center flex-1\">\n                <div className=\"inline-block\">\n                  <h1 className=\"text-5xl font-bold text-pch-teal tracking-tight\">PCH</h1>\n                  <p className=\"text-pch-orange text-sm font-semibold tracking-wide\">PET CLAIM HELPER</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n\n      if (step === 'upload') {\n        return (\n          <div className=\"min-h-screen\">\n            <Header />\n\n            <div className=\"max-w-5xl mx-auto px-6 py-12\">\n              {/* Hero */}\n              <div className=\"text-center mb-12\">\n                <h2 className=\"text-4xl font-bold text-gray-900 mb-4\">Pet Claim IQ</h2>\n                <p className=\"text-xl text-gray-600 mb-2\">Will your vet bill be covered?</p>\n                <p className=\"text-gray-500\">Find out in seconds—before you file</p>\n              </div>\n\n              {/* Upload Cards */}\n              <div className=\"grid md:grid-cols-2 gap-6 mb-8\">\n                {/* Vet Bill */}\n                <div className=\"bg-white rounded-2xl p-8 shadow-sm border border-gray-100 card-hover\">\n                  <div className=\"text-center\">\n                    <div className=\"w-16 h-16 bg-pch-teal/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                      <FileText className=\"w-8 h-8 text-pch-teal\" />\n                    </div>\n                    <h3 className=\"text-xl font-semibold mb-2 text-gray-900\">Upload Vet Bill</h3>\n                    <p className=\"text-gray-600 mb-6 text-sm\">Photo or PDF of your receipt</p>\n\n                    <label>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*,.pdf\"\n                        onChange={handleVetBillUpload}\n                        className=\"hidden\"\n                      />\n                      <div className=\"bg-pch-teal text-white px-6 py-3 rounded-xl font-semibold cursor-pointer hover:bg-pch-teal-dark transition-colors inline-block\">\n                        {vetBill ? '✓ Bill Uploaded' : 'Choose File'}\n                      </div>\n                    </label>\n\n                    {vetBill && (\n                      <p className=\"mt-3 text-sm text-gray-500\">{vetBill.name}</p>\n                    )}\n                  </div>\n                </div>\n\n                {/* Policy Info */}\n                <div className=\"bg-white rounded-2xl p-8 shadow-sm border border-gray-100 card-hover\">\n                  <div className=\"text-center mb-6\">\n                    <div className=\"w-16 h-16 bg-pch-blue/10 rounded-full flex items-center justify-center mx-auto mb-4\">\n                      <DollarSign className=\"w-8 h-8 text-pch-blue\" />\n                    </div>\n                    <h3 className=\"text-xl font-semibold mb-2 text-gray-900\">Your Policy</h3>\n                    <p className=\"text-gray-600 text-sm\">Tell us about your insurance</p>\n                  </div>\n\n                  <div className=\"flex gap-2 mb-6\">\n                    <button\n                      onClick={() => setPolicyInput('select')}\n                      className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${\n                        policyInput === 'select'\n                          ? 'bg-pch-teal text-white'\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                      }`}\n                    >\n                      Enter Details\n                    </button>\n                    <button\n                      onClick={() => setPolicyInput('upload')}\n                      className={`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${\n                        policyInput === 'upload'\n                          ? 'bg-pch-teal text-white'\n                          : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                      }`}\n                    >\n                      Upload Policy\n                    </button>\n                  </div>\n\n                  {policyInput === 'select' ? (\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide\">Insurance</label>\n                        <select\n                          value={policyData.insurance}\n                          onChange={(e) => setPolicyData(prev => ({ ...prev, insurance: e.target.value }))}\n                          className=\"w-full px-4 py-2.5 rounded-lg border-2 border-gray-200 focus:border-pch-teal focus:outline-none text-sm\"\n                        >\n                          <option value=\"healthy-paws\">Healthy Paws</option>\n                        </select>\n                      </div>\n\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide\">Reimburse %</label>\n                          <input\n                            type=\"number\"\n                            value={policyData.reimbursement}\n                            onChange={(e) => setPolicyData(prev => ({ ...prev, reimbursement: parseInt(e.target.value) }))}\n                            className=\"w-full px-4 py-2.5 rounded-lg border-2 border-gray-200 focus:border-pch-teal focus:outline-none text-sm\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide\">Deductible</label>\n                          <input\n                            type=\"number\"\n                            value={policyData.deductible}\n                            onChange={(e) => setPolicyData(prev => ({ ...prev, deductible: parseInt(e.target.value) }))}\n                            className=\"w-full px-4 py-2.5 rounded-lg border-2 border-gray-200 focus:border-pch-teal focus:outline-none text-sm\"\n                          />\n                        </div>\n                      </div>\n\n                      <div>\n                        <label className=\"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide\">Policy Start</label>\n                        <input\n                          type=\"date\"\n                          value={policyData.policyStart}\n                          onChange={(e) => setPolicyData(prev => ({ ...prev, policyStart: e.target.value }))}\n                          className=\"w-full px-4 py-2.5 rounded-lg border-2 border-gray-200 focus:border-pch-teal focus:outline-none text-sm\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-wide\">Deductible Met <span className=\"text-gray-400 font-normal\">(optional)</span></label>\n                        <input\n                          type=\"number\"\n                          value={policyData.deductibleMet}\n                          onChange={(e) => setPolicyData(prev => ({ ...prev, deductibleMet: parseInt(e.target.value) || 0 }))}\n                          className=\"w-full px-4 py-2.5 rounded-lg border-2 border-gray-200 focus:border-pch-teal focus:outline-none text-sm\"\n                          placeholder=\"$0\"\n                        />\n                      </div>\n                    </div>\n                  ) : (\n                    <label>\n                      <input type=\"file\" accept=\".pdf\" className=\"hidden\" />\n                      <div className=\"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer hover:border-pch-teal transition-colors\">\n                        <Upload className=\"w-10 h-10 text-gray-400 mx-auto mb-2\" />\n                        <p className=\"text-sm text-gray-600\">Upload Declarations Page</p>\n                      </div>\n                    </label>\n                  )}\n                </div>\n              </div>\n\n              {isAnalyzing && (\n                <div className=\"text-center py-8\">\n                  <div className=\"inline-block animate-spin rounded-full h-10 w-10 border-b-2 border-pch-teal\"></div>\n                  <p className=\"mt-4 text-gray-600\">Analyzing your documents...</p>\n                </div>\n              )}\n\n              {/* Footer */}\n              <div className=\"text-center text-sm text-gray-500 mt-12\">\n                <p>Free tool by <a href=\"https://petclaimhelper.com\" className=\"text-pch-teal hover:underline font-semibold\">Pet Claim Helper</a></p>\n                <p className=\"mt-1\">© 2026 Pet Claim Helper</p>\n              </div>\n            </div>\n          </div>\n        );\n      }\n\n      if (step === 'validate') {\n        const isValid = validateExtraction();\n\n        return (\n          <div className=\"min-h-screen\">\n            <Header />\n\n            <div className=\"max-w-4xl mx-auto px-6 py-12\">\n              <h2 className=\"text-3xl font-bold text-center mb-2 text-gray-900\">Review & Confirm</h2>\n              <p className=\"text-center text-gray-600 mb-8\">Make sure everything looks correct</p>\n\n              {/* Bill Details */}\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-6\">\n                <div className=\"flex justify-between items-center mb-6\">\n                  <div>\n                    <h3 className=\"text-lg font-semibold text-gray-900\">{billData.petName}'s Vet Visit</h3>\n                    <p className=\"text-sm text-gray-600\">{new Date(billData.date).toLocaleDateString()} • {billData.clinic}</p>\n                  </div>\n                  {isValid ? (\n                    <div className=\"flex items-center gap-2 text-pch-teal\">\n                      <Check className=\"w-5 h-5\" />\n                      <span className=\"text-sm font-semibold\">Verified</span>\n                    </div>\n                  ) : (\n                    <div className=\"flex items-center gap-2 text-red-600\">\n                      <X className=\"w-5 h-5\" />\n                      <span className=\"text-sm font-semibold\">Check totals</span>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  {billData.lineItems.map((item, idx) => (\n                    <div key={idx} className=\"flex justify-between items-center py-3 px-4 bg-gray-50 rounded-lg\">\n                      <span className=\"text-sm text-gray-700\">{item.description}</span>\n                      <input\n                        type=\"number\"\n                        step=\"0.01\"\n                        value={item.amount}\n                        onChange={(e) => {\n                          const newItems = [...billData.lineItems];\n                          newItems[idx].amount = parseFloat(e.target.value);\n                          setBillData(prev => ({ ...prev, lineItems: newItems }));\n                        }}\n                        className=\"w-24 px-3 py-1.5 rounded border border-gray-300 focus:border-pch-teal focus:outline-none text-right text-sm\"\n                      />\n                    </div>\n                  ))}\n\n                  <div className=\"flex justify-between items-center py-3 px-4 bg-pch-teal/10 rounded-lg font-semibold\">\n                    <span className=\"text-gray-900\">Total</span>\n                    <span className=\"text-lg text-gray-900\">${billData.total.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Policy Summary */}\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8\">\n                <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Policy Summary</h3>\n                <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                  <div>\n                    <p className=\"text-gray-500 mb-1\">Insurance</p>\n                    <p className=\"font-semibold text-gray-900\">Healthy Paws</p>\n                  </div>\n                  <div>\n                    <p className=\"text-gray-500 mb-1\">Reimbursement</p>\n                    <p className=\"font-semibold text-gray-900\">{policyData.reimbursement}%</p>\n                  </div>\n                  <div>\n                    <p className=\"text-gray-500 mb-1\">Deductible</p>\n                    <p className=\"font-semibold text-gray-900\">${policyData.deductible}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-gray-500 mb-1\">Policy Start</p>\n                    <p className=\"font-semibold text-gray-900\">{policyData.policyStart || 'Not set'}</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex gap-4\">\n                <button\n                  onClick={() => setStep('upload')}\n                  className=\"flex-1 py-3 rounded-xl border-2 border-gray-300 font-semibold text-gray-700 hover:bg-gray-50 transition-colors\"\n                >\n                  Back\n                </button>\n                <button\n                  onClick={analyzeCoverage}\n                  disabled={!isValid || !policyData.policyStart}\n                  className=\"flex-1 py-3 rounded-xl bg-pch-teal text-white font-semibold hover:bg-pch-teal-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Analyze Coverage →\n                </button>\n              </div>\n            </div>\n          </div>\n        );\n      }\n\n      if (step === 'results' && results) {\n        const shouldSubmit = results.totalCovered > 0;\n\n        return (\n          <div className=\"min-h-screen\">\n            <Header />\n\n            <div className=\"max-w-4xl mx-auto px-6 py-12\">\n              <h2 className=\"text-3xl font-bold text-center mb-2 text-gray-900\">Coverage Analysis</h2>\n              <p className=\"text-center text-gray-600 mb-8\">{billData.petName}'s Claim • {new Date(billData.date).toLocaleDateString()}</p>\n\n              {/* Recommendation */}\n              <div className={`rounded-2xl p-6 mb-8 ${shouldSubmit ? 'bg-pch-teal/10 border-2 border-pch-teal' : 'bg-red-50 border-2 border-red-500'}`}>\n                <div className=\"flex items-center gap-4\">\n                  <div className={`w-12 h-12 rounded-full flex items-center justify-center ${shouldSubmit ? 'bg-pch-teal' : 'bg-red-500'}`}>\n                    {shouldSubmit ? <Check className=\"w-7 h-7 text-white\" /> : <X className=\"w-7 h-7 text-white\" />}\n                  </div>\n                  <div>\n                    <h3 className={`text-2xl font-bold ${shouldSubmit ? 'text-pch-teal-dark' : 'text-red-900'}`}>\n                      {shouldSubmit ? 'Submit This Claim' : \"Don't Submit Yet\"}\n                    </h3>\n                    <p className={shouldSubmit ? 'text-pch-teal-dark' : 'text-red-700'}>\n                      {shouldSubmit ? 'Parts of this bill are covered' : 'This bill isn't covered by your policy'}\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Breakdown */}\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8\">\n                <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">What's Covered</h3>\n\n                <div className=\"space-y-2 mb-6\">\n                  {results.analyzedItems.map((item, idx) => (\n                    <div key={idx} className={`p-4 rounded-lg ${item.covered ? 'bg-green-50' : 'bg-red-50'}`}>\n                      <div className=\"flex justify-between items-center\">\n                        <div className=\"flex items-center gap-3\">\n                          {item.covered ? <Check className=\"w-5 h-5 text-green-600\" /> : <X className=\"w-5 h-5 text-red-600\" />}\n                          <div>\n                            <p className=\"font-medium text-gray-900\">{item.description}</p>\n                            {!item.covered && <p className=\"text-sm text-red-600\">{item.reason}</p>}\n                          </div>\n                        </div>\n                        <span className=\"font-semibold text-gray-900\">${item.amount.toFixed(2)}</span>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n\n                <div className=\"border-t pt-4 space-y-2\">\n                  <div className=\"flex justify-between text-green-700\">\n                    <span className=\"font-medium\">Covered</span>\n                    <span className=\"font-semibold\">${results.totalCovered.toFixed(2)}</span>\n                  </div>\n                  {results.totalNotCovered > 0 && (\n                    <div className=\"flex justify-between text-red-700\">\n                      <span className=\"font-medium\">Not Covered</span>\n                      <span className=\"font-semibold\">${results.totalNotCovered.toFixed(2)}</span>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Reimbursement */}\n              <div className=\"pch-gradient rounded-2xl p-6 text-white mb-8\">\n                <h3 className=\"text-xl font-semibold mb-6\">Estimated Reimbursement</h3>\n\n                <div className=\"space-y-3 bg-white/10 rounded-xl p-5\">\n                  <div className=\"flex justify-between items-center\">\n                    <span>Covered amount</span>\n                    <span className=\"font-semibold text-lg\">${results.totalCovered.toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span>Your reimbursement ({policyData.reimbursement}%)</span>\n                    <span className=\"font-semibold text-lg\">${results.reimbursementAmount.toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span>Minus deductible</span>\n                    <span className=\"font-semibold text-lg\">-${results.deductibleUsed.toFixed(2)}</span>\n                  </div>\n                  <div className=\"border-t border-white/30 pt-3\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-xl font-bold\">You Get Back</span>\n                      <span className=\"text-3xl font-bold\">${results.finalReimbursement.toFixed(2)}</span>\n                    </div>\n                  </div>\n                </div>\n\n                {results.deductibleUsed > 0 && (\n                  <div className=\"mt-5 bg-white/10 rounded-xl p-4 text-sm\">\n                    <p className=\"mb-1\">\n                      This claim uses <strong>${results.deductibleUsed.toFixed(2)}</strong> of your deductible.\n                    </p>\n                    <p>Remaining: <strong>${(policyData.deductible - results.newDeductibleMet).toFixed(2)}</strong></p>\n                  </div>\n                )}\n              </div>\n\n              {/* Next Steps */}\n              <div className=\"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8\">\n                <h3 className=\"text-lg font-semibold mb-4 text-gray-900\">Next Steps</h3>\n                <ol className=\"space-y-2 text-gray-700\">\n                  <li className=\"flex gap-3\">\n                    <span className=\"text-pch-teal font-bold\">1.</span>\n                    <span>File this claim with Healthy Paws</span>\n                  </li>\n                  <li className=\"flex gap-3\">\n                    <span className=\"text-pch-teal font-bold\">2.</span>\n                    <span>Keep your receipt and this analysis</span>\n                  </li>\n                  <li className=\"flex gap-3\">\n                    <span className=\"text-pch-teal font-bold\">3.</span>\n                    <span>Track your deductible progress</span>\n                  </li>\n                </ol>\n              </div>\n\n              {/* CTAs */}\n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <button\n                  onClick={() => {\n                    setStep('upload');\n                    setResults(null);\n                    setVetBill(null);\n                  }}\n                  className=\"py-3 rounded-xl border-2 border-gray-300 font-semibold text-gray-700 hover:bg-gray-50 transition-colors\"\n                >\n                  Analyze Another Bill\n                </button>\n                <button\n                  onClick={() => window.open('https://petclaimhelper.com', '_blank')}\n                  className=\"py-3 rounded-xl bg-pch-teal text-white font-semibold hover:bg-pch-teal-dark transition-colors\"\n                >\n                  Get Pet Claim Helper →\n                </button>\n              </div>\n\n              {/* Footer */}\n              <div className=\"text-center text-sm text-gray-500 mt-12\">\n                <p>Powered by <a href=\"https://petclaimhelper.com\" className=\"text-pch-teal hover:underline font-semibold\">Pet Claim Helper</a></p>\n              </div>\n            </div>\n          </div>\n        );\n      }\n\n      return null;\n    }\n\n    const root = createRoot(document.getElementById('root'));\n    root.render(<PetClaimIQ />);\n  </script>\n</body>\n</html>\n";
  res.setHeader('Content-Type', 'text/html; charset=utf-8');
  res.setHeader('Cache-Control', 'public, max-age=3600');
  res.status(200).send(html);
};