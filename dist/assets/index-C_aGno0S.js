var Kj=Object.defineProperty;var nN=s=>{throw TypeError(s)};var Yj=(s,e,t)=>e in s?Kj(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var gt=(s,e,t)=>Yj(s,typeof e!="symbol"?e+"":e,t),j5=(s,e,t)=>e.has(s)||nN("Cannot "+t);var d=(s,e,t)=>(j5(s,e,"read from private field"),t?t.call(s):e.get(s)),$=(s,e,t)=>e.has(s)?nN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t),E=(s,e,t,n)=>(j5(s,e,"write to private field"),n?n.call(s,t):e.set(s,t),t),z=(s,e,t)=>(j5(s,e,"access private method"),t);var $r=(s,e,t,n)=>({set _(r){E(s,e,r,t)},get _(){return d(s,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var Ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jj(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Qj(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var r=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return s[n]}})}),t}var WE={exports:{}},ww={},VE={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv=Symbol.for("react.element"),Zj=Symbol.for("react.portal"),eR=Symbol.for("react.fragment"),tR=Symbol.for("react.strict_mode"),nR=Symbol.for("react.profiler"),sR=Symbol.for("react.provider"),rR=Symbol.for("react.context"),iR=Symbol.for("react.forward_ref"),aR=Symbol.for("react.suspense"),oR=Symbol.for("react.memo"),lR=Symbol.for("react.lazy"),sN=Symbol.iterator;function cR(s){return s===null||typeof s!="object"?null:(s=sN&&s[sN]||s["@@iterator"],typeof s=="function"?s:null)}var GE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},XE=Object.assign,KE={};function Zm(s,e,t){this.props=s,this.context=e,this.refs=KE,this.updater=t||GE}Zm.prototype.isReactComponent={};Zm.prototype.setState=function(s,e){if(typeof s!="object"&&typeof s!="function"&&s!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,s,e,"setState")};Zm.prototype.forceUpdate=function(s){this.updater.enqueueForceUpdate(this,s,"forceUpdate")};function YE(){}YE.prototype=Zm.prototype;function PS(s,e,t){this.props=s,this.context=e,this.refs=KE,this.updater=t||GE}var LS=PS.prototype=new YE;LS.constructor=PS;XE(LS,Zm.prototype);LS.isPureReactComponent=!0;var rN=Array.isArray,JE=Object.prototype.hasOwnProperty,TS={current:null},QE={key:!0,ref:!0,__self:!0,__source:!0};function ZE(s,e,t){var n,r={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)JE.call(e,n)&&!QE.hasOwnProperty(n)&&(r[n]=e[n]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];r.children=l}if(s&&s.defaultProps)for(n in o=s.defaultProps,o)r[n]===void 0&&(r[n]=o[n]);return{$$typeof:Dv,type:s,key:i,ref:a,props:r,_owner:TS.current}}function uR(s,e){return{$$typeof:Dv,type:s.type,key:e,ref:s.ref,props:s.props,_owner:s._owner}}function IS(s){return typeof s=="object"&&s!==null&&s.$$typeof===Dv}function dR(s){var e={"=":"=0",":":"=2"};return"$"+s.replace(/[=:]/g,function(t){return e[t]})}var iN=/\/+/g;function R5(s,e){return typeof s=="object"&&s!==null&&s.key!=null?dR(""+s.key):e.toString(36)}function mb(s,e,t,n,r){var i=typeof s;(i==="undefined"||i==="boolean")&&(s=null);var a=!1;if(s===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(s.$$typeof){case Dv:case Zj:a=!0}}if(a)return a=s,r=r(a),s=n===""?"."+R5(a,0):n,rN(r)?(t="",s!=null&&(t=s.replace(iN,"$&/")+"/"),mb(r,e,t,"",function(c){return c})):r!=null&&(IS(r)&&(r=uR(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(iN,"$&/")+"/")+s)),e.push(r)),1;if(a=0,n=n===""?".":n+":",rN(s))for(var o=0;o<s.length;o++){i=s[o];var l=n+R5(i,o);a+=mb(i,e,t,l,r)}else if(l=cR(s),typeof l=="function")for(s=l.call(s),o=0;!(i=s.next()).done;)i=i.value,l=n+R5(i,o++),a+=mb(i,e,t,l,r);else if(i==="object")throw e=String(s),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Iy(s,e,t){if(s==null)return s;var n=[],r=0;return mb(s,n,"","",function(i){return e.call(t,i,r++)}),n}function hR(s){if(s._status===-1){var e=s._result;e=e(),e.then(function(t){(s._status===0||s._status===-1)&&(s._status=1,s._result=t)},function(t){(s._status===0||s._status===-1)&&(s._status=2,s._result=t)}),s._status===-1&&(s._status=0,s._result=e)}if(s._status===1)return s._result.default;throw s._result}var Jr={current:null},gb={transition:null},fR={ReactCurrentDispatcher:Jr,ReactCurrentBatchConfig:gb,ReactCurrentOwner:TS};function e4(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:Iy,forEach:function(s,e,t){Iy(s,function(){e.apply(this,arguments)},t)},count:function(s){var e=0;return Iy(s,function(){e++}),e},toArray:function(s){return Iy(s,function(e){return e})||[]},only:function(s){if(!IS(s))throw Error("React.Children.only expected to receive a single React element child.");return s}};qt.Component=Zm;qt.Fragment=eR;qt.Profiler=nR;qt.PureComponent=PS;qt.StrictMode=tR;qt.Suspense=aR;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fR;qt.act=e4;qt.cloneElement=function(s,e,t){if(s==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+s+".");var n=XE({},s.props),r=s.key,i=s.ref,a=s._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=TS.current),e.key!==void 0&&(r=""+e.key),s.type&&s.type.defaultProps)var o=s.type.defaultProps;for(l in e)JE.call(e,l)&&!QE.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Dv,type:s.type,key:r,ref:i,props:n,_owner:a}};qt.createContext=function(s){return s={$$typeof:rR,_currentValue:s,_currentValue2:s,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},s.Provider={$$typeof:sR,_context:s},s.Consumer=s};qt.createElement=ZE;qt.createFactory=function(s){var e=ZE.bind(null,s);return e.type=s,e};qt.createRef=function(){return{current:null}};qt.forwardRef=function(s){return{$$typeof:iR,render:s}};qt.isValidElement=IS;qt.lazy=function(s){return{$$typeof:lR,_payload:{_status:-1,_result:s},_init:hR}};qt.memo=function(s,e){return{$$typeof:oR,type:s,compare:e===void 0?null:e}};qt.startTransition=function(s){var e=gb.transition;gb.transition={};try{s()}finally{gb.transition=e}};qt.unstable_act=e4;qt.useCallback=function(s,e){return Jr.current.useCallback(s,e)};qt.useContext=function(s){return Jr.current.useContext(s)};qt.useDebugValue=function(){};qt.useDeferredValue=function(s){return Jr.current.useDeferredValue(s)};qt.useEffect=function(s,e){return Jr.current.useEffect(s,e)};qt.useId=function(){return Jr.current.useId()};qt.useImperativeHandle=function(s,e,t){return Jr.current.useImperativeHandle(s,e,t)};qt.useInsertionEffect=function(s,e){return Jr.current.useInsertionEffect(s,e)};qt.useLayoutEffect=function(s,e){return Jr.current.useLayoutEffect(s,e)};qt.useMemo=function(s,e){return Jr.current.useMemo(s,e)};qt.useReducer=function(s,e,t){return Jr.current.useReducer(s,e,t)};qt.useRef=function(s){return Jr.current.useRef(s)};qt.useState=function(s){return Jr.current.useState(s)};qt.useSyncExternalStore=function(s,e,t){return Jr.current.useSyncExternalStore(s,e,t)};qt.useTransition=function(){return Jr.current.useTransition()};qt.version="18.3.1";VE.exports=qt;var xe=VE.exports;const pR=Jj(xe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mR=xe,gR=Symbol.for("react.element"),vR=Symbol.for("react.fragment"),yR=Object.prototype.hasOwnProperty,bR=mR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wR={key:!0,ref:!0,__self:!0,__source:!0};function t4(s,e,t){var n,r={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)yR.call(e,n)&&!wR.hasOwnProperty(n)&&(r[n]=e[n]);if(s&&s.defaultProps)for(n in e=s.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:gR,type:s,key:i,ref:a,props:r,_owner:bR.current}}ww.Fragment=vR;ww.jsx=t4;ww.jsxs=t4;WE.exports=ww;var v=WE.exports,Ux={},n4={exports:{}},na={},s4={exports:{}},r4={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(s){function e(Z,he){var me=Z.length;Z.push(he);e:for(;0<me;){var Ne=me-1>>>1,L=Z[Ne];if(0<r(L,he))Z[Ne]=he,Z[me]=L,me=Ne;else break e}}function t(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var he=Z[0],me=Z.pop();if(me!==he){Z[0]=me;e:for(var Ne=0,L=Z.length,V=L>>>1;Ne<V;){var Q=2*(Ne+1)-1,se=Z[Q],re=Q+1,de=Z[re];if(0>r(se,me))re<L&&0>r(de,se)?(Z[Ne]=de,Z[re]=me,Ne=re):(Z[Ne]=se,Z[Q]=me,Ne=Q);else if(re<L&&0>r(de,me))Z[Ne]=de,Z[re]=me,Ne=re;else break e}}return he}function r(Z,he){var me=Z.sortIndex-he.sortIndex;return me!==0?me:Z.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;s.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();s.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,p=3,m=!1,b=!1,y=!1,S=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(Z){for(var he=t(c);he!==null;){if(he.callback===null)n(c);else if(he.startTime<=Z)n(c),he.sortIndex=he.expirationTime,e(l,he);else break;he=t(c)}}function C(Z){if(y=!1,k(Z),!b)if(t(l)!==null)b=!0,te(B);else{var he=t(c);he!==null&&ue(C,he.startTime-Z)}}function B(Z,he){b=!1,y&&(y=!1,w(T),T=-1),m=!0;var me=p;try{for(k(he),f=t(l);f!==null&&(!(f.expirationTime>he)||Z&&!I());){var Ne=f.callback;if(typeof Ne=="function"){f.callback=null,p=f.priorityLevel;var L=Ne(f.expirationTime<=he);he=s.unstable_now(),typeof L=="function"?f.callback=L:f===t(l)&&n(l),k(he)}else n(l);f=t(l)}if(f!==null)var V=!0;else{var Q=t(c);Q!==null&&ue(C,Q.startTime-he),V=!1}return V}finally{f=null,p=me,m=!1}}var F=!1,j=null,T=-1,W=5,Y=-1;function I(){return!(s.unstable_now()-Y<W)}function O(){if(j!==null){var Z=s.unstable_now();Y=Z;var he=!0;try{he=j(!0,Z)}finally{he?X():(F=!1,j=null)}}else F=!1}var X;if(typeof _=="function")X=function(){_(O)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,ne=K.port2;K.port1.onmessage=O,X=function(){ne.postMessage(null)}}else X=function(){S(O,0)};function te(Z){j=Z,F||(F=!0,X())}function ue(Z,he){T=S(function(){Z(s.unstable_now())},he)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(Z){Z.callback=null},s.unstable_continueExecution=function(){b||m||(b=!0,te(B))},s.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<Z?Math.floor(1e3/Z):5},s.unstable_getCurrentPriorityLevel=function(){return p},s.unstable_getFirstCallbackNode=function(){return t(l)},s.unstable_next=function(Z){switch(p){case 1:case 2:case 3:var he=3;break;default:he=p}var me=p;p=he;try{return Z()}finally{p=me}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(Z,he){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var me=p;p=Z;try{return he()}finally{p=me}},s.unstable_scheduleCallback=function(Z,he,me){var Ne=s.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?Ne+me:Ne):me=Ne,Z){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=me+L,Z={id:u++,callback:he,priorityLevel:Z,startTime:me,expirationTime:L,sortIndex:-1},me>Ne?(Z.sortIndex=me,e(c,Z),t(l)===null&&Z===t(c)&&(y?(w(T),T=-1):y=!0,ue(C,me-Ne))):(Z.sortIndex=L,e(l,Z),b||m||(b=!0,te(B))),Z},s.unstable_shouldYield=I,s.unstable_wrapCallback=function(Z){var he=p;return function(){var me=p;p=he;try{return Z.apply(this,arguments)}finally{p=me}}}})(r4);s4.exports=r4;var xR=s4.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _R=xe,ta=xR;function Me(s){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+s,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+s+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i4=new Set,z0={};function rf(s,e){Wm(s,e),Wm(s+"Capture",e)}function Wm(s,e){for(z0[s]=e,s=0;s<e.length;s++)i4.add(e[s])}var fc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zx=Object.prototype.hasOwnProperty,AR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,aN={},oN={};function SR(s){return zx.call(oN,s)?!0:zx.call(aN,s)?!1:AR.test(s)?oN[s]=!0:(aN[s]=!0,!1)}function kR(s,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function NR(s,e,t,n){if(e===null||typeof e>"u"||kR(s,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Qr(s,e,t,n,r,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=s,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var dr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){dr[s]=new Qr(s,0,!1,s,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var e=s[0];dr[e]=new Qr(e,1,!1,s[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(s){dr[s]=new Qr(s,2,!1,s.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){dr[s]=new Qr(s,2,!1,s,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){dr[s]=new Qr(s,3,!1,s.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(s){dr[s]=new Qr(s,3,!0,s,null,!1,!1)});["capture","download"].forEach(function(s){dr[s]=new Qr(s,4,!1,s,null,!1,!1)});["cols","rows","size","span"].forEach(function(s){dr[s]=new Qr(s,6,!1,s,null,!1,!1)});["rowSpan","start"].forEach(function(s){dr[s]=new Qr(s,5,!1,s.toLowerCase(),null,!1,!1)});var jS=/[\-:]([a-z])/g;function RS(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var e=s.replace(jS,RS);dr[e]=new Qr(e,1,!1,s,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var e=s.replace(jS,RS);dr[e]=new Qr(e,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(s){var e=s.replace(jS,RS);dr[e]=new Qr(e,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(s){dr[s]=new Qr(s,1,!1,s.toLowerCase(),null,!1,!1)});dr.xlinkHref=new Qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(s){dr[s]=new Qr(s,1,!1,s.toLowerCase(),null,!0,!0)});function OS(s,e,t,n){var r=dr.hasOwnProperty(e)?dr[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(NR(e,t,r,n)&&(t=null),n||r===null?SR(e)&&(t===null?s.removeAttribute(e):s.setAttribute(e,""+t)):r.mustUseProperty?s[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,n=r.attributeNamespace,t===null?s.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,n?s.setAttributeNS(n,e,t):s.setAttribute(e,t))))}var bc=_R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jy=Symbol.for("react.element"),lp=Symbol.for("react.portal"),cp=Symbol.for("react.fragment"),MS=Symbol.for("react.strict_mode"),qx=Symbol.for("react.profiler"),a4=Symbol.for("react.provider"),o4=Symbol.for("react.context"),FS=Symbol.for("react.forward_ref"),Hx=Symbol.for("react.suspense"),Wx=Symbol.for("react.suspense_list"),DS=Symbol.for("react.memo"),Yc=Symbol.for("react.lazy"),l4=Symbol.for("react.offscreen"),lN=Symbol.iterator;function Fg(s){return s===null||typeof s!="object"?null:(s=lN&&s[lN]||s["@@iterator"],typeof s=="function"?s:null)}var Yn=Object.assign,O5;function Qg(s){if(O5===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);O5=e&&e[1]||""}return`
`+O5+s}var M5=!1;function F5(s,e){if(!s||M5)return"";M5=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(s,[],e)}else{try{e.call()}catch(c){n=c}s.call(e.prototype)}else{try{throw Error()}catch(c){n=c}s()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),i=n.stack.split(`
`),a=r.length-1,o=i.length-1;1<=a&&0<=o&&r[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==i[o]){var l=`
`+r[a].replace(" at new "," at ");return s.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",s.displayName)),l}while(1<=a&&0<=o);break}}}finally{M5=!1,Error.prepareStackTrace=t}return(s=s?s.displayName||s.name:"")?Qg(s):""}function CR(s){switch(s.tag){case 5:return Qg(s.type);case 16:return Qg("Lazy");case 13:return Qg("Suspense");case 19:return Qg("SuspenseList");case 0:case 2:case 15:return s=F5(s.type,!1),s;case 11:return s=F5(s.type.render,!1),s;case 1:return s=F5(s.type,!0),s;default:return""}}function Vx(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case cp:return"Fragment";case lp:return"Portal";case qx:return"Profiler";case MS:return"StrictMode";case Hx:return"Suspense";case Wx:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case o4:return(s.displayName||"Context")+".Consumer";case a4:return(s._context.displayName||"Context")+".Provider";case FS:var e=s.render;return s=s.displayName,s||(s=e.displayName||e.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case DS:return e=s.displayName||null,e!==null?e:Vx(s.type)||"Memo";case Yc:e=s._payload,s=s._init;try{return Vx(s(e))}catch{}}return null}function ER(s){var e=s.type;switch(s.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=e.render,s=s.displayName||s.name||"",e.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vx(e);case 8:return e===MS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Wu(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function c4(s){var e=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function PR(s){var e=c4(s)?"checked":"value",t=Object.getOwnPropertyDescriptor(s.constructor.prototype,e),n=""+s[e];if(!s.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,i=t.set;return Object.defineProperty(s,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(s,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){s._valueTracker=null,delete s[e]}}}}function Ry(s){s._valueTracker||(s._valueTracker=PR(s))}function u4(s){if(!s)return!1;var e=s._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return s&&(n=c4(s)?s.checked?"true":"false":s.value),s=n,s!==t?(e.setValue(s),!0):!1}function f2(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Gx(s,e){var t=e.checked;return Yn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??s._wrapperState.initialChecked})}function cN(s,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=Wu(e.value!=null?e.value:t),s._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function d4(s,e){e=e.checked,e!=null&&OS(s,"checked",e,!1)}function Xx(s,e){d4(s,e);var t=Wu(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&s.value===""||s.value!=t)&&(s.value=""+t):s.value!==""+t&&(s.value=""+t);else if(n==="submit"||n==="reset"){s.removeAttribute("value");return}e.hasOwnProperty("value")?Kx(s,e.type,t):e.hasOwnProperty("defaultValue")&&Kx(s,e.type,Wu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(s.defaultChecked=!!e.defaultChecked)}function uN(s,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+s._wrapperState.initialValue,t||e===s.value||(s.value=e),s.defaultValue=e}t=s.name,t!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,t!==""&&(s.name=t)}function Kx(s,e,t){(e!=="number"||f2(s.ownerDocument)!==s)&&(t==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+t&&(s.defaultValue=""+t))}var Zg=Array.isArray;function Sp(s,e,t,n){if(s=s.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<s.length;t++)r=e.hasOwnProperty("$"+s[t].value),s[t].selected!==r&&(s[t].selected=r),r&&n&&(s[t].defaultSelected=!0)}else{for(t=""+Wu(t),e=null,r=0;r<s.length;r++){if(s[r].value===t){s[r].selected=!0,n&&(s[r].defaultSelected=!0);return}e!==null||s[r].disabled||(e=s[r])}e!==null&&(e.selected=!0)}}function Yx(s,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Me(91));return Yn({},e,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function dN(s,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Me(92));if(Zg(t)){if(1<t.length)throw Error(Me(93));t=t[0]}e=t}e==null&&(e=""),t=e}s._wrapperState={initialValue:Wu(t)}}function h4(s,e){var t=Wu(e.value),n=Wu(e.defaultValue);t!=null&&(t=""+t,t!==s.value&&(s.value=t),e.defaultValue==null&&s.defaultValue!==t&&(s.defaultValue=t)),n!=null&&(s.defaultValue=""+n)}function hN(s){var e=s.textContent;e===s._wrapperState.initialValue&&e!==""&&e!==null&&(s.value=e)}function f4(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jx(s,e){return s==null||s==="http://www.w3.org/1999/xhtml"?f4(e):s==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Oy,p4=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return s(e,t,n,r)})}:s}(function(s,e){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=e;else{for(Oy=Oy||document.createElement("div"),Oy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Oy.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;e.firstChild;)s.appendChild(e.firstChild)}});function q0(s,e){if(e){var t=s.firstChild;if(t&&t===s.lastChild&&t.nodeType===3){t.nodeValue=e;return}}s.textContent=e}var k0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LR=["Webkit","ms","Moz","O"];Object.keys(k0).forEach(function(s){LR.forEach(function(e){e=e+s.charAt(0).toUpperCase()+s.substring(1),k0[e]=k0[s]})});function m4(s,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||k0.hasOwnProperty(s)&&k0[s]?(""+e).trim():e+"px"}function g4(s,e){s=s.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,r=m4(t,e[t],n);t==="float"&&(t="cssFloat"),n?s.setProperty(t,r):s[t]=r}}var TR=Yn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qx(s,e){if(e){if(TR[s]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Me(137,s));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Me(62))}}function Zx(s,e){if(s.indexOf("-")===-1)return typeof e.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var e_=null;function BS(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var t_=null,kp=null,Np=null;function fN(s){if(s=Uv(s)){if(typeof t_!="function")throw Error(Me(280));var e=s.stateNode;e&&(e=kw(e),t_(s.stateNode,s.type,e))}}function v4(s){kp?Np?Np.push(s):Np=[s]:kp=s}function y4(){if(kp){var s=kp,e=Np;if(Np=kp=null,fN(s),e)for(s=0;s<e.length;s++)fN(e[s])}}function b4(s,e){return s(e)}function w4(){}var D5=!1;function x4(s,e,t){if(D5)return s(e,t);D5=!0;try{return b4(s,e,t)}finally{D5=!1,(kp!==null||Np!==null)&&(w4(),y4())}}function H0(s,e){var t=s.stateNode;if(t===null)return null;var n=kw(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(s=s.type,n=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!n;break e;default:s=!1}if(s)return null;if(t&&typeof t!="function")throw Error(Me(231,e,typeof t));return t}var n_=!1;if(fc)try{var Dg={};Object.defineProperty(Dg,"passive",{get:function(){n_=!0}}),window.addEventListener("test",Dg,Dg),window.removeEventListener("test",Dg,Dg)}catch{n_=!1}function IR(s,e,t,n,r,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var N0=!1,p2=null,m2=!1,s_=null,jR={onError:function(s){N0=!0,p2=s}};function RR(s,e,t,n,r,i,a,o,l){N0=!1,p2=null,IR.apply(jR,arguments)}function OR(s,e,t,n,r,i,a,o,l){if(RR.apply(this,arguments),N0){if(N0){var c=p2;N0=!1,p2=null}else throw Error(Me(198));m2||(m2=!0,s_=c)}}function af(s){var e=s,t=s;if(s.alternate)for(;e.return;)e=e.return;else{s=e;do e=s,e.flags&4098&&(t=e.return),s=e.return;while(s)}return e.tag===3?t:null}function _4(s){if(s.tag===13){var e=s.memoizedState;if(e===null&&(s=s.alternate,s!==null&&(e=s.memoizedState)),e!==null)return e.dehydrated}return null}function pN(s){if(af(s)!==s)throw Error(Me(188))}function MR(s){var e=s.alternate;if(!e){if(e=af(s),e===null)throw Error(Me(188));return e!==s?null:s}for(var t=s,n=e;;){var r=t.return;if(r===null)break;var i=r.alternate;if(i===null){if(n=r.return,n!==null){t=n;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===t)return pN(r),s;if(i===n)return pN(r),e;i=i.sibling}throw Error(Me(188))}if(t.return!==n.return)t=r,n=i;else{for(var a=!1,o=r.child;o;){if(o===t){a=!0,t=r,n=i;break}if(o===n){a=!0,n=r,t=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===t){a=!0,t=i,n=r;break}if(o===n){a=!0,n=i,t=r;break}o=o.sibling}if(!a)throw Error(Me(189))}}if(t.alternate!==n)throw Error(Me(190))}if(t.tag!==3)throw Error(Me(188));return t.stateNode.current===t?s:e}function A4(s){return s=MR(s),s!==null?S4(s):null}function S4(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var e=S4(s);if(e!==null)return e;s=s.sibling}return null}var k4=ta.unstable_scheduleCallback,mN=ta.unstable_cancelCallback,FR=ta.unstable_shouldYield,DR=ta.unstable_requestPaint,cs=ta.unstable_now,BR=ta.unstable_getCurrentPriorityLevel,$S=ta.unstable_ImmediatePriority,N4=ta.unstable_UserBlockingPriority,g2=ta.unstable_NormalPriority,$R=ta.unstable_LowPriority,C4=ta.unstable_IdlePriority,xw=null,ul=null;function UR(s){if(ul&&typeof ul.onCommitFiberRoot=="function")try{ul.onCommitFiberRoot(xw,s,void 0,(s.current.flags&128)===128)}catch{}}var vo=Math.clz32?Math.clz32:HR,zR=Math.log,qR=Math.LN2;function HR(s){return s>>>=0,s===0?32:31-(zR(s)/qR|0)|0}var My=64,Fy=4194304;function e0(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function v2(s,e){var t=s.pendingLanes;if(t===0)return 0;var n=0,r=s.suspendedLanes,i=s.pingedLanes,a=t&268435455;if(a!==0){var o=a&~r;o!==0?n=e0(o):(i&=a,i!==0&&(n=e0(i)))}else a=t&~r,a!==0?n=e0(a):i!==0&&(n=e0(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(n&4&&(n|=t&16),e=s.entangledLanes,e!==0)for(s=s.entanglements,e&=n;0<e;)t=31-vo(e),r=1<<t,n|=s[t],e&=~r;return n}function WR(s,e){switch(s){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VR(s,e){for(var t=s.suspendedLanes,n=s.pingedLanes,r=s.expirationTimes,i=s.pendingLanes;0<i;){var a=31-vo(i),o=1<<a,l=r[a];l===-1?(!(o&t)||o&n)&&(r[a]=WR(o,e)):l<=e&&(s.expiredLanes|=o),i&=~o}}function r_(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function E4(){var s=My;return My<<=1,!(My&4194240)&&(My=64),s}function B5(s){for(var e=[],t=0;31>t;t++)e.push(s);return e}function Bv(s,e,t){s.pendingLanes|=e,e!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,e=31-vo(e),s[e]=t}function GR(s,e){var t=s.pendingLanes&~e;s.pendingLanes=e,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=e,s.mutableReadLanes&=e,s.entangledLanes&=e,e=s.entanglements;var n=s.eventTimes;for(s=s.expirationTimes;0<t;){var r=31-vo(t),i=1<<r;e[r]=0,n[r]=-1,s[r]=-1,t&=~i}}function US(s,e){var t=s.entangledLanes|=e;for(s=s.entanglements;t;){var n=31-vo(t),r=1<<n;r&e|s[n]&e&&(s[n]|=e),t&=~r}}var pn=0;function P4(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var L4,zS,T4,I4,j4,i_=!1,Dy=[],Ou=null,Mu=null,Fu=null,W0=new Map,V0=new Map,Qc=[],XR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gN(s,e){switch(s){case"focusin":case"focusout":Ou=null;break;case"dragenter":case"dragleave":Mu=null;break;case"mouseover":case"mouseout":Fu=null;break;case"pointerover":case"pointerout":W0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":V0.delete(e.pointerId)}}function Bg(s,e,t,n,r,i){return s===null||s.nativeEvent!==i?(s={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:i,targetContainers:[r]},e!==null&&(e=Uv(e),e!==null&&zS(e)),s):(s.eventSystemFlags|=n,e=s.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),s)}function KR(s,e,t,n,r){switch(e){case"focusin":return Ou=Bg(Ou,s,e,t,n,r),!0;case"dragenter":return Mu=Bg(Mu,s,e,t,n,r),!0;case"mouseover":return Fu=Bg(Fu,s,e,t,n,r),!0;case"pointerover":var i=r.pointerId;return W0.set(i,Bg(W0.get(i)||null,s,e,t,n,r)),!0;case"gotpointercapture":return i=r.pointerId,V0.set(i,Bg(V0.get(i)||null,s,e,t,n,r)),!0}return!1}function R4(s){var e=Md(s.target);if(e!==null){var t=af(e);if(t!==null){if(e=t.tag,e===13){if(e=_4(t),e!==null){s.blockedOn=e,j4(s.priority,function(){T4(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){s.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}s.blockedOn=null}function vb(s){if(s.blockedOn!==null)return!1;for(var e=s.targetContainers;0<e.length;){var t=a_(s.domEventName,s.eventSystemFlags,e[0],s.nativeEvent);if(t===null){t=s.nativeEvent;var n=new t.constructor(t.type,t);e_=n,t.target.dispatchEvent(n),e_=null}else return e=Uv(t),e!==null&&zS(e),s.blockedOn=t,!1;e.shift()}return!0}function vN(s,e,t){vb(s)&&t.delete(e)}function YR(){i_=!1,Ou!==null&&vb(Ou)&&(Ou=null),Mu!==null&&vb(Mu)&&(Mu=null),Fu!==null&&vb(Fu)&&(Fu=null),W0.forEach(vN),V0.forEach(vN)}function $g(s,e){s.blockedOn===e&&(s.blockedOn=null,i_||(i_=!0,ta.unstable_scheduleCallback(ta.unstable_NormalPriority,YR)))}function G0(s){function e(r){return $g(r,s)}if(0<Dy.length){$g(Dy[0],s);for(var t=1;t<Dy.length;t++){var n=Dy[t];n.blockedOn===s&&(n.blockedOn=null)}}for(Ou!==null&&$g(Ou,s),Mu!==null&&$g(Mu,s),Fu!==null&&$g(Fu,s),W0.forEach(e),V0.forEach(e),t=0;t<Qc.length;t++)n=Qc[t],n.blockedOn===s&&(n.blockedOn=null);for(;0<Qc.length&&(t=Qc[0],t.blockedOn===null);)R4(t),t.blockedOn===null&&Qc.shift()}var Cp=bc.ReactCurrentBatchConfig,y2=!0;function JR(s,e,t,n){var r=pn,i=Cp.transition;Cp.transition=null;try{pn=1,qS(s,e,t,n)}finally{pn=r,Cp.transition=i}}function QR(s,e,t,n){var r=pn,i=Cp.transition;Cp.transition=null;try{pn=4,qS(s,e,t,n)}finally{pn=r,Cp.transition=i}}function qS(s,e,t,n){if(y2){var r=a_(s,e,t,n);if(r===null)K5(s,e,n,b2,t),gN(s,n);else if(KR(r,s,e,t,n))n.stopPropagation();else if(gN(s,n),e&4&&-1<XR.indexOf(s)){for(;r!==null;){var i=Uv(r);if(i!==null&&L4(i),i=a_(s,e,t,n),i===null&&K5(s,e,n,b2,t),i===r)break;r=i}r!==null&&n.stopPropagation()}else K5(s,e,n,null,t)}}var b2=null;function a_(s,e,t,n){if(b2=null,s=BS(n),s=Md(s),s!==null)if(e=af(s),e===null)s=null;else if(t=e.tag,t===13){if(s=_4(e),s!==null)return s;s=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;s=null}else e!==s&&(s=null);return b2=s,null}function O4(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BR()){case $S:return 1;case N4:return 4;case g2:case $R:return 16;case C4:return 536870912;default:return 16}default:return 16}}var Iu=null,HS=null,yb=null;function M4(){if(yb)return yb;var s,e=HS,t=e.length,n,r="value"in Iu?Iu.value:Iu.textContent,i=r.length;for(s=0;s<t&&e[s]===r[s];s++);var a=t-s;for(n=1;n<=a&&e[t-n]===r[i-n];n++);return yb=r.slice(s,1<n?1-n:void 0)}function bb(s){var e=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&e===13&&(s=13)):s=e,s===10&&(s=13),32<=s||s===13?s:0}function By(){return!0}function yN(){return!1}function sa(s){function e(t,n,r,i,a){this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in s)s.hasOwnProperty(o)&&(t=s[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?By:yN,this.isPropagationStopped=yN,this}return Yn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=By)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=By)},persist:function(){},isPersistent:By}),e}var eg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},WS=sa(eg),$v=Yn({},eg,{view:0,detail:0}),ZR=sa($v),$5,U5,Ug,_w=Yn({},$v,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:VS,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ug&&(Ug&&s.type==="mousemove"?($5=s.screenX-Ug.screenX,U5=s.screenY-Ug.screenY):U5=$5=0,Ug=s),$5)},movementY:function(s){return"movementY"in s?s.movementY:U5}}),bN=sa(_w),e8=Yn({},_w,{dataTransfer:0}),t8=sa(e8),n8=Yn({},$v,{relatedTarget:0}),z5=sa(n8),s8=Yn({},eg,{animationName:0,elapsedTime:0,pseudoElement:0}),r8=sa(s8),i8=Yn({},eg,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),a8=sa(i8),o8=Yn({},eg,{data:0}),wN=sa(o8),l8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function d8(s){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(s):(s=u8[s])?!!e[s]:!1}function VS(){return d8}var h8=Yn({},$v,{key:function(s){if(s.key){var e=l8[s.key]||s.key;if(e!=="Unidentified")return e}return s.type==="keypress"?(s=bb(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?c8[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:VS,charCode:function(s){return s.type==="keypress"?bb(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?bb(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),f8=sa(h8),p8=Yn({},_w,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xN=sa(p8),m8=Yn({},$v,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:VS}),g8=sa(m8),v8=Yn({},eg,{propertyName:0,elapsedTime:0,pseudoElement:0}),y8=sa(v8),b8=Yn({},_w,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),w8=sa(b8),x8=[9,13,27,32],GS=fc&&"CompositionEvent"in window,C0=null;fc&&"documentMode"in document&&(C0=document.documentMode);var _8=fc&&"TextEvent"in window&&!C0,F4=fc&&(!GS||C0&&8<C0&&11>=C0),_N=" ",AN=!1;function D4(s,e){switch(s){case"keyup":return x8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B4(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var up=!1;function A8(s,e){switch(s){case"compositionend":return B4(e);case"keypress":return e.which!==32?null:(AN=!0,_N);case"textInput":return s=e.data,s===_N&&AN?null:s;default:return null}}function S8(s,e){if(up)return s==="compositionend"||!GS&&D4(s,e)?(s=M4(),yb=HS=Iu=null,up=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return F4&&e.locale!=="ko"?null:e.data;default:return null}}var k8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function SN(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e==="input"?!!k8[s.type]:e==="textarea"}function $4(s,e,t,n){v4(n),e=w2(e,"onChange"),0<e.length&&(t=new WS("onChange","change",null,t,n),s.push({event:t,listeners:e}))}var E0=null,X0=null;function N8(s){J4(s,0)}function Aw(s){var e=fp(s);if(u4(e))return s}function C8(s,e){if(s==="change")return e}var U4=!1;if(fc){var q5;if(fc){var H5="oninput"in document;if(!H5){var kN=document.createElement("div");kN.setAttribute("oninput","return;"),H5=typeof kN.oninput=="function"}q5=H5}else q5=!1;U4=q5&&(!document.documentMode||9<document.documentMode)}function NN(){E0&&(E0.detachEvent("onpropertychange",z4),X0=E0=null)}function z4(s){if(s.propertyName==="value"&&Aw(X0)){var e=[];$4(e,X0,s,BS(s)),x4(N8,e)}}function E8(s,e,t){s==="focusin"?(NN(),E0=e,X0=t,E0.attachEvent("onpropertychange",z4)):s==="focusout"&&NN()}function P8(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Aw(X0)}function L8(s,e){if(s==="click")return Aw(e)}function T8(s,e){if(s==="input"||s==="change")return Aw(e)}function I8(s,e){return s===e&&(s!==0||1/s===1/e)||s!==s&&e!==e}var bo=typeof Object.is=="function"?Object.is:I8;function K0(s,e){if(bo(s,e))return!0;if(typeof s!="object"||s===null||typeof e!="object"||e===null)return!1;var t=Object.keys(s),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var r=t[n];if(!zx.call(e,r)||!bo(s[r],e[r]))return!1}return!0}function CN(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function EN(s,e){var t=CN(s);s=0;for(var n;t;){if(t.nodeType===3){if(n=s+t.textContent.length,s<=e&&n>=e)return{node:t,offset:e-s};s=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=CN(t)}}function q4(s,e){return s&&e?s===e?!0:s&&s.nodeType===3?!1:e&&e.nodeType===3?q4(s,e.parentNode):"contains"in s?s.contains(e):s.compareDocumentPosition?!!(s.compareDocumentPosition(e)&16):!1:!1}function H4(){for(var s=window,e=f2();e instanceof s.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)s=e.contentWindow;else break;e=f2(s.document)}return e}function XS(s){var e=s&&s.nodeName&&s.nodeName.toLowerCase();return e&&(e==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||e==="textarea"||s.contentEditable==="true")}function j8(s){var e=H4(),t=s.focusedElem,n=s.selectionRange;if(e!==t&&t&&t.ownerDocument&&q4(t.ownerDocument.documentElement,t)){if(n!==null&&XS(t)){if(e=n.start,s=n.end,s===void 0&&(s=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(s,t.value.length);else if(s=(e=t.ownerDocument||document)&&e.defaultView||window,s.getSelection){s=s.getSelection();var r=t.textContent.length,i=Math.min(n.start,r);n=n.end===void 0?i:Math.min(n.end,r),!s.extend&&i>n&&(r=n,n=i,i=r),r=EN(t,i);var a=EN(t,n);r&&a&&(s.rangeCount!==1||s.anchorNode!==r.node||s.anchorOffset!==r.offset||s.focusNode!==a.node||s.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),s.removeAllRanges(),i>n?(s.addRange(e),s.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),s.addRange(e)))}}for(e=[],s=t;s=s.parentNode;)s.nodeType===1&&e.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)s=e[t],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var R8=fc&&"documentMode"in document&&11>=document.documentMode,dp=null,o_=null,P0=null,l_=!1;function PN(s,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;l_||dp==null||dp!==f2(n)||(n=dp,"selectionStart"in n&&XS(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),P0&&K0(P0,n)||(P0=n,n=w2(o_,"onSelect"),0<n.length&&(e=new WS("onSelect","select",null,e,t),s.push({event:e,listeners:n}),e.target=dp)))}function $y(s,e){var t={};return t[s.toLowerCase()]=e.toLowerCase(),t["Webkit"+s]="webkit"+e,t["Moz"+s]="moz"+e,t}var hp={animationend:$y("Animation","AnimationEnd"),animationiteration:$y("Animation","AnimationIteration"),animationstart:$y("Animation","AnimationStart"),transitionend:$y("Transition","TransitionEnd")},W5={},W4={};fc&&(W4=document.createElement("div").style,"AnimationEvent"in window||(delete hp.animationend.animation,delete hp.animationiteration.animation,delete hp.animationstart.animation),"TransitionEvent"in window||delete hp.transitionend.transition);function Sw(s){if(W5[s])return W5[s];if(!hp[s])return s;var e=hp[s],t;for(t in e)if(e.hasOwnProperty(t)&&t in W4)return W5[s]=e[t];return s}var V4=Sw("animationend"),G4=Sw("animationiteration"),X4=Sw("animationstart"),K4=Sw("transitionend"),Y4=new Map,LN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zu(s,e){Y4.set(s,e),rf(e,[s])}for(var V5=0;V5<LN.length;V5++){var G5=LN[V5],O8=G5.toLowerCase(),M8=G5[0].toUpperCase()+G5.slice(1);Zu(O8,"on"+M8)}Zu(V4,"onAnimationEnd");Zu(G4,"onAnimationIteration");Zu(X4,"onAnimationStart");Zu("dblclick","onDoubleClick");Zu("focusin","onFocus");Zu("focusout","onBlur");Zu(K4,"onTransitionEnd");Wm("onMouseEnter",["mouseout","mouseover"]);Wm("onMouseLeave",["mouseout","mouseover"]);Wm("onPointerEnter",["pointerout","pointerover"]);Wm("onPointerLeave",["pointerout","pointerover"]);rf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rf("onBeforeInput",["compositionend","keypress","textInput","paste"]);rf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var t0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F8=new Set("cancel close invalid load scroll toggle".split(" ").concat(t0));function TN(s,e,t){var n=s.type||"unknown-event";s.currentTarget=t,OR(n,e,void 0,s),s.currentTarget=null}function J4(s,e){e=(e&4)!==0;for(var t=0;t<s.length;t++){var n=s[t],r=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&r.isPropagationStopped())break e;TN(r,o,c),i=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&r.isPropagationStopped())break e;TN(r,o,c),i=l}}}if(m2)throw s=s_,m2=!1,s_=null,s}function Tn(s,e){var t=e[f_];t===void 0&&(t=e[f_]=new Set);var n=s+"__bubble";t.has(n)||(Q4(e,s,2,!1),t.add(n))}function X5(s,e,t){var n=0;e&&(n|=4),Q4(t,s,n,e)}var Uy="_reactListening"+Math.random().toString(36).slice(2);function Y0(s){if(!s[Uy]){s[Uy]=!0,i4.forEach(function(t){t!=="selectionchange"&&(F8.has(t)||X5(t,!1,s),X5(t,!0,s))});var e=s.nodeType===9?s:s.ownerDocument;e===null||e[Uy]||(e[Uy]=!0,X5("selectionchange",!1,e))}}function Q4(s,e,t,n){switch(O4(e)){case 1:var r=JR;break;case 4:r=QR;break;default:r=qS}t=r.bind(null,e,t,s),r=void 0,!n_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?s.addEventListener(e,t,{capture:!0,passive:r}):s.addEventListener(e,t,!0):r!==void 0?s.addEventListener(e,t,{passive:r}):s.addEventListener(e,t,!1)}function K5(s,e,t,n,r){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=Md(o),a===null)return;if(l=a.tag,l===5||l===6){n=i=a;continue e}o=o.parentNode}}n=n.return}x4(function(){var c=i,u=BS(t),f=[];e:{var p=Y4.get(s);if(p!==void 0){var m=WS,b=s;switch(s){case"keypress":if(bb(t)===0)break e;case"keydown":case"keyup":m=f8;break;case"focusin":b="focus",m=z5;break;case"focusout":b="blur",m=z5;break;case"beforeblur":case"afterblur":m=z5;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=bN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=t8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=g8;break;case V4:case G4:case X4:m=r8;break;case K4:m=y8;break;case"scroll":m=ZR;break;case"wheel":m=w8;break;case"copy":case"cut":case"paste":m=a8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=xN}var y=(e&4)!==0,S=!y&&s==="scroll",w=y?p!==null?p+"Capture":null:p;y=[];for(var _=c,k;_!==null;){k=_;var C=k.stateNode;if(k.tag===5&&C!==null&&(k=C,w!==null&&(C=H0(_,w),C!=null&&y.push(J0(_,C,k)))),S)break;_=_.return}0<y.length&&(p=new m(p,b,null,t,u),f.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=s==="mouseover"||s==="pointerover",m=s==="mouseout"||s==="pointerout",p&&t!==e_&&(b=t.relatedTarget||t.fromElement)&&(Md(b)||b[pc]))break e;if((m||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,m?(b=t.relatedTarget||t.toElement,m=c,b=b?Md(b):null,b!==null&&(S=af(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(m=null,b=c),m!==b)){if(y=bN,C="onMouseLeave",w="onMouseEnter",_="mouse",(s==="pointerout"||s==="pointerover")&&(y=xN,C="onPointerLeave",w="onPointerEnter",_="pointer"),S=m==null?p:fp(m),k=b==null?p:fp(b),p=new y(C,_+"leave",m,t,u),p.target=S,p.relatedTarget=k,C=null,Md(u)===c&&(y=new y(w,_+"enter",b,t,u),y.target=k,y.relatedTarget=S,C=y),S=C,m&&b)t:{for(y=m,w=b,_=0,k=y;k;k=Of(k))_++;for(k=0,C=w;C;C=Of(C))k++;for(;0<_-k;)y=Of(y),_--;for(;0<k-_;)w=Of(w),k--;for(;_--;){if(y===w||w!==null&&y===w.alternate)break t;y=Of(y),w=Of(w)}y=null}else y=null;m!==null&&IN(f,p,m,y,!1),b!==null&&S!==null&&IN(f,S,b,y,!0)}}e:{if(p=c?fp(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var B=C8;else if(SN(p))if(U4)B=T8;else{B=P8;var F=E8}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(B=L8);if(B&&(B=B(s,c))){$4(f,B,t,u);break e}F&&F(s,p,c),s==="focusout"&&(F=p._wrapperState)&&F.controlled&&p.type==="number"&&Kx(p,"number",p.value)}switch(F=c?fp(c):window,s){case"focusin":(SN(F)||F.contentEditable==="true")&&(dp=F,o_=c,P0=null);break;case"focusout":P0=o_=dp=null;break;case"mousedown":l_=!0;break;case"contextmenu":case"mouseup":case"dragend":l_=!1,PN(f,t,u);break;case"selectionchange":if(R8)break;case"keydown":case"keyup":PN(f,t,u)}var j;if(GS)e:{switch(s){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else up?D4(s,t)&&(T="onCompositionEnd"):s==="keydown"&&t.keyCode===229&&(T="onCompositionStart");T&&(F4&&t.locale!=="ko"&&(up||T!=="onCompositionStart"?T==="onCompositionEnd"&&up&&(j=M4()):(Iu=u,HS="value"in Iu?Iu.value:Iu.textContent,up=!0)),F=w2(c,T),0<F.length&&(T=new wN(T,s,null,t,u),f.push({event:T,listeners:F}),j?T.data=j:(j=B4(t),j!==null&&(T.data=j)))),(j=_8?A8(s,t):S8(s,t))&&(c=w2(c,"onBeforeInput"),0<c.length&&(u=new wN("onBeforeInput","beforeinput",null,t,u),f.push({event:u,listeners:c}),u.data=j))}J4(f,e)})}function J0(s,e,t){return{instance:s,listener:e,currentTarget:t}}function w2(s,e){for(var t=e+"Capture",n=[];s!==null;){var r=s,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=H0(s,t),i!=null&&n.unshift(J0(s,i,r)),i=H0(s,e),i!=null&&n.push(J0(s,i,r))),s=s.return}return n}function Of(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function IN(s,e,t,n,r){for(var i=e._reactName,a=[];t!==null&&t!==n;){var o=t,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,r?(l=H0(t,i),l!=null&&a.unshift(J0(t,l,o))):r||(l=H0(t,i),l!=null&&a.push(J0(t,l,o)))),t=t.return}a.length!==0&&s.push({event:e,listeners:a})}var D8=/\r\n?/g,B8=/\u0000|\uFFFD/g;function jN(s){return(typeof s=="string"?s:""+s).replace(D8,`
`).replace(B8,"")}function zy(s,e,t){if(e=jN(e),jN(s)!==e&&t)throw Error(Me(425))}function x2(){}var c_=null,u_=null;function d_(s,e){return s==="textarea"||s==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var h_=typeof setTimeout=="function"?setTimeout:void 0,$8=typeof clearTimeout=="function"?clearTimeout:void 0,RN=typeof Promise=="function"?Promise:void 0,U8=typeof queueMicrotask=="function"?queueMicrotask:typeof RN<"u"?function(s){return RN.resolve(null).then(s).catch(z8)}:h_;function z8(s){setTimeout(function(){throw s})}function Y5(s,e){var t=e,n=0;do{var r=t.nextSibling;if(s.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(n===0){s.removeChild(r),G0(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=r}while(t);G0(e)}function Du(s){for(;s!=null;s=s.nextSibling){var e=s.nodeType;if(e===1||e===3)break;if(e===8){if(e=s.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return s}function ON(s){s=s.previousSibling;for(var e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return s;e--}else t==="/$"&&e++}s=s.previousSibling}return null}var tg=Math.random().toString(36).slice(2),ol="__reactFiber$"+tg,Q0="__reactProps$"+tg,pc="__reactContainer$"+tg,f_="__reactEvents$"+tg,q8="__reactListeners$"+tg,H8="__reactHandles$"+tg;function Md(s){var e=s[ol];if(e)return e;for(var t=s.parentNode;t;){if(e=t[pc]||t[ol]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(s=ON(s);s!==null;){if(t=s[ol])return t;s=ON(s)}return e}s=t,t=s.parentNode}return null}function Uv(s){return s=s[ol]||s[pc],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function fp(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(Me(33))}function kw(s){return s[Q0]||null}var p_=[],pp=-1;function ed(s){return{current:s}}function Rn(s){0>pp||(s.current=p_[pp],p_[pp]=null,pp--)}function En(s,e){pp++,p_[pp]=s.current,s.current=e}var Vu={},jr=ed(Vu),xi=ed(!1),Xh=Vu;function Vm(s,e){var t=s.type.contextTypes;if(!t)return Vu;var n=s.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in t)r[i]=e[i];return n&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=e,s.__reactInternalMemoizedMaskedChildContext=r),r}function _i(s){return s=s.childContextTypes,s!=null}function _2(){Rn(xi),Rn(jr)}function MN(s,e,t){if(jr.current!==Vu)throw Error(Me(168));En(jr,e),En(xi,t)}function Z4(s,e,t){var n=s.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(Me(108,ER(s)||"Unknown",r));return Yn({},t,n)}function A2(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vu,Xh=jr.current,En(jr,s),En(xi,xi.current),!0}function FN(s,e,t){var n=s.stateNode;if(!n)throw Error(Me(169));t?(s=Z4(s,e,Xh),n.__reactInternalMemoizedMergedChildContext=s,Rn(xi),Rn(jr),En(jr,s)):Rn(xi),En(xi,t)}var Ol=null,Nw=!1,J5=!1;function eP(s){Ol===null?Ol=[s]:Ol.push(s)}function W8(s){Nw=!0,eP(s)}function td(){if(!J5&&Ol!==null){J5=!0;var s=0,e=pn;try{var t=Ol;for(pn=1;s<t.length;s++){var n=t[s];do n=n(!0);while(n!==null)}Ol=null,Nw=!1}catch(r){throw Ol!==null&&(Ol=Ol.slice(s+1)),k4($S,td),r}finally{pn=e,J5=!1}}return null}var mp=[],gp=0,S2=null,k2=0,Sa=[],ka=0,Kh=null,lc=1,cc="";function Ad(s,e){mp[gp++]=k2,mp[gp++]=S2,S2=s,k2=e}function tP(s,e,t){Sa[ka++]=lc,Sa[ka++]=cc,Sa[ka++]=Kh,Kh=s;var n=lc;s=cc;var r=32-vo(n)-1;n&=~(1<<r),t+=1;var i=32-vo(e)+r;if(30<i){var a=r-r%5;i=(n&(1<<a)-1).toString(32),n>>=a,r-=a,lc=1<<32-vo(e)+r|t<<r|n,cc=i+s}else lc=1<<i|t<<r|n,cc=s}function KS(s){s.return!==null&&(Ad(s,1),tP(s,1,0))}function YS(s){for(;s===S2;)S2=mp[--gp],mp[gp]=null,k2=mp[--gp],mp[gp]=null;for(;s===Kh;)Kh=Sa[--ka],Sa[ka]=null,cc=Sa[--ka],Sa[ka]=null,lc=Sa[--ka],Sa[ka]=null}var Zi=null,Ji=null,Bn=!1,po=null;function nP(s,e){var t=Ea(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=s,e=s.deletions,e===null?(s.deletions=[t],s.flags|=16):e.push(t)}function DN(s,e){switch(s.tag){case 5:var t=s.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(s.stateNode=e,Zi=s,Ji=Du(e.firstChild),!0):!1;case 6:return e=s.pendingProps===""||e.nodeType!==3?null:e,e!==null?(s.stateNode=e,Zi=s,Ji=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Kh!==null?{id:lc,overflow:cc}:null,s.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ea(18,null,null,0),t.stateNode=e,t.return=s,s.child=t,Zi=s,Ji=null,!0):!1;default:return!1}}function m_(s){return(s.mode&1)!==0&&(s.flags&128)===0}function g_(s){if(Bn){var e=Ji;if(e){var t=e;if(!DN(s,e)){if(m_(s))throw Error(Me(418));e=Du(t.nextSibling);var n=Zi;e&&DN(s,e)?nP(n,t):(s.flags=s.flags&-4097|2,Bn=!1,Zi=s)}}else{if(m_(s))throw Error(Me(418));s.flags=s.flags&-4097|2,Bn=!1,Zi=s}}}function BN(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Zi=s}function qy(s){if(s!==Zi)return!1;if(!Bn)return BN(s),Bn=!0,!1;var e;if((e=s.tag!==3)&&!(e=s.tag!==5)&&(e=s.type,e=e!=="head"&&e!=="body"&&!d_(s.type,s.memoizedProps)),e&&(e=Ji)){if(m_(s))throw sP(),Error(Me(418));for(;e;)nP(s,e),e=Du(e.nextSibling)}if(BN(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));e:{for(s=s.nextSibling,e=0;s;){if(s.nodeType===8){var t=s.data;if(t==="/$"){if(e===0){Ji=Du(s.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}s=s.nextSibling}Ji=null}}else Ji=Zi?Du(s.stateNode.nextSibling):null;return!0}function sP(){for(var s=Ji;s;)s=Du(s.nextSibling)}function Gm(){Ji=Zi=null,Bn=!1}function JS(s){po===null?po=[s]:po.push(s)}var V8=bc.ReactCurrentBatchConfig;function zg(s,e,t){if(s=t.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Me(309));var n=t.stateNode}if(!n)throw Error(Me(147,s));var r=n,i=""+s;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=r.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof s!="string")throw Error(Me(284));if(!t._owner)throw Error(Me(290,s))}return s}function Hy(s,e){throw s=Object.prototype.toString.call(e),Error(Me(31,s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s))}function $N(s){var e=s._init;return e(s._payload)}function rP(s){function e(w,_){if(s){var k=w.deletions;k===null?(w.deletions=[_],w.flags|=16):k.push(_)}}function t(w,_){if(!s)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function n(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function r(w,_){return w=zu(w,_),w.index=0,w.sibling=null,w}function i(w,_,k){return w.index=k,s?(k=w.alternate,k!==null?(k=k.index,k<_?(w.flags|=2,_):k):(w.flags|=2,_)):(w.flags|=1048576,_)}function a(w){return s&&w.alternate===null&&(w.flags|=2),w}function o(w,_,k,C){return _===null||_.tag!==6?(_=rx(k,w.mode,C),_.return=w,_):(_=r(_,k),_.return=w,_)}function l(w,_,k,C){var B=k.type;return B===cp?u(w,_,k.props.children,C,k.key):_!==null&&(_.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Yc&&$N(B)===_.type)?(C=r(_,k.props),C.ref=zg(w,_,k),C.return=w,C):(C=Nb(k.type,k.key,k.props,null,w.mode,C),C.ref=zg(w,_,k),C.return=w,C)}function c(w,_,k,C){return _===null||_.tag!==4||_.stateNode.containerInfo!==k.containerInfo||_.stateNode.implementation!==k.implementation?(_=ix(k,w.mode,C),_.return=w,_):(_=r(_,k.children||[]),_.return=w,_)}function u(w,_,k,C,B){return _===null||_.tag!==7?(_=Vh(k,w.mode,C,B),_.return=w,_):(_=r(_,k),_.return=w,_)}function f(w,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return _=rx(""+_,w.mode,k),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case jy:return k=Nb(_.type,_.key,_.props,null,w.mode,k),k.ref=zg(w,null,_),k.return=w,k;case lp:return _=ix(_,w.mode,k),_.return=w,_;case Yc:var C=_._init;return f(w,C(_._payload),k)}if(Zg(_)||Fg(_))return _=Vh(_,w.mode,k,null),_.return=w,_;Hy(w,_)}return null}function p(w,_,k,C){var B=_!==null?_.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return B!==null?null:o(w,_,""+k,C);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case jy:return k.key===B?l(w,_,k,C):null;case lp:return k.key===B?c(w,_,k,C):null;case Yc:return B=k._init,p(w,_,B(k._payload),C)}if(Zg(k)||Fg(k))return B!==null?null:u(w,_,k,C,null);Hy(w,k)}return null}function m(w,_,k,C,B){if(typeof C=="string"&&C!==""||typeof C=="number")return w=w.get(k)||null,o(_,w,""+C,B);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case jy:return w=w.get(C.key===null?k:C.key)||null,l(_,w,C,B);case lp:return w=w.get(C.key===null?k:C.key)||null,c(_,w,C,B);case Yc:var F=C._init;return m(w,_,k,F(C._payload),B)}if(Zg(C)||Fg(C))return w=w.get(k)||null,u(_,w,C,B,null);Hy(_,C)}return null}function b(w,_,k,C){for(var B=null,F=null,j=_,T=_=0,W=null;j!==null&&T<k.length;T++){j.index>T?(W=j,j=null):W=j.sibling;var Y=p(w,j,k[T],C);if(Y===null){j===null&&(j=W);break}s&&j&&Y.alternate===null&&e(w,j),_=i(Y,_,T),F===null?B=Y:F.sibling=Y,F=Y,j=W}if(T===k.length)return t(w,j),Bn&&Ad(w,T),B;if(j===null){for(;T<k.length;T++)j=f(w,k[T],C),j!==null&&(_=i(j,_,T),F===null?B=j:F.sibling=j,F=j);return Bn&&Ad(w,T),B}for(j=n(w,j);T<k.length;T++)W=m(j,w,T,k[T],C),W!==null&&(s&&W.alternate!==null&&j.delete(W.key===null?T:W.key),_=i(W,_,T),F===null?B=W:F.sibling=W,F=W);return s&&j.forEach(function(I){return e(w,I)}),Bn&&Ad(w,T),B}function y(w,_,k,C){var B=Fg(k);if(typeof B!="function")throw Error(Me(150));if(k=B.call(k),k==null)throw Error(Me(151));for(var F=B=null,j=_,T=_=0,W=null,Y=k.next();j!==null&&!Y.done;T++,Y=k.next()){j.index>T?(W=j,j=null):W=j.sibling;var I=p(w,j,Y.value,C);if(I===null){j===null&&(j=W);break}s&&j&&I.alternate===null&&e(w,j),_=i(I,_,T),F===null?B=I:F.sibling=I,F=I,j=W}if(Y.done)return t(w,j),Bn&&Ad(w,T),B;if(j===null){for(;!Y.done;T++,Y=k.next())Y=f(w,Y.value,C),Y!==null&&(_=i(Y,_,T),F===null?B=Y:F.sibling=Y,F=Y);return Bn&&Ad(w,T),B}for(j=n(w,j);!Y.done;T++,Y=k.next())Y=m(j,w,T,Y.value,C),Y!==null&&(s&&Y.alternate!==null&&j.delete(Y.key===null?T:Y.key),_=i(Y,_,T),F===null?B=Y:F.sibling=Y,F=Y);return s&&j.forEach(function(O){return e(w,O)}),Bn&&Ad(w,T),B}function S(w,_,k,C){if(typeof k=="object"&&k!==null&&k.type===cp&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case jy:e:{for(var B=k.key,F=_;F!==null;){if(F.key===B){if(B=k.type,B===cp){if(F.tag===7){t(w,F.sibling),_=r(F,k.props.children),_.return=w,w=_;break e}}else if(F.elementType===B||typeof B=="object"&&B!==null&&B.$$typeof===Yc&&$N(B)===F.type){t(w,F.sibling),_=r(F,k.props),_.ref=zg(w,F,k),_.return=w,w=_;break e}t(w,F);break}else e(w,F);F=F.sibling}k.type===cp?(_=Vh(k.props.children,w.mode,C,k.key),_.return=w,w=_):(C=Nb(k.type,k.key,k.props,null,w.mode,C),C.ref=zg(w,_,k),C.return=w,w=C)}return a(w);case lp:e:{for(F=k.key;_!==null;){if(_.key===F)if(_.tag===4&&_.stateNode.containerInfo===k.containerInfo&&_.stateNode.implementation===k.implementation){t(w,_.sibling),_=r(_,k.children||[]),_.return=w,w=_;break e}else{t(w,_);break}else e(w,_);_=_.sibling}_=ix(k,w.mode,C),_.return=w,w=_}return a(w);case Yc:return F=k._init,S(w,_,F(k._payload),C)}if(Zg(k))return b(w,_,k,C);if(Fg(k))return y(w,_,k,C);Hy(w,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,_!==null&&_.tag===6?(t(w,_.sibling),_=r(_,k),_.return=w,w=_):(t(w,_),_=rx(k,w.mode,C),_.return=w,w=_),a(w)):t(w,_)}return S}var Xm=rP(!0),iP=rP(!1),N2=ed(null),C2=null,vp=null,QS=null;function ZS(){QS=vp=C2=null}function ek(s){var e=N2.current;Rn(N2),s._currentValue=e}function v_(s,e,t){for(;s!==null;){var n=s.alternate;if((s.childLanes&e)!==e?(s.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),s===t)break;s=s.return}}function Ep(s,e){C2=s,QS=vp=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&e&&(wi=!0),s.firstContext=null)}function ja(s){var e=s._currentValue;if(QS!==s)if(s={context:s,memoizedValue:e,next:null},vp===null){if(C2===null)throw Error(Me(308));vp=s,C2.dependencies={lanes:0,firstContext:s}}else vp=vp.next=s;return e}var Fd=null;function tk(s){Fd===null?Fd=[s]:Fd.push(s)}function aP(s,e,t,n){var r=e.interleaved;return r===null?(t.next=t,tk(e)):(t.next=r.next,r.next=t),e.interleaved=t,mc(s,n)}function mc(s,e){s.lanes|=e;var t=s.alternate;for(t!==null&&(t.lanes|=e),t=s,s=s.return;s!==null;)s.childLanes|=e,t=s.alternate,t!==null&&(t.childLanes|=e),t=s,s=s.return;return t.tag===3?t.stateNode:null}var Jc=!1;function nk(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oP(s,e){s=s.updateQueue,e.updateQueue===s&&(e.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function uc(s,e){return{eventTime:s,lane:e,tag:0,payload:null,callback:null,next:null}}function Bu(s,e,t){var n=s.updateQueue;if(n===null)return null;if(n=n.shared,Jt&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,mc(s,t)}return r=n.interleaved,r===null?(e.next=e,tk(n)):(e.next=r.next,r.next=e),n.interleaved=e,mc(s,t)}function wb(s,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=s.pendingLanes,t|=n,e.lanes=t,US(s,t)}}function UN(s,e){var t=s.updateQueue,n=s.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var r=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?r=i=a:i=i.next=a,t=t.next}while(t!==null);i===null?r=i=e:i=i.next=e}else r=i=e;t={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:n.shared,effects:n.effects},s.updateQueue=t;return}s=t.lastBaseUpdate,s===null?t.firstBaseUpdate=e:s.next=e,t.lastBaseUpdate=e}function E2(s,e,t,n){var r=s.updateQueue;Jc=!1;var i=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?i=c:a.next=c,a=l;var u=s.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=r.baseState;a=0,u=c=l=null,o=i;do{var p=o.lane,m=o.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var b=s,y=o;switch(p=e,m=t,y.tag){case 1:if(b=y.payload,typeof b=="function"){f=b.call(m,f,p);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=y.payload,p=typeof b=="function"?b.call(m,f,p):b,p==null)break e;f=Yn({},f,p);break e;case 2:Jc=!0}}o.callback!==null&&o.lane!==0&&(s.flags|=64,p=r.effects,p===null?r.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=m,l=f):u=u.next=m,a|=p;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;p=o,o=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(u===null&&(l=f),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Jh|=a,s.lanes=a,s.memoizedState=f}}function zN(s,e,t){if(s=e.effects,e.effects=null,s!==null)for(e=0;e<s.length;e++){var n=s[e],r=n.callback;if(r!==null){if(n.callback=null,n=t,typeof r!="function")throw Error(Me(191,r));r.call(n)}}}var zv={},dl=ed(zv),Z0=ed(zv),e1=ed(zv);function Dd(s){if(s===zv)throw Error(Me(174));return s}function sk(s,e){switch(En(e1,e),En(Z0,s),En(dl,zv),s=e.nodeType,s){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jx(null,"");break;default:s=s===8?e.parentNode:e,e=s.namespaceURI||null,s=s.tagName,e=Jx(e,s)}Rn(dl),En(dl,e)}function Km(){Rn(dl),Rn(Z0),Rn(e1)}function lP(s){Dd(e1.current);var e=Dd(dl.current),t=Jx(e,s.type);e!==t&&(En(Z0,s),En(dl,t))}function rk(s){Z0.current===s&&(Rn(dl),Rn(Z0))}var Gn=ed(0);function P2(s){for(var e=s;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Q5=[];function ik(){for(var s=0;s<Q5.length;s++)Q5[s]._workInProgressVersionPrimary=null;Q5.length=0}var xb=bc.ReactCurrentDispatcher,Z5=bc.ReactCurrentBatchConfig,Yh=0,Kn=null,js=null,Ks=null,L2=!1,L0=!1,t1=0,G8=0;function mr(){throw Error(Me(321))}function ak(s,e){if(e===null)return!1;for(var t=0;t<e.length&&t<s.length;t++)if(!bo(s[t],e[t]))return!1;return!0}function ok(s,e,t,n,r,i){if(Yh=i,Kn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xb.current=s===null||s.memoizedState===null?J8:Q8,s=t(n,r),L0){i=0;do{if(L0=!1,t1=0,25<=i)throw Error(Me(301));i+=1,Ks=js=null,e.updateQueue=null,xb.current=Z8,s=t(n,r)}while(L0)}if(xb.current=T2,e=js!==null&&js.next!==null,Yh=0,Ks=js=Kn=null,L2=!1,e)throw Error(Me(300));return s}function lk(){var s=t1!==0;return t1=0,s}function $o(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ks===null?Kn.memoizedState=Ks=s:Ks=Ks.next=s,Ks}function Ra(){if(js===null){var s=Kn.alternate;s=s!==null?s.memoizedState:null}else s=js.next;var e=Ks===null?Kn.memoizedState:Ks.next;if(e!==null)Ks=e,js=s;else{if(s===null)throw Error(Me(310));js=s,s={memoizedState:js.memoizedState,baseState:js.baseState,baseQueue:js.baseQueue,queue:js.queue,next:null},Ks===null?Kn.memoizedState=Ks=s:Ks=Ks.next=s}return Ks}function n1(s,e){return typeof e=="function"?e(s):e}function ex(s){var e=Ra(),t=e.queue;if(t===null)throw Error(Me(311));t.lastRenderedReducer=s;var n=js,r=n.baseQueue,i=t.pending;if(i!==null){if(r!==null){var a=r.next;r.next=i.next,i.next=a}n.baseQueue=r=i,t.pending=null}if(r!==null){i=r.next,n=n.baseState;var o=a=null,l=null,c=i;do{var u=c.lane;if((Yh&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:s(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,a=n):l=l.next=f,Kn.lanes|=u,Jh|=u}c=c.next}while(c!==null&&c!==i);l===null?a=n:l.next=o,bo(n,e.memoizedState)||(wi=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,t.lastRenderedState=n}if(s=t.interleaved,s!==null){r=s;do i=r.lane,Kn.lanes|=i,Jh|=i,r=r.next;while(r!==s)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function tx(s){var e=Ra(),t=e.queue;if(t===null)throw Error(Me(311));t.lastRenderedReducer=s;var n=t.dispatch,r=t.pending,i=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do i=s(i,a.action),a=a.next;while(a!==r);bo(i,e.memoizedState)||(wi=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,n]}function cP(){}function uP(s,e){var t=Kn,n=Ra(),r=e(),i=!bo(n.memoizedState,r);if(i&&(n.memoizedState=r,wi=!0),n=n.queue,ck(fP.bind(null,t,n,s),[s]),n.getSnapshot!==e||i||Ks!==null&&Ks.memoizedState.tag&1){if(t.flags|=2048,s1(9,hP.bind(null,t,n,r,e),void 0,null),Js===null)throw Error(Me(349));Yh&30||dP(t,e,r)}return r}function dP(s,e,t){s.flags|=16384,s={getSnapshot:e,value:t},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.stores=[s]):(t=e.stores,t===null?e.stores=[s]:t.push(s))}function hP(s,e,t,n){e.value=t,e.getSnapshot=n,pP(e)&&mP(s)}function fP(s,e,t){return t(function(){pP(e)&&mP(s)})}function pP(s){var e=s.getSnapshot;s=s.value;try{var t=e();return!bo(s,t)}catch{return!0}}function mP(s){var e=mc(s,1);e!==null&&yo(e,s,1,-1)}function qN(s){var e=$o();return typeof s=="function"&&(s=s()),e.memoizedState=e.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n1,lastRenderedState:s},e.queue=s,s=s.dispatch=Y8.bind(null,Kn,s),[e.memoizedState,s]}function s1(s,e,t,n){return s={tag:s,create:e,destroy:t,deps:n,next:null},e=Kn.updateQueue,e===null?(e={lastEffect:null,stores:null},Kn.updateQueue=e,e.lastEffect=s.next=s):(t=e.lastEffect,t===null?e.lastEffect=s.next=s:(n=t.next,t.next=s,s.next=n,e.lastEffect=s)),s}function gP(){return Ra().memoizedState}function _b(s,e,t,n){var r=$o();Kn.flags|=s,r.memoizedState=s1(1|e,t,void 0,n===void 0?null:n)}function Cw(s,e,t,n){var r=Ra();n=n===void 0?null:n;var i=void 0;if(js!==null){var a=js.memoizedState;if(i=a.destroy,n!==null&&ak(n,a.deps)){r.memoizedState=s1(e,t,i,n);return}}Kn.flags|=s,r.memoizedState=s1(1|e,t,i,n)}function HN(s,e){return _b(8390656,8,s,e)}function ck(s,e){return Cw(2048,8,s,e)}function vP(s,e){return Cw(4,2,s,e)}function yP(s,e){return Cw(4,4,s,e)}function bP(s,e){if(typeof e=="function")return s=s(),e(s),function(){e(null)};if(e!=null)return s=s(),e.current=s,function(){e.current=null}}function wP(s,e,t){return t=t!=null?t.concat([s]):null,Cw(4,4,bP.bind(null,e,s),t)}function uk(){}function xP(s,e){var t=Ra();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&ak(e,n[1])?n[0]:(t.memoizedState=[s,e],s)}function _P(s,e){var t=Ra();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&ak(e,n[1])?n[0]:(s=s(),t.memoizedState=[s,e],s)}function AP(s,e,t){return Yh&21?(bo(t,e)||(t=E4(),Kn.lanes|=t,Jh|=t,s.baseState=!0),e):(s.baseState&&(s.baseState=!1,wi=!0),s.memoizedState=t)}function X8(s,e){var t=pn;pn=t!==0&&4>t?t:4,s(!0);var n=Z5.transition;Z5.transition={};try{s(!1),e()}finally{pn=t,Z5.transition=n}}function SP(){return Ra().memoizedState}function K8(s,e,t){var n=Uu(s);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},kP(s))NP(e,t);else if(t=aP(s,e,t,n),t!==null){var r=Gr();yo(t,s,n,r),CP(t,e,n)}}function Y8(s,e,t){var n=Uu(s),r={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(kP(s))NP(e,r);else{var i=s.alternate;if(s.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,t);if(r.hasEagerState=!0,r.eagerState=o,bo(o,a)){var l=e.interleaved;l===null?(r.next=r,tk(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=aP(s,e,r,n),t!==null&&(r=Gr(),yo(t,s,n,r),CP(t,e,n))}}function kP(s){var e=s.alternate;return s===Kn||e!==null&&e===Kn}function NP(s,e){L0=L2=!0;var t=s.pending;t===null?e.next=e:(e.next=t.next,t.next=e),s.pending=e}function CP(s,e,t){if(t&4194240){var n=e.lanes;n&=s.pendingLanes,t|=n,e.lanes=t,US(s,t)}}var T2={readContext:ja,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useInsertionEffect:mr,useLayoutEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useMutableSource:mr,useSyncExternalStore:mr,useId:mr,unstable_isNewReconciler:!1},J8={readContext:ja,useCallback:function(s,e){return $o().memoizedState=[s,e===void 0?null:e],s},useContext:ja,useEffect:HN,useImperativeHandle:function(s,e,t){return t=t!=null?t.concat([s]):null,_b(4194308,4,bP.bind(null,e,s),t)},useLayoutEffect:function(s,e){return _b(4194308,4,s,e)},useInsertionEffect:function(s,e){return _b(4,2,s,e)},useMemo:function(s,e){var t=$o();return e=e===void 0?null:e,s=s(),t.memoizedState=[s,e],s},useReducer:function(s,e,t){var n=$o();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:e},n.queue=s,s=s.dispatch=K8.bind(null,Kn,s),[n.memoizedState,s]},useRef:function(s){var e=$o();return s={current:s},e.memoizedState=s},useState:qN,useDebugValue:uk,useDeferredValue:function(s){return $o().memoizedState=s},useTransition:function(){var s=qN(!1),e=s[0];return s=X8.bind(null,s[1]),$o().memoizedState=s,[e,s]},useMutableSource:function(){},useSyncExternalStore:function(s,e,t){var n=Kn,r=$o();if(Bn){if(t===void 0)throw Error(Me(407));t=t()}else{if(t=e(),Js===null)throw Error(Me(349));Yh&30||dP(n,e,t)}r.memoizedState=t;var i={value:t,getSnapshot:e};return r.queue=i,HN(fP.bind(null,n,i,s),[s]),n.flags|=2048,s1(9,hP.bind(null,n,i,t,e),void 0,null),t},useId:function(){var s=$o(),e=Js.identifierPrefix;if(Bn){var t=cc,n=lc;t=(n&~(1<<32-vo(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=t1++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=G8++,e=":"+e+"r"+t.toString(32)+":";return s.memoizedState=e},unstable_isNewReconciler:!1},Q8={readContext:ja,useCallback:xP,useContext:ja,useEffect:ck,useImperativeHandle:wP,useInsertionEffect:vP,useLayoutEffect:yP,useMemo:_P,useReducer:ex,useRef:gP,useState:function(){return ex(n1)},useDebugValue:uk,useDeferredValue:function(s){var e=Ra();return AP(e,js.memoizedState,s)},useTransition:function(){var s=ex(n1)[0],e=Ra().memoizedState;return[s,e]},useMutableSource:cP,useSyncExternalStore:uP,useId:SP,unstable_isNewReconciler:!1},Z8={readContext:ja,useCallback:xP,useContext:ja,useEffect:ck,useImperativeHandle:wP,useInsertionEffect:vP,useLayoutEffect:yP,useMemo:_P,useReducer:tx,useRef:gP,useState:function(){return tx(n1)},useDebugValue:uk,useDeferredValue:function(s){var e=Ra();return js===null?e.memoizedState=s:AP(e,js.memoizedState,s)},useTransition:function(){var s=tx(n1)[0],e=Ra().memoizedState;return[s,e]},useMutableSource:cP,useSyncExternalStore:uP,useId:SP,unstable_isNewReconciler:!1};function Ka(s,e){if(s&&s.defaultProps){e=Yn({},e),s=s.defaultProps;for(var t in s)e[t]===void 0&&(e[t]=s[t]);return e}return e}function y_(s,e,t,n){e=s.memoizedState,t=t(n,e),t=t==null?e:Yn({},e,t),s.memoizedState=t,s.lanes===0&&(s.updateQueue.baseState=t)}var Ew={isMounted:function(s){return(s=s._reactInternals)?af(s)===s:!1},enqueueSetState:function(s,e,t){s=s._reactInternals;var n=Gr(),r=Uu(s),i=uc(n,r);i.payload=e,t!=null&&(i.callback=t),e=Bu(s,i,r),e!==null&&(yo(e,s,r,n),wb(e,s,r))},enqueueReplaceState:function(s,e,t){s=s._reactInternals;var n=Gr(),r=Uu(s),i=uc(n,r);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Bu(s,i,r),e!==null&&(yo(e,s,r,n),wb(e,s,r))},enqueueForceUpdate:function(s,e){s=s._reactInternals;var t=Gr(),n=Uu(s),r=uc(t,n);r.tag=2,e!=null&&(r.callback=e),e=Bu(s,r,n),e!==null&&(yo(e,s,n,t),wb(e,s,n))}};function WN(s,e,t,n,r,i,a){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!K0(t,n)||!K0(r,i):!0}function EP(s,e,t){var n=!1,r=Vu,i=e.contextType;return typeof i=="object"&&i!==null?i=ja(i):(r=_i(e)?Xh:jr.current,n=e.contextTypes,i=(n=n!=null)?Vm(s,r):Vu),e=new e(t,i),s.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ew,s.stateNode=e,e._reactInternals=s,n&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=r,s.__reactInternalMemoizedMaskedChildContext=i),e}function VN(s,e,t,n){s=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==s&&Ew.enqueueReplaceState(e,e.state,null)}function b_(s,e,t,n){var r=s.stateNode;r.props=t,r.state=s.memoizedState,r.refs={},nk(s);var i=e.contextType;typeof i=="object"&&i!==null?r.context=ja(i):(i=_i(e)?Xh:jr.current,r.context=Vm(s,i)),r.state=s.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(y_(s,e,i,t),r.state=s.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Ew.enqueueReplaceState(r,r.state,null),E2(s,t,r,n),r.state=s.memoizedState),typeof r.componentDidMount=="function"&&(s.flags|=4194308)}function Ym(s,e){try{var t="",n=e;do t+=CR(n),n=n.return;while(n);var r=t}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:s,source:e,stack:r,digest:null}}function nx(s,e,t){return{value:s,source:null,stack:t??null,digest:e??null}}function w_(s,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var eO=typeof WeakMap=="function"?WeakMap:Map;function PP(s,e,t){t=uc(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){j2||(j2=!0,L_=n),w_(s,e)},t}function LP(s,e,t){t=uc(-1,t),t.tag=3;var n=s.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;t.payload=function(){return n(r)},t.callback=function(){w_(s,e)}}var i=s.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){w_(s,e),typeof n!="function"&&($u===null?$u=new Set([this]):$u.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function GN(s,e,t){var n=s.pingCache;if(n===null){n=s.pingCache=new eO;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(t)||(r.add(t),s=pO.bind(null,s,e,t),e.then(s,s))}function XN(s){do{var e;if((e=s.tag===13)&&(e=s.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return s;s=s.return}while(s!==null);return null}function KN(s,e,t,n,r){return s.mode&1?(s.flags|=65536,s.lanes=r,s):(s===e?s.flags|=65536:(s.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=uc(-1,1),e.tag=2,Bu(t,e,1))),t.lanes|=1),s)}var tO=bc.ReactCurrentOwner,wi=!1;function Vr(s,e,t,n){e.child=s===null?iP(e,null,t,n):Xm(e,s.child,t,n)}function YN(s,e,t,n,r){t=t.render;var i=e.ref;return Ep(e,r),n=ok(s,e,t,n,i,r),t=lk(),s!==null&&!wi?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~r,gc(s,e,r)):(Bn&&t&&KS(e),e.flags|=1,Vr(s,e,n,r),e.child)}function JN(s,e,t,n,r){if(s===null){var i=t.type;return typeof i=="function"&&!yk(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,TP(s,e,i,n,r)):(s=Nb(t.type,null,n,e,e.mode,r),s.ref=e.ref,s.return=e,e.child=s)}if(i=s.child,!(s.lanes&r)){var a=i.memoizedProps;if(t=t.compare,t=t!==null?t:K0,t(a,n)&&s.ref===e.ref)return gc(s,e,r)}return e.flags|=1,s=zu(i,n),s.ref=e.ref,s.return=e,e.child=s}function TP(s,e,t,n,r){if(s!==null){var i=s.memoizedProps;if(K0(i,n)&&s.ref===e.ref)if(wi=!1,e.pendingProps=n=i,(s.lanes&r)!==0)s.flags&131072&&(wi=!0);else return e.lanes=s.lanes,gc(s,e,r)}return x_(s,e,t,n,r)}function IP(s,e,t){var n=e.pendingProps,r=n.children,i=s!==null?s.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(bp,Xi),Xi|=t;else{if(!(t&1073741824))return s=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:s,cachePool:null,transitions:null},e.updateQueue=null,En(bp,Xi),Xi|=s,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:t,En(bp,Xi),Xi|=n}else i!==null?(n=i.baseLanes|t,e.memoizedState=null):n=t,En(bp,Xi),Xi|=n;return Vr(s,e,r,t),e.child}function jP(s,e){var t=e.ref;(s===null&&t!==null||s!==null&&s.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function x_(s,e,t,n,r){var i=_i(t)?Xh:jr.current;return i=Vm(e,i),Ep(e,r),t=ok(s,e,t,n,i,r),n=lk(),s!==null&&!wi?(e.updateQueue=s.updateQueue,e.flags&=-2053,s.lanes&=~r,gc(s,e,r)):(Bn&&n&&KS(e),e.flags|=1,Vr(s,e,t,r),e.child)}function QN(s,e,t,n,r){if(_i(t)){var i=!0;A2(e)}else i=!1;if(Ep(e,r),e.stateNode===null)Ab(s,e),EP(e,t,n),b_(e,t,n,r),n=!0;else if(s===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=t.contextType;typeof c=="object"&&c!==null?c=ja(c):(c=_i(t)?Xh:jr.current,c=Vm(e,c));var u=t.getDerivedStateFromProps,f=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&VN(e,a,n,c),Jc=!1;var p=e.memoizedState;a.state=p,E2(e,n,a,r),l=e.memoizedState,o!==n||p!==l||xi.current||Jc?(typeof u=="function"&&(y_(e,t,u,n),l=e.memoizedState),(o=Jc||WN(e,t,o,n,p,l,c))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,oP(s,e),o=e.memoizedProps,c=e.type===e.elementType?o:Ka(e.type,o),a.props=c,f=e.pendingProps,p=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=ja(l):(l=_i(t)?Xh:jr.current,l=Vm(e,l));var m=t.getDerivedStateFromProps;(u=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==l)&&VN(e,a,n,l),Jc=!1,p=e.memoizedState,a.state=p,E2(e,n,a,r);var b=e.memoizedState;o!==f||p!==b||xi.current||Jc?(typeof m=="function"&&(y_(e,t,m,n),b=e.memoizedState),(c=Jc||WN(e,t,c,n,p,b,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,b,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,b,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===s.memoizedProps&&p===s.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===s.memoizedProps&&p===s.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=b),a.props=n,a.state=b,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===s.memoizedProps&&p===s.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===s.memoizedProps&&p===s.memoizedState||(e.flags|=1024),n=!1)}return __(s,e,t,n,i,r)}function __(s,e,t,n,r,i){jP(s,e);var a=(e.flags&128)!==0;if(!n&&!a)return r&&FN(e,t,!1),gc(s,e,i);n=e.stateNode,tO.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,s!==null&&a?(e.child=Xm(e,s.child,null,i),e.child=Xm(e,null,o,i)):Vr(s,e,o,i),e.memoizedState=n.state,r&&FN(e,t,!0),e.child}function RP(s){var e=s.stateNode;e.pendingContext?MN(s,e.pendingContext,e.pendingContext!==e.context):e.context&&MN(s,e.context,!1),sk(s,e.containerInfo)}function ZN(s,e,t,n,r){return Gm(),JS(r),e.flags|=256,Vr(s,e,t,n),e.child}var A_={dehydrated:null,treeContext:null,retryLane:0};function S_(s){return{baseLanes:s,cachePool:null,transitions:null}}function OP(s,e,t){var n=e.pendingProps,r=Gn.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=s!==null&&s.memoizedState===null?!1:(r&2)!==0),o?(i=!0,e.flags&=-129):(s===null||s.memoizedState!==null)&&(r|=1),En(Gn,r&1),s===null)return g_(e),s=e.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(e.mode&1?s.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,s=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Tw(a,n,0,null),s=Vh(s,n,t,null),i.return=e,s.return=e,i.sibling=s,e.child=i,e.child.memoizedState=S_(t),e.memoizedState=A_,s):dk(e,a));if(r=s.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return nO(s,e,a,n,o,r,t);if(i){i=n.fallback,a=e.mode,r=s.child,o=r.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=zu(r,l),n.subtreeFlags=r.subtreeFlags&14680064),o!==null?i=zu(o,i):(i=Vh(i,a,t,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=s.child.memoizedState,a=a===null?S_(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=s.childLanes&~t,e.memoizedState=A_,n}return i=s.child,s=i.sibling,n=zu(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,s!==null&&(t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)),e.child=n,e.memoizedState=null,n}function dk(s,e){return e=Tw({mode:"visible",children:e},s.mode,0,null),e.return=s,s.child=e}function Wy(s,e,t,n){return n!==null&&JS(n),Xm(e,s.child,null,t),s=dk(e,e.pendingProps.children),s.flags|=2,e.memoizedState=null,s}function nO(s,e,t,n,r,i,a){if(t)return e.flags&256?(e.flags&=-257,n=nx(Error(Me(422))),Wy(s,e,a,n)):e.memoizedState!==null?(e.child=s.child,e.flags|=128,null):(i=n.fallback,r=e.mode,n=Tw({mode:"visible",children:n.children},r,0,null),i=Vh(i,r,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Xm(e,s.child,null,a),e.child.memoizedState=S_(a),e.memoizedState=A_,i);if(!(e.mode&1))return Wy(s,e,a,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(Me(419)),n=nx(i,n,void 0),Wy(s,e,a,n)}if(o=(a&s.childLanes)!==0,wi||o){if(n=Js,n!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|a)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,mc(s,r),yo(n,s,r,-1))}return vk(),n=nx(Error(Me(421))),Wy(s,e,a,n)}return r.data==="$?"?(e.flags|=128,e.child=s.child,e=mO.bind(null,s),r._reactRetry=e,null):(s=i.treeContext,Ji=Du(r.nextSibling),Zi=e,Bn=!0,po=null,s!==null&&(Sa[ka++]=lc,Sa[ka++]=cc,Sa[ka++]=Kh,lc=s.id,cc=s.overflow,Kh=e),e=dk(e,n.children),e.flags|=4096,e)}function eC(s,e,t){s.lanes|=e;var n=s.alternate;n!==null&&(n.lanes|=e),v_(s.return,e,t)}function sx(s,e,t,n,r){var i=s.memoizedState;i===null?s.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=t,i.tailMode=r)}function MP(s,e,t){var n=e.pendingProps,r=n.revealOrder,i=n.tail;if(Vr(s,e,n.children,t),n=Gn.current,n&2)n=n&1|2,e.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=e.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&eC(s,t,e);else if(s.tag===19)eC(s,t,e);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break e;for(;s.sibling===null;){if(s.return===null||s.return===e)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}n&=1}if(En(Gn,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)s=t.alternate,s!==null&&P2(s)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),sx(e,!1,r,t,i);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(s=r.alternate,s!==null&&P2(s)===null){e.child=r;break}s=r.sibling,r.sibling=t,t=r,r=s}sx(e,!0,t,null,i);break;case"together":sx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ab(s,e){!(e.mode&1)&&s!==null&&(s.alternate=null,e.alternate=null,e.flags|=2)}function gc(s,e,t){if(s!==null&&(e.dependencies=s.dependencies),Jh|=e.lanes,!(t&e.childLanes))return null;if(s!==null&&e.child!==s.child)throw Error(Me(153));if(e.child!==null){for(s=e.child,t=zu(s,s.pendingProps),e.child=t,t.return=e;s.sibling!==null;)s=s.sibling,t=t.sibling=zu(s,s.pendingProps),t.return=e;t.sibling=null}return e.child}function sO(s,e,t){switch(e.tag){case 3:RP(e),Gm();break;case 5:lP(e);break;case 1:_i(e.type)&&A2(e);break;case 4:sk(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;En(N2,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(En(Gn,Gn.current&1),e.flags|=128,null):t&e.child.childLanes?OP(s,e,t):(En(Gn,Gn.current&1),s=gc(s,e,t),s!==null?s.sibling:null);En(Gn,Gn.current&1);break;case 19:if(n=(t&e.childLanes)!==0,s.flags&128){if(n)return MP(s,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),En(Gn,Gn.current),n)break;return null;case 22:case 23:return e.lanes=0,IP(s,e,t)}return gc(s,e,t)}var FP,k_,DP,BP;FP=function(s,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)s.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};k_=function(){};DP=function(s,e,t,n){var r=s.memoizedProps;if(r!==n){s=e.stateNode,Dd(dl.current);var i=null;switch(t){case"input":r=Gx(s,r),n=Gx(s,n),i=[];break;case"select":r=Yn({},r,{value:void 0}),n=Yn({},n,{value:void 0}),i=[];break;case"textarea":r=Yx(s,r),n=Yx(s,n),i=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(s.onclick=x2)}Qx(t,n);var a;t=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var o=r[c];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(z0.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(z0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Tn("scroll",s),i||o===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};BP=function(s,e,t,n){t!==n&&(e.flags|=4)};function qg(s,e){if(!Bn)switch(s.tailMode){case"hidden":e=s.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?s.tail=null:t.sibling=null;break;case"collapsed":t=s.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||s.tail===null?s.tail=null:s.tail.sibling=null:n.sibling=null}}function gr(s){var e=s.alternate!==null&&s.alternate.child===s.child,t=0,n=0;if(e)for(var r=s.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=s,r=r.sibling;else for(r=s.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=s,r=r.sibling;return s.subtreeFlags|=n,s.childLanes=t,e}function rO(s,e,t){var n=e.pendingProps;switch(YS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gr(e),null;case 1:return _i(e.type)&&_2(),gr(e),null;case 3:return n=e.stateNode,Km(),Rn(xi),Rn(jr),ik(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(s===null||s.child===null)&&(qy(e)?e.flags|=4:s===null||s.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,po!==null&&(j_(po),po=null))),k_(s,e),gr(e),null;case 5:rk(e);var r=Dd(e1.current);if(t=e.type,s!==null&&e.stateNode!=null)DP(s,e,t,n,r),s.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(Me(166));return gr(e),null}if(s=Dd(dl.current),qy(e)){n=e.stateNode,t=e.type;var i=e.memoizedProps;switch(n[ol]=e,n[Q0]=i,s=(e.mode&1)!==0,t){case"dialog":Tn("cancel",n),Tn("close",n);break;case"iframe":case"object":case"embed":Tn("load",n);break;case"video":case"audio":for(r=0;r<t0.length;r++)Tn(t0[r],n);break;case"source":Tn("error",n);break;case"img":case"image":case"link":Tn("error",n),Tn("load",n);break;case"details":Tn("toggle",n);break;case"input":cN(n,i),Tn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Tn("invalid",n);break;case"textarea":dN(n,i),Tn("invalid",n)}Qx(t,i),r=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&zy(n.textContent,o,s),r=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&zy(n.textContent,o,s),r=["children",""+o]):z0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Tn("scroll",n)}switch(t){case"input":Ry(n),uN(n,i,!0);break;case"textarea":Ry(n),hN(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=x2)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=f4(t)),s==="http://www.w3.org/1999/xhtml"?t==="script"?(s=a.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof n.is=="string"?s=a.createElement(t,{is:n.is}):(s=a.createElement(t),t==="select"&&(a=s,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):s=a.createElementNS(s,t),s[ol]=e,s[Q0]=n,FP(s,e,!1,!1),e.stateNode=s;e:{switch(a=Zx(t,n),t){case"dialog":Tn("cancel",s),Tn("close",s),r=n;break;case"iframe":case"object":case"embed":Tn("load",s),r=n;break;case"video":case"audio":for(r=0;r<t0.length;r++)Tn(t0[r],s);r=n;break;case"source":Tn("error",s),r=n;break;case"img":case"image":case"link":Tn("error",s),Tn("load",s),r=n;break;case"details":Tn("toggle",s),r=n;break;case"input":cN(s,n),r=Gx(s,n),Tn("invalid",s);break;case"option":r=n;break;case"select":s._wrapperState={wasMultiple:!!n.multiple},r=Yn({},n,{value:void 0}),Tn("invalid",s);break;case"textarea":dN(s,n),r=Yx(s,n),Tn("invalid",s);break;default:r=n}Qx(t,r),o=r;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?g4(s,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&p4(s,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&q0(s,l):typeof l=="number"&&q0(s,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(z0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Tn("scroll",s):l!=null&&OS(s,i,l,a))}switch(t){case"input":Ry(s),uN(s,n,!1);break;case"textarea":Ry(s),hN(s);break;case"option":n.value!=null&&s.setAttribute("value",""+Wu(n.value));break;case"select":s.multiple=!!n.multiple,i=n.value,i!=null?Sp(s,!!n.multiple,i,!1):n.defaultValue!=null&&Sp(s,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(s.onclick=x2)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gr(e),null;case 6:if(s&&e.stateNode!=null)BP(s,e,s.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(Me(166));if(t=Dd(e1.current),Dd(dl.current),qy(e)){if(n=e.stateNode,t=e.memoizedProps,n[ol]=e,(i=n.nodeValue!==t)&&(s=Zi,s!==null))switch(s.tag){case 3:zy(n.nodeValue,t,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&zy(n.nodeValue,t,(s.mode&1)!==0)}i&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[ol]=e,e.stateNode=n}return gr(e),null;case 13:if(Rn(Gn),n=e.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Bn&&Ji!==null&&e.mode&1&&!(e.flags&128))sP(),Gm(),e.flags|=98560,i=!1;else if(i=qy(e),n!==null&&n.dehydrated!==null){if(s===null){if(!i)throw Error(Me(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Me(317));i[ol]=e}else Gm(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gr(e),i=!1}else po!==null&&(j_(po),po=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(s!==null&&s.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(s===null||Gn.current&1?Rs===0&&(Rs=3):vk())),e.updateQueue!==null&&(e.flags|=4),gr(e),null);case 4:return Km(),k_(s,e),s===null&&Y0(e.stateNode.containerInfo),gr(e),null;case 10:return ek(e.type._context),gr(e),null;case 17:return _i(e.type)&&_2(),gr(e),null;case 19:if(Rn(Gn),i=e.memoizedState,i===null)return gr(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)qg(i,!1);else{if(Rs!==0||s!==null&&s.flags&128)for(s=e.child;s!==null;){if(a=P2(s),a!==null){for(e.flags|=128,qg(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)i=t,s=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,s=a.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),t=t.sibling;return En(Gn,Gn.current&1|2),e.child}s=s.sibling}i.tail!==null&&cs()>Jm&&(e.flags|=128,n=!0,qg(i,!1),e.lanes=4194304)}else{if(!n)if(s=P2(a),s!==null){if(e.flags|=128,n=!0,t=s.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),qg(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Bn)return gr(e),null}else 2*cs()-i.renderingStartTime>Jm&&t!==1073741824&&(e.flags|=128,n=!0,qg(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(t=i.last,t!==null?t.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=cs(),e.sibling=null,t=Gn.current,En(Gn,n?t&1|2:t&1),e):(gr(e),null);case 22:case 23:return gk(),n=e.memoizedState!==null,s!==null&&s.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Xi&1073741824&&(gr(e),e.subtreeFlags&6&&(e.flags|=8192)):gr(e),null;case 24:return null;case 25:return null}throw Error(Me(156,e.tag))}function iO(s,e){switch(YS(e),e.tag){case 1:return _i(e.type)&&_2(),s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 3:return Km(),Rn(xi),Rn(jr),ik(),s=e.flags,s&65536&&!(s&128)?(e.flags=s&-65537|128,e):null;case 5:return rk(e),null;case 13:if(Rn(Gn),s=e.memoizedState,s!==null&&s.dehydrated!==null){if(e.alternate===null)throw Error(Me(340));Gm()}return s=e.flags,s&65536?(e.flags=s&-65537|128,e):null;case 19:return Rn(Gn),null;case 4:return Km(),null;case 10:return ek(e.type._context),null;case 22:case 23:return gk(),null;case 24:return null;default:return null}}var Vy=!1,Lr=!1,aO=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function yp(s,e){var t=s.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){ss(s,e,n)}else t.current=null}function N_(s,e,t){try{t()}catch(n){ss(s,e,n)}}var tC=!1;function oO(s,e){if(c_=y2,s=H4(),XS(s)){if("selectionStart"in s)var t={start:s.selectionStart,end:s.selectionEnd};else e:{t=(t=s.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var r=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,c=0,u=0,f=s,p=null;t:for(;;){for(var m;f!==t||r!==0&&f.nodeType!==3||(o=a+r),f!==i||n!==0&&f.nodeType!==3||(l=a+n),f.nodeType===3&&(a+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===s)break t;if(p===t&&++c===r&&(o=a),p===i&&++u===n&&(l=a),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(u_={focusedElem:s,selectionRange:t},y2=!1,Ze=e;Ze!==null;)if(e=Ze,s=e.child,(e.subtreeFlags&1028)!==0&&s!==null)s.return=e,Ze=s;else for(;Ze!==null;){e=Ze;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var y=b.memoizedProps,S=b.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?y:Ka(e.type,y),S);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(C){ss(e,e.return,C)}if(s=e.sibling,s!==null){s.return=e.return,Ze=s;break}Ze=e.return}return b=tC,tC=!1,b}function T0(s,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&s)===s){var i=r.destroy;r.destroy=void 0,i!==void 0&&N_(e,t,i)}r=r.next}while(r!==n)}}function Pw(s,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&s)===s){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function C_(s){var e=s.ref;if(e!==null){var t=s.stateNode;switch(s.tag){case 5:s=t;break;default:s=t}typeof e=="function"?e(s):e.current=s}}function $P(s){var e=s.alternate;e!==null&&(s.alternate=null,$P(e)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(e=s.stateNode,e!==null&&(delete e[ol],delete e[Q0],delete e[f_],delete e[q8],delete e[H8])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function UP(s){return s.tag===5||s.tag===3||s.tag===4}function nC(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||UP(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function E_(s,e,t){var n=s.tag;if(n===5||n===6)s=s.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(s,e):t.insertBefore(s,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(s,t)):(e=t,e.appendChild(s)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=x2));else if(n!==4&&(s=s.child,s!==null))for(E_(s,e,t),s=s.sibling;s!==null;)E_(s,e,t),s=s.sibling}function P_(s,e,t){var n=s.tag;if(n===5||n===6)s=s.stateNode,e?t.insertBefore(s,e):t.appendChild(s);else if(n!==4&&(s=s.child,s!==null))for(P_(s,e,t),s=s.sibling;s!==null;)P_(s,e,t),s=s.sibling}var or=null,ho=!1;function Uc(s,e,t){for(t=t.child;t!==null;)zP(s,e,t),t=t.sibling}function zP(s,e,t){if(ul&&typeof ul.onCommitFiberUnmount=="function")try{ul.onCommitFiberUnmount(xw,t)}catch{}switch(t.tag){case 5:Lr||yp(t,e);case 6:var n=or,r=ho;or=null,Uc(s,e,t),or=n,ho=r,or!==null&&(ho?(s=or,t=t.stateNode,s.nodeType===8?s.parentNode.removeChild(t):s.removeChild(t)):or.removeChild(t.stateNode));break;case 18:or!==null&&(ho?(s=or,t=t.stateNode,s.nodeType===8?Y5(s.parentNode,t):s.nodeType===1&&Y5(s,t),G0(s)):Y5(or,t.stateNode));break;case 4:n=or,r=ho,or=t.stateNode.containerInfo,ho=!0,Uc(s,e,t),or=n,ho=r;break;case 0:case 11:case 14:case 15:if(!Lr&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var i=r,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&N_(t,e,a),r=r.next}while(r!==n)}Uc(s,e,t);break;case 1:if(!Lr&&(yp(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(o){ss(t,e,o)}Uc(s,e,t);break;case 21:Uc(s,e,t);break;case 22:t.mode&1?(Lr=(n=Lr)||t.memoizedState!==null,Uc(s,e,t),Lr=n):Uc(s,e,t);break;default:Uc(s,e,t)}}function sC(s){var e=s.updateQueue;if(e!==null){s.updateQueue=null;var t=s.stateNode;t===null&&(t=s.stateNode=new aO),e.forEach(function(n){var r=gO.bind(null,s,n);t.has(n)||(t.add(n),n.then(r,r))})}}function qa(s,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];try{var i=s,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:or=o.stateNode,ho=!1;break e;case 3:or=o.stateNode.containerInfo,ho=!0;break e;case 4:or=o.stateNode.containerInfo,ho=!0;break e}o=o.return}if(or===null)throw Error(Me(160));zP(i,a,r),or=null,ho=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){ss(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)qP(e,s),e=e.sibling}function qP(s,e){var t=s.alternate,n=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(qa(e,s),jo(s),n&4){try{T0(3,s,s.return),Pw(3,s)}catch(y){ss(s,s.return,y)}try{T0(5,s,s.return)}catch(y){ss(s,s.return,y)}}break;case 1:qa(e,s),jo(s),n&512&&t!==null&&yp(t,t.return);break;case 5:if(qa(e,s),jo(s),n&512&&t!==null&&yp(t,t.return),s.flags&32){var r=s.stateNode;try{q0(r,"")}catch(y){ss(s,s.return,y)}}if(n&4&&(r=s.stateNode,r!=null)){var i=s.memoizedProps,a=t!==null?t.memoizedProps:i,o=s.type,l=s.updateQueue;if(s.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&d4(r,i),Zx(o,a);var c=Zx(o,i);for(a=0;a<l.length;a+=2){var u=l[a],f=l[a+1];u==="style"?g4(r,f):u==="dangerouslySetInnerHTML"?p4(r,f):u==="children"?q0(r,f):OS(r,u,f,c)}switch(o){case"input":Xx(r,i);break;case"textarea":h4(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Sp(r,!!i.multiple,m,!1):p!==!!i.multiple&&(i.defaultValue!=null?Sp(r,!!i.multiple,i.defaultValue,!0):Sp(r,!!i.multiple,i.multiple?[]:"",!1))}r[Q0]=i}catch(y){ss(s,s.return,y)}}break;case 6:if(qa(e,s),jo(s),n&4){if(s.stateNode===null)throw Error(Me(162));r=s.stateNode,i=s.memoizedProps;try{r.nodeValue=i}catch(y){ss(s,s.return,y)}}break;case 3:if(qa(e,s),jo(s),n&4&&t!==null&&t.memoizedState.isDehydrated)try{G0(e.containerInfo)}catch(y){ss(s,s.return,y)}break;case 4:qa(e,s),jo(s);break;case 13:qa(e,s),jo(s),r=s.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(pk=cs())),n&4&&sC(s);break;case 22:if(u=t!==null&&t.memoizedState!==null,s.mode&1?(Lr=(c=Lr)||u,qa(e,s),Lr=c):qa(e,s),jo(s),n&8192){if(c=s.memoizedState!==null,(s.stateNode.isHidden=c)&&!u&&s.mode&1)for(Ze=s,u=s.child;u!==null;){for(f=Ze=u;Ze!==null;){switch(p=Ze,m=p.child,p.tag){case 0:case 11:case 14:case 15:T0(4,p,p.return);break;case 1:yp(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){n=p,t=p.return;try{e=n,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(y){ss(n,t,y)}}break;case 5:yp(p,p.return);break;case 22:if(p.memoizedState!==null){iC(f);continue}}m!==null?(m.return=p,Ze=m):iC(f)}u=u.sibling}e:for(u=null,f=s;;){if(f.tag===5){if(u===null){u=f;try{r=f.stateNode,c?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=m4("display",a))}catch(y){ss(s,s.return,y)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(y){ss(s,s.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===s)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===s)break e;for(;f.sibling===null;){if(f.return===null||f.return===s)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:qa(e,s),jo(s),n&4&&sC(s);break;case 21:break;default:qa(e,s),jo(s)}}function jo(s){var e=s.flags;if(e&2){try{e:{for(var t=s.return;t!==null;){if(UP(t)){var n=t;break e}t=t.return}throw Error(Me(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(q0(r,""),n.flags&=-33);var i=nC(s);P_(s,i,r);break;case 3:case 4:var a=n.stateNode.containerInfo,o=nC(s);E_(s,o,a);break;default:throw Error(Me(161))}}catch(l){ss(s,s.return,l)}s.flags&=-3}e&4096&&(s.flags&=-4097)}function lO(s,e,t){Ze=s,HP(s)}function HP(s,e,t){for(var n=(s.mode&1)!==0;Ze!==null;){var r=Ze,i=r.child;if(r.tag===22&&n){var a=r.memoizedState!==null||Vy;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||Lr;o=Vy;var c=Lr;if(Vy=a,(Lr=l)&&!c)for(Ze=r;Ze!==null;)a=Ze,l=a.child,a.tag===22&&a.memoizedState!==null?aC(r):l!==null?(l.return=a,Ze=l):aC(r);for(;i!==null;)Ze=i,HP(i),i=i.sibling;Ze=r,Vy=o,Lr=c}rC(s)}else r.subtreeFlags&8772&&i!==null?(i.return=r,Ze=i):rC(s)}}function rC(s){for(;Ze!==null;){var e=Ze;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lr||Pw(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Lr)if(t===null)n.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Ka(e.type,t.memoizedProps);n.componentDidUpdate(r,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&zN(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}zN(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&G0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}Lr||e.flags&512&&C_(e)}catch(p){ss(e,e.return,p)}}if(e===s){Ze=null;break}if(t=e.sibling,t!==null){t.return=e.return,Ze=t;break}Ze=e.return}}function iC(s){for(;Ze!==null;){var e=Ze;if(e===s){Ze=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Ze=t;break}Ze=e.return}}function aC(s){for(;Ze!==null;){var e=Ze;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Pw(4,e)}catch(l){ss(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){ss(e,r,l)}}var i=e.return;try{C_(e)}catch(l){ss(e,i,l)}break;case 5:var a=e.return;try{C_(e)}catch(l){ss(e,a,l)}}}catch(l){ss(e,e.return,l)}if(e===s){Ze=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ze=o;break}Ze=e.return}}var cO=Math.ceil,I2=bc.ReactCurrentDispatcher,hk=bc.ReactCurrentOwner,La=bc.ReactCurrentBatchConfig,Jt=0,Js=null,xs=null,ur=0,Xi=0,bp=ed(0),Rs=0,r1=null,Jh=0,Lw=0,fk=0,I0=null,yi=null,pk=0,Jm=1/0,Tl=null,j2=!1,L_=null,$u=null,Gy=!1,ju=null,R2=0,j0=0,T_=null,Sb=-1,kb=0;function Gr(){return Jt&6?cs():Sb!==-1?Sb:Sb=cs()}function Uu(s){return s.mode&1?Jt&2&&ur!==0?ur&-ur:V8.transition!==null?(kb===0&&(kb=E4()),kb):(s=pn,s!==0||(s=window.event,s=s===void 0?16:O4(s.type)),s):1}function yo(s,e,t,n){if(50<j0)throw j0=0,T_=null,Error(Me(185));Bv(s,t,n),(!(Jt&2)||s!==Js)&&(s===Js&&(!(Jt&2)&&(Lw|=t),Rs===4&&Zc(s,ur)),Ai(s,n),t===1&&Jt===0&&!(e.mode&1)&&(Jm=cs()+500,Nw&&td()))}function Ai(s,e){var t=s.callbackNode;VR(s,e);var n=v2(s,s===Js?ur:0);if(n===0)t!==null&&mN(t),s.callbackNode=null,s.callbackPriority=0;else if(e=n&-n,s.callbackPriority!==e){if(t!=null&&mN(t),e===1)s.tag===0?W8(oC.bind(null,s)):eP(oC.bind(null,s)),U8(function(){!(Jt&6)&&td()}),t=null;else{switch(P4(n)){case 1:t=$S;break;case 4:t=N4;break;case 16:t=g2;break;case 536870912:t=C4;break;default:t=g2}t=QP(t,WP.bind(null,s))}s.callbackPriority=e,s.callbackNode=t}}function WP(s,e){if(Sb=-1,kb=0,Jt&6)throw Error(Me(327));var t=s.callbackNode;if(Pp()&&s.callbackNode!==t)return null;var n=v2(s,s===Js?ur:0);if(n===0)return null;if(n&30||n&s.expiredLanes||e)e=O2(s,n);else{e=n;var r=Jt;Jt|=2;var i=GP();(Js!==s||ur!==e)&&(Tl=null,Jm=cs()+500,Wh(s,e));do try{hO();break}catch(o){VP(s,o)}while(!0);ZS(),I2.current=i,Jt=r,xs!==null?e=0:(Js=null,ur=0,e=Rs)}if(e!==0){if(e===2&&(r=r_(s),r!==0&&(n=r,e=I_(s,r))),e===1)throw t=r1,Wh(s,0),Zc(s,n),Ai(s,cs()),t;if(e===6)Zc(s,n);else{if(r=s.current.alternate,!(n&30)&&!uO(r)&&(e=O2(s,n),e===2&&(i=r_(s),i!==0&&(n=i,e=I_(s,i))),e===1))throw t=r1,Wh(s,0),Zc(s,n),Ai(s,cs()),t;switch(s.finishedWork=r,s.finishedLanes=n,e){case 0:case 1:throw Error(Me(345));case 2:Sd(s,yi,Tl);break;case 3:if(Zc(s,n),(n&130023424)===n&&(e=pk+500-cs(),10<e)){if(v2(s,0)!==0)break;if(r=s.suspendedLanes,(r&n)!==n){Gr(),s.pingedLanes|=s.suspendedLanes&r;break}s.timeoutHandle=h_(Sd.bind(null,s,yi,Tl),e);break}Sd(s,yi,Tl);break;case 4:if(Zc(s,n),(n&4194240)===n)break;for(e=s.eventTimes,r=-1;0<n;){var a=31-vo(n);i=1<<a,a=e[a],a>r&&(r=a),n&=~i}if(n=r,n=cs()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cO(n/1960))-n,10<n){s.timeoutHandle=h_(Sd.bind(null,s,yi,Tl),n);break}Sd(s,yi,Tl);break;case 5:Sd(s,yi,Tl);break;default:throw Error(Me(329))}}}return Ai(s,cs()),s.callbackNode===t?WP.bind(null,s):null}function I_(s,e){var t=I0;return s.current.memoizedState.isDehydrated&&(Wh(s,e).flags|=256),s=O2(s,e),s!==2&&(e=yi,yi=t,e!==null&&j_(e)),s}function j_(s){yi===null?yi=s:yi.push.apply(yi,s)}function uO(s){for(var e=s;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var r=t[n],i=r.getSnapshot;r=r.value;try{if(!bo(i(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===s)break;for(;e.sibling===null;){if(e.return===null||e.return===s)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zc(s,e){for(e&=~fk,e&=~Lw,s.suspendedLanes|=e,s.pingedLanes&=~e,s=s.expirationTimes;0<e;){var t=31-vo(e),n=1<<t;s[t]=-1,e&=~n}}function oC(s){if(Jt&6)throw Error(Me(327));Pp();var e=v2(s,0);if(!(e&1))return Ai(s,cs()),null;var t=O2(s,e);if(s.tag!==0&&t===2){var n=r_(s);n!==0&&(e=n,t=I_(s,n))}if(t===1)throw t=r1,Wh(s,0),Zc(s,e),Ai(s,cs()),t;if(t===6)throw Error(Me(345));return s.finishedWork=s.current.alternate,s.finishedLanes=e,Sd(s,yi,Tl),Ai(s,cs()),null}function mk(s,e){var t=Jt;Jt|=1;try{return s(e)}finally{Jt=t,Jt===0&&(Jm=cs()+500,Nw&&td())}}function Qh(s){ju!==null&&ju.tag===0&&!(Jt&6)&&Pp();var e=Jt;Jt|=1;var t=La.transition,n=pn;try{if(La.transition=null,pn=1,s)return s()}finally{pn=n,La.transition=t,Jt=e,!(Jt&6)&&td()}}function gk(){Xi=bp.current,Rn(bp)}function Wh(s,e){s.finishedWork=null,s.finishedLanes=0;var t=s.timeoutHandle;if(t!==-1&&(s.timeoutHandle=-1,$8(t)),xs!==null)for(t=xs.return;t!==null;){var n=t;switch(YS(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&_2();break;case 3:Km(),Rn(xi),Rn(jr),ik();break;case 5:rk(n);break;case 4:Km();break;case 13:Rn(Gn);break;case 19:Rn(Gn);break;case 10:ek(n.type._context);break;case 22:case 23:gk()}t=t.return}if(Js=s,xs=s=zu(s.current,null),ur=Xi=e,Rs=0,r1=null,fk=Lw=Jh=0,yi=I0=null,Fd!==null){for(e=0;e<Fd.length;e++)if(t=Fd[e],n=t.interleaved,n!==null){t.interleaved=null;var r=n.next,i=t.pending;if(i!==null){var a=i.next;i.next=r,n.next=a}t.pending=n}Fd=null}return s}function VP(s,e){do{var t=xs;try{if(ZS(),xb.current=T2,L2){for(var n=Kn.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}L2=!1}if(Yh=0,Ks=js=Kn=null,L0=!1,t1=0,hk.current=null,t===null||t.return===null){Rs=1,r1=e,xs=null;break}e:{var i=s,a=t.return,o=t,l=e;if(e=ur,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=XN(a);if(m!==null){m.flags&=-257,KN(m,a,o,i,e),m.mode&1&&GN(i,c,e),e=m,l=c;var b=e.updateQueue;if(b===null){var y=new Set;y.add(l),e.updateQueue=y}else b.add(l);break e}else{if(!(e&1)){GN(i,c,e),vk();break e}l=Error(Me(426))}}else if(Bn&&o.mode&1){var S=XN(a);if(S!==null){!(S.flags&65536)&&(S.flags|=256),KN(S,a,o,i,e),JS(Ym(l,o));break e}}i=l=Ym(l,o),Rs!==4&&(Rs=2),I0===null?I0=[i]:I0.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=PP(i,l,e);UN(i,w);break e;case 1:o=l;var _=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&($u===null||!$u.has(k)))){i.flags|=65536,e&=-e,i.lanes|=e;var C=LP(i,o,e);UN(i,C);break e}}i=i.return}while(i!==null)}KP(t)}catch(B){e=B,xs===t&&t!==null&&(xs=t=t.return);continue}break}while(!0)}function GP(){var s=I2.current;return I2.current=T2,s===null?T2:s}function vk(){(Rs===0||Rs===3||Rs===2)&&(Rs=4),Js===null||!(Jh&268435455)&&!(Lw&268435455)||Zc(Js,ur)}function O2(s,e){var t=Jt;Jt|=2;var n=GP();(Js!==s||ur!==e)&&(Tl=null,Wh(s,e));do try{dO();break}catch(r){VP(s,r)}while(!0);if(ZS(),Jt=t,I2.current=n,xs!==null)throw Error(Me(261));return Js=null,ur=0,Rs}function dO(){for(;xs!==null;)XP(xs)}function hO(){for(;xs!==null&&!FR();)XP(xs)}function XP(s){var e=JP(s.alternate,s,Xi);s.memoizedProps=s.pendingProps,e===null?KP(s):xs=e,hk.current=null}function KP(s){var e=s;do{var t=e.alternate;if(s=e.return,e.flags&32768){if(t=iO(t,e),t!==null){t.flags&=32767,xs=t;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{Rs=6,xs=null;return}}else if(t=rO(t,e,Xi),t!==null){xs=t;return}if(e=e.sibling,e!==null){xs=e;return}xs=e=s}while(e!==null);Rs===0&&(Rs=5)}function Sd(s,e,t){var n=pn,r=La.transition;try{La.transition=null,pn=1,fO(s,e,t,n)}finally{La.transition=r,pn=n}return null}function fO(s,e,t,n){do Pp();while(ju!==null);if(Jt&6)throw Error(Me(327));t=s.finishedWork;var r=s.finishedLanes;if(t===null)return null;if(s.finishedWork=null,s.finishedLanes=0,t===s.current)throw Error(Me(177));s.callbackNode=null,s.callbackPriority=0;var i=t.lanes|t.childLanes;if(GR(s,i),s===Js&&(xs=Js=null,ur=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Gy||(Gy=!0,QP(g2,function(){return Pp(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=La.transition,La.transition=null;var a=pn;pn=1;var o=Jt;Jt|=4,hk.current=null,oO(s,t),qP(t,s),j8(u_),y2=!!c_,u_=c_=null,s.current=t,lO(t),DR(),Jt=o,pn=a,La.transition=i}else s.current=t;if(Gy&&(Gy=!1,ju=s,R2=r),i=s.pendingLanes,i===0&&($u=null),UR(t.stateNode),Ai(s,cs()),e!==null)for(n=s.onRecoverableError,t=0;t<e.length;t++)r=e[t],n(r.value,{componentStack:r.stack,digest:r.digest});if(j2)throw j2=!1,s=L_,L_=null,s;return R2&1&&s.tag!==0&&Pp(),i=s.pendingLanes,i&1?s===T_?j0++:(j0=0,T_=s):j0=0,td(),null}function Pp(){if(ju!==null){var s=P4(R2),e=La.transition,t=pn;try{if(La.transition=null,pn=16>s?16:s,ju===null)var n=!1;else{if(s=ju,ju=null,R2=0,Jt&6)throw Error(Me(331));var r=Jt;for(Jt|=4,Ze=s.current;Ze!==null;){var i=Ze,a=i.child;if(Ze.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ze=c;Ze!==null;){var u=Ze;switch(u.tag){case 0:case 11:case 15:T0(8,u,i)}var f=u.child;if(f!==null)f.return=u,Ze=f;else for(;Ze!==null;){u=Ze;var p=u.sibling,m=u.return;if($P(u),u===c){Ze=null;break}if(p!==null){p.return=m,Ze=p;break}Ze=m}}}var b=i.alternate;if(b!==null){var y=b.child;if(y!==null){b.child=null;do{var S=y.sibling;y.sibling=null,y=S}while(y!==null)}}Ze=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,Ze=a;else e:for(;Ze!==null;){if(i=Ze,i.flags&2048)switch(i.tag){case 0:case 11:case 15:T0(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,Ze=w;break e}Ze=i.return}}var _=s.current;for(Ze=_;Ze!==null;){a=Ze;var k=a.child;if(a.subtreeFlags&2064&&k!==null)k.return=a,Ze=k;else e:for(a=_;Ze!==null;){if(o=Ze,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Pw(9,o)}}catch(B){ss(o,o.return,B)}if(o===a){Ze=null;break e}var C=o.sibling;if(C!==null){C.return=o.return,Ze=C;break e}Ze=o.return}}if(Jt=r,td(),ul&&typeof ul.onPostCommitFiberRoot=="function")try{ul.onPostCommitFiberRoot(xw,s)}catch{}n=!0}return n}finally{pn=t,La.transition=e}}return!1}function lC(s,e,t){e=Ym(t,e),e=PP(s,e,1),s=Bu(s,e,1),e=Gr(),s!==null&&(Bv(s,1,e),Ai(s,e))}function ss(s,e,t){if(s.tag===3)lC(s,s,t);else for(;e!==null;){if(e.tag===3){lC(e,s,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&($u===null||!$u.has(n))){s=Ym(t,s),s=LP(e,s,1),e=Bu(e,s,1),s=Gr(),e!==null&&(Bv(e,1,s),Ai(e,s));break}}e=e.return}}function pO(s,e,t){var n=s.pingCache;n!==null&&n.delete(e),e=Gr(),s.pingedLanes|=s.suspendedLanes&t,Js===s&&(ur&t)===t&&(Rs===4||Rs===3&&(ur&130023424)===ur&&500>cs()-pk?Wh(s,0):fk|=t),Ai(s,e)}function YP(s,e){e===0&&(s.mode&1?(e=Fy,Fy<<=1,!(Fy&130023424)&&(Fy=4194304)):e=1);var t=Gr();s=mc(s,e),s!==null&&(Bv(s,e,t),Ai(s,t))}function mO(s){var e=s.memoizedState,t=0;e!==null&&(t=e.retryLane),YP(s,t)}function gO(s,e){var t=0;switch(s.tag){case 13:var n=s.stateNode,r=s.memoizedState;r!==null&&(t=r.retryLane);break;case 19:n=s.stateNode;break;default:throw Error(Me(314))}n!==null&&n.delete(e),YP(s,t)}var JP;JP=function(s,e,t){if(s!==null)if(s.memoizedProps!==e.pendingProps||xi.current)wi=!0;else{if(!(s.lanes&t)&&!(e.flags&128))return wi=!1,sO(s,e,t);wi=!!(s.flags&131072)}else wi=!1,Bn&&e.flags&1048576&&tP(e,k2,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Ab(s,e),s=e.pendingProps;var r=Vm(e,jr.current);Ep(e,t),r=ok(null,e,n,s,r,t);var i=lk();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_i(n)?(i=!0,A2(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,nk(e),r.updater=Ew,e.stateNode=r,r._reactInternals=e,b_(e,n,s,t),e=__(null,e,n,!0,i,t)):(e.tag=0,Bn&&i&&KS(e),Vr(null,e,r,t),e=e.child),e;case 16:n=e.elementType;e:{switch(Ab(s,e),s=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=yO(n),s=Ka(n,s),r){case 0:e=x_(null,e,n,s,t);break e;case 1:e=QN(null,e,n,s,t);break e;case 11:e=YN(null,e,n,s,t);break e;case 14:e=JN(null,e,n,Ka(n.type,s),t);break e}throw Error(Me(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Ka(n,r),x_(s,e,n,r,t);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Ka(n,r),QN(s,e,n,r,t);case 3:e:{if(RP(e),s===null)throw Error(Me(387));n=e.pendingProps,i=e.memoizedState,r=i.element,oP(s,e),E2(e,n,null,t);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=Ym(Error(Me(423)),e),e=ZN(s,e,n,t,r);break e}else if(n!==r){r=Ym(Error(Me(424)),e),e=ZN(s,e,n,t,r);break e}else for(Ji=Du(e.stateNode.containerInfo.firstChild),Zi=e,Bn=!0,po=null,t=iP(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Gm(),n===r){e=gc(s,e,t);break e}Vr(s,e,n,t)}e=e.child}return e;case 5:return lP(e),s===null&&g_(e),n=e.type,r=e.pendingProps,i=s!==null?s.memoizedProps:null,a=r.children,d_(n,r)?a=null:i!==null&&d_(n,i)&&(e.flags|=32),jP(s,e),Vr(s,e,a,t),e.child;case 6:return s===null&&g_(e),null;case 13:return OP(s,e,t);case 4:return sk(e,e.stateNode.containerInfo),n=e.pendingProps,s===null?e.child=Xm(e,null,n,t):Vr(s,e,n,t),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Ka(n,r),YN(s,e,n,r,t);case 7:return Vr(s,e,e.pendingProps,t),e.child;case 8:return Vr(s,e,e.pendingProps.children,t),e.child;case 12:return Vr(s,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,i=e.memoizedProps,a=r.value,En(N2,n._currentValue),n._currentValue=a,i!==null)if(bo(i.value,a)){if(i.children===r.children&&!xi.current){e=gc(s,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=uc(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),v_(i.return,t,e),o.lanes|=t;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(Me(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),v_(a,t,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Vr(s,e,r.children,t),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,Ep(e,t),r=ja(r),n=n(r),e.flags|=1,Vr(s,e,n,t),e.child;case 14:return n=e.type,r=Ka(n,e.pendingProps),r=Ka(n.type,r),JN(s,e,n,r,t);case 15:return TP(s,e,e.type,e.pendingProps,t);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Ka(n,r),Ab(s,e),e.tag=1,_i(n)?(s=!0,A2(e)):s=!1,Ep(e,t),EP(e,n,r),b_(e,n,r,t),__(null,e,n,!0,s,t);case 19:return MP(s,e,t);case 22:return IP(s,e,t)}throw Error(Me(156,e.tag))};function QP(s,e){return k4(s,e)}function vO(s,e,t,n){this.tag=s,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(s,e,t,n){return new vO(s,e,t,n)}function yk(s){return s=s.prototype,!(!s||!s.isReactComponent)}function yO(s){if(typeof s=="function")return yk(s)?1:0;if(s!=null){if(s=s.$$typeof,s===FS)return 11;if(s===DS)return 14}return 2}function zu(s,e){var t=s.alternate;return t===null?(t=Ea(s.tag,e,s.key,s.mode),t.elementType=s.elementType,t.type=s.type,t.stateNode=s.stateNode,t.alternate=s,s.alternate=t):(t.pendingProps=e,t.type=s.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=s.flags&14680064,t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,e=s.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=s.sibling,t.index=s.index,t.ref=s.ref,t}function Nb(s,e,t,n,r,i){var a=2;if(n=s,typeof s=="function")yk(s)&&(a=1);else if(typeof s=="string")a=5;else e:switch(s){case cp:return Vh(t.children,r,i,e);case MS:a=8,r|=8;break;case qx:return s=Ea(12,t,e,r|2),s.elementType=qx,s.lanes=i,s;case Hx:return s=Ea(13,t,e,r),s.elementType=Hx,s.lanes=i,s;case Wx:return s=Ea(19,t,e,r),s.elementType=Wx,s.lanes=i,s;case l4:return Tw(t,r,i,e);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case a4:a=10;break e;case o4:a=9;break e;case FS:a=11;break e;case DS:a=14;break e;case Yc:a=16,n=null;break e}throw Error(Me(130,s==null?s:typeof s,""))}return e=Ea(a,t,e,r),e.elementType=s,e.type=n,e.lanes=i,e}function Vh(s,e,t,n){return s=Ea(7,s,n,e),s.lanes=t,s}function Tw(s,e,t,n){return s=Ea(22,s,n,e),s.elementType=l4,s.lanes=t,s.stateNode={isHidden:!1},s}function rx(s,e,t){return s=Ea(6,s,null,e),s.lanes=t,s}function ix(s,e,t){return e=Ea(4,s.children!==null?s.children:[],s.key,e),e.lanes=t,e.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},e}function bO(s,e,t,n,r){this.tag=e,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=B5(0),this.expirationTimes=B5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B5(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function bk(s,e,t,n,r,i,a,o,l){return s=new bO(s,e,t,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ea(3,null,null,e),s.current=i,i.stateNode=s,i.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},nk(i),s}function wO(s,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:lp,key:n==null?null:""+n,children:s,containerInfo:e,implementation:t}}function ZP(s){if(!s)return Vu;s=s._reactInternals;e:{if(af(s)!==s||s.tag!==1)throw Error(Me(170));var e=s;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_i(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Me(171))}if(s.tag===1){var t=s.type;if(_i(t))return Z4(s,t,e)}return e}function eL(s,e,t,n,r,i,a,o,l){return s=bk(t,n,!0,s,r,i,a,o,l),s.context=ZP(null),t=s.current,n=Gr(),r=Uu(t),i=uc(n,r),i.callback=e??null,Bu(t,i,r),s.current.lanes=r,Bv(s,r,n),Ai(s,n),s}function Iw(s,e,t,n){var r=e.current,i=Gr(),a=Uu(r);return t=ZP(t),e.context===null?e.context=t:e.pendingContext=t,e=uc(i,a),e.payload={element:s},n=n===void 0?null:n,n!==null&&(e.callback=n),s=Bu(r,e,a),s!==null&&(yo(s,r,a,i),wb(s,r,a)),a}function M2(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function cC(s,e){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var t=s.retryLane;s.retryLane=t!==0&&t<e?t:e}}function wk(s,e){cC(s,e),(s=s.alternate)&&cC(s,e)}function xO(){return null}var tL=typeof reportError=="function"?reportError:function(s){console.error(s)};function xk(s){this._internalRoot=s}jw.prototype.render=xk.prototype.render=function(s){var e=this._internalRoot;if(e===null)throw Error(Me(409));Iw(s,e,null,null)};jw.prototype.unmount=xk.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var e=s.containerInfo;Qh(function(){Iw(null,s,null,null)}),e[pc]=null}};function jw(s){this._internalRoot=s}jw.prototype.unstable_scheduleHydration=function(s){if(s){var e=I4();s={blockedOn:null,target:s,priority:e};for(var t=0;t<Qc.length&&e!==0&&e<Qc[t].priority;t++);Qc.splice(t,0,s),t===0&&R4(s)}};function _k(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Rw(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function uC(){}function _O(s,e,t,n,r){if(r){if(typeof n=="function"){var i=n;n=function(){var c=M2(a);i.call(c)}}var a=eL(e,n,s,0,null,!1,!1,"",uC);return s._reactRootContainer=a,s[pc]=a.current,Y0(s.nodeType===8?s.parentNode:s),Qh(),a}for(;r=s.lastChild;)s.removeChild(r);if(typeof n=="function"){var o=n;n=function(){var c=M2(l);o.call(c)}}var l=bk(s,0,!1,null,null,!1,!1,"",uC);return s._reactRootContainer=l,s[pc]=l.current,Y0(s.nodeType===8?s.parentNode:s),Qh(function(){Iw(e,l,t,n)}),l}function Ow(s,e,t,n,r){var i=t._reactRootContainer;if(i){var a=i;if(typeof r=="function"){var o=r;r=function(){var l=M2(a);o.call(l)}}Iw(e,a,s,r)}else a=_O(t,e,s,r,n);return M2(a)}L4=function(s){switch(s.tag){case 3:var e=s.stateNode;if(e.current.memoizedState.isDehydrated){var t=e0(e.pendingLanes);t!==0&&(US(e,t|1),Ai(e,cs()),!(Jt&6)&&(Jm=cs()+500,td()))}break;case 13:Qh(function(){var n=mc(s,1);if(n!==null){var r=Gr();yo(n,s,1,r)}}),wk(s,1)}};zS=function(s){if(s.tag===13){var e=mc(s,134217728);if(e!==null){var t=Gr();yo(e,s,134217728,t)}wk(s,134217728)}};T4=function(s){if(s.tag===13){var e=Uu(s),t=mc(s,e);if(t!==null){var n=Gr();yo(t,s,e,n)}wk(s,e)}};I4=function(){return pn};j4=function(s,e){var t=pn;try{return pn=s,e()}finally{pn=t}};t_=function(s,e,t){switch(e){case"input":if(Xx(s,t),e=t.name,t.type==="radio"&&e!=null){for(t=s;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==s&&n.form===s.form){var r=kw(n);if(!r)throw Error(Me(90));u4(n),Xx(n,r)}}}break;case"textarea":h4(s,t);break;case"select":e=t.value,e!=null&&Sp(s,!!t.multiple,e,!1)}};b4=mk;w4=Qh;var AO={usingClientEntryPoint:!1,Events:[Uv,fp,kw,v4,y4,mk]},Hg={findFiberByHostInstance:Md,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SO={bundleType:Hg.bundleType,version:Hg.version,rendererPackageName:Hg.rendererPackageName,rendererConfig:Hg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bc.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=A4(s),s===null?null:s.stateNode},findFiberByHostInstance:Hg.findFiberByHostInstance||xO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xy.isDisabled&&Xy.supportsFiber)try{xw=Xy.inject(SO),ul=Xy}catch{}}na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AO;na.createPortal=function(s,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_k(e))throw Error(Me(200));return wO(s,e,null,t)};na.createRoot=function(s,e){if(!_k(s))throw Error(Me(299));var t=!1,n="",r=tL;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=bk(s,1,!1,null,null,t,!1,n,r),s[pc]=e.current,Y0(s.nodeType===8?s.parentNode:s),new xk(e)};na.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var e=s._reactInternals;if(e===void 0)throw typeof s.render=="function"?Error(Me(188)):(s=Object.keys(s).join(","),Error(Me(268,s)));return s=A4(e),s=s===null?null:s.stateNode,s};na.flushSync=function(s){return Qh(s)};na.hydrate=function(s,e,t){if(!Rw(e))throw Error(Me(200));return Ow(null,s,e,!0,t)};na.hydrateRoot=function(s,e,t){if(!_k(s))throw Error(Me(405));var n=t!=null&&t.hydratedSources||null,r=!1,i="",a=tL;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=eL(e,null,s,1,t??null,r,!1,i,a),s[pc]=e.current,Y0(s),n)for(s=0;s<n.length;s++)t=n[s],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new jw(e)};na.render=function(s,e,t){if(!Rw(e))throw Error(Me(200));return Ow(null,s,e,!1,t)};na.unmountComponentAtNode=function(s){if(!Rw(s))throw Error(Me(40));return s._reactRootContainer?(Qh(function(){Ow(null,null,s,!1,function(){s._reactRootContainer=null,s[pc]=null})}),!0):!1};na.unstable_batchedUpdates=mk;na.unstable_renderSubtreeIntoContainer=function(s,e,t,n){if(!Rw(t))throw Error(Me(200));if(s==null||s._reactInternals===void 0)throw Error(Me(38));return Ow(s,e,t,!1,n)};na.version="18.3.1-next-f1338f8080-20240426";function nL(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(nL)}catch(s){console.error(s)}}nL(),n4.exports=na;var kO=n4.exports,dC=kO;Ux.createRoot=dC.createRoot,Ux.hydrateRoot=dC.hydrateRoot;function NO(s){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(s)})}const R_="RFC3986",O_={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},CO="RFC1738",EO=Array.isArray,Ro=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),ax=1024,PO=(s,e,t,n,r)=>{if(s.length===0)return s;let i=s;if(typeof s=="symbol"?i=Symbol.prototype.toString.call(s):typeof s!="string"&&(i=String(s)),t==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=ax){const l=i.length>=ax?i.slice(o,o+ax):i,c=[];for(let u=0;u<l.length;++u){let f=l.charCodeAt(u);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||r===CO&&(f===40||f===41)){c[c.length]=l.charAt(u);continue}if(f<128){c[c.length]=Ro[f];continue}if(f<2048){c[c.length]=Ro[192|f>>6]+Ro[128|f&63];continue}if(f<55296||f>=57344){c[c.length]=Ro[224|f>>12]+Ro[128|f>>6&63]+Ro[128|f&63];continue}u+=1,f=65536+((f&1023)<<10|l.charCodeAt(u)&1023),c[c.length]=Ro[240|f>>18]+Ro[128|f>>12&63]+Ro[128|f>>6&63]+Ro[128|f&63]}a+=c.join("")}return a};function LO(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function hC(s,e){if(EO(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const TO=Object.prototype.hasOwnProperty,sL={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},zo=Array.isArray,IO=Array.prototype.push,rL=function(s,e){IO.apply(s,zo(e)?e:[e])},jO=Date.prototype.toISOString,Ls={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:PO,encodeValuesOnly:!1,format:R_,formatter:O_[R_],indices:!1,serializeDate(s){return jO.call(s)},skipNulls:!1,strictNullHandling:!1};function RO(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const ox={};function iL(s,e,t,n,r,i,a,o,l,c,u,f,p,m,b,y,S,w){let _=s,k=w,C=0,B=!1;for(;(k=k.get(ox))!==void 0&&!B;){const Y=k.get(s);if(C+=1,typeof Y<"u"){if(Y===C)throw new RangeError("Cyclic object value");B=!0}typeof k.get(ox)>"u"&&(C=0)}if(typeof c=="function"?_=c(e,_):_ instanceof Date?_=p==null?void 0:p(_):t==="comma"&&zo(_)&&(_=hC(_,function(Y){return Y instanceof Date?p==null?void 0:p(Y):Y})),_===null){if(i)return l&&!y?l(e,Ls.encoder,S,"key",m):e;_=""}if(RO(_)||LO(_)){if(l){const Y=y?e:l(e,Ls.encoder,S,"key",m);return[(b==null?void 0:b(Y))+"="+(b==null?void 0:b(l(_,Ls.encoder,S,"value",m)))]}return[(b==null?void 0:b(e))+"="+(b==null?void 0:b(String(_)))]}const F=[];if(typeof _>"u")return F;let j;if(t==="comma"&&zo(_))y&&l&&(_=hC(_,l)),j=[{value:_.length>0?_.join(",")||null:void 0}];else if(zo(c))j=c;else{const Y=Object.keys(_);j=u?Y.sort(u):Y}const T=o?String(e).replace(/\./g,"%2E"):String(e),W=n&&zo(_)&&_.length===1?T+"[]":T;if(r&&zo(_)&&_.length===0)return W+"[]";for(let Y=0;Y<j.length;++Y){const I=j[Y],O=typeof I=="object"&&typeof I.value<"u"?I.value:_[I];if(a&&O===null)continue;const X=f&&o?I.replace(/\./g,"%2E"):I,K=zo(_)?typeof t=="function"?t(W,X):W:W+(f?"."+X:"["+X+"]");w.set(s,C);const ne=new WeakMap;ne.set(ox,w),rL(F,iL(O,K,t,n,r,i,a,o,t==="comma"&&y&&zo(_)?null:l,c,u,f,p,m,b,y,S,ne))}return F}function OO(s=Ls){if(typeof s.allowEmptyArrays<"u"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys<"u"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder<"u"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||Ls.charset;if(typeof s.charset<"u"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=R_;if(typeof s.format<"u"){if(!TO.call(O_,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=O_[t];let r=Ls.filter;(typeof s.filter=="function"||zo(s.filter))&&(r=s.filter);let i;if(s.arrayFormat&&s.arrayFormat in sL?i=s.arrayFormat:"indices"in s?i=s.indices?"indices":"repeat":i=Ls.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof s.allowDots>"u"?s.encodeDotInKeys?!0:Ls.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:Ls.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:Ls.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:Ls.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter>"u"?Ls.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:Ls.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:Ls.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:Ls.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:Ls.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:Ls.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:Ls.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:Ls.strictNullHandling}}function MO(s,e={}){let t=s;const n=OO(e);let r,i;typeof n.filter=="function"?(i=n.filter,t=i("",t)):zo(n.filter)&&(i=n.filter,r=i);const a=[];if(typeof t!="object"||t===null)return"";const o=sL[n.arrayFormat],l=o==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const c=new WeakMap;for(let p=0;p<r.length;++p){const m=r[p];n.skipNulls&&t[m]===null||rL(a,iL(t[m],m,o,l,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const u=a.join(n.delimiter);let f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),u.length>0?f+u:""}const Kf="4.104.0";let fC=!1,R0,aL,oL,M_,lL,cL,uL,dL,hL;function FO(s,e={auto:!1}){if(fC)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(R0)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${R0}'\``);fC=e.auto,R0=s.kind,aL=s.fetch,oL=s.FormData,M_=s.File,lL=s.ReadableStream,cL=s.getMultipartRequestOptions,uL=s.getDefaultAgent,dL=s.fileFromPath,hL=s.isFsReadStream}class DO{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function BO({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,r,i;try{t=fetch,n=Request,r=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new DO(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}const fL=()=>{R0||FO(BO(),{auto:!0})};fL();class wt extends Error{}class hr extends wt{constructor(e,t,n,r){super(`${hr.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r==null?void 0:r["x-request-id"],this.error=t;const i=t;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new Mw({message:n,cause:D_(t)});const i=t==null?void 0:t.error;return e===400?new pL(e,i,n,r):e===401?new mL(e,i,n,r):e===403?new gL(e,i,n,r):e===404?new vL(e,i,n,r):e===409?new yL(e,i,n,r):e===422?new bL(e,i,n,r):e===429?new wL(e,i,n,r):e>=500?new xL(e,i,n,r):new hr(e,i,n,r)}}class Pa extends hr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Mw extends hr{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ak extends Mw{constructor({message:e}={}){super({message:e??"Request timed out."})}}class pL extends hr{}class mL extends hr{}class gL extends hr{}class vL extends hr{}class yL extends hr{}class bL extends hr{}class wL extends hr{}class xL extends hr{}class _L extends wt{constructor(){super("Could not parse response content as the length limit was reached")}}class AL extends wt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Ky=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},wd=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ii;class Fw{constructor(){Ii.set(this,void 0),this.buffer=new Uint8Array,Ky(this,Ii,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let i;for(;(i=$O(this.buffer,wd(this,Ii,"f")))!=null;){if(i.carriage&&wd(this,Ii,"f")==null){Ky(this,Ii,i.index,"f");continue}if(wd(this,Ii,"f")!=null&&(i.index!==wd(this,Ii,"f")+1||i.carriage)){r.push(this.decodeText(this.buffer.slice(0,wd(this,Ii,"f")-1))),this.buffer=this.buffer.slice(wd(this,Ii,"f")),Ky(this,Ii,null,"f");continue}const a=wd(this,Ii,"f")!==null?i.preceding-1:i.preceding,o=this.decodeText(this.buffer.slice(0,a));r.push(o),this.buffer=this.buffer.slice(i.index),Ky(this,Ii,null,"f")}return r}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new wt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new wt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new wt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Ii=new WeakMap;Fw.NEWLINE_CHARS=new Set([`
`,"\r"]);Fw.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function $O(s,e){for(let r=e??0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function UO(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}function SL(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class ll{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*r(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const a of zO(e,t))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null||a.event.startsWith("response.")||a.event.startsWith("transcript.")){let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(o&&o.error)throw new hr(void 0,o.error,void 0,TL(e.headers));yield o}else{let o;try{o=JSON.parse(a.data)}catch(l){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),l}if(a.event=="error")throw new hr(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||t.abort()}}return new ll(r,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const a=new Fw,o=SL(e);for await(const l of o)for(const c of a.decode(l))yield c;for(const l of a.flush())yield l}async function*i(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const o of r())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new ll(i,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=i=>({next:()=>{if(i.length===0){const a=n.next();e.push(a),t.push(a)}return i.shift()}});return[new ll(()=>r(e),this.controller),new ll(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new lL({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:i,done:a}=await t.next();if(a)return r.close();const o=n.encode(JSON.stringify(i)+`
`);r.enqueue(o)}catch(i){r.error(i)}},async cancel(){var r;await((r=t.return)==null?void 0:r.call(t))}})}}async function*zO(s,e){if(!s.body)throw e.abort(),new wt("Attempted to iterate over a response with no body");const t=new HO,n=new Fw,r=SL(s.body);for await(const i of qO(r))for(const a of n.decode(i)){const o=t.decode(a);o&&(yield o)}for(const i of n.flush()){const a=t.decode(i);a&&(yield a)}}async function*qO(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),e=r;let i;for(;(i=UO(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class HO{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=WO(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function WO(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}const kL=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",NL=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&Dw(s),Dw=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",VO=s=>NL(s)||kL(s)||hL(s);async function CL(s,e,t){var r;if(s=await s,NL(s))return s;if(kL(s)){const i=await s.blob();e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file");const a=Dw(i)?[await i.arrayBuffer()]:[i];return new M_(a,e,t)}const n=await GO(s);if(e||(e=KO(s)??"unknown_file"),!(t!=null&&t.type)){const i=(r=n[0])==null?void 0:r.type;typeof i=="string"&&(t={...t,type:i})}return new M_(n,e,t)}async function GO(s){var t;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(Dw(s))e.push(await s.arrayBuffer());else if(YO(s))for await(const n of s)e.push(n);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(t=s==null?void 0:s.constructor)==null?void 0:t.name}; props: ${XO(s)}`);return e}function XO(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function KO(s){var e;return lx(s.name)||lx(s.filename)||((e=lx(s.path))==null?void 0:e.split(/[\\/]/).pop())}const lx=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},YO=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",pC=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",Zh=async s=>{const e=await JO(s.body);return cL(e,s)},JO=async s=>{const e=new oL;return await Promise.all(Object.entries(s||{}).map(([t,n])=>F_(e,t,n))),e},F_=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(VO(t)){const n=await CL(t);s.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>F_(s,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,r])=>F_(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Lp={},QO=function(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t},ZO=function(s,e,t,n){if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Yy;fL();async function EL(s){var a;const{response:e}=s;if(s.options.stream)return qu("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):ll.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const t=e.headers.get("content-type"),n=(a=t==null?void 0:t.split(";")[0])==null?void 0:a.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const o=await e.json();return qu("response",e.status,e.url,e.headers,o),PL(o,e)}const i=await e.text();return qu("response",e.status,e.url,e.headers,i),i}function PL(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Bw extends Promise{constructor(e,t=EL){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Bw(this.responsePromise,async t=>PL(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class eM{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:i}){this.baseURL=e,this.maxRetries=cx("maxRetries",t),this.timeout=cx("timeout",n),this.httpAgent=r,this.fetch=i??aL}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...iM(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${cM()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const i=r&&Dw(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:i}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var y;const n={...e},{method:r,path:i,query:a,headers:o={}}=n,l=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:pC(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,c=this.calculateContentLength(l),u=this.buildURL(i,a);"timeout"in n&&cx("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const f=n.httpAgent??this.httpAgent??uL(u),p=n.timeout+1e3;typeof((y=f==null?void 0:f.options)==null?void 0:y.timeout)=="number"&&p>(f.options.timeout??0)&&(f.options.timeout=p),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:n,headers:o,contentLength:c,retryCount:t});return{req:{method:r,...l&&{body:l},headers:m,...f&&{agent:f},signal:n.signal??null},url:u,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const i={};n&&(i["content-length"]=n);const a=this.defaultHeaders(e);return yC(i,a),yC(i,t),pC(e.body)&&R0!=="node"&&delete i["content-type"],Qy(a,"x-stainless-retry-count")===void 0&&Qy(t,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(r)),Qy(a,"x-stainless-timeout")===void 0&&Qy(t,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,t),i}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return hr.generate(e,t,n,r)}request(e,t=null){return new Bw(this.makeRequest(e,t))}async makeRequest(e,t){var f,p;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:i,url:a,timeout:o}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(i,{url:a,options:n}),qu("request",a,n,i.headers),(f=n.signal)!=null&&f.aborted)throw new Pa;const l=new AbortController,c=await this.fetchWithTimeout(a,i,o,l).catch(D_);if(c instanceof Error){if((p=n.signal)!=null&&p.aborted)throw new Pa;if(t)return this.retryRequest(n,t);throw c.name==="AbortError"?new Ak:new Mw({cause:c})}const u=TL(c.headers);if(!c.ok){if(t&&this.shouldRetry(c)){const _=`retrying, ${t} attempts remaining`;return qu(`response (error; ${_})`,c.status,a,u),this.retryRequest(n,t,u)}const m=await c.text().catch(_=>D_(_).message),b=aM(m),y=b?void 0:m;throw qu(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,c.status,a,u,y),this.makeStatusError(c.status,b,y,u)}return{response:c,options:n,controller:l}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new tM(this,n,e)}buildURL(e,t){const n=lM(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return IL(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new wt(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:i,...a}=t||{};i&&i.addEventListener("abort",()=>r.abort());const o=setTimeout(()=>r.abort(),n),l={signal:r.signal,...a};return l.method&&(l.method=l.method.toUpperCase()),this.fetch.call(void 0,e,l).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const i=n==null?void 0:n["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(r=o)}const a=n==null?void 0:n["retry-after"];if(a&&!r){const o=parseFloat(a);Number.isNaN(o)?r=Date.parse(a)-Date.now():r=o*1e3}if(!(r&&0<=r&&r<60*1e3)){const o=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,o)}return await qv(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const i=t-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Kf}`}}class LL{constructor(e,t,n,r){Yy.set(this,void 0),QO(this,Yy,e),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new wt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[r,i]of n)e.url.searchParams.set(r,i);t.query=void 0,t.path=e.url.toString()}return await ZO(this,Yy,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Yy=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class tM extends Bw{constructor(e,t,n){super(t,async r=>new n(e,r.response,await EL(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const TL=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),nM={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},Jn=s=>typeof s=="object"&&s!==null&&!IL(s)&&Object.keys(s).every(e=>jL(nM,e)),sM=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kf,"X-Stainless-OS":gC(Deno.build.os),"X-Stainless-Arch":mC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kf,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kf,"X-Stainless-OS":gC(process.platform),"X-Stainless-Arch":mC(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=rM();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kf,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Kf,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function rM(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,i=n[2]||0,a=n[3]||0;return{browser:e,version:`${r}.${i}.${a}`}}}return null}const mC=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",gC=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let vC;const iM=()=>vC??(vC=sM()),aM=s=>{try{return JSON.parse(s)}catch{return}},oM=/^[a-z][a-z0-9+.-]*:/i,lM=s=>oM.test(s),qv=s=>new Promise(e=>setTimeout(e,s)),cx=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wt(`${s} must be an integer`);if(e<0)throw new wt(`${s} must be a positive integer`);return e},D_=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch{}return new Error(s)},Jy=s=>{var e,t,n,r;if(typeof process<"u")return((e=Lp==null?void 0:Lp[s])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(r=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,s))==null?void 0:r.trim()};function IL(s){if(!s)return!0;for(const e in s)return!1;return!0}function jL(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function yC(s,e){for(const t in e){if(!jL(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}const bC=new Set(["authorization","api-key"]);function qu(s,...e){if(typeof process<"u"&&(Lp==null?void 0:Lp.DEBUG)==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const i={...n,headers:{...n.headers}};for(const a in n.headers)bC.has(a.toLowerCase())&&(i.headers[a]="REDACTED");return i}let r=null;for(const i in n)bC.has(i.toLowerCase())&&(r??(r={...n}),r[i]="REDACTED");return r??n});console.log(`OpenAI:DEBUG:${s}`,...t)}}const cM=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),uM=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",dM=s=>typeof(s==null?void 0:s.get)=="function",Qy=(s,e)=>{var n;const t=e.toLowerCase();if(dM(s)){const r=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,a,o)=>a+o.toUpperCase());for(const i of[e,t,e.toUpperCase(),r]){const a=s.get(i);if(a)return a}}for(const[r,i]of Object.entries(s))if(r.toLowerCase()===t)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},hM=s=>{if(typeof Buffer<"u"){const e=Buffer.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};function ux(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class $w extends LL{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Ms extends LL{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class xt{constructor(e){this._client=e}}let RL=class extends xt{list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,fM,{query:t,...n})}},Uw=class extends xt{constructor(){super(...arguments),this.messages=new RL(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/chat/completions",zw,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class zw extends Ms{}class fM extends Ms{}Uw.ChatCompletionsPage=zw;Uw.Messages=RL;let qw=class extends xt{constructor(){super(...arguments),this.completions=new Uw(this._client)}};qw.Completions=Uw;qw.ChatCompletionsPage=zw;class OL extends xt{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class ML extends xt{create(e,t){return this._client.post("/audio/transcriptions",Zh({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class FL extends xt{create(e,t){return this._client.post("/audio/translations",Zh({body:e,...t,__metadata:{model:e.model}}))}}class Hv extends xt{constructor(){super(...arguments),this.transcriptions=new ML(this._client),this.translations=new FL(this._client),this.speech=new OL(this._client)}}Hv.Transcriptions=ML;Hv.Translations=FL;Hv.Speech=OL;class Sk extends xt{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/batches",kk,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class kk extends Ms{}Sk.BatchesPage=kk;var Ga=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Hn=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},B_,Cb,Eb,n0,s0,Pb,r0,Cl,i0,F2,D2,Yf,DL;class Nk{constructor(){B_.add(this),this.controller=new AbortController,Cb.set(this,void 0),Eb.set(this,()=>{}),n0.set(this,()=>{}),s0.set(this,void 0),Pb.set(this,()=>{}),r0.set(this,()=>{}),Cl.set(this,{}),i0.set(this,!1),F2.set(this,!1),D2.set(this,!1),Yf.set(this,!1),Ga(this,Cb,new Promise((e,t)=>{Ga(this,Eb,e,"f"),Ga(this,n0,t,"f")}),"f"),Ga(this,s0,new Promise((e,t)=>{Ga(this,Pb,e,"f"),Ga(this,r0,t,"f")}),"f"),Hn(this,Cb,"f").catch(()=>{}),Hn(this,s0,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},Hn(this,B_,"m",DL).bind(this))},0)}_connected(){this.ended||(Hn(this,Eb,"f").call(this),this._emit("connect"))}get ended(){return Hn(this,i0,"f")}get errored(){return Hn(this,F2,"f")}get aborted(){return Hn(this,D2,"f")}abort(){this.controller.abort()}on(e,t){return(Hn(this,Cl,"f")[e]||(Hn(this,Cl,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=Hn(this,Cl,"f")[e];if(!n)return this;const r=n.findIndex(i=>i.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(Hn(this,Cl,"f")[e]||(Hn(this,Cl,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{Ga(this,Yf,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){Ga(this,Yf,!0,"f"),await Hn(this,s0,"f")}_emit(e,...t){if(Hn(this,i0,"f"))return;e==="end"&&(Ga(this,i0,!0,"f"),Hn(this,Pb,"f").call(this));const n=Hn(this,Cl,"f")[e];if(n&&(Hn(this,Cl,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!Hn(this,Yf,"f")&&!(n!=null&&n.length)&&Promise.reject(r),Hn(this,n0,"f").call(this,r),Hn(this,r0,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!Hn(this,Yf,"f")&&!(n!=null&&n.length)&&Promise.reject(r),Hn(this,n0,"f").call(this,r),Hn(this,r0,"f").call(this,r),this._emit("end")}}_emitFinal(){}}Cb=new WeakMap,Eb=new WeakMap,n0=new WeakMap,s0=new WeakMap,Pb=new WeakMap,r0=new WeakMap,Cl=new WeakMap,i0=new WeakMap,F2=new WeakMap,D2=new WeakMap,Yf=new WeakMap,B_=new WeakSet,DL=function(e){if(Ga(this,F2,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Pa),e instanceof Pa)return Ga(this,D2,!0,"f"),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const t=new wt(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new wt(String(e)))};var ot=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ti=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},lr,$_,qo,Lb,Ya,Bd,wp,Ld,B2,ji,Tb,Ib,O0,a0,o0,wC,xC,_C,AC,SC,kC,NC;class mo extends Nk{constructor(){super(...arguments),lr.add(this),$_.set(this,[]),qo.set(this,{}),Lb.set(this,{}),Ya.set(this,void 0),Bd.set(this,void 0),wp.set(this,void 0),Ld.set(this,void 0),B2.set(this,void 0),ji.set(this,void 0),Tb.set(this,void 0),Ib.set(this,void 0),O0.set(this,void 0)}[($_=new WeakMap,qo=new WeakMap,Lb=new WeakMap,Ya=new WeakMap,Bd=new WeakMap,wp=new WeakMap,Ld=new WeakMap,B2=new WeakMap,ji=new WeakMap,Tb=new WeakMap,Ib=new WeakMap,O0=new WeakMap,lr=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new mo;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=ll.fromReadableStream(e,this.controller);for await(const a of r)ot(this,lr,"m",a0).call(this,a);if((i=r.controller.signal)!=null&&i.aborted)throw new Pa;return this._addRun(ot(this,lr,"m",o0).call(this))}toReadableStream(){return new ll(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,i){const a=new mo;return a._run(()=>a._runToolAssistantStream(e,t,n,r,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,t,n,r,i){var c;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.submitToolOutputs(t,n,o,{...i,signal:this.controller.signal});this._connected();for await(const u of l)ot(this,lr,"m",a0).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new Pa;return this._addRun(ot(this,lr,"m",o0).call(this))}static createThreadAssistantStream(e,t,n){const r=new mo;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){const i=new mo;return i._run(()=>i._runAssistantStream(e,t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return ot(this,Tb,"f")}currentRun(){return ot(this,Ib,"f")}currentMessageSnapshot(){return ot(this,Ya,"f")}currentRunStepSnapshot(){return ot(this,O0,"f")}async finalRunSteps(){return await this.done(),Object.values(ot(this,qo,"f"))}async finalMessages(){return await this.done(),Object.values(ot(this,Lb,"f"))}async finalRun(){if(await this.done(),!ot(this,Bd,"f"))throw Error("Final run was not received.");return ot(this,Bd,"f")}async _createThreadAssistantStream(e,t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const i={...t,stream:!0},a=await e.createAndRun(i,{...n,signal:this.controller.signal});this._connected();for await(const l of a)ot(this,lr,"m",a0).call(this,l);if((o=a.controller.signal)!=null&&o.aborted)throw new Pa;return this._addRun(ot(this,lr,"m",o0).call(this))}async _createAssistantStream(e,t,n,r){var l;const i=r==null?void 0:r.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...n,stream:!0},o=await e.create(t,a,{...r,signal:this.controller.signal});this._connected();for await(const c of o)ot(this,lr,"m",a0).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new Pa;return this._addRun(ot(this,lr,"m",o0).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let i=e[n];if(i==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof i=="string"&&typeof r=="string")i+=r;else if(typeof i=="number"&&typeof r=="number")i+=r;else if(ux(i)&&ux(r))i=this.accumulateDelta(i,r);else if(Array.isArray(i)&&Array.isArray(r)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...r);continue}for(const a of r){if(!ux(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const l=i[o];l==null?i.push(a):i[o]=this.accumulateDelta(l,a)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${i}`);e[n]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,i){return await this._createToolAssistantStream(n,e,t,r,i)}}a0=function(e){if(!this.ended)switch(Ti(this,Tb,e,"f"),ot(this,lr,"m",_C).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ot(this,lr,"m",NC).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ot(this,lr,"m",xC).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ot(this,lr,"m",wC).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},o0=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");if(!ot(this,Bd,"f"))throw Error("Final run has not been received");return ot(this,Bd,"f")},wC=function(e){const[t,n]=ot(this,lr,"m",SC).call(this,e,ot(this,Ya,"f"));Ti(this,Ya,t,"f"),ot(this,Lb,"f")[t.id]=t;for(const r of n){const i=t.content[r.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let i=r.text,a=t.content[r.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=ot(this,wp,"f")){if(ot(this,Ld,"f"))switch(ot(this,Ld,"f").type){case"text":this._emit("textDone",ot(this,Ld,"f").text,ot(this,Ya,"f"));break;case"image_file":this._emit("imageFileDone",ot(this,Ld,"f").image_file,ot(this,Ya,"f"));break}Ti(this,wp,r.index,"f")}Ti(this,Ld,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ot(this,wp,"f")!==void 0){const r=e.data.content[ot(this,wp,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,ot(this,Ya,"f"));break;case"text":this._emit("textDone",r.text,ot(this,Ya,"f"));break}}ot(this,Ya,"f")&&this._emit("messageDone",e.data),Ti(this,Ya,void 0,"f")}},xC=function(e){const t=ot(this,lr,"m",AC).call(this,e);switch(Ti(this,O0,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const i of n.step_details.tool_calls)i.index==ot(this,B2,"f")?this._emit("toolCallDelta",i,t.step_details.tool_calls[i.index]):(ot(this,ji,"f")&&this._emit("toolCallDone",ot(this,ji,"f")),Ti(this,B2,i.index,"f"),Ti(this,ji,t.step_details.tool_calls[i.index],"f"),ot(this,ji,"f")&&this._emit("toolCallCreated",ot(this,ji,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ti(this,O0,void 0,"f"),e.data.step_details.type=="tool_calls"&&ot(this,ji,"f")&&(this._emit("toolCallDone",ot(this,ji,"f")),Ti(this,ji,void 0,"f")),this._emit("runStepDone",e.data,t);break}},_C=function(e){ot(this,$_,"f").push(e),this._emit("event",e)},AC=function(e){switch(e.event){case"thread.run.step.created":return ot(this,qo,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=ot(this,qo,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=mo.accumulateDelta(t,n.delta);ot(this,qo,"f")[e.data.id]=r}return ot(this,qo,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ot(this,qo,"f")[e.data.id]=e.data;break}if(ot(this,qo,"f")[e.data.id])return ot(this,qo,"f")[e.data.id];throw new Error("No snapshot available")},SC=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const i of r.delta.content)if(i.index in t.content){let a=t.content[i.index];t.content[i.index]=ot(this,lr,"m",kC).call(this,i,a)}else t.content[i.index]=i,n.push(i);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},kC=function(e,t){return mo.accumulateDelta(t,e)},NC=function(e){switch(Ti(this,Ib,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Ti(this,Bd,e.data,"f"),ot(this,ji,"f")&&(this._emit("toolCallDone",ot(this,ji,"f")),Ti(this,ji,void 0,"f"));break}};class Ck extends xt{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/assistants",Ek,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ek extends Ms{}Ck.AssistantsPage=Ek;function CC(s){return typeof s.parse=="function"}const Tp=s=>(s==null?void 0:s.role)==="assistant",BL=s=>(s==null?void 0:s.role)==="function",$L=s=>(s==null?void 0:s.role)==="tool";function Pk(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function Wv(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function pM(s,e){return!e||!UL(e)?{...s,choices:s.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:Lk(s,e)}function Lk(s,e){const t=s.choices.map(n=>{var r;if(n.finish_reason==="length")throw new _L;if(n.finish_reason==="content_filter")throw new AL;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((r=n.message.tool_calls)==null?void 0:r.map(i=>gM(e,i)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?mM(e,n.message.content):null}}});return{...s,choices:t}}function mM(s,e){var t,n;return((t=s.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function gM(s,e){var n;const t=(n=s.tools)==null?void 0:n.find(r=>{var i;return((i=r.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Wv(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function vM(s,e){var n;if(!s)return!1;const t=(n=s.tools)==null?void 0:n.find(r=>{var i;return((i=r.function)==null?void 0:i.name)===e.function.name});return Wv(t)||(t==null?void 0:t.function.strict)||!1}function UL(s){var e;return Pk(s.response_format)?!0:((e=s.tools)==null?void 0:e.some(t=>Wv(t)||t.type==="function"&&t.function.strict===!0))??!1}function yM(s){for(const e of s??[]){if(e.type!=="function")throw new wt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new wt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var di=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ar,U_,$2,z_,q_,H_,zL,W_;const EC=10;class qL extends Nk{constructor(){super(...arguments),Ar.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(BL(e)||$L(e))&&e.content)this._emit("functionCallResult",e.content);else if(Tp(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Tp(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),di(this,Ar,"m",U_).call(this)}async finalMessage(){return await this.done(),di(this,Ar,"m",$2).call(this)}async finalFunctionCall(){return await this.done(),di(this,Ar,"m",z_).call(this)}async finalFunctionCallResult(){return await this.done(),di(this,Ar,"m",q_).call(this)}async totalUsage(){return await this.done(),di(this,Ar,"m",H_).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=di(this,Ar,"m",$2).call(this);t&&this._emit("finalMessage",t);const n=di(this,Ar,"m",U_).call(this);n&&this._emit("finalContent",n);const r=di(this,Ar,"m",z_).call(this);r&&this._emit("finalFunctionCall",r);const i=di(this,Ar,"m",q_).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",di(this,Ar,"m",H_).call(this))}async _createChatCompletion(e,t,n){const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),di(this,Ar,"m",zL).call(this,t);const i=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Lk(i,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var p;const r="function",{function_call:i="auto",stream:a,...o}=t,l=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:c=EC}=n||{},u={};for(const m of t.functions)u[m.name||m.function.name]=m;const f=t.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of t.messages)this._addMessage(m,!1);for(let m=0;m<c;++m){const y=(p=(await this._createChatCompletion(e,{...o,function_call:i,functions:f,messages:[...this.messages]},n)).choices[0])==null?void 0:p.message;if(!y)throw new wt("missing message in ChatCompletion response");if(!y.function_call)return;const{name:S,arguments:w}=y.function_call,_=u[S];if(_){if(l&&l!==S){const F=`Invalid function_call: ${JSON.stringify(S)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,name:S,content:F});continue}}else{const F=`Invalid function_call: ${JSON.stringify(S)}. Available options are: ${f.map(j=>JSON.stringify(j.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:S,content:F});continue}let k;try{k=CC(_)?await _.parse(w):w}catch(F){this._addMessage({role:r,name:S,content:F instanceof Error?F.message:String(F)});continue}const C=await _.function(k,this),B=di(this,Ar,"m",W_).call(this,C);if(this._addMessage({role:r,name:S,content:B}),l)return}}async _runTools(e,t,n){var m,b,y;const r="tool",{tool_choice:i="auto",stream:a,...o}=t,l=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:c=EC}=n||{},u=t.tools.map(S=>{if(Wv(S)){if(!S.$callback)throw new wt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:S.$callback,name:S.function.name,description:S.function.description||"",parameters:S.function.parameters,parse:S.$parseRaw,strict:!0}}}return S}),f={};for(const S of u)S.type==="function"&&(f[S.function.name||S.function.function.name]=S.function);const p="tools"in t?u.map(S=>S.type==="function"?{type:"function",function:{name:S.function.name||S.function.function.name,parameters:S.function.parameters,description:S.function.description,strict:S.function.strict}}:S):void 0;for(const S of t.messages)this._addMessage(S,!1);for(let S=0;S<c;++S){const _=(b=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:p,messages:[...this.messages]},n)).choices[0])==null?void 0:b.message;if(!_)throw new wt("missing message in ChatCompletion response");if(!((y=_.tool_calls)!=null&&y.length))return;for(const k of _.tool_calls){if(k.type!=="function")continue;const C=k.id,{name:B,arguments:F}=k.function,j=f[B];if(j){if(l&&l!==B){const I=`Invalid tool_call: ${JSON.stringify(B)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,tool_call_id:C,content:I});continue}}else{const I=`Invalid tool_call: ${JSON.stringify(B)}. Available options are: ${Object.keys(f).map(O=>JSON.stringify(O)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:C,content:I});continue}let T;try{T=CC(j)?await j.parse(F):F}catch(I){const O=I instanceof Error?I.message:String(I);this._addMessage({role:r,tool_call_id:C,content:O});continue}const W=await j.function(T,this),Y=di(this,Ar,"m",W_).call(this,W);if(this._addMessage({role:r,tool_call_id:C,content:Y}),l)return}}}}Ar=new WeakSet,U_=function(){return di(this,Ar,"m",$2).call(this).content??null},$2=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Tp(t)){const{function_call:n,...r}=t,i={...r,content:t.content??null,refusal:t.refusal??null};return n&&(i.function_call=n),i}}throw new wt("stream ended without producing a ChatCompletionMessage with role=assistant")},z_=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(Tp(r)&&(r!=null&&r.function_call))return r.function_call;if(Tp(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},q_=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(BL(t)&&t.content!=null||$L(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(i=>i.type==="function"&&i.id===t.tool_call_id))}))return t.content}},H_=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},zL=function(e){if(e.n!=null&&e.n>1)throw new wt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},W_=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class i1 extends qL{static runFunctions(e,t,n){const r=new i1,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,i)),r}static runTools(e,t,n){const r=new i1,i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,i)),r}_addMessage(e,t=!0){super._addMessage(e,t),Tp(e)&&e.content&&this._emit("content",e.content)}}const HL=1,WL=2,VL=4,GL=8,XL=16,KL=32,YL=64,JL=128,QL=256,ZL=JL|QL,eT=XL|KL|ZL|YL,tT=HL|WL|eT,nT=VL|GL,bM=tT|nT,zs={STR:HL,NUM:WL,ARR:VL,OBJ:GL,NULL:XL,BOOL:KL,NAN:YL,INFINITY:JL,MINUS_INFINITY:QL,INF:ZL,SPECIAL:eT,ATOM:tT,COLLECTION:nT,ALL:bM};class wM extends Error{}class xM extends Error{}function _M(s,e=zs.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return AM(s.trim(),e)}const AM=(s,e)=>{const t=s.length;let n=0;const r=p=>{throw new wM(`${p} at position ${n}`)},i=p=>{throw new xM(`${p} at position ${n}`)},a=()=>(f(),n>=t&&r("Unexpected end of input"),s[n]==='"'?o():s[n]==="{"?l():s[n]==="["?c():s.substring(n,n+4)==="null"||zs.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||zs.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||zs.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||zs.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||zs.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||zs.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):u()),o=()=>{const p=n;let m=!1;for(n++;n<t&&(s[n]!=='"'||m&&s[n-1]==="\\");)m=s[n]==="\\"?!m:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(p,++n-Number(m)))}catch(b){i(String(b))}else if(zs.STR&e)try{return JSON.parse(s.substring(p,n-Number(m))+'"')}catch{return JSON.parse(s.substring(p,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},l=()=>{n++,f();const p={};try{for(;s[n]!=="}";){if(f(),n>=t&&zs.OBJ&e)return p;const m=o();f(),n++;try{const b=a();Object.defineProperty(p,m,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(zs.OBJ&e)return p;throw b}f(),s[n]===","&&n++}}catch{if(zs.OBJ&e)return p;r("Expected '}' at end of object")}return n++,p},c=()=>{n++;const p=[];try{for(;s[n]!=="]";)p.push(a()),f(),s[n]===","&&n++}catch{if(zs.ARR&e)return p;r("Expected ']' at end of array")}return n++,p},u=()=>{if(n===0){s==="-"&&zs.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(m){if(zs.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch{}i(String(m))}}const p=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(zs.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(p,n))}catch{s.substring(p,n)==="-"&&zs.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(p,s.lastIndexOf("e")))}catch(b){i(String(b))}}},f=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return a()},PC=s=>_M(s,zs.ALL^zs.NUM);var Mf=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},gn=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ns,kl,Ff,zc,dx,Zy,hx,fx,px,eb,mx,LC;class a1 extends qL{constructor(e){super(),Ns.add(this),kl.set(this,void 0),Ff.set(this,void 0),zc.set(this,void 0),Mf(this,kl,e,"f"),Mf(this,Ff,[],"f")}get currentChatCompletionSnapshot(){return gn(this,zc,"f")}static fromReadableStream(e){const t=new a1(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new a1(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){var a;super._createChatCompletion;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),gn(this,Ns,"m",dx).call(this);const i=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of i)gn(this,Ns,"m",hx).call(this,o);if((a=i.controller.signal)!=null&&a.aborted)throw new Pa;return this._addChatCompletion(gn(this,Ns,"m",eb).call(this))}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),gn(this,Ns,"m",dx).call(this),this._connected();const r=ll.fromReadableStream(e,this.controller);let i;for await(const o of r)i&&i!==o.id&&this._addChatCompletion(gn(this,Ns,"m",eb).call(this)),gn(this,Ns,"m",hx).call(this,o),i=o.id;if((a=r.controller.signal)!=null&&a.aborted)throw new Pa;return this._addChatCompletion(gn(this,Ns,"m",eb).call(this))}[(kl=new WeakMap,Ff=new WeakMap,zc=new WeakMap,Ns=new WeakSet,dx=function(){this.ended||Mf(this,zc,void 0,"f")},Zy=function(t){let n=gn(this,Ff,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},gn(this,Ff,"f")[t.index]=n,n)},hx=function(t){var r,i,a,o,l,c,u,f,p,m,b,y,S,w,_;if(this.ended)return;const n=gn(this,Ns,"m",LC).call(this,t);this._emit("chunk",t,n);for(const k of t.choices){const C=n.choices[k.index];k.delta.content!=null&&((r=C.message)==null?void 0:r.role)==="assistant"&&((i=C.message)!=null&&i.content)&&(this._emit("content",k.delta.content,C.message.content),this._emit("content.delta",{delta:k.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),k.delta.refusal!=null&&((a=C.message)==null?void 0:a.role)==="assistant"&&((o=C.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:k.delta.refusal,snapshot:C.message.refusal}),((l=k.logprobs)==null?void 0:l.content)!=null&&((c=C.message)==null?void 0:c.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(u=k.logprobs)==null?void 0:u.content,snapshot:((f=C.logprobs)==null?void 0:f.content)??[]}),((p=k.logprobs)==null?void 0:p.refusal)!=null&&((m=C.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(b=k.logprobs)==null?void 0:b.refusal,snapshot:((y=C.logprobs)==null?void 0:y.refusal)??[]});const B=gn(this,Ns,"m",Zy).call(this,C);C.finish_reason&&(gn(this,Ns,"m",px).call(this,C),B.current_tool_call_index!=null&&gn(this,Ns,"m",fx).call(this,C,B.current_tool_call_index));for(const F of k.delta.tool_calls??[])B.current_tool_call_index!==F.index&&(gn(this,Ns,"m",px).call(this,C),B.current_tool_call_index!=null&&gn(this,Ns,"m",fx).call(this,C,B.current_tool_call_index)),B.current_tool_call_index=F.index;for(const F of k.delta.tool_calls??[]){const j=(S=C.message.tool_calls)==null?void 0:S[F.index];j!=null&&j.type&&((j==null?void 0:j.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(w=j.function)==null?void 0:w.name,index:F.index,arguments:j.function.arguments,parsed_arguments:j.function.parsed_arguments,arguments_delta:((_=F.function)==null?void 0:_.arguments)??""}):(j==null||j.type,void 0))}}},fx=function(t,n){var a,o,l;if(gn(this,Ns,"m",Zy).call(this,t).done_tool_calls.has(n))return;const i=(a=t.message.tool_calls)==null?void 0:a[n];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const c=(l=(o=gn(this,kl,"f"))==null?void 0:o.tools)==null?void 0:l.find(u=>u.type==="function"&&u.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:n,arguments:i.function.arguments,parsed_arguments:Wv(c)?c.$parseRaw(i.function.arguments):c!=null&&c.function.strict?JSON.parse(i.function.arguments):null})}else i.type},px=function(t){var r,i;const n=gn(this,Ns,"m",Zy).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const a=gn(this,Ns,"m",mx).call(this);this._emit("content.done",{content:t.message.content,parsed:a?a.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(i=t.logprobs)!=null&&i.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},eb=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const t=gn(this,zc,"f");if(!t)throw new wt("request ended without sending any chunks");return Mf(this,zc,void 0,"f"),Mf(this,Ff,[],"f"),SM(t,gn(this,kl,"f"))},mx=function(){var n;const t=(n=gn(this,kl,"f"))==null?void 0:n.response_format;return Pk(t)?t:null},LC=function(t){var n,r,i,a;let o=gn(this,zc,"f");const{choices:l,...c}=t;o?Object.assign(o,c):o=Mf(this,zc,{...c,choices:[]},"f");for(const{delta:u,finish_reason:f,index:p,logprobs:m=null,...b}of t.choices){let y=o.choices[p];if(y||(y=o.choices[p]={finish_reason:f,index:p,message:{},logprobs:m,...b}),m)if(!y.logprobs)y.logprobs=Object.assign({},m);else{const{content:F,refusal:j,...T}=m;Object.assign(y.logprobs,T),F&&((n=y.logprobs).content??(n.content=[]),y.logprobs.content.push(...F)),j&&((r=y.logprobs).refusal??(r.refusal=[]),y.logprobs.refusal.push(...j))}if(f&&(y.finish_reason=f,gn(this,kl,"f")&&UL(gn(this,kl,"f")))){if(f==="length")throw new _L;if(f==="content_filter")throw new AL}if(Object.assign(y,b),!u)continue;const{content:S,refusal:w,function_call:_,role:k,tool_calls:C,...B}=u;if(Object.assign(y.message,B),w&&(y.message.refusal=(y.message.refusal||"")+w),k&&(y.message.role=k),_&&(y.message.function_call?(_.name&&(y.message.function_call.name=_.name),_.arguments&&((i=y.message.function_call).arguments??(i.arguments=""),y.message.function_call.arguments+=_.arguments)):y.message.function_call=_),S&&(y.message.content=(y.message.content||"")+S,!y.message.refusal&&gn(this,Ns,"m",mx).call(this)&&(y.message.parsed=PC(y.message.content))),C){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:F,id:j,type:T,function:W,...Y}of C){const I=(a=y.message.tool_calls)[F]??(a[F]={});Object.assign(I,Y),j&&(I.id=j),T&&(I.type=T),W&&(I.function??(I.function={name:W.name??"",arguments:""})),W!=null&&W.name&&(I.function.name=W.name),W!=null&&W.arguments&&(I.function.arguments+=W.arguments,vM(gn(this,kl,"f"),I)&&(I.function.parsed_arguments=PC(I.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new ll(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function SM(s,e){const{id:t,choices:n,created:r,model:i,system_fingerprint:a,...o}=s,l={...o,id:t,choices:n.map(({message:c,finish_reason:u,index:f,logprobs:p,...m})=>{if(!u)throw new wt(`missing finish_reason for choice ${f}`);const{content:b=null,function_call:y,tool_calls:S,...w}=c,_=c.role;if(!_)throw new wt(`missing role for choice ${f}`);if(y){const{arguments:k,name:C}=y;if(k==null)throw new wt(`missing function_call.arguments for choice ${f}`);if(!C)throw new wt(`missing function_call.name for choice ${f}`);return{...m,message:{content:b,function_call:{arguments:k,name:C},role:_,refusal:c.refusal??null},finish_reason:u,index:f,logprobs:p}}return S?{...m,index:f,finish_reason:u,logprobs:p,message:{...w,role:_,content:b,refusal:c.refusal??null,tool_calls:S.map((k,C)=>{const{function:B,type:F,id:j,...T}=k,{arguments:W,name:Y,...I}=B||{};if(j==null)throw new wt(`missing choices[${f}].tool_calls[${C}].id
${tb(s)}`);if(F==null)throw new wt(`missing choices[${f}].tool_calls[${C}].type
${tb(s)}`);if(Y==null)throw new wt(`missing choices[${f}].tool_calls[${C}].function.name
${tb(s)}`);if(W==null)throw new wt(`missing choices[${f}].tool_calls[${C}].function.arguments
${tb(s)}`);return{...T,id:j,type:F,function:{...I,name:Y,arguments:W}}})}}:{...m,message:{...w,content:b,role:_,refusal:c.refusal??null},finish_reason:u,index:f,logprobs:p}}),created:r,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return pM(l,e)}function tb(s){return JSON.stringify(s)}class Ip extends a1{static fromReadableStream(e){const t=new Ip(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const r=new Ip(null),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,i)),r}static runTools(e,t,n){const r=new Ip(t),i={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,i)),r}}let sT=class extends xt{parse(e,t){return yM(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>Lk(n,e))}runFunctions(e,t){return e.stream?Ip.runFunctions(this._client,e,t):i1.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Ip.runTools(this._client,e,t):i1.runTools(this._client,e,t)}stream(e,t){return a1.createChatCompletion(this._client,e,t)}};class V_ extends xt{constructor(){super(...arguments),this.completions=new sT(this._client)}}(function(s){s.Completions=sT})(V_||(V_={}));class rT extends xt{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class iT extends xt{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Hw extends xt{constructor(){super(...arguments),this.sessions=new rT(this._client),this.transcriptionSessions=new iT(this._client)}}Hw.Sessions=rT;Hw.TranscriptionSessions=iT;class Tk extends xt{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,Ik,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Ik extends Ms{}Tk.MessagesPage=Ik;class jk extends xt{retrieve(e,t,n,r={},i){return Jn(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,t,n={},r){return Jn(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Rk,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Rk extends Ms{}jk.RunStepsPage=Rk;let Vv=class extends xt{constructor(){super(...arguments),this.steps=new jk(this._client)}create(e,t,n){const{include:r,...i}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:i,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,Ok,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return mo.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...r}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await qv(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,t,n){return mo.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const i=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,i.id,r)}submitToolOutputsStream(e,t,n,r){return mo.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}};class Ok extends Ms{}Vv.RunsPage=Ok;Vv.Steps=jk;Vv.RunStepsPage=Rk;class ng extends xt{constructor(){super(...arguments),this.runs=new Vv(this._client),this.messages=new Tk(this._client)}create(e={},t){return Jn(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return mo.createThreadAssistantStream(e,this._client.beta.threads,t)}}ng.Runs=Vv;ng.RunsPage=Ok;ng.Messages=Tk;ng.MessagesPage=Ik;class sg extends xt{constructor(){super(...arguments),this.realtime=new Hw(this._client),this.chat=new V_(this._client),this.assistants=new Ck(this._client),this.threads=new ng(this._client)}}sg.Realtime=Hw;sg.Assistants=Ck;sg.AssistantsPage=Ek;sg.Threads=ng;class aT extends xt{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class oT extends xt{retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}}let Ww=class extends xt{constructor(){super(...arguments),this.content=new oT(this._client)}create(e,t,n){return this._client.post(`/containers/${e}/files`,Zh({body:t,...n}))}retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}`,n)}list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,Mk,{query:t,...n})}del(e,t,n){return this._client.delete(`/containers/${e}/files/${t}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}};class Mk extends Ms{}Ww.FileListResponsesPage=Mk;Ww.Content=oT;class Gv extends xt{constructor(){super(...arguments),this.files=new Ww(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/containers",Fk,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class Fk extends Ms{}Gv.ContainerListResponsesPage=Fk;Gv.Files=Ww;Gv.FileListResponsesPage=Mk;class lT extends xt{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&qu("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?i:(qu("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(a=>(a&&a.data&&a.data.forEach(o=>{const l=o.embedding;o.embedding=hM(l)}),a)))}}class Dk extends xt{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return Jn(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,Bk,{query:n,...r})}}class Bk extends Ms{}Dk.OutputItemListResponsesPage=Bk;class Xv extends xt{constructor(){super(...arguments),this.outputItems=new Dk(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,$k,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class $k extends Ms{}Xv.RunListResponsesPage=$k;Xv.OutputItems=Dk;Xv.OutputItemListResponsesPage=Bk;class Kv extends xt{constructor(){super(...arguments),this.runs=new Xv(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/evals",Uk,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class Uk extends Ms{}Kv.EvalListResponsesPage=Uk;Kv.Runs=Xv;Kv.RunListResponsesPage=$k;let zk=class extends xt{create(e,t){return this._client.post("/files",Zh({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/files",qk,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const r=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!r.has(a.status);)if(await qv(t),a=await this.retrieve(e),Date.now()-i>n)throw new Ak({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return a}};class qk extends Ms{}zk.FileObjectsPage=qk;class cT extends xt{}let uT=class extends xt{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class Hk extends xt{constructor(){super(...arguments),this.graders=new uT(this._client)}}Hk.Graders=uT;class Wk extends xt{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,Vk,{body:t,method:"post",...n})}retrieve(e,t={},n){return Jn(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class Vk extends $w{}Wk.PermissionCreateResponsesPage=Vk;let Vw=class extends xt{constructor(){super(...arguments),this.permissions=new Wk(this._client)}};Vw.Permissions=Wk;Vw.PermissionCreateResponsesPage=Vk;class Gk extends xt{list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Xk,{query:t,...n})}}class Xk extends Ms{}Gk.FineTuningJobCheckpointsPage=Xk;class rg extends xt{constructor(){super(...arguments),this.checkpoints=new Gk(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Kk,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return Jn(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Yk,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class Kk extends Ms{}class Yk extends Ms{}rg.FineTuningJobsPage=Kk;rg.FineTuningJobEventsPage=Yk;rg.Checkpoints=Gk;rg.FineTuningJobCheckpointsPage=Xk;class nd extends xt{constructor(){super(...arguments),this.methods=new cT(this._client),this.jobs=new rg(this._client),this.checkpoints=new Vw(this._client),this.alpha=new Hk(this._client)}}nd.Methods=cT;nd.Jobs=rg;nd.FineTuningJobsPage=Kk;nd.FineTuningJobEventsPage=Yk;nd.Checkpoints=Vw;nd.Alpha=Hk;class dT extends xt{}class Jk extends xt{constructor(){super(...arguments),this.graderModels=new dT(this._client)}}Jk.GraderModels=dT;class hT extends xt{createVariation(e,t){return this._client.post("/images/variations",Zh({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",Zh({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Qk extends xt{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Zk,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Zk extends $w{}Qk.ModelsPage=Zk;class fT extends xt{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function kM(s,e){return!e||!CM(e)?{...s,output_parsed:null,output:s.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:pT(s,e)}function pT(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:LM(e,r)};if(r.type==="message"){const i=r.content.map(a=>a.type==="output_text"?{...a,parsed:NM(e,a.text)}:a);return{...r,content:i}}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||mT(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const i of r.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),n}function NM(s,e){var t,n,r,i;return((n=(t=s.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((r=s.text)==null?void 0:r.format)?((i=s.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function CM(s){var e;return!!Pk((e=s.text)==null?void 0:e.format)}function EM(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function PM(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function LM(s,e){const t=PM(s.tools??[],e.name);return{...e,...e,parsed_arguments:EM(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function mT(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}class gT extends xt{list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,IM,{query:t,...n})}}var Df=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},qc=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Bf,nb,Hc,sb,TC,IC,jC,RC;class e3 extends Nk{constructor(e){super(),Bf.add(this),nb.set(this,void 0),Hc.set(this,void 0),sb.set(this,void 0),Df(this,nb,e,"f")}static createResponse(e,t,n){const r=new e3(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),qc(this,Bf,"m",TC).call(this);let i,a=null;"response_id"in t?(i=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),a=t.starting_after??null):i=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const l of i)qc(this,Bf,"m",IC).call(this,l,a);if((o=i.controller.signal)!=null&&o.aborted)throw new Pa;return qc(this,Bf,"m",jC).call(this)}[(nb=new WeakMap,Hc=new WeakMap,sb=new WeakMap,Bf=new WeakSet,TC=function(){this.ended||Df(this,Hc,void 0,"f")},IC=function(t,n){if(this.ended)return;const r=(a,o)=>{(n==null||o.sequence_number>n)&&this._emit(a,o)},i=qc(this,Bf,"m",RC).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const a=i.output[t.output_index];if(!a)throw new wt(`missing output at index ${t.output_index}`);if(a.type==="message"){const o=a.content[t.content_index];if(!o)throw new wt(`missing content at index ${t.content_index}`);if(o.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${o.type}`);r("response.output_text.delta",{...t,snapshot:o.text})}break}case"response.function_call_arguments.delta":{const a=i.output[t.output_index];if(!a)throw new wt(`missing output at index ${t.output_index}`);a.type==="function_call"&&r("response.function_call_arguments.delta",{...t,snapshot:a.arguments});break}default:r(t.type,t);break}},jC=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const t=qc(this,Hc,"f");if(!t)throw new wt("request ended without sending any events");Df(this,Hc,void 0,"f");const n=TM(t,qc(this,nb,"f"));return Df(this,sb,n,"f"),n},RC=function(t){let n=qc(this,Hc,"f");if(!n){if(t.type!=="response.created")throw new wt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=Df(this,Hc,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const r=n.output[t.output_index];if(!r)throw new wt(`missing output at index ${t.output_index}`);r.type==="message"&&r.content.push(t.part);break}case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new wt(`missing output at index ${t.output_index}`);if(r.type==="message"){const i=r.content[t.content_index];if(!i)throw new wt(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new wt(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.completed":{Df(this,Hc,t.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const i=t.shift();i?i.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const i of t)i.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((i,a)=>t.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=qc(this,sb,"f");if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}}function TM(s,e){return kM(s,e)}class t3 extends xt{constructor(){super(...arguments),this.inputItems=new gT(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&mT(n),n))}retrieve(e,t={},n){return this._client.get(`/responses/${e}`,{query:t,...n,stream:(t==null?void 0:t.stream)??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>pT(n,e))}stream(e,t){return e3.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class IM extends Ms{}t3.InputItems=gT;class vT extends xt{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,Zh({body:t,...n}))}}class n3 extends xt{constructor(){super(...arguments),this.parts=new vT(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}n3.Parts=vT;const jM=async s=>{const e=await Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n};class Gw extends xt{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return Jn(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,Xw,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const i=await this.retrieve(e,t,{...n,headers:r}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=i.response.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await qv(o);break;case"failed":case"completed":return a}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,s3,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class Xw extends Ms{}class s3 extends $w{}Gw.VectorStoreFilesPage=Xw;Gw.FileContentResponsesPage=s3;class yT extends xt{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return Jn(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,Xw,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const l=a.headers.get("openai-poll-after-ms");if(l){const c=parseInt(l);isNaN(c)||(o=c)}}await qv(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(r==null?void 0:r.maxConcurrency)??5,a=Math.min(i,t.length),o=this._client,l=t.values(),c=[...n];async function u(p){for(let m of p){const b=await o.files.create({file:m,purpose:"assistants"},r);c.push(b.id)}}const f=Array(a).fill(l).map(u);return await jM(f),await this.createAndPoll(e,{file_ids:c})}}class sd extends xt{constructor(){super(...arguments),this.files=new Gw(this._client),this.fileBatches=new yT(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return Jn(e)?this.list({},e):this._client.getAPIList("/vector_stores",r3,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,i3,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class r3 extends Ms{}class i3 extends $w{}sd.VectorStoresPage=r3;sd.VectorStoreSearchResponsesPage=i3;sd.Files=Gw;sd.VectorStoreFilesPage=Xw;sd.FileContentResponsesPage=s3;sd.FileBatches=yT;var bT;class Pt extends eM{constructor({baseURL:e=Jy("OPENAI_BASE_URL"),apiKey:t=Jy("OPENAI_API_KEY"),organization:n=Jy("OPENAI_ORG_ID")??null,project:r=Jy("OPENAI_PROJECT_ID")??null,...i}={}){if(t===void 0)throw new wt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:t,organization:n,project:r,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&uM())throw new wt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new aT(this),this.chat=new qw(this),this.embeddings=new lT(this),this.files=new zk(this),this.images=new hT(this),this.audio=new Hv(this),this.moderations=new fT(this),this.models=new Qk(this),this.fineTuning=new nd(this),this.graders=new Jk(this),this.vectorStores=new sd(this),this.beta=new sg(this),this.batches=new Sk(this),this.uploads=new n3(this),this.responses=new t3(this),this.evals=new Kv(this),this.containers=new Gv(this),this._options=a,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return MO(e,{arrayFormat:"brackets"})}}bT=Pt;Pt.OpenAI=bT;Pt.DEFAULT_TIMEOUT=6e5;Pt.OpenAIError=wt;Pt.APIError=hr;Pt.APIConnectionError=Mw;Pt.APIConnectionTimeoutError=Ak;Pt.APIUserAbortError=Pa;Pt.NotFoundError=vL;Pt.ConflictError=yL;Pt.RateLimitError=wL;Pt.BadRequestError=pL;Pt.AuthenticationError=mL;Pt.InternalServerError=xL;Pt.PermissionDeniedError=gL;Pt.UnprocessableEntityError=bL;Pt.toFile=CL;Pt.fileFromPath=dL;Pt.Completions=aT;Pt.Chat=qw;Pt.ChatCompletionsPage=zw;Pt.Embeddings=lT;Pt.Files=zk;Pt.FileObjectsPage=qk;Pt.Images=hT;Pt.Audio=Hv;Pt.Moderations=fT;Pt.Models=Qk;Pt.ModelsPage=Zk;Pt.FineTuning=nd;Pt.Graders=Jk;Pt.VectorStores=sd;Pt.VectorStoresPage=r3;Pt.VectorStoreSearchResponsesPage=i3;Pt.Beta=sg;Pt.Batches=Sk;Pt.BatchesPage=kk;Pt.Uploads=n3;Pt.Responses=t3;Pt.Evals=Kv;Pt.EvalListResponsesPage=Uk;Pt.Containers=Gv;Pt.ContainerListResponsesPage=Fk;const RM=new Pt({apiKey:"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",dangerouslyAllowBrowser:!0,timeout:9e4});var M0={};M0.d=(s,e)=>{for(var t in e)M0.o(e,t)&&!M0.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:e[t]})};M0.o=(s,e)=>Object.prototype.hasOwnProperty.call(s,e);var At=globalThis.pdfjsLib={};M0.d(At,{AbortException:()=>Gu,AnnotationEditorLayer:()=>tS,AnnotationEditorParamsType:()=>Gt,AnnotationEditorType:()=>Rt,AnnotationEditorUIManager:()=>tf,AnnotationLayer:()=>PD,AnnotationMode:()=>eu,ColorPicker:()=>V2,DOMSVGFactory:()=>p3,DrawLayer:()=>rS,FeatureTest:()=>Xr,GlobalWorkerOptions:()=>oc,ImageKind:()=>jb,InvalidPDFException:()=>X_,MissingPDFException:()=>o1,OPS:()=>Ja,OutputScale:()=>Y_,PDFDataRangeTransport:()=>x6,PDFDateString:()=>u3,PDFWorker:()=>Rp,PasswordResponses:()=>DM,PermissionFlag:()=>FM,PixelsPerInch:()=>Xu,RenderingCancelledException:()=>l3,TextLayer:()=>l1,TouchManager:()=>H2,UnexpectedResponseException:()=>U2,Util:()=>it,VerbosityLevel:()=>Kw,XfaLayer:()=>A6,build:()=>cD,createValidAbsoluteUrl:()=>zM,fetchData:()=>Zw,getDocument:()=>eD,getFilenameFromUrl:()=>JM,getPdfFilenameFromUrl:()=>QM,getXfaPageViewport:()=>ZM,isDataScheme:()=>e5,isPdfFile:()=>c3,noContextMenu:()=>wo,normalizeUnicode:()=>XM,setLayerDimensions:()=>ef,shadow:()=>zt,stopEvent:()=>Yi,version:()=>lD});const Tr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),wT=[1,0,0,1,0,0],G_=[.001,0,0,.001,0,0],OM=1e7,gx=1.35,Gi={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},eu={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},MM="pdfjs_internal_editor_",Rt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Gt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},FM={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},jb={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Cs={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Wg={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Kw={ERRORS:0,WARNINGS:1,INFOS:5},Ja={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},DM={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Yw=Kw.WARNINGS;function BM(s){Number.isInteger(s)&&(Yw=s)}function $M(){return Yw}function Jw(s){Yw>=Kw.INFOS&&console.log(`Info: ${s}`)}function Ot(s){Yw>=Kw.WARNINGS&&console.log(`Warning: ${s}`)}function An(s){throw new Error(s)}function _s(s,e){s||An(e)}function UM(s){switch(s==null?void 0:s.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function zM(s,e=null,t=null){if(!s)return null;try{if(t&&typeof s=="string"){if(t.addDefaultProtocol&&s.startsWith("www.")){const r=s.match(/\./g);(r==null?void 0:r.length)>=2&&(s=`http://${s}`)}if(t.tryConvertEncoding)try{s=GM(s)}catch{}}const n=e?new URL(s,e):new URL(s);if(UM(n))return n}catch{}return null}function zt(s,e,t,n=!1){return Object.defineProperty(s,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const rd=function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();class OC extends rd{constructor(e,t){super(e,"PasswordException"),this.code=t}}class vx extends rd{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class X_ extends rd{constructor(e){super(e,"InvalidPDFException")}}class o1 extends rd{constructor(e){super(e,"MissingPDFException")}}class U2 extends rd{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class qM extends rd{constructor(e){super(e,"FormatError")}}class Gu extends rd{constructor(e){super(e,"AbortException")}}function xT(s){(typeof s!="object"||(s==null?void 0:s.length)===void 0)&&An("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const n=[];for(let r=0;r<e;r+=t){const i=Math.min(r+t,e),a=s.subarray(r,i);n.push(String.fromCharCode.apply(null,a))}return n.join("")}function Qw(s){typeof s!="string"&&An("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=s.charCodeAt(n)&255;return t}function HM(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function a3(s){const e=Object.create(null);for(const[t,n]of s)e[t]=n;return e}function WM(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function VM(){try{return new Function(""),!0}catch{return!1}}class Xr{static get isLittleEndian(){return zt(this,"isLittleEndian",WM())}static get isEvalSupported(){return zt(this,"isEvalSupported",VM())}static get isOffscreenCanvasSupported(){return zt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return zt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?zt(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):zt(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return zt(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const yx=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));var dc,Rb,K_;class it{static makeHexColor(e,t,n){return`#${yx[e]}${yx[t]}${yx[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const n=e[0]*t[0]+e[1]*t[2]+t[4],r=e[0]*t[1]+e[1]*t[3]+t[5];return[n,r]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2],r=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,i=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n;return[r,i]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),r=this.applyTransform(e.slice(2,4),t),i=this.applyTransform([e[0],e[3]],t),a=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],r[0],i[0],a[0]),Math.min(n[1],r[1],i[1],a[1]),Math.max(n[0],r[0],i[0],a[0]),Math.max(n[1],r[1],i[1],a[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],a=e[2]*t[1]+e[3]*t[3],o=(n+a)/2,l=Math.sqrt((n+a)**2-4*(n*a-i*r))/2,c=o+l||1,u=o-l||1;return[Math.sqrt(c),Math.sqrt(u)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[n,i,r,a]}static bezierBoundingBox(e,t,n,r,i,a,o,l,c){return c?(c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,l),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,l)):c=[Math.min(e,o),Math.min(t,l),Math.max(e,o),Math.max(t,l)],z(this,dc,K_).call(this,e,n,i,o,t,r,a,l,3*(-e+3*(n-i)+o),6*(e-2*n+i),3*(n-e),c),z(this,dc,K_).call(this,e,n,i,o,t,r,a,l,3*(-t+3*(r-a)+l),6*(t-2*r+a),3*(r-t),c),c}}dc=new WeakSet,Rb=function(e,t,n,r,i,a,o,l,c,u){if(c<=0||c>=1)return;const f=1-c,p=c*c,m=p*c,b=f*(f*(f*e+3*c*t)+3*p*n)+m*r,y=f*(f*(f*i+3*c*a)+3*p*o)+m*l;u[0]=Math.min(u[0],b),u[1]=Math.min(u[1],y),u[2]=Math.max(u[2],b),u[3]=Math.max(u[3],y)},K_=function(e,t,n,r,i,a,o,l,c,u,f,p){if(Math.abs(c)<1e-12){Math.abs(u)>=1e-12&&z(this,dc,Rb).call(this,e,t,n,r,i,a,o,l,-f/u,p);return}const m=u**2-4*f*c;if(m<0)return;const b=Math.sqrt(m),y=2*c;z(this,dc,Rb).call(this,e,t,n,r,i,a,o,l,(-u+b)/y,p),z(this,dc,Rb).call(this,e,t,n,r,i,a,o,l,(-u-b)/y,p)},$(it,dc);function GM(s){return decodeURIComponent(escape(s))}let bx=null,MC=null;function XM(s){return bx||(bx=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,MC=new Map([["ﬅ","ſt"]])),s.replaceAll(bx,(e,t,n)=>t?t.normalize("NFKC"):MC.get(n))}function KM(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),xT(s)}const o3="pdfjs_internal_id_";function YM(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(xT(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...e){return new Promise(t=>{t(s(...e))})});const El="http://www.w3.org/2000/svg",Rd=class Rd{};gt(Rd,"CSS",96),gt(Rd,"PDF",72),gt(Rd,"PDF_TO_CSS_UNITS",Rd.CSS/Rd.PDF);let Xu=Rd;async function Zw(s,e="text"){if(l0(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const r=new XMLHttpRequest;r.open("GET",s,!0),r.responseType=e,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(r.response);return}t(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class Yv{constructor({viewBox:e,userUnit:t,scale:n,rotation:r,offsetX:i=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=r,this.offsetX=i,this.offsetY=a,n*=t;const l=(e[2]+e[0])/2,c=(e[3]+e[1])/2;let u,f,p,m;switch(r%=360,r<0&&(r+=360),r){case 180:u=-1,f=0,p=0,m=1;break;case 90:u=0,f=1,p=1,m=0;break;case 270:u=0,f=-1,p=-1,m=0;break;case 0:u=1,f=0,p=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,m=-m);let b,y,S,w;u===0?(b=Math.abs(c-e[1])*n+i,y=Math.abs(l-e[0])*n+a,S=(e[3]-e[1])*n,w=(e[2]-e[0])*n):(b=Math.abs(l-e[0])*n+i,y=Math.abs(c-e[1])*n+a,S=(e[2]-e[0])*n,w=(e[3]-e[1])*n),this.transform=[u*n,f*n,p*n,m*n,b-u*n*l-p*n*c,y-f*n*l-m*n*c],this.width=S,this.height=w}get rawDims(){const{userUnit:e,viewBox:t}=this,n=t.map(r=>r*e);return zt(this,"rawDims",{pageWidth:n[2]-n[0],pageHeight:n[3]-n[1],pageX:n[0],pageY:n[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:i=!1}={}){return new Yv({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}convertToViewportPoint(e,t){return it.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=it.applyTransform([e[0],e[1]],this.transform),n=it.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return it.applyInverseTransform([e,t],this.transform)}}class l3 extends rd{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function e5(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function c3(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function JM(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function QM(s,e="document.pdf"){if(typeof s!="string")return e;if(e5(s))return Ot('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=t.exec(s);let i=n.exec(r[1])||n.exec(r[2])||n.exec(r[3]);if(i&&(i=i[0],i.includes("%")))try{i=n.exec(decodeURIComponent(i))[0]}catch{}return i||e}class FC{constructor(){gt(this,"started",Object.create(null));gt(this,"times",[])}time(e){e in this.started&&Ot(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ot(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:r,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-r}ms
`);return e.join("")}}function l0(s,e){try{const{protocol:t}=e?new URL(s,e):new URL(s);return t==="http:"||t==="https:"}catch{return!1}}function wo(s){s.preventDefault()}function Yi(s){s.preventDefault(),s.stopPropagation()}var f1;class u3{static toDateObject(e){if(!e||typeof e!="string")return null;d(this,f1)||E(this,f1,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=d(this,f1).exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,c==="-"?(a+=u,o+=f):c==="+"&&(a-=u,o-=f),new Date(Date.UTC(n,r,i,a,o,l))}}f1=new WeakMap,$(u3,f1);function ZM(s,{scale:e=1,rotation:t=0}){const{width:n,height:r}=s.attributes.style,i=[0,0,parseInt(n),parseInt(r)];return new Yv({viewBox:i,userUnit:1,scale:e,rotation:t})}function d3(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ot(`Not a valid color format: "${s}"`),[0,0,0])}function eF(s){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of s.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;s.set(t,d3(n))}e.remove()}function Fn(s){const{a:e,b:t,c:n,d:r,e:i,f:a}=s.getTransform();return[e,t,n,r,i,a]}function Oo(s){const{a:e,b:t,c:n,d:r,e:i,f:a}=s.getTransform().invertSelf();return[e,t,n,r,i,a]}function ef(s,e,t=!1,n=!0){if(e instanceof Yv){const{pageWidth:r,pageHeight:i}=e.rawDims,{style:a}=s,o=Xr.isCSSRoundSupported,l=`var(--scale-factor) * ${r}px`,c=`var(--scale-factor) * ${i}px`,u=o?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,f=o?`round(down, ${c}, var(--scale-round-y, 1px))`:`calc(${c})`;!t||e.rotation%180===0?(a.width=u,a.height=f):(a.width=f,a.height=u)}n&&s.setAttribute("data-main-rotation",e.rotation)}class Y_{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var nu,Ud,Za,zd,p1,m1,tw,_T,Kr,AT,ST,Ob,kT,Q_;const jl=class jl{constructor(e){$(this,Kr);$(this,nu,null);$(this,Ud,null);$(this,Za);$(this,zd,null);$(this,p1,null);E(this,Za,e),d(jl,m1)||E(jl,m1,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=E(this,nu,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=d(this,Za)._uiManager._signal;e.addEventListener("contextmenu",wo,{signal:t}),e.addEventListener("pointerdown",z(jl,tw,_T),{signal:t});const n=E(this,zd,document.createElement("div"));n.className="buttons",e.append(n);const r=d(this,Za).toolbarPosition;if(r){const{style:i}=e,a=d(this,Za)._uiManager.direction==="ltr"?1-r[0]:r[0];i.insetInlineEnd=`${100*a}%`,i.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return z(this,Kr,kT).call(this),e}get div(){return d(this,nu)}hide(){var e;d(this,nu).classList.add("hidden"),(e=d(this,Ud))==null||e.hideDropdown()}show(){var e;d(this,nu).classList.remove("hidden"),(e=d(this,p1))==null||e.shown()}async addAltText(e){const t=await e.render();z(this,Kr,Ob).call(this,t),d(this,zd).prepend(t,d(this,Kr,Q_)),E(this,p1,e)}addColorPicker(e){E(this,Ud,e);const t=e.renderButton();z(this,Kr,Ob).call(this,t),d(this,zd).prepend(t,d(this,Kr,Q_))}remove(){var e;d(this,nu).remove(),(e=d(this,Ud))==null||e.destroy(),E(this,Ud,null)}};nu=new WeakMap,Ud=new WeakMap,Za=new WeakMap,zd=new WeakMap,p1=new WeakMap,m1=new WeakMap,tw=new WeakSet,_T=function(e){e.stopPropagation()},Kr=new WeakSet,AT=function(e){d(this,Za)._focusEventsAllowed=!1,Yi(e)},ST=function(e){d(this,Za)._focusEventsAllowed=!0,Yi(e)},Ob=function(e){const t=d(this,Za)._uiManager._signal;e.addEventListener("focusin",z(this,Kr,AT).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",z(this,Kr,ST).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",wo,{signal:t})},kT=function(){const{editorType:e,_uiManager:t}=d(this,Za),n=document.createElement("button");n.className="delete",n.tabIndex=0,n.setAttribute("data-l10n-id",d(jl,m1)[e]),z(this,Kr,Ob).call(this,n),n.addEventListener("click",r=>{t.delete()},{signal:t._signal}),d(this,zd).append(n)},Q_=function(){const e=document.createElement("div");return e.className="divider",e},$(jl,tw),$(jl,m1,null);let J_=jl;var g1,qd,Hd,Qu,NT,CT,ET;class tF{constructor(e){$(this,Qu);$(this,g1,null);$(this,qd,null);$(this,Hd);E(this,Hd,e)}show(e,t,n){const[r,i]=z(this,Qu,CT).call(this,t,n),{style:a}=d(this,qd)||E(this,qd,z(this,Qu,NT).call(this));e.append(d(this,qd)),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){d(this,qd).remove()}}g1=new WeakMap,qd=new WeakMap,Hd=new WeakMap,Qu=new WeakSet,NT=function(){const e=E(this,qd,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",wo,{signal:d(this,Hd)._signal});const t=E(this,g1,document.createElement("div"));return t.className="buttons",e.append(t),z(this,Qu,ET).call(this),e},CT=function(e,t){let n=0,r=0;for(const i of e){const a=i.y+i.height;if(a<n)continue;const o=i.x+(t?i.width:0);if(a>n){r=o,n=a;continue}t?o>r&&(r=o):o<r&&(r=o)}return[t?1-r:r,n]},ET=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const n=d(this,Hd)._signal;e.addEventListener("contextmenu",wo,{signal:n}),e.addEventListener("click",()=>{d(this,Hd).highlightSelection("floating_button")},{signal:n}),d(this,g1).append(e)};function z2(s,e,t){for(const n of t)e.addEventListener(n,s[n].bind(s))}var nw;class nF{constructor(){$(this,nw,0)}get id(){return`${MM}${$r(this,nw)._++}`}}nw=new WeakMap;var $p,v1,kr,Up,Mb;const A3=class A3{constructor(){$(this,Up);$(this,$p,KM());$(this,v1,0);$(this,kr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=e;const i=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return zt(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:n,size:r,type:i}=e;return z(this,Up,Mb).call(this,`${t}_${n}_${r}_${i}`,e)}async getFromUrl(e){return z(this,Up,Mb).call(this,e,e)}async getFromBlob(e,t){const n=await t;return z(this,Up,Mb).call(this,e,n)}async getFromId(e){d(this,kr)||E(this,kr,new Map);const t=d(this,kr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){d(this,kr)||E(this,kr,new Map);let n=d(this,kr).get(e);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(t.width,t.height);return r.getContext("2d").drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${d(this,$p)}_${$r(this,v1)._++}`,refCounter:1,isSvg:!1},d(this,kr).set(e,n),d(this,kr).set(n.id,n),n}getSvgUrl(e){const t=d(this,kr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var r;d(this,kr)||E(this,kr,new Map);const t=d(this,kr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}(r=n.close)==null||r.call(n),t.bitmap=null}isValidId(e){return e.startsWith(`image_${d(this,$p)}_`)}};$p=new WeakMap,v1=new WeakMap,kr=new WeakMap,Up=new WeakSet,Mb=async function(e,t){d(this,kr)||E(this,kr,new Map);let n=d(this,kr).get(e);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${d(this,$p)}_${$r(this,v1)._++}`,refCounter:0,isSvg:!1});let r;if(typeof t=="string"?(n.url=t,r=await Zw(t,"blob")):t instanceof File?r=n.file=t:t instanceof Blob&&(r=t),r.type==="image/svg+xml"){const i=A3._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((c,u)=>{o.onload=()=>{n.bitmap=o,n.isSvg=!0,c()},a.onload=async()=>{const f=n.svgUrl=a.result;o.src=await i?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=u});a.readAsDataURL(r),await l}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){Ot(r),n=null}return d(this,kr).set(e,n),n&&d(this,kr).set(n.id,n),n};let Z_=A3;var os,su,y1,Wn;class sF{constructor(e=128){$(this,os,[]);$(this,su,!1);$(this,y1);$(this,Wn,-1);E(this,y1,e)}add({cmd:e,undo:t,post:n,mustExec:r,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),d(this,su))return;const l={cmd:e,undo:t,post:n,type:i};if(d(this,Wn)===-1){d(this,os).length>0&&(d(this,os).length=0),E(this,Wn,0),d(this,os).push(l);return}if(a&&d(this,os)[d(this,Wn)].type===i){o&&(l.undo=d(this,os)[d(this,Wn)].undo),d(this,os)[d(this,Wn)]=l;return}const c=d(this,Wn)+1;c===d(this,y1)?d(this,os).splice(0,1):(E(this,Wn,c),c<d(this,os).length&&d(this,os).splice(c)),d(this,os).push(l)}undo(){if(d(this,Wn)===-1)return;E(this,su,!0);const{undo:e,post:t}=d(this,os)[d(this,Wn)];e(),t==null||t(),E(this,su,!1),E(this,Wn,d(this,Wn)-1)}redo(){if(d(this,Wn)<d(this,os).length-1){E(this,Wn,d(this,Wn)+1),E(this,su,!0);const{cmd:e,post:t}=d(this,os)[d(this,Wn)];e(),t==null||t(),E(this,su,!1)}}hasSomethingToUndo(){return d(this,Wn)!==-1}hasSomethingToRedo(){return d(this,Wn)<d(this,os).length-1}cleanType(e){if(d(this,Wn)!==-1){for(let t=d(this,Wn);t>=0;t--)if(d(this,os)[t].type!==e){d(this,os).splice(t+1,d(this,Wn)-t),E(this,Wn,t);return}d(this,os).length=0,E(this,Wn,-1)}}destroy(){E(this,os,null)}}os=new WeakMap,su=new WeakMap,y1=new WeakMap,Wn=new WeakMap;var sw,PT;class Jv{constructor(e){$(this,sw);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Xr.platform;for(const[n,r,i={}]of e)for(const a of n){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:r,options:i}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:r,options:i}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(z(this,sw,PT).call(this,t));if(!n)return;const{callback:r,options:{bubbles:i=!1,args:a=[],checker:o=null}}=n;o&&!o(e,t)||(r.bind(e,...a,t)(),i||Yi(t))}}sw=new WeakSet,PT=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const rw=class rw{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return eF(e),zt(this,"_colors",e)}convert(e){const t=d3(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,r]of this._colors)if(r.every((i,a)=>i===t[a]))return rw._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?it.makeHexColor(...t):e}};gt(rw,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let eA=rw;var zp,Oi,Ts,nr,qp,Ml,Hp,va,ru,Wd,Wp,Vd,Ho,eo,Gd,b1,w1,Vp,x1,Wo,iu,Gp,au,Vo,iw,ou,_1,lu,Xd,A1,S1,qs,dn,Fl,Kd,k1,N1,cu,Go,Dl,C1,ya,We,Fb,tA,LT,TT,Db,IT,jT,RT,nA,OT,sA,rA,MT,Ur,Pl,FT,DT,iA,BT,c0,aA;const _p=class _p{constructor(e,t,n,r,i,a,o,l,c,u,f,p,m){$(this,We);$(this,zp,new AbortController);$(this,Oi,null);$(this,Ts,new Map);$(this,nr,new Map);$(this,qp,null);$(this,Ml,null);$(this,Hp,null);$(this,va,new sF);$(this,ru,null);$(this,Wd,null);$(this,Wp,0);$(this,Vd,new Set);$(this,Ho,null);$(this,eo,null);$(this,Gd,new Set);gt(this,"_editorUndoBar",null);$(this,b1,!1);$(this,w1,!1);$(this,Vp,!1);$(this,x1,null);$(this,Wo,null);$(this,iu,null);$(this,Gp,null);$(this,au,!1);$(this,Vo,null);$(this,iw,new nF);$(this,ou,!1);$(this,_1,!1);$(this,lu,null);$(this,Xd,null);$(this,A1,null);$(this,S1,null);$(this,qs,Rt.NONE);$(this,dn,new Set);$(this,Fl,null);$(this,Kd,null);$(this,k1,null);$(this,N1,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});$(this,cu,[0,0]);$(this,Go,null);$(this,Dl,null);$(this,C1,null);$(this,ya,null);const b=this._signal=d(this,zp).signal;E(this,Dl,e),E(this,C1,t),E(this,qp,n),this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:b}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),r._on("setpreference",this.onSetPreference.bind(this),{signal:b}),r._on("switchannotationeditorparams",y=>this.updateParams(y.type,y.value),{signal:b}),z(this,We,IT).call(this),z(this,We,MT).call(this),z(this,We,nA).call(this),E(this,Ml,i.annotationStorage),E(this,x1,i.filterFactory),E(this,Kd,a),E(this,Gp,o||null),E(this,b1,l),E(this,w1,c),E(this,Vp,u),E(this,S1,f||null),this.viewParameters={realScale:Xu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=p||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=_p.prototype,t=a=>d(a,Dl).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),n=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},r=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return zt(this,"_keyboardManager",new Jv([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&d(a,Dl).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&d(a,Dl).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,n,r,i;(e=d(this,ya))==null||e.resolve(),E(this,ya,null),(t=d(this,zp))==null||t.abort(),E(this,zp,null),this._signal=null;for(const a of d(this,nr).values())a.destroy();d(this,nr).clear(),d(this,Ts).clear(),d(this,Gd).clear(),E(this,Oi,null),d(this,dn).clear(),d(this,va).destroy(),(n=d(this,qp))==null||n.destroy(),(r=d(this,Vo))==null||r.hide(),E(this,Vo,null),d(this,Wo)&&(clearTimeout(d(this,Wo)),E(this,Wo,null)),d(this,Go)&&(clearTimeout(d(this,Go)),E(this,Go,null)),(i=this._editorUndoBar)==null||i.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return d(this,S1)}get useNewAltTextFlow(){return d(this,w1)}get useNewAltTextWhenAddingImage(){return d(this,Vp)}get hcmFilter(){return zt(this,"hcmFilter",d(this,Kd)?d(this,x1).addHCMFilter(d(this,Kd).foreground,d(this,Kd).background):"none")}get direction(){return zt(this,"direction",getComputedStyle(d(this,Dl)).direction)}get highlightColors(){return zt(this,"highlightColors",d(this,Gp)?new Map(d(this,Gp).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return zt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),E(this,Wd,e)}setMainHighlightColorPicker(e){E(this,A1,e)}editAltText(e,t=!1){var n;(n=d(this,qp))==null||n.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":E(this,Vp,t);break}}onPageChanging({pageNumber:e}){E(this,Wp,e-1)}focusMainContainer(){d(this,Dl).focus()}findParent(e,t){for(const n of d(this,nr).values()){const{x:r,y:i,width:a,height:o}=n.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=i&&t<=i+o)return n}return null}disableUserSelect(e=!1){d(this,C1).classList.toggle("noUserSelect",e)}addShouldRescale(e){d(this,Gd).add(e)}removeShouldRescale(e){d(this,Gd).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Xu.PDF_TO_CSS_UNITS;for(const n of d(this,Gd))n.onScaleChanging();(t=d(this,Wd))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:a}=t,o=t.toString(),c=z(this,We,Fb).call(this,t).closest(".textLayer"),u=this.getSelectionBoxes(c);if(!u)return;t.empty();const f=z(this,We,tA).call(this,c),p=d(this,qs)===Rt.NONE,m=()=>{f==null||f.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:u,anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:a,text:o}),p&&this.showAllEditors("highlight",!0,!0)};if(p){this.switchToMode(Rt.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&d(this,Ml)&&!d(this,Ml).has(e.id)&&d(this,Ml).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,d(this,au)&&(E(this,au,!1),z(this,We,Db).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of d(this,dn))if(t.div.contains(e)){E(this,Xd,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!d(this,Xd))return;const[e,t]=d(this,Xd);E(this,Xd,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){z(this,We,nA).call(this),z(this,We,sA).call(this)}removeEditListeners(){z(this,We,OT).call(this),z(this,We,rA).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of d(this,eo))if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of d(this,eo))if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var n;if(e.preventDefault(),(n=d(this,Oi))==null||n.commitOrRemove(),!this.hasSelection)return;const t=[];for(const r of d(this,dn)){const i=r.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const a of d(this,eo))if(a.isHandlingMimeForPasting(i.type)){a.paste(i,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(i){Ot(`paste: "${i.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const i=[];for(const l of n){const c=await r.deserialize(l);if(!c)return;i.push(c)}const a=()=>{for(const l of i)z(this,We,iA).call(this,l);z(this,We,aA).call(this,i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(i){Ot(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),d(this,qs)!==Rt.NONE&&!this.isEditorHandlingKeyboard&&_p._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,d(this,au)&&(E(this,au,!1),z(this,We,Db).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(z(this,We,jT).call(this),z(this,We,sA).call(this),z(this,We,Ur).call(this,{isEditing:d(this,qs)!==Rt.NONE,isEmpty:z(this,We,c0).call(this),hasSomethingToUndo:d(this,va).hasSomethingToUndo(),hasSomethingToRedo:d(this,va).hasSomethingToRedo(),hasSelectedEditor:!1})):(z(this,We,RT).call(this),z(this,We,rA).call(this),z(this,We,Ur).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!d(this,eo)){E(this,eo,e);for(const t of d(this,eo))z(this,We,Pl).call(this,t.defaultPropertiesToUpdate)}}getId(){return d(this,iw).id}get currentLayer(){return d(this,nr).get(d(this,Wp))}getLayer(e){return d(this,nr).get(e)}get currentPageIndex(){return d(this,Wp)}addLayer(e){d(this,nr).set(e.pageIndex,e),d(this,ou)?e.enable():e.disable()}removeLayer(e){d(this,nr).delete(e.pageIndex)}async updateMode(e,t=null,n=!1){var r;if(d(this,qs)!==e&&!(d(this,ya)&&(await d(this,ya).promise,!d(this,ya)))){if(E(this,ya,Promise.withResolvers()),E(this,qs,e),e===Rt.NONE){this.setEditingState(!1),z(this,We,DT).call(this),(r=this._editorUndoBar)==null||r.hide(),d(this,ya).resolve();return}this.setEditingState(!0),await z(this,We,FT).call(this),this.unselectAll();for(const i of d(this,nr).values())i.updateMode(e);if(!t){n&&this.addNewEditorFromKeyboard(),d(this,ya).resolve();return}for(const i of d(this,Ts).values())i.annotationElementId===t?(this.setSelected(i),i.enterInEditMode()):i.unselect();d(this,ya).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==d(this,qs)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var n;if(d(this,eo)){switch(e){case Gt.CREATE:this.currentLayer.addNewEditor();return;case Gt.HIGHLIGHT_DEFAULT_COLOR:(n=d(this,A1))==null||n.updateColor(t);break;case Gt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(d(this,k1)||E(this,k1,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const r of d(this,dn))r.updateParams(e,t);for(const r of d(this,eo))r.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){var i;for(const a of d(this,Ts).values())a.editorType===e&&a.show(t);(((i=d(this,k1))==null?void 0:i.get(Gt.HIGHLIGHT_SHOW_ALL))??!0)!==t&&z(this,We,Pl).call(this,[[Gt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(d(this,_1)!==e){E(this,_1,e);for(const t of d(this,nr).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const n of d(this,Ts).values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return d(this,Ts).get(e)}addEditor(e){d(this,Ts).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(d(this,Wo)&&clearTimeout(d(this,Wo)),E(this,Wo,setTimeout(()=>{this.focusMainContainer(),E(this,Wo,null)},0))),d(this,Ts).delete(e.id),this.unselect(e),(!e.annotationElementId||!d(this,Vd).has(e.annotationElementId))&&((t=d(this,Ml))==null||t.remove(e.id))}addDeletedAnnotationElement(e){d(this,Vd).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return d(this,Vd).has(e)}removeDeletedAnnotationElement(e){d(this,Vd).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){d(this,Oi)!==e&&(E(this,Oi,e),e&&z(this,We,Pl).call(this,e.propertiesToUpdate))}updateUI(e){d(this,We,BT)===e&&z(this,We,Pl).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){z(this,We,Pl).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(d(this,dn).has(e)){d(this,dn).delete(e),e.unselect(),z(this,We,Ur).call(this,{hasSelectedEditor:this.hasSelection});return}d(this,dn).add(e),e.select(),z(this,We,Pl).call(this,e.propertiesToUpdate),z(this,We,Ur).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=d(this,Wd))==null||t.commitOrRemove();for(const n of d(this,dn))n!==e&&n.unselect();d(this,dn).clear(),d(this,dn).add(e),e.select(),z(this,We,Pl).call(this,e.propertiesToUpdate),z(this,We,Ur).call(this,{hasSelectedEditor:!0})}isSelected(e){return d(this,dn).has(e)}get firstSelectedEditor(){return d(this,dn).values().next().value}unselect(e){e.unselect(),d(this,dn).delete(e),z(this,We,Ur).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return d(this,dn).size!==0}get isEnterHandled(){return d(this,dn).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;d(this,va).undo(),z(this,We,Ur).call(this,{hasSomethingToUndo:d(this,va).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:z(this,We,c0).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){d(this,va).redo(),z(this,We,Ur).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:d(this,va).hasSomethingToRedo(),isEmpty:z(this,We,c0).call(this)})}addCommands(e){d(this,va).add(e),z(this,We,Ur).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:z(this,We,c0).call(this)})}cleanUndoStack(e){d(this,va).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...d(this,dn)],n=()=>{var a;(a=this._editorUndoBar)==null||a.show(r,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},r=()=>{for(const a of t)z(this,We,iA).call(this,a)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){var e;(e=d(this,Oi))==null||e.commitOrRemove()}hasSomethingToControl(){return d(this,Oi)||this.hasSelection}selectAll(){for(const e of d(this,dn))e.commit();z(this,We,aA).call(this,d(this,Ts).values())}unselectAll(){var e;if(!(d(this,Oi)&&(d(this,Oi).commitOrRemove(),d(this,qs)!==Rt.NONE))&&!((e=d(this,Wd))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of d(this,dn))t.unselect();d(this,dn).clear(),z(this,We,Ur).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;d(this,cu)[0]+=e,d(this,cu)[1]+=t;const[r,i]=d(this,cu),a=[...d(this,dn)],o=1e3;d(this,Go)&&clearTimeout(d(this,Go)),E(this,Go,setTimeout(()=>{E(this,Go,null),d(this,cu)[0]=d(this,cu)[1]=0,this.addCommands({cmd:()=>{for(const l of a)d(this,Ts).has(l.id)&&l.translateInPage(r,i)},undo:()=>{for(const l of a)d(this,Ts).has(l.id)&&l.translateInPage(-r,-i)},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),E(this,Ho,new Map);for(const e of d(this,dn))d(this,Ho).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!d(this,Ho))return!1;this.disableUserSelect(!1);const e=d(this,Ho);E(this,Ho,null);let t=!1;for(const[{x:r,y:i,pageIndex:a},o]of e)o.newX=r,o.newY=i,o.newPageIndex=a,t||(t=r!==o.savedX||i!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const n=(r,i,a,o)=>{if(d(this,Ts).has(r.id)){const l=d(this,nr).get(o);l?r._setParentAndPosition(l,i,a):(r.pageIndex=o,r.x=i,r.y=a)}};return this.addCommands({cmd:()=>{for(const[r,{newX:i,newY:a,newPageIndex:o}]of e)n(r,i,a,o)},undo:()=>{for(const[r,{savedX:i,savedY:a,savedPageIndex:o}]of e)n(r,i,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(d(this,Ho))for(const n of d(this,Ho).keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||d(this,dn).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return d(this,Oi)===e}getActive(){return d(this,Oi)}getMode(){return d(this,qs)}get imageManager(){return zt(this,"imageManager",new Z_)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let c=0,u=t.rangeCount;c<u;c++)if(!e.contains(t.getRangeAt(c).commonAncestorContainer))return null;const{x:n,y:r,width:i,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(c,u,f,p)=>({x:(u-r)/a,y:1-(c+f-n)/i,width:p/a,height:f/i});break;case"180":o=(c,u,f,p)=>({x:1-(c+f-n)/i,y:1-(u+p-r)/a,width:f/i,height:p/a});break;case"270":o=(c,u,f,p)=>({x:1-(u+p-r)/a,y:(c-n)/i,width:p/a,height:f/i});break;default:o=(c,u,f,p)=>({x:(c-n)/i,y:(u-r)/a,width:f/i,height:p/a});break}const l=[];for(let c=0,u=t.rangeCount;c<u;c++){const f=t.getRangeAt(c);if(!f.collapsed)for(const{x:p,y:m,width:b,height:y}of f.getClientRects())b===0||y===0||l.push(o(p,m,b,y))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(d(this,Hp)||E(this,Hp,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=d(this,Hp))==null||t.delete(e)}renderAnnotationElement(e){var r;const t=(r=d(this,Hp))==null?void 0:r.get(e.data.id);if(!t)return;const n=d(this,Ml).getRawValue(t);n&&(d(this,qs)===Rt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}};zp=new WeakMap,Oi=new WeakMap,Ts=new WeakMap,nr=new WeakMap,qp=new WeakMap,Ml=new WeakMap,Hp=new WeakMap,va=new WeakMap,ru=new WeakMap,Wd=new WeakMap,Wp=new WeakMap,Vd=new WeakMap,Ho=new WeakMap,eo=new WeakMap,Gd=new WeakMap,b1=new WeakMap,w1=new WeakMap,Vp=new WeakMap,x1=new WeakMap,Wo=new WeakMap,iu=new WeakMap,Gp=new WeakMap,au=new WeakMap,Vo=new WeakMap,iw=new WeakMap,ou=new WeakMap,_1=new WeakMap,lu=new WeakMap,Xd=new WeakMap,A1=new WeakMap,S1=new WeakMap,qs=new WeakMap,dn=new WeakMap,Fl=new WeakMap,Kd=new WeakMap,k1=new WeakMap,N1=new WeakMap,cu=new WeakMap,Go=new WeakMap,Dl=new WeakMap,C1=new WeakMap,ya=new WeakMap,We=new WeakSet,Fb=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},tA=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of d(this,nr).values())if(n.hasTextLayer(e))return n;return null},LT=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=z(this,We,Fb).call(this,e).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(d(this,Vo)||E(this,Vo,new tF(this)),d(this,Vo).show(n,r,this.direction==="ltr"))},TT=function(){var i,a,o;const e=document.getSelection();if(!e||e.isCollapsed){d(this,Fl)&&((i=d(this,Vo))==null||i.hide(),E(this,Fl,null),z(this,We,Ur).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===d(this,Fl))return;const r=z(this,We,Fb).call(this,e).closest(".textLayer");if(!r){d(this,Fl)&&((a=d(this,Vo))==null||a.hide(),E(this,Fl,null),z(this,We,Ur).call(this,{hasSelectedText:!1}));return}if((o=d(this,Vo))==null||o.hide(),E(this,Fl,t),z(this,We,Ur).call(this,{hasSelectedText:!0}),!(d(this,qs)!==Rt.HIGHLIGHT&&d(this,qs)!==Rt.NONE)&&(d(this,qs)===Rt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),E(this,au,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=d(this,qs)===Rt.HIGHLIGHT?z(this,We,tA).call(this,r):null;l==null||l.toggleDrawing();const c=new AbortController,u=this.combinedSignal(c),f=p=>{p.type==="pointerup"&&p.button!==0||(c.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&z(this,We,Db).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:u}),window.addEventListener("blur",f,{signal:u})}},Db=function(e=""){d(this,qs)===Rt.HIGHLIGHT?this.highlightSelection(e):d(this,b1)&&z(this,We,LT).call(this)},IT=function(){document.addEventListener("selectionchange",z(this,We,TT).bind(this),{signal:this._signal})},jT=function(){if(d(this,iu))return;E(this,iu,new AbortController);const e=this.combinedSignal(d(this,iu));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},RT=function(){var e;(e=d(this,iu))==null||e.abort(),E(this,iu,null)},nA=function(){if(d(this,lu))return;E(this,lu,new AbortController);const e=this.combinedSignal(d(this,lu));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},OT=function(){var e;(e=d(this,lu))==null||e.abort(),E(this,lu,null)},sA=function(){if(d(this,ru))return;E(this,ru,new AbortController);const e=this.combinedSignal(d(this,ru));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},rA=function(){var e;(e=d(this,ru))==null||e.abort(),E(this,ru,null)},MT=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Ur=function(e){Object.entries(e).some(([n,r])=>d(this,N1)[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(d(this,N1),e)}),d(this,qs)===Rt.HIGHLIGHT&&e.hasSelectedEditor===!1&&z(this,We,Pl).call(this,[[Gt.HIGHLIGHT_FREE,!0]]))},Pl=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},FT=async function(){if(!d(this,ou)){E(this,ou,!0);const e=[];for(const t of d(this,nr).values())e.push(t.enable());await Promise.all(e);for(const t of d(this,Ts).values())t.enable()}},DT=function(){if(this.unselectAll(),d(this,ou)){E(this,ou,!1);for(const e of d(this,nr).values())e.disable();for(const e of d(this,Ts).values())e.disable()}},iA=function(e){const t=d(this,nr).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},BT=function(){let e=null;for(e of d(this,dn));return e},c0=function(){if(d(this,Ts).size===0)return!0;if(d(this,Ts).size===1)for(const e of d(this,Ts).values())return e.isEmpty();return!1},aA=function(e){for(const t of d(this,dn))t.unselect();d(this,dn).clear();for(const t of e)t.isEmpty()||(d(this,dn).add(t),t.select());z(this,We,Ur).call(this,{hasSelectedEditor:this.hasSelection})},gt(_p,"TRANSLATE_SMALL",1),gt(_p,"TRANSLATE_BIG",10);let tf=_p;var Hs,Xo,to,Xp,Ko,Mi,Kp,Yo,pi,Bl,Yd,Jo,uu,go,u0,Bb;const zr=class zr{constructor(e){$(this,go);$(this,Hs,null);$(this,Xo,!1);$(this,to,null);$(this,Xp,null);$(this,Ko,null);$(this,Mi,null);$(this,Kp,!1);$(this,Yo,null);$(this,pi,null);$(this,Bl,null);$(this,Yd,null);$(this,Jo,!1);E(this,pi,e),E(this,Jo,e._uiManager.useNewAltTextFlow),d(zr,uu)||E(zr,uu,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){zr._l10n??(zr._l10n=e)}async render(){const e=E(this,to,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=E(this,Xp,document.createElement("span"));e.append(t),d(this,Jo)?(e.classList.add("new"),e.setAttribute("data-l10n-id",d(zr,uu).missing),t.setAttribute("data-l10n-id",d(zr,uu)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=d(this,pi)._uiManager._signal;e.addEventListener("contextmenu",wo,{signal:n}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:n});const r=i=>{i.preventDefault(),d(this,pi)._uiManager.editAltText(d(this,pi)),d(this,Jo)&&d(this,pi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:d(this,go,u0)}})};return e.addEventListener("click",r,{capture:!0,signal:n}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(E(this,Kp,!0),r(i))},{signal:n}),await z(this,go,Bb).call(this),e}finish(){d(this,to)&&(d(this,to).focus({focusVisible:d(this,Kp)}),E(this,Kp,!1))}isEmpty(){return d(this,Jo)?d(this,Hs)===null:!d(this,Hs)&&!d(this,Xo)}hasData(){return d(this,Jo)?d(this,Hs)!==null||!!d(this,Bl):this.isEmpty()}get guessedText(){return d(this,Bl)}async setGuessedText(e){d(this,Hs)===null&&(E(this,Bl,e),E(this,Yd,await zr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),z(this,go,Bb).call(this))}toggleAltTextBadge(e=!1){var t;if(!d(this,Jo)||d(this,Hs)){(t=d(this,Yo))==null||t.remove(),E(this,Yo,null);return}if(!d(this,Yo)){const n=E(this,Yo,document.createElement("div"));n.className="noAltTextBadge",d(this,pi).div.append(n)}d(this,Yo).classList.toggle("hidden",!e)}serialize(e){let t=d(this,Hs);return!e&&d(this,Bl)===t&&(t=d(this,Yd)),{altText:t,decorative:d(this,Xo),guessedText:d(this,Bl),textWithDisclaimer:d(this,Yd)}}get data(){return{altText:d(this,Hs),decorative:d(this,Xo)}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:r,cancel:i=!1}){n&&(E(this,Bl,n),E(this,Yd,r)),!(d(this,Hs)===e&&d(this,Xo)===t)&&(i||(E(this,Hs,e),E(this,Xo,t)),z(this,go,Bb).call(this))}toggle(e=!1){d(this,to)&&(!e&&d(this,Mi)&&(clearTimeout(d(this,Mi)),E(this,Mi,null)),d(this,to).disabled=!e)}shown(){d(this,pi)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:d(this,go,u0)}})}destroy(){var e,t;(e=d(this,to))==null||e.remove(),E(this,to,null),E(this,Xp,null),E(this,Ko,null),(t=d(this,Yo))==null||t.remove(),E(this,Yo,null)}};Hs=new WeakMap,Xo=new WeakMap,to=new WeakMap,Xp=new WeakMap,Ko=new WeakMap,Mi=new WeakMap,Kp=new WeakMap,Yo=new WeakMap,pi=new WeakMap,Bl=new WeakMap,Yd=new WeakMap,Jo=new WeakMap,uu=new WeakMap,go=new WeakSet,u0=function(){return d(this,Hs)&&"added"||d(this,Hs)===null&&this.guessedText&&"review"||"missing"},Bb=async function(){var r,i,a;const e=d(this,to);if(!e)return;if(d(this,Jo)){if(e.classList.toggle("done",!!d(this,Hs)),e.setAttribute("data-l10n-id",d(zr,uu)[d(this,go,u0)]),(r=d(this,Xp))==null||r.setAttribute("data-l10n-id",d(zr,uu)[`${d(this,go,u0)}-label`]),!d(this,Hs)){(i=d(this,Ko))==null||i.remove();return}}else{if(!d(this,Hs)&&!d(this,Xo)){e.classList.remove("done"),(a=d(this,Ko))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=d(this,Ko);if(!t){E(this,Ko,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${d(this,pi).id}`;const o=100,l=d(this,pi)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(d(this,Mi)),E(this,Mi,null)},{once:!0}),e.addEventListener("mouseenter",()=>{E(this,Mi,setTimeout(()=>{E(this,Mi,null),d(this,Ko).classList.add("show"),d(this,pi)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var c;d(this,Mi)&&(clearTimeout(d(this,Mi)),E(this,Mi,null)),(c=d(this,Ko))==null||c.classList.remove("show")},{signal:l})}d(this,Xo)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=d(this,Hs)),t.parentNode||e.append(t);const n=d(this,pi).getImageForAltText();n==null||n.setAttribute("aria-describedby",t.id)},$(zr,uu,null),gt(zr,"_l10n",null);let q2=zr;var E1,Jd,P1,L1,T1,I1,j1,Yp,$l,Qd,du,vc,$T,UT,oA;const S3=class S3{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:a=null,signal:o}){$(this,vc);$(this,E1);$(this,Jd,!1);$(this,P1,null);$(this,L1);$(this,T1);$(this,I1);$(this,j1);$(this,Yp);$(this,$l,null);$(this,Qd);$(this,du,null);E(this,E1,e),E(this,P1,n),E(this,L1,t),E(this,T1,r),E(this,I1,i),E(this,j1,a),E(this,Qd,new AbortController),E(this,Yp,AbortSignal.any([o,d(this,Qd).signal])),e.addEventListener("touchstart",z(this,vc,$T).bind(this),{passive:!1,signal:d(this,Yp)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return zt(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=d(this,Qd))==null||e.abort(),E(this,Qd,null)}};E1=new WeakMap,Jd=new WeakMap,P1=new WeakMap,L1=new WeakMap,T1=new WeakMap,I1=new WeakMap,j1=new WeakMap,Yp=new WeakMap,$l=new WeakMap,Qd=new WeakMap,du=new WeakMap,vc=new WeakSet,$T=function(e){var r,i,a;if((r=d(this,L1))!=null&&r.call(this)||e.touches.length<2)return;if(!d(this,du)){E(this,du,new AbortController);const o=AbortSignal.any([d(this,Yp),d(this,du).signal]),l=d(this,E1),c={signal:o,passive:!1};l.addEventListener("touchmove",z(this,vc,UT).bind(this),c),l.addEventListener("touchend",z(this,vc,oA).bind(this),c),l.addEventListener("touchcancel",z(this,vc,oA).bind(this),c),(i=d(this,T1))==null||i.call(this)}if(Yi(e),e.touches.length!==2||(a=d(this,P1))!=null&&a.call(this)){E(this,$l,null);return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),E(this,$l,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY})},UT=function(e){var C;if(!d(this,$l)||e.touches.length!==2)return;let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:r,screenY:i}=t,{screenX:a,screenY:o}=n,l=d(this,$l),{touch0X:c,touch0Y:u,touch1X:f,touch1Y:p}=l,m=f-c,b=p-u,y=a-r,S=o-i,w=Math.hypot(y,S)||1,_=Math.hypot(m,b)||1;if(!d(this,Jd)&&Math.abs(_-w)<=S3.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=r,l.touch0Y=i,l.touch1X=a,l.touch1Y=o,e.preventDefault(),!d(this,Jd)){E(this,Jd,!0);return}const k=[(r+a)/2,(i+o)/2];(C=d(this,I1))==null||C.call(this,k,_,w)},oA=function(e){var t;d(this,du).abort(),E(this,du,null),(t=d(this,j1))==null||t.call(this),d(this,$l)&&(e.preventDefault(),E(this,$l,null),E(this,Jd,!1))};let H2=S3;var Zd,no,In,Jp,hu,R1,eh,sr,th,Ul,fu,O1,nh,Fi,M1,sh,zl,Qo,Qp,Zp,ba,rh,F1,aw,vt,lA,D1,cA,$b,zT,qT,uA,Ub,dA,HT,WT,VT,hA,GT,fA,XT,KT,YT,pA,d0;const Dt=class Dt{constructor(e){$(this,vt);$(this,Zd,null);$(this,no,null);$(this,In,null);$(this,Jp,!1);$(this,hu,null);$(this,R1,"");$(this,eh,!1);$(this,sr,null);$(this,th,null);$(this,Ul,null);$(this,fu,null);$(this,O1,"");$(this,nh,!1);$(this,Fi,null);$(this,M1,!1);$(this,sh,!1);$(this,zl,!1);$(this,Qo,null);$(this,Qp,0);$(this,Zp,0);$(this,ba,null);$(this,rh,null);gt(this,"_editToolbar",null);gt(this,"_initialOptions",Object.create(null));gt(this,"_initialData",null);gt(this,"_isVisible",!0);gt(this,"_uiManager",null);gt(this,"_focusEventsAllowed",!0);$(this,F1,!1);$(this,aw,Dt._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[i,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=Dt.prototype._resizeWithKeyboard,t=tf.TRANSLATE_SMALL,n=tf.TRANSLATE_BIG;return zt(this,"_resizerKeyboardManager",new Jv([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],Dt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return zt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new rF({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(Dt._l10n??(Dt._l10n=e),Dt._l10nResizer||(Dt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),Dt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);Dt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){An("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return d(this,F1)}set _isDraggable(e){var t;E(this,F1,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=d(this,aw)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):z(this,vt,d0).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(d(this,nh)?E(this,nh,!1):this.parent.setSelected(this))}focusout(e){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){const[i,a]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/i,this.y=(t+r)/a,this.fixAndSetPosition()}translate(e,t){z(this,vt,lA).call(this,this.parentDimensions,e,t)}translateInPage(e,t){d(this,Fi)||E(this,Fi,[this.x,this.y,this.width,this.height]),z(this,vt,lA).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){d(this,Fi)||E(this,Fi,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,c]=this.getBaseTranslation();a+=l,o+=c;const{style:u}=n;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!d(this,Fi)&&(d(this,Fi)[0]!==this.x||d(this,Fi)[1]!==this.y)}get _hasBeenResized(){return!!d(this,Fi)&&(d(this,Fi)[2]!==this.width||d(this,Fi)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=Dt,r=n/e,i=n/t;switch(this.rotation){case 90:return[-r,i];case 180:return[r,i];case 270:return[r,-i];default:return[-r,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,r]}=this;let{x:i,y:a,width:o,height:l}=this;if(o*=n,l*=r,i*=n,a*=r,this._mustFixPosition)switch(e){case 0:i=Math.max(0,Math.min(n-o,i)),a=Math.max(0,Math.min(r-l,a));break;case 90:i=Math.max(0,Math.min(n-l,i)),a=Math.min(r,Math.max(o,a));break;case 180:i=Math.min(n,Math.max(o,i)),a=Math.min(r,Math.max(l,a));break;case 270:i=Math.min(n,Math.max(l,i)),a=Math.max(0,Math.min(r-o,a));break}this.x=i/=n,this.y=a/=r;const[c,u]=this.getBaseTranslation();i+=c,a+=u,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var n;return z(n=Dt,D1,cA).call(n,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var n;return z(n=Dt,D1,cA).call(n,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(e,t){const[n,r]=this.parentDimensions,{style:i}=this.div;i.width=`${(100*e/n).toFixed(2)}%`,d(this,eh)||(i.height=`${(100*t/r).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,r=n.endsWith("%"),i=!d(this,eh)&&t.endsWith("%");if(r&&i)return;const[a,o]=this.parentDimensions;r||(e.width=`${(100*parseFloat(n)/a).toFixed(2)}%`),!d(this,eh)&&!i&&(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=d(this,In))==null||e.finish()}async addEditToolbar(){return this._editToolbar||d(this,sh)?this._editToolbar:(this._editToolbar=new J_(this),this.div.append(this._editToolbar.render()),d(this,In)&&await this._editToolbar.addAltText(d(this,In)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=d(this,In))==null||e.destroy())}addContainer(e){var n;const t=(n=this._editToolbar)==null?void 0:n.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){d(this,In)||(q2.initialize(Dt._l10n),E(this,In,new q2(this)),d(this,Zd)&&(d(this,In).data=d(this,Zd),E(this,Zd,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=d(this,In))==null?void 0:e.data}set altTextData(e){d(this,In)&&(d(this,In).data=e)}get guessedAltText(){var e;return(e=d(this,In))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=d(this,In))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=d(this,In))==null?void 0:t.serialize(e)}hasAltText(){return!!d(this,In)&&!d(this,In).isEmpty()}hasAltTextData(){var e;return((e=d(this,In))==null?void 0:e.hasData())??!1}render(){var i;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=d(this,Jp)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),z(this,vt,fA).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),z2(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(d(this,rh)||E(this,rh,new H2({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:z(this,vt,HT).bind(this),onPinching:z(this,vt,WT).bind(this),onPinchEnd:z(this,vt,VT).bind(this),signal:this._uiManager._signal}))),(i=this._uiManager._editorUndoBar)==null||i.hide(),this.div}pointerdown(e){const{isMac:t}=Xr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(E(this,nh,!0),this._isDraggable){z(this,vt,GT).call(this,e);return}z(this,vt,hA).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){d(this,Qo)&&clearTimeout(d(this,Qo)),E(this,Qo,setTimeout(()=>{var e;E(this,Qo,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const r=this.parentScale,[i,a]=this.pageDimensions,[o,l]=this.pageTranslation,c=e/r,u=t/r,f=this.x*i,p=this.y*a,m=this.width*i,b=this.height*a;switch(n){case 0:return[f+c+o,a-p-u-b+l,f+c+m+o,a-p-u+l];case 90:return[f+u+o,a-p+c+l,f+u+b+o,a-p+c+m+l];case 180:return[f-c-m+o,a-p+u+l,f-c+o,a-p+u+b+l];case 270:return[f-u-b+o,a-p-c-m+l,f-u+o,a-p-c+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,r,i,a]=e,o=i-n,l=a-r;switch(this.rotation){case 0:return[n,t-a,o,l];case 90:return[n,t-r,l,o];case 180:return[i,t-r,o,l];case 270:return[i,t-a,l,o];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){E(this,sh,!0)}disableEditMode(){E(this,sh,!1)}isInEditMode(){return d(this,sh)}shouldGetKeyboardEvents(){return d(this,zl)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&r>0&&e<i&&n>0}rebuild(){z(this,vt,fA).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){An("An editor must be serializable")}static async deserialize(e,t,n){const r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});r.rotation=e.rotation,E(r,Zd,e.accessibilityData);const[i,a]=r.pageDimensions,[o,l,c,u]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/i,r.y=l/a,r.width=c/i,r.height=u/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=d(this,fu))==null||e.abort(),E(this,fu,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),d(this,Qo)&&(clearTimeout(d(this,Qo)),E(this,Qo,null)),z(this,vt,d0).call(this),this.removeEditToolbar(),d(this,ba)){for(const n of d(this,ba).values())clearTimeout(n);E(this,ba,null)}this.parent=null,(t=d(this,rh))==null||t.destroy(),E(this,rh,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(z(this,vt,zT).call(this),d(this,sr).classList.remove("hidden"),z2(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),E(this,Ul,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=d(this,sr).children;if(!d(this,no)){E(this,no,Array.from(t));const a=z(this,vt,XT).bind(this),o=z(this,vt,KT).bind(this),l=this._uiManager._signal;for(const c of d(this,no)){const u=c.getAttribute("data-resizer-name");c.setAttribute("role","spinbutton"),c.addEventListener("keydown",a,{signal:l}),c.addEventListener("blur",o,{signal:l}),c.addEventListener("focus",z(this,vt,YT).bind(this,u),{signal:l}),c.setAttribute("data-l10n-id",Dt._l10nResizer[u])}}const n=d(this,no)[0];let r=0;for(const a of t){if(a===n)break;r++}const i=(360-this.rotation+this.parentRotation)%360/90*(d(this,no).length/4);if(i!==r){if(i<r)for(let o=0;o<r-i;o++)d(this,sr).append(d(this,sr).firstChild);else if(i>r)for(let o=0;o<i-r;o++)d(this,sr).firstChild.before(d(this,sr).lastChild);let a=0;for(const o of t){const c=d(this,no)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",Dt._l10nResizer[c])}}z(this,vt,pA).call(this,0),E(this,zl,!0),d(this,sr).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){d(this,zl)&&z(this,vt,dA).call(this,d(this,O1),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){z(this,vt,d0).call(this),this.div.focus()}select(){var e,t,n;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,i;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(n=d(this,In))==null||n.toggleAltTextBadge(!1)}unselect(){var e,t,n,r,i;(e=d(this,sr))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(i=d(this,In))==null||i.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return d(this,M1)}set isEditing(e){E(this,M1,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){E(this,eh,!0);const n=e/t,{style:r}=this.div;r.aspectRatio=n,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){d(this,ba)||E(this,ba,new Map);const{action:n}=e;let r=d(this,ba).get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(e),d(this,ba).delete(n),d(this,ba).size===0&&E(this,ba,null)},Dt._telemetryTimeout),d(this,ba).set(n,r);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),E(this,Jp,!1)}disable(){this.div&&(this.div.tabIndex=-1),E(this,Jp,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};Zd=new WeakMap,no=new WeakMap,In=new WeakMap,Jp=new WeakMap,hu=new WeakMap,R1=new WeakMap,eh=new WeakMap,sr=new WeakMap,th=new WeakMap,Ul=new WeakMap,fu=new WeakMap,O1=new WeakMap,nh=new WeakMap,Fi=new WeakMap,M1=new WeakMap,sh=new WeakMap,zl=new WeakMap,Qo=new WeakMap,Qp=new WeakMap,Zp=new WeakMap,ba=new WeakMap,rh=new WeakMap,F1=new WeakMap,aw=new WeakMap,vt=new WeakSet,lA=function([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},D1=new WeakSet,cA=function(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},$b=function(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}},zT=function(){if(d(this,sr))return;E(this,sr,document.createElement("div")),d(this,sr).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const r=document.createElement("div");d(this,sr).append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",z(this,vt,qT).bind(this,n),{signal:t}),r.addEventListener("contextmenu",wo,{signal:t}),r.tabIndex=-1}this.div.prepend(d(this,sr))},qT=function(e,t){var u;t.preventDefault();const{isMac:n}=Xr.platform;if(t.button!==0||t.ctrlKey&&n)return;(u=d(this,In))==null||u.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,E(this,th,[t.screenX,t.screenY]);const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",z(this,vt,dA).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",Yi,{passive:!1,signal:a}),window.addEventListener("contextmenu",wo,{signal:a}),E(this,Ul,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const c=()=>{var f;i.abort(),this.parent.togglePointerEvents(!0),(f=d(this,In))==null||f.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=l,z(this,vt,Ub).call(this)};window.addEventListener("pointerup",c,{signal:a}),window.addEventListener("blur",c,{signal:a})},uA=function(e,t,n,r){this.width=n,this.height=r,this.x=e,this.y=t;const[i,a]=this.parentDimensions;this.setDims(i*n,a*r),this.fixAndSetPosition(),this._onResized()},Ub=function(){if(!d(this,Ul))return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=d(this,Ul);E(this,Ul,null);const i=this.x,a=this.y,o=this.width,l=this.height;i===e&&a===t&&o===n&&l===r||this.addCommands({cmd:z(this,vt,uA).bind(this,i,a,o,l),undo:z(this,vt,uA).bind(this,e,t,n,r),mustExec:!0})},dA=function(e,t){const[n,r]=this.parentDimensions,i=this.x,a=this.y,o=this.width,l=this.height,c=Dt.MIN_SIZE/n,u=Dt.MIN_SIZE/r,f=z(this,vt,$b).call(this,this.rotation),p=(te,ue)=>[f[0]*te+f[2]*ue,f[1]*te+f[3]*ue],m=z(this,vt,$b).call(this,360-this.rotation),b=(te,ue)=>[m[0]*te+m[2]*ue,m[1]*te+m[3]*ue];let y,S,w=!1,_=!1;switch(e){case"topLeft":w=!0,y=(te,ue)=>[0,0],S=(te,ue)=>[te,ue];break;case"topMiddle":y=(te,ue)=>[te/2,0],S=(te,ue)=>[te/2,ue];break;case"topRight":w=!0,y=(te,ue)=>[te,0],S=(te,ue)=>[0,ue];break;case"middleRight":_=!0,y=(te,ue)=>[te,ue/2],S=(te,ue)=>[0,ue/2];break;case"bottomRight":w=!0,y=(te,ue)=>[te,ue],S=(te,ue)=>[0,0];break;case"bottomMiddle":y=(te,ue)=>[te/2,ue],S=(te,ue)=>[te/2,0];break;case"bottomLeft":w=!0,y=(te,ue)=>[0,ue],S=(te,ue)=>[te,0];break;case"middleLeft":_=!0,y=(te,ue)=>[0,ue/2],S=(te,ue)=>[te,ue/2];break}const k=y(o,l),C=S(o,l);let B=p(...C);const F=Dt._round(i+B[0]),j=Dt._round(a+B[1]);let T=1,W=1,Y,I;if(t.fromKeyboard)({deltaX:Y,deltaY:I}=t);else{const{screenX:te,screenY:ue}=t,[Z,he]=d(this,th);[Y,I]=this.screenToPageTranslation(te-Z,ue-he),d(this,th)[0]=te,d(this,th)[1]=ue}if([Y,I]=b(Y/n,I/r),w){const te=Math.hypot(o,l);T=W=Math.max(Math.min(Math.hypot(C[0]-k[0]-Y,C[1]-k[1]-I)/te,1/o,1/l),c/o,u/l)}else _?T=Math.max(c,Math.min(1,Math.abs(C[0]-k[0]-Y)))/o:W=Math.max(u,Math.min(1,Math.abs(C[1]-k[1]-I)))/l;const O=Dt._round(o*T),X=Dt._round(l*W);B=p(...S(O,X));const K=F-B[0],ne=j-B[1];d(this,Fi)||E(this,Fi,[this.x,this.y,this.width,this.height]),this.width=O,this.height=X,this.x=K,this.y=ne,this.setDims(n*O,r*X),this.fixAndSetPosition(),this._onResizing()},HT=function(){var e;E(this,Ul,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=d(this,In))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},WT=function(e,t,n){let i=.7*(n/t)+1-.7;if(i===1)return;const a=z(this,vt,$b).call(this,this.rotation),o=(F,j)=>[a[0]*F+a[2]*j,a[1]*F+a[3]*j],[l,c]=this.parentDimensions,u=this.x,f=this.y,p=this.width,m=this.height,b=Dt.MIN_SIZE/l,y=Dt.MIN_SIZE/c;i=Math.max(Math.min(i,1/p,1/m),b/p,y/m);const S=Dt._round(p*i),w=Dt._round(m*i);if(S===p&&w===m)return;d(this,Fi)||E(this,Fi,[u,f,p,m]);const _=o(p/2,m/2),k=Dt._round(u+_[0]),C=Dt._round(f+_[1]),B=o(S/2,w/2);this.x=k-B[0],this.y=C-B[1],this.width=S,this.height=w,this.setDims(l*S,c*w),this.fixAndSetPosition(),this._onResizing()},VT=function(){var e;(e=d(this,In))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),z(this,vt,Ub).call(this)},hA=function(e){const{isMac:t}=Xr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},GT=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,i=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:i},o=c=>{r.abort(),E(this,hu,null),E(this,nh,!1),this._uiManager.endDragSession()||z(this,vt,hA).call(this,c),n&&this._onStopDragging()};t&&(E(this,Qp,e.clientX),E(this,Zp,e.clientY),E(this,hu,e.pointerId),E(this,R1,e.pointerType),window.addEventListener("pointermove",c=>{n||(n=!0,this._onStartDragging());const{clientX:u,clientY:f,pointerId:p}=c;if(p!==d(this,hu)){Yi(c);return}const[m,b]=this.screenToPageTranslation(u-d(this,Qp),f-d(this,Zp));E(this,Qp,u),E(this,Zp,f),this._uiManager.dragSelectedEditors(m,b)},a),window.addEventListener("touchmove",Yi,a),window.addEventListener("pointerdown",c=>{c.pointerType===d(this,R1)&&(d(this,rh)||c.isPrimary)&&o(c),Yi(c)},a));const l=c=>{if(!d(this,hu)||d(this,hu)===c.pointerId){o(c);return}Yi(c)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},fA=function(){if(d(this,fu)||!this.div)return;E(this,fu,new AbortController);const e=this._uiManager.combinedSignal(d(this,fu));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},XT=function(e){Dt._resizerKeyboardManager.exec(this,e)},KT=function(e){var t;d(this,zl)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==d(this,sr)&&z(this,vt,d0).call(this)},YT=function(e){E(this,O1,d(this,zl)?e:"")},pA=function(e){if(d(this,no))for(const t of d(this,no))t.tabIndex=e},d0=function(){E(this,zl,!1),z(this,vt,pA).call(this,-1),z(this,vt,Ub).call(this)},$(Dt,D1),gt(Dt,"_l10n",null),gt(Dt,"_l10nResizer",null),gt(Dt,"_borderLineWidth",-1),gt(Dt,"_colorManager",new eA),gt(Dt,"_zIndex",1),gt(Dt,"_telemetryTimeout",1e3);let Xn=Dt;class rF extends Xn{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const DC=3285377520,ga=4294901760,Mo=65535;class JT{constructor(e){this.h1=e?e&4294967295:DC,this.h2=e?e&4294967295:DC}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let y=0,S=e.length;y<S;y++){const w=e.charCodeAt(y);w<=255?t[n++]=w:(t[n++]=w>>>8,t[n++]=w&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,i=n-r*4,a=new Uint32Array(t.buffer,0,r);let o=0,l=0,c=this.h1,u=this.h2;const f=3432918353,p=461845907,m=f&Mo,b=p&Mo;for(let y=0;y<r;y++)y&1?(o=a[y],o=o*f&ga|o*m&Mo,o=o<<15|o>>>17,o=o*p&ga|o*b&Mo,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(l=a[y],l=l*f&ga|l*m&Mo,l=l<<15|l>>>17,l=l*p&ga|l*b&Mo,u^=l,u=u<<13|u>>>19,u=u*5+3864292196);switch(o=0,i){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*f&ga|o*m&Mo,o=o<<15|o>>>17,o=o*p&ga|o*b&Mo,r&1?c^=o:u^=o}this.h1=c,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&ga|e*36045&Mo,t=t*4283543511&ga|((t<<16|e>>>16)*2950163797&ga)>>>16,e^=t>>>1,e=e*444984403&ga|e*60499&Mo,t=t*3301882366&ga|((t<<16|e>>>16)*3120437893&ga)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const mA=Object.freeze({map:null,hash:"",transfer:void 0});var ih,ah,Ws,ow,QT;class h3{constructor(){$(this,ow);$(this,ih,!1);$(this,ah,null);$(this,Ws,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=d(this,Ws).get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return d(this,Ws).get(e)}remove(e){if(d(this,Ws).delete(e),d(this,Ws).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of d(this,Ws).values())if(t instanceof Xn)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=d(this,Ws).get(e);let r=!1;if(n!==void 0)for(const[i,a]of Object.entries(t))n[i]!==a&&(r=!0,n[i]=a);else r=!0,d(this,Ws).set(e,t);r&&z(this,ow,QT).call(this),t instanceof Xn&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return d(this,Ws).has(e)}getAll(){return d(this,Ws).size>0?a3(d(this,Ws)):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return d(this,Ws).size}resetModified(){d(this,ih)&&(E(this,ih,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ZT(this)}get serializable(){if(d(this,Ws).size===0)return mA;const e=new Map,t=new JT,n=[],r=Object.create(null);let i=!1;for(const[a,o]of d(this,Ws)){const l=o instanceof Xn?o.serialize(!1,r):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:mA}get editorStats(){let e=null;const t=new Map;for(const n of d(this,Ws).values()){if(!(n instanceof Xn))continue;const r=n.telemetryFinalData;if(!r)continue;const{type:i}=r;t.has(i)||t.set(i,Object.getPrototypeOf(n).constructor),e||(e=Object.create(null));const a=e[i]||(e[i]=new Map);for(const[o,l]of Object.entries(r)){if(o==="type")continue;let c=a.get(o);c||(c=new Map,a.set(o,c));const u=c.get(l)??0;c.set(l,u+1)}}for(const[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){E(this,ah,null)}get modifiedIds(){if(d(this,ah))return d(this,ah);const e=[];for(const t of d(this,Ws).values())!(t instanceof Xn)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return E(this,ah,{ids:new Set(e),hash:e.join(",")})}}ih=new WeakMap,ah=new WeakMap,Ws=new WeakMap,ow=new WeakSet,QT=function(){d(this,ih)||(E(this,ih,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var B1;class ZT extends h3{constructor(t){super();$(this,B1);const{map:n,hash:r,transfer:i}=t.serializable,a=structuredClone(n,i?{transfer:i}:null);E(this,B1,{map:a,hash:r,transfer:i})}get print(){An("Should not call PrintAnnotationStorage.print")}get serializable(){return d(this,B1)}get modifiedIds(){return zt(this,"modifiedIds",{ids:new Set,hash:""})}}B1=new WeakMap;var em;class iF{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){$(this,em,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),d(this,em).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||d(this,em).has(e.loadedName))){if(_s(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:n,src:r,style:i}=e,a=new FontFace(n,r,i);this.addNativeFontFace(a);try{await a.load(),d(this,em).add(n),t==null||t(e)}catch{Ot(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}An("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw Ot(`Failed to load font '${n.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,r)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return zt(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Tr||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),zt(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(_s(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const i=n.shift();setTimeout(i.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return zt(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(C,B){return C.charCodeAt(B)<<24|C.charCodeAt(B+1)<<16|C.charCodeAt(B+2)<<8|C.charCodeAt(B+3)&255}function r(C,B,F,j){const T=C.substring(0,B),W=C.substring(B+F);return T+j+W}let i,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let c=0;function u(C,B){if(++c>30){Ot("Load test font never loaded."),B();return}if(l.font="30px "+C,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){B();return}setTimeout(u.bind(null,C,B))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=r(p,976,f.length,f);const b=16,y=1482184792;let S=n(p,b);for(i=0,a=f.length-3;i<a;i+=4)S=S-y+n(f,i)|0;i<f.length&&(S=S-y+n(f+"XXX",i)|0),p=r(p,b,4,HM(S));const w=`url(data:font/opentype;base64,${btoa(p)});`,_=`@font-face {font-family:"${f}";src:${w}}`;this.insertRule(_);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const C of[e.loadedName,f]){const B=this._document.createElement("span");B.textContent="Hi",B.style.fontFamily=C,k.append(B)}this._document.body.append(k),u(f,()=>{k.remove(),t.complete()})}}em=new WeakMap;class aF{constructor(e,{disableFontFace:t=!1,fontExtraProperties:n=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const i in e)this[i]=e[i];this.disableFontFace=t===!0,this.fontExtraProperties=n===!0,this._inspectFont=r}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${YM(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${e}}`}return(n=this._inspectFont)==null||n.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let r;try{r=e.get(n)}catch(a){Ot(`getPathGenerator - ignoring character: "${a}".`)}const i=new Path2D(r||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}}const rb={DATA:1,ERROR:2},ys={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function BC(){}function hi(s){if(s instanceof Gu||s instanceof X_||s instanceof o1||s instanceof OC||s instanceof U2||s instanceof vx)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||An('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new Gu(s.message);case"InvalidPDFException":return new X_(s.message);case"MissingPDFException":return new o1(s.message);case"PasswordException":return new OC(s.message,s.code);case"UnexpectedResponseException":return new U2(s.message,s.status);case"UnknownErrorException":return new vx(s.message,s.details)}return new vx(s.message,s.toString())}var tm,Ta,e6,t6,n6,zb;class h0{constructor(e,t,n){$(this,Ta);$(this,tm,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",z(this,Ta,e6).bind(this),{signal:d(this,tm).signal})}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,n,r){const i=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:c=>{const u=Promise.withResolvers();return this.streamControllers[i]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:c.desiredSize},r),u.promise},pull:c=>{const u=Promise.withResolvers();return this.streamControllers[i].pullCall=u,l.postMessage({sourceName:a,targetName:o,stream:ys.PULL,streamId:i,desiredSize:c.desiredSize}),u.promise},cancel:c=>{_s(c instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[i].cancelCall=u,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:ys.CANCEL,streamId:i,reason:hi(c)}),u.promise}},n)}destroy(){var e;(e=d(this,tm))==null||e.abort(),E(this,tm,null)}}tm=new WeakMap,Ta=new WeakSet,e6=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){z(this,Ta,n6).call(this,e);return}if(e.callback){const n=e.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===rb.DATA)r.resolve(e.data);else if(e.callback===rb.ERROR)r.reject(hi(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(a){i.postMessage({sourceName:n,targetName:r,callback:rb.DATA,callbackId:e.callbackId,data:a})},function(a){i.postMessage({sourceName:n,targetName:r,callback:rb.ERROR,callbackId:e.callbackId,reason:hi(a)})});return}if(e.streamId){z(this,Ta,t6).call(this,e);return}t(e.data)},t6=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(c,u=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=u,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:r,stream:ys.ENQUEUE,streamId:t,chunk:c},f)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:ys.CLOSE,streamId:t}),delete a.streamSinks[t])},error(c){_s(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:ys.ERROR,streamId:t,reason:hi(c)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:n,targetName:r,stream:ys.START_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:r,stream:ys.START_COMPLETE,streamId:t,reason:hi(c)})})},n6=function(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case ys.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(hi(e.reason));break;case ys.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(hi(e.reason));break;case ys.PULL:if(!o){i.postMessage({sourceName:n,targetName:r,stream:ys.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||BC).then(function(){i.postMessage({sourceName:n,targetName:r,stream:ys.PULL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:r,stream:ys.PULL_COMPLETE,streamId:t,reason:hi(c)})});break;case ys.ENQUEUE:if(_s(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case ys.CLOSE:if(_s(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),z(this,Ta,zb).call(this,a,t);break;case ys.ERROR:_s(a,"error should have stream controller"),a.controller.error(hi(e.reason)),z(this,Ta,zb).call(this,a,t);break;case ys.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(hi(e.reason)),z(this,Ta,zb).call(this,a,t);break;case ys.CANCEL:if(!o)break;const l=hi(e.reason);Promise.try(o.onCancel||BC,l).then(function(){i.postMessage({sourceName:n,targetName:r,stream:ys.CANCEL_COMPLETE,streamId:t,success:!0})},function(c){i.postMessage({sourceName:n,targetName:r,stream:ys.CANCEL_COMPLETE,streamId:t,reason:hi(c)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},zb=async function(e,t){var n,r,i;await Promise.allSettled([(n=e.startCall)==null?void 0:n.promise,(r=e.pullCall)==null?void 0:r.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var $1;class s6{constructor({enableHWA:e=!1}){$(this,$1,!1);E(this,$1,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!d(this,$1)})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){An("Abstract method `_createCanvas` called.")}}$1=new WeakMap;class oF extends s6{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class r6{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){An("Abstract method `_fetch` called.")}}class i6 extends r6{async _fetch(e){const t=await Zw(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Qw(t)}}class a6{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,r,i){return"none"}destroy(e=!1){}}var oh,nm,ql,Hl,Nr,lh,ch,Ye,_r,f0,Jf,qb,Qf,o6,gA,Zf,p0,m0,vA,g0;class lF extends a6{constructor({docId:t,ownerDocument:n=globalThis.document}){super();$(this,Ye);$(this,oh);$(this,nm);$(this,ql);$(this,Hl);$(this,Nr);$(this,lh);$(this,ch,0);E(this,Hl,t),E(this,Nr,n)}addFilter(t){if(!t)return"none";let n=d(this,Ye,_r).get(t);if(n)return n;const[r,i,a]=z(this,Ye,qb).call(this,t),o=t.length===1?r:`${r}${i}${a}`;if(n=d(this,Ye,_r).get(o),n)return d(this,Ye,_r).set(t,n),n;const l=`g_${d(this,Hl)}_transfer_map_${$r(this,ch)._++}`,c=z(this,Ye,Qf).call(this,l);d(this,Ye,_r).set(t,c),d(this,Ye,_r).set(o,c);const u=z(this,Ye,Zf).call(this,l);return z(this,Ye,m0).call(this,r,i,a,u),c}addHCMFilter(t,n){var b;const r=`${t}-${n}`,i="base";let a=d(this,Ye,f0).get(i);if((a==null?void 0:a.key)===r||(a?((b=a.filter)==null||b.remove(),a.key=r,a.url="none",a.filter=null):(a={key:r,url:"none",filter:null},d(this,Ye,f0).set(i,a)),!t||!n))return a.url;const o=z(this,Ye,g0).call(this,t);t=it.makeHexColor(...o);const l=z(this,Ye,g0).call(this,n);if(n=it.makeHexColor(...l),d(this,Ye,Jf).style.color="",t==="#000000"&&n==="#ffffff"||t===n)return a.url;const c=new Array(256);for(let y=0;y<=255;y++){const S=y/255;c[y]=S<=.03928?S/12.92:((S+.055)/1.055)**2.4}const u=c.join(","),f=`g_${d(this,Hl)}_hcm_filter`,p=a.filter=z(this,Ye,Zf).call(this,f);z(this,Ye,m0).call(this,u,u,u,p),z(this,Ye,gA).call(this,p);const m=(y,S)=>{const w=o[y]/255,_=l[y]/255,k=new Array(S+1);for(let C=0;C<=S;C++)k[C]=w+C/S*(_-w);return k.join(",")};return z(this,Ye,m0).call(this,m(0,5),m(1,5),m(2,5),p),a.url=z(this,Ye,Qf).call(this,f),a.url}addAlphaFilter(t){let n=d(this,Ye,_r).get(t);if(n)return n;const[r]=z(this,Ye,qb).call(this,[t]),i=`alpha_${r}`;if(n=d(this,Ye,_r).get(i),n)return d(this,Ye,_r).set(t,n),n;const a=`g_${d(this,Hl)}_alpha_map_${$r(this,ch)._++}`,o=z(this,Ye,Qf).call(this,a);d(this,Ye,_r).set(t,o),d(this,Ye,_r).set(i,o);const l=z(this,Ye,Zf).call(this,a);return z(this,Ye,vA).call(this,r,l),o}addLuminosityFilter(t){let n=d(this,Ye,_r).get(t||"luminosity");if(n)return n;let r,i;if(t?([r]=z(this,Ye,qb).call(this,[t]),i=`luminosity_${r}`):i="luminosity",n=d(this,Ye,_r).get(i),n)return d(this,Ye,_r).set(t,n),n;const a=`g_${d(this,Hl)}_luminosity_map_${$r(this,ch)._++}`,o=z(this,Ye,Qf).call(this,a);d(this,Ye,_r).set(t,o),d(this,Ye,_r).set(i,o);const l=z(this,Ye,Zf).call(this,a);return z(this,Ye,o6).call(this,l),t&&z(this,Ye,vA).call(this,r,l),o}addHighlightHCMFilter(t,n,r,i,a){var _;const o=`${n}-${r}-${i}-${a}`;let l=d(this,Ye,f0).get(t);if((l==null?void 0:l.key)===o||(l?((_=l.filter)==null||_.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},d(this,Ye,f0).set(t,l)),!n||!r))return l.url;const[c,u]=[n,r].map(z(this,Ye,g0).bind(this));let f=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),[m,b]=[i,a].map(z(this,Ye,g0).bind(this));p<f&&([f,p,m,b]=[p,f,b,m]),d(this,Ye,Jf).style.color="";const y=(k,C,B)=>{const F=new Array(256),j=(p-f)/B,T=k/255,W=(C-k)/(255*B);let Y=0;for(let I=0;I<=B;I++){const O=Math.round(f+I*j),X=T+I*W;for(let K=Y;K<=O;K++)F[K]=X;Y=O+1}for(let I=Y;I<256;I++)F[I]=F[Y-1];return F.join(",")},S=`g_${d(this,Hl)}_hcm_${t}_filter`,w=l.filter=z(this,Ye,Zf).call(this,S);return z(this,Ye,gA).call(this,w),z(this,Ye,m0).call(this,y(m[0],b[0],5),y(m[1],b[1],5),y(m[2],b[2],5),w),l.url=z(this,Ye,Qf).call(this,S),l.url}destroy(t=!1){var n,r,i,a;t&&((n=d(this,lh))!=null&&n.size)||((r=d(this,ql))==null||r.parentNode.parentNode.remove(),E(this,ql,null),(i=d(this,nm))==null||i.clear(),E(this,nm,null),(a=d(this,lh))==null||a.clear(),E(this,lh,null),E(this,ch,0))}}oh=new WeakMap,nm=new WeakMap,ql=new WeakMap,Hl=new WeakMap,Nr=new WeakMap,lh=new WeakMap,ch=new WeakMap,Ye=new WeakSet,_r=function(){return d(this,nm)||E(this,nm,new Map)},f0=function(){return d(this,lh)||E(this,lh,new Map)},Jf=function(){if(!d(this,ql)){const t=d(this,Nr).createElement("div"),{style:n}=t;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const r=d(this,Nr).createElementNS(El,"svg");r.setAttribute("width",0),r.setAttribute("height",0),E(this,ql,d(this,Nr).createElementNS(El,"defs")),t.append(r),r.append(d(this,ql)),d(this,Nr).body.append(t)}return d(this,ql)},qb=function(t){if(t.length===1){const c=t[0],u=new Array(256);for(let p=0;p<256;p++)u[p]=c[p]/255;const f=u.join(",");return[f,f,f]}const[n,r,i]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let c=0;c<256;c++)a[c]=n[c]/255,o[c]=r[c]/255,l[c]=i[c]/255;return[a.join(","),o.join(","),l.join(",")]},Qf=function(t){if(d(this,oh)===void 0){E(this,oh,"");const n=d(this,Nr).URL;n!==d(this,Nr).baseURI&&(e5(n)?Ot('#createUrl: ignore "data:"-URL for performance reasons.'):E(this,oh,n.split("#",1)[0]))}return`url(${d(this,oh)}#${t})`},o6=function(t){const n=d(this,Nr).createElementNS(El,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(n)},gA=function(t){const n=d(this,Nr).createElementNS(El,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(n)},Zf=function(t){const n=d(this,Nr).createElementNS(El,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",t),d(this,Ye,Jf).append(n),n},p0=function(t,n,r){const i=d(this,Nr).createElementNS(El,n);i.setAttribute("type","discrete"),i.setAttribute("tableValues",r),t.append(i)},m0=function(t,n,r,i){const a=d(this,Nr).createElementNS(El,"feComponentTransfer");i.append(a),z(this,Ye,p0).call(this,a,"feFuncR",t),z(this,Ye,p0).call(this,a,"feFuncG",n),z(this,Ye,p0).call(this,a,"feFuncB",r)},vA=function(t,n){const r=d(this,Nr).createElementNS(El,"feComponentTransfer");n.append(r),z(this,Ye,p0).call(this,r,"feFuncA",t)},g0=function(t){return d(this,Ye,Jf).style.color=t,d3(getComputedStyle(d(this,Ye,Jf)).getPropertyValue("color"))};class l6{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){An("Abstract method `_fetch` called.")}}class c6 extends l6{async _fetch(e){const t=await Zw(e,"arraybuffer");return new Uint8Array(t)}}Tr&&Ot("Please use the `legacy` build in Node.js environments.");async function u6(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class cF extends a6{}class uF extends s6{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class dF extends r6{async _fetch(e){return u6(e)}}class hF extends l6{async _fetch(e){return u6(e)}}const Pr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function yA(s,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],r=new Path2D;r.rect(e[0],e[1],t,n),s.clip(r)}class f3{getPattern(){An("Abstract method `getPattern` called.")}}class fF extends f3{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,r){let i;if(r===Pr.STROKE||r===Pr.FILL){const a=t.current.getClippedPathBoundingBox(r,Fn(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas("pattern",o,l),u=c.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),n=it.transform(n,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),yA(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),i=e.createPattern(c.canvas,"no-repeat");const f=new DOMMatrix(n);i.setTransform(f)}else yA(e,this._bbox),i=this._createGradient(e);return i}}function wx(s,e,t,n,r,i,a,o){const l=e.coords,c=e.colors,u=s.data,f=s.width*4;let p;l[t+1]>l[n+1]&&(p=t,t=n,n=p,p=i,i=a,a=p),l[n+1]>l[r+1]&&(p=n,n=r,r=p,p=a,a=o,o=p),l[t+1]>l[n+1]&&(p=t,t=n,n=p,p=i,i=a,a=p);const m=(l[t]+e.offsetX)*e.scaleX,b=(l[t+1]+e.offsetY)*e.scaleY,y=(l[n]+e.offsetX)*e.scaleX,S=(l[n+1]+e.offsetY)*e.scaleY,w=(l[r]+e.offsetX)*e.scaleX,_=(l[r+1]+e.offsetY)*e.scaleY;if(b>=_)return;const k=c[i],C=c[i+1],B=c[i+2],F=c[a],j=c[a+1],T=c[a+2],W=c[o],Y=c[o+1],I=c[o+2],O=Math.round(b),X=Math.round(_);let K,ne,te,ue,Z,he,me,Ne;for(let L=O;L<=X;L++){if(L<S){const de=L<b?0:(b-L)/(b-S);K=m-(m-y)*de,ne=k-(k-F)*de,te=C-(C-j)*de,ue=B-(B-T)*de}else{let de;L>_?de=1:S===_?de=0:de=(S-L)/(S-_),K=y-(y-w)*de,ne=F-(F-W)*de,te=j-(j-Y)*de,ue=T-(T-I)*de}let V;L<b?V=0:L>_?V=1:V=(b-L)/(b-_),Z=m-(m-w)*V,he=k-(k-W)*V,me=C-(C-Y)*V,Ne=B-(B-I)*V;const Q=Math.round(Math.min(K,Z)),se=Math.round(Math.max(K,Z));let re=f*L+Q*4;for(let de=Q;de<=se;de++)V=(K-de)/(K-Z),V<0?V=0:V>1&&(V=1),u[re++]=ne-(ne-he)*V|0,u[re++]=te-(te-me)*V|0,u[re++]=ue-(ue-Ne)*V|0,u[re++]=255}}function pF(s,e,t){const n=e.coords,r=e.colors;let i,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(n.length/o)-1,c=o-1;for(i=0;i<l;i++){let u=i*o;for(let f=0;f<c;f++,u++)wx(s,t,n[u],n[u+1],n[u+o],r[u],r[u+1],r[u+o]),wx(s,t,n[u+o+1],n[u+1],n[u+o],r[u+o+1],r[u+1],r[u+o])}break;case"triangles":for(i=0,a=n.length;i<a;i+=3)wx(s,t,n[i],n[i+1],n[i+2],r[i],r[i+1],r[i+2]);break;default:throw new Error("illegal figure")}}class mF extends f3{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),c=Math.ceil(this._bounds[2])-o,u=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(c*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),m=c/f,b=u/p,y={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/m,scaleY:1/b},S=f+2*2,w=p+2*2,_=n.getCanvas("mesh",S,w),k=_.context,C=k.createImageData(f,p);if(t){const F=C.data;for(let j=0,T=F.length;j<T;j+=4)F[j]=t[0],F[j+1]=t[1],F[j+2]=t[2],F[j+3]=255}for(const F of this._figures)pF(C,F,y);return k.putImageData(C,2,2),{canvas:_.canvas,offsetX:o-2*m,offsetY:l-2*b,scaleX:m,scaleY:b}}getPattern(e,t,n,r){yA(e,this._bbox);let i;if(r===Pr.SHADING)i=it.singularValueDecompose2dScale(Fn(e));else if(i=it.singularValueDecompose2dScale(t.baseTransform),this.matrix){const o=it.singularValueDecompose2dScale(this.matrix);i=[i[0]*o[0],i[1]*o[1]]}const a=this._createMeshCanvas(i,r===Pr.SHADING?null:this._background,t.cachedCanvases);return r!==Pr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class gF extends f3{getPattern(){return"hotpink"}}function vF(s){switch(s[0]){case"RadialAxial":return new fF(s);case"Mesh":return new mF(s);case"Dummy":return new gF}throw new Error(`Unknown IR type: ${s[0]}`)}const $C={COLORED:1,UNCOLORED:2},lw=class lw{constructor(e,t,n,r,i){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=r,this.baseTransform=i}createPatternCanvas(e){const{bbox:t,operatorList:n,paintType:r,tilingType:i,color:a,canvasGraphicsFactory:o}=this;let{xstep:l,ystep:c}=this;l=Math.abs(l),c=Math.abs(c),Jw("TilingType: "+i);const u=t[0],f=t[1],p=t[2],m=t[3],b=p-u,y=m-f,S=it.singularValueDecompose2dScale(this.matrix),w=it.singularValueDecompose2dScale(this.baseTransform),_=S[0]*w[0],k=S[1]*w[1];let C=b,B=y,F=!1,j=!1;const T=Math.ceil(l*_),W=Math.ceil(c*k),Y=Math.ceil(b*_),I=Math.ceil(y*k);T>=Y?C=l:F=!0,W>=I?B=c:j=!0;const O=this.getSizeAndScale(C,this.ctx.canvas.width,_),X=this.getSizeAndScale(B,this.ctx.canvas.height,k),K=e.cachedCanvases.getCanvas("pattern",O.size,X.size),ne=K.context,te=o.createCanvasGraphics(ne);if(te.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(te,r,a),ne.translate(-O.scale*u,-X.scale*f),te.transform(O.scale,0,0,X.scale,0,0),ne.save(),this.clipBbox(te,u,f,p,m),te.baseTransform=Fn(te.ctx),te.executeOperatorList(n),te.endDrawing(),ne.restore(),F||j){const ue=K.canvas;F&&(C=l),j&&(B=c);const Z=this.getSizeAndScale(C,this.ctx.canvas.width,_),he=this.getSizeAndScale(B,this.ctx.canvas.height,k),me=Z.size,Ne=he.size,L=e.cachedCanvases.getCanvas("pattern-workaround",me,Ne),V=L.context,Q=F?Math.floor(b/l):0,se=j?Math.floor(y/c):0;for(let re=0;re<=Q;re++)for(let de=0;de<=se;de++)V.drawImage(ue,me*re,Ne*de,me,Ne,0,0,me,Ne);return{canvas:L.canvas,scaleX:Z.scale,scaleY:he.scale,offsetX:u,offsetY:f}}return{canvas:K.canvas,scaleX:O.scale,scaleY:X.scale,offsetX:u,offsetY:f}}getSizeAndScale(e,t,n){const r=Math.max(lw.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*n);return i>=r?i=r:n=i/e,{scale:n,size:i}}clipBbox(e,t,n,r,i){const a=r-t,o=i-n;e.ctx.rect(t,n,a,o),e.current.updateRectMinMax(Fn(e.ctx),[t,n,r,i]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const r=e.ctx,i=e.current;switch(t){case $C.COLORED:const a=this.ctx;r.fillStyle=a.fillStyle,r.strokeStyle=a.strokeStyle,i.fillColor=a.fillStyle,i.strokeColor=a.strokeStyle;break;case $C.UNCOLORED:const o=it.makeHexColor(n[0],n[1],n[2]);r.fillStyle=o,r.strokeStyle=o,i.fillColor=o,i.strokeColor=o;break;default:throw new qM(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,r){let i=n;r!==Pr.SHADING&&(i=it.transform(i,t.baseTransform),this.matrix&&(i=it.transform(i,this.matrix)));const a=this.createPatternCanvas(t);let o=new DOMMatrix(i);o=o.translate(a.offsetX,a.offsetY),o=o.scale(1/a.scaleX,1/a.scaleY);const l=e.createPattern(a.canvas,"repeat");return l.setTransform(o),l}};gt(lw,"MAX_PATTERN_SIZE",3e3);let bA=lw;function yF({src:s,srcPos:e=0,dest:t,width:n,height:r,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const o=Xr.isLittleEndian?4278190080:255,[l,c]=a?[i,o]:[o,i],u=n>>3,f=n&7,p=s.length;t=new Uint32Array(t.buffer);let m=0;for(let b=0;b<r;b++){for(const S=e+u;e<S;e++){const w=e<p?s[e]:255;t[m++]=w&128?c:l,t[m++]=w&64?c:l,t[m++]=w&32?c:l,t[m++]=w&16?c:l,t[m++]=w&8?c:l,t[m++]=w&4?c:l,t[m++]=w&2?c:l,t[m++]=w&1?c:l}if(f===0)continue;const y=e<p?s[e++]:255;for(let S=0;S<f;S++)t[m++]=y&1<<7-S?c:l}return{srcPos:e,destPos:m}}const UC=16,zC=100,bF=15,qC=10,HC=1e3,vi=16;function wF(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(n,r){e.translate(n,r),this.__originalTranslate(n,r)},s.scale=function(n,r){e.scale(n,r),this.__originalScale(n,r)},s.transform=function(n,r,i,a,o,l){e.transform(n,r,i,a,o,l),this.__originalTransform(n,r,i,a,o,l)},s.setTransform=function(n,r,i,a,o,l){e.setTransform(n,r,i,a,o,l),this.__originalSetTransform(n,r,i,a,o,l)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(n){e.rotate(n),this.__originalRotate(n)},s.clip=function(n){e.clip(n),this.__originalClip(n)},s.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},s.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},s.bezierCurveTo=function(t,n,r,i,a,o){e.bezierCurveTo(t,n,r,i,a,o),this.__originalBezierCurveTo(t,n,r,i,a,o)},s.rect=function(t,n,r,i){e.rect(t,n,r,i),this.__originalRect(t,n,r,i)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class xF{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]!==void 0?(r=this.cache[e],this.canvasFactory.reset(r,t,n)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),r}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function ib(s,e,t,n,r,i,a,o,l,c){const[u,f,p,m,b,y]=Fn(s);if(f===0&&p===0){const _=a*u+b,k=Math.round(_),C=o*m+y,B=Math.round(C),F=(a+l)*u+b,j=Math.abs(Math.round(F)-k)||1,T=(o+c)*m+y,W=Math.abs(Math.round(T)-B)||1;return s.setTransform(Math.sign(u),0,0,Math.sign(m),k,B),s.drawImage(e,t,n,r,i,0,0,j,W),s.setTransform(u,f,p,m,b,y),[j,W]}if(u===0&&m===0){const _=o*p+b,k=Math.round(_),C=a*f+y,B=Math.round(C),F=(o+c)*p+b,j=Math.abs(Math.round(F)-k)||1,T=(a+l)*f+y,W=Math.abs(Math.round(T)-B)||1;return s.setTransform(0,Math.sign(f),Math.sign(p),0,k,B),s.drawImage(e,t,n,r,i,0,0,W,j),s.setTransform(u,f,p,m,b,y),[W,j]}s.drawImage(e,t,n,r,i,a,o,l,c);const S=Math.hypot(u,f),w=Math.hypot(p,m);return[S*l,w*c]}function _F(s){const{width:e,height:t}=s;if(e>HC||t>HC)return null;const n=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=e+1;let a=new Uint8Array(i*(t+1)),o,l,c;const u=e+7&-8;let f=new Uint8Array(u*t),p=0;for(const w of s.data){let _=128;for(;_>0;)f[p++]=w&_?0:255,_>>=1}let m=0;for(p=0,f[p]!==0&&(a[0]=1,++m),l=1;l<e;l++)f[p]!==f[p+1]&&(a[l]=f[p]?2:1,++m),p++;for(f[p]!==0&&(a[l]=2,++m),o=1;o<t;o++){p=o*u,c=o*i,f[p-u]!==f[p]&&(a[c]=f[p]?1:8,++m);let w=(f[p]?4:0)+(f[p-u]?8:0);for(l=1;l<e;l++)w=(w>>2)+(f[p+1]?4:0)+(f[p-u+1]?8:0),r[w]&&(a[c+l]=r[w],++m),p++;if(f[p-u]!==f[p]&&(a[c+l]=f[p]?2:4,++m),m>n)return null}for(p=u*(t-1),c=o*i,f[p]!==0&&(a[c]=8,++m),l=1;l<e;l++)f[p]!==f[p+1]&&(a[c+l]=f[p]?4:8,++m),p++;if(f[p]!==0&&(a[c+l]=4,++m),m>n)return null;const b=new Int32Array([0,i,-1,0,-i,0,0,0,1]),y=new Path2D;for(o=0;m&&o<=t;o++){let w=o*i;const _=w+e;for(;w<_&&!a[w];)w++;if(w===_)continue;y.moveTo(w%i,o);const k=w;let C=a[w];do{const B=b[C];do w+=B;while(!a[w]);const F=a[w];F!==5&&F!==10?(C=F,a[w]=0):(C=F&51*C>>4,a[w]&=C>>2|C<<2),y.lineTo(w%i,w/i|0),a[w]||--m}while(k!==w);--o}return f=null,a=null,function(w){w.save(),w.scale(1/e,-1/t),w.translate(0,-t),w.fill(y),w.beginPath(),w.restore()}}class WC{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=wT,this.textMatrixScale=1,this.fontMatrix=G_,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=xr.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=it.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=it.applyTransform(t,e),r=it.applyTransform(t.slice(2),e),i=it.applyTransform([t[0],t[3]],e),a=it.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,n[0],r[0],i[0],a[0]),this.minY=Math.min(this.minY,n[1],r[1],i[1],a[1]),this.maxX=Math.max(this.maxX,n[0],r[0],i[0],a[0]),this.maxY=Math.max(this.maxY,n[1],r[1],i[1],a[1])}updateScalingPathMinMax(e,t){it.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,r,i,a,o,l,c,u){const f=it.bezierBoundingBox(t,n,r,i,a,o,l,c,u);u||this.updateRectMinMax(e,f)}getPathBoundingBox(e=Pr.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===Pr.STROKE){t||An("Stroke bounding box must include transform.");const r=it.singularValueDecompose2dScale(t),i=r[0]*this.lineWidth/2,a=r[1]*this.lineWidth/2;n[0]-=i,n[1]-=a,n[2]+=i,n[3]+=a}return n}updateClipFromPath(){const e=it.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Pr.FILL,t=null){return it.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function VC(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,n=e.width,r=t%vi,i=(t-r)/vi,a=r===0?i:i+1,o=s.createImageData(n,vi);let l=0,c;const u=e.data,f=o.data;let p,m,b,y;if(e.kind===jb.GRAYSCALE_1BPP){const S=u.byteLength,w=new Uint32Array(f.buffer,0,f.byteLength>>2),_=w.length,k=n+7>>3,C=4294967295,B=Xr.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(b=p<i?vi:r,c=0,m=0;m<b;m++){const F=S-l;let j=0;const T=F>k?n:F*8-7,W=T&-8;let Y=0,I=0;for(;j<W;j+=8)I=u[l++],w[c++]=I&128?C:B,w[c++]=I&64?C:B,w[c++]=I&32?C:B,w[c++]=I&16?C:B,w[c++]=I&8?C:B,w[c++]=I&4?C:B,w[c++]=I&2?C:B,w[c++]=I&1?C:B;for(;j<T;j++)Y===0&&(I=u[l++],Y=128),w[c++]=I&Y?C:B,Y>>=1}for(;c<_;)w[c++]=0;s.putImageData(o,0,p*vi)}}else if(e.kind===jb.RGBA_32BPP){for(m=0,y=n*vi*4,p=0;p<i;p++)f.set(u.subarray(l,l+y)),l+=y,s.putImageData(o,0,m),m+=vi;p<a&&(y=n*r*4,f.set(u.subarray(l,l+y)),s.putImageData(o,0,m))}else if(e.kind===jb.RGB_24BPP)for(b=vi,y=n*b,p=0;p<a;p++){for(p>=i&&(b=r,y=n*b),c=0,m=y;m--;)f[c++]=u[l++],f[c++]=u[l++],f[c++]=u[l++],f[c++]=255;s.putImageData(o,0,p*vi)}else throw new Error(`bad image kind: ${e.kind}`)}function GC(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,r=t%vi,i=(t-r)/vi,a=r===0?i:i+1,o=s.createImageData(n,vi);let l=0;const c=e.data,u=o.data;for(let f=0;f<a;f++){const p=f<i?vi:r;({srcPos:l}=yF({src:c,srcPos:l,dest:u,width:n,height:p,nonBlackColor:0})),s.putImageData(o,0,f*vi)}}function Vg(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)s[n]!==void 0&&(e[n]=s[n]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function ab(s){if(s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0),!Tr){const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}}function XC(s,e){if(e)return!0;const t=it.singularValueDecompose2dScale(s);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const n=Math.fround((globalThis.devicePixelRatio||1)*Xu.PDF_TO_CSS_UNITS);return t[0]<=n&&t[1]<=n}const AF=["butt","round","square"],SF=["miter","round","bevel"],kF={},KC={};var xo,wA,xA,_A;const k3=class k3{constructor(e,t,n,r,i,{optionalContentConfig:a,markedContentStack:o=null},l,c){$(this,xo);this.ctx=e,this.current=new WC(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new xF(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){const i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,n){const l=this.cachedCanvases.getCanvas("transparent",i,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Fn(this.compositeCtx))}this.ctx.save(),ab(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Fn(this.ctx)}executeOperatorList(e,t,n,r){const i=e.argsArray,a=e.fnArray;let o=t||0;const l=i.length;if(l===o)return o;const c=l-o>qC&&typeof n=="function",u=c?Date.now()+bF:0;let f=0;const p=this.commonObjs,m=this.objs;let b;for(;;){if(r!==void 0&&o===r.nextBreakPoint)return r.breakIt(o,n),o;if(b=a[o],b!==Ja.dependency)this[b].apply(this,i[o]);else for(const y of i[o]){const S=y.startsWith("g_")?p:m;if(!S.has(y))return S.get(y,n),o}if(o++,o===l)return o;if(c&&++f>qC){if(Date.now()>u)return n(),o;f=0}}}endDrawing(){z(this,xo,wA).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),z(this,xo,xA).call(this)}_scaleImage(e,t){const n=e.width??e.displayWidth,r=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=n,l=r,c="prescale1",u,f;for(;i>2&&o>1||a>2&&l>1;){let p=o,m=l;i>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/p),a>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/m),u=this.cachedCanvases.getCanvas(c,p,m),f=u.context,f.clearRect(0,0,p,m),f.drawImage(e,0,0,o,l,0,0,p,m),e=u.canvas,o=p,l=m,c=c==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:r}=e,i=this.current.fillColor,a=this.current.patternFill,o=Fn(t);let l,c,u,f;if((e.bitmap||e.data)&&e.count>1){const T=e.bitmap||e.data.buffer;c=JSON.stringify(a?o:[o.slice(0,4),i]),l=this._cachedBitmapsMap.get(T),l||(l=new Map,this._cachedBitmapsMap.set(T,l));const W=l.get(c);if(W&&!a){const Y=Math.round(Math.min(o[0],o[2])+o[4]),I=Math.round(Math.min(o[1],o[3])+o[5]);return{canvas:W,offsetX:Y,offsetY:I}}u=W}u||(f=this.cachedCanvases.getCanvas("maskCanvas",n,r),GC(f.context,e));let p=it.transform(o,[1/n,0,0,-1/r,0,0]);p=it.transform(p,[1,0,0,1,0,-r]);const[m,b,y,S]=it.getAxialAlignedBoundingBox([0,0,n,r],p),w=Math.round(y-m)||1,_=Math.round(S-b)||1,k=this.cachedCanvases.getCanvas("fillCanvas",w,_),C=k.context,B=m,F=b;C.translate(-B,-F),C.transform(...p),u||(u=this._scaleImage(f.canvas,Oo(C)),u=u.img,l&&a&&l.set(c,u)),C.imageSmoothingEnabled=XC(Fn(C),e.interpolate),ib(C,u,0,0,u.width,u.height,0,0,n,r),C.globalCompositeOperation="source-in";const j=it.transform(Oo(C),[1,0,0,1,-B,-F]);return C.fillStyle=a?i.getPattern(t,this,j,Pr.FILL):i,C.fillRect(0,0,n,r),l&&!a&&(this.cachedCanvases.delete("fillCanvas"),l.set(c,k.canvas)),{canvas:k.canvas,offsetX:Math.round(B),offsetY:Math.round(F)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=AF[e]}setLineJoin(e){this.ctx.lineJoin=SF[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;n.setLineDash!==void 0&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=r.context;const i=this.ctx;i.setTransform(...Fn(this.suspendedCtx)),Vg(this.suspendedCtx,i),wF(i,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Vg(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){const i=r[0],a=r[1],o=r[2]-i,l=r[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,n,o,l,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,i,a,o,l,c,u,f){let p=e.canvas,m=l-u,b=c-f;if(a){const S=it.makeHexColor(...a);if(m<0||b<0||m+n>p.width||b+r>p.height){const w=this.cachedCanvases.getCanvas("maskExtension",n,r),_=w.context;_.drawImage(p,-m,-b),_.globalCompositeOperation="destination-atop",_.fillStyle=S,_.fillRect(0,0,n,r),_.globalCompositeOperation="source-over",p=w.canvas,m=b=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(m,b,n,r),e.clip(w),e.globalCompositeOperation="destination-atop",e.fillStyle=S,e.fillRect(m,b,n,r),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const y=new Path2D;y.rect(l,c,n,r),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(p,m,b,n,r,l,c,n,r),t.restore()}save(){this.inSMaskMode?(Vg(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Vg(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,r,i,a){this.ctx.transform(e,t,n,r,i,a),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const r=this.ctx,i=this.current;let a=i.x,o=i.y,l,c;const u=Fn(r),f=u[0]===0&&u[3]===0||u[1]===0&&u[2]===0,p=f?n.slice(0):null;for(let m=0,b=0,y=e.length;m<y;m++)switch(e[m]|0){case Ja.rectangle:a=t[b++],o=t[b++];const S=t[b++],w=t[b++],_=a+S,k=o+w;r.moveTo(a,o),S===0||w===0?r.lineTo(_,k):(r.lineTo(_,o),r.lineTo(_,k),r.lineTo(a,k)),f||i.updateRectMinMax(u,[a,o,_,k]),r.closePath();break;case Ja.moveTo:a=t[b++],o=t[b++],r.moveTo(a,o),f||i.updatePathMinMax(u,a,o);break;case Ja.lineTo:a=t[b++],o=t[b++],r.lineTo(a,o),f||i.updatePathMinMax(u,a,o);break;case Ja.curveTo:l=a,c=o,a=t[b+4],o=t[b+5],r.bezierCurveTo(t[b],t[b+1],t[b+2],t[b+3],a,o),i.updateCurvePathMinMax(u,l,c,t[b],t[b+1],t[b+2],t[b+3],a,o,p),b+=6;break;case Ja.curveTo2:l=a,c=o,r.bezierCurveTo(a,o,t[b],t[b+1],t[b+2],t[b+3]),i.updateCurvePathMinMax(u,l,c,a,o,t[b],t[b+1],t[b+2],t[b+3],p),a=t[b+2],o=t[b+3],b+=4;break;case Ja.curveTo3:l=a,c=o,a=t[b+2],o=t[b+3],r.bezierCurveTo(t[b],t[b+1],a,o,a,o),i.updateCurvePathMinMax(u,l,c,t[b],t[b+1],a,o,a,o,p),b+=4;break;case Ja.closePath:r.closePath();break}f&&i.updateScalingPathMinMax(u,p),i.setCurrentPoint(a,o)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof n=="object"&&(n!=null&&n.getPattern)?(t.save(),t.strokeStyle=n.getPattern(t,this,Oo(t),Pr.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;let i=!1;r&&(t.save(),t.fillStyle=n.getPattern(t,this,Oo(t),Pr.FILL),i=!0);const a=this.current.getClippedPathBoundingBox();this.contentVisible&&a!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(a)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=kF}eoClip(){this.pendingClip=KC}beginText(){this.current.textMatrix=wT,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const n=new Path2D,r=t.getTransform().invertSelf();for(const{transform:i,x:a,y:o,fontSize:l,path:c}of e)n.addPath(c,new DOMMatrix(i).preMultiplySelf(r).translate(a,o).scale(l,-l));t.clip(n),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var u;const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||G_,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&Ot("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const i=n.loadedName||"sans-serif",a=((u=n.systemFontInfo)==null?void 0:u.css)||`"${i}", ${n.fallbackName}`;let o="normal";n.black?o="900":n.bold&&(o="bold");const l=n.italic?"italic":"normal";let c=t;t<UC?c=UC:t>zC&&(c=zC),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${o} ${c}px ${a}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,r,i,a){this.current.textMatrix=[e,t,n,r,i,a],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,r,i){const a=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,u=o.fontSize/o.fontSizeScale,f=c&xr.FILL_STROKE_MASK,p=!!(c&xr.ADD_TO_PATH_FLAG),m=o.patternFill&&!l.missingFile,b=o.patternStroke&&!l.missingFile;let y;if((l.disableFontFace||p||m||b)&&(y=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||b){if(a.save(),a.translate(t,n),a.scale(u,-u),f===xr.FILL||f===xr.FILL_STROKE)if(r){const S=a.getTransform();a.setTransform(...r),a.fill(z(this,xo,_A).call(this,y,S,r))}else a.fill(y);if(f===xr.STROKE||f===xr.FILL_STROKE)if(i){const S=a.getTransform();a.setTransform(...i),a.stroke(z(this,xo,_A).call(this,y,S,i))}else a.lineWidth/=u,a.stroke(y);a.restore()}else(f===xr.FILL||f===xr.FILL_STROKE)&&a.fillText(e,t,n),(f===xr.STROKE||f===xr.FILL_STROKE)&&a.strokeText(e,t,n);p&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Fn(a),x:t,y:n,fontSize:u,path:y})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return zt(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const r=t.fontSize;if(r===0)return;const i=this.ctx,a=t.fontSizeScale,o=t.charSpacing,l=t.wordSpacing,c=t.fontDirection,u=t.textHScale*c,f=e.length,p=n.vertical,m=p?1:-1,b=n.defaultVMetrics,y=r*t.fontMatrix[0],S=t.textRenderingMode===xr.FILL&&!n.disableFontFace&&!t.patternFill;i.save(),i.transform(...t.textMatrix),i.translate(t.x,t.y+t.textRise),c>0?i.scale(u,-1):i.scale(u,1);let w,_;if(t.patternFill){i.save();const j=t.fillColor.getPattern(i,this,Oo(i),Pr.FILL);w=Fn(i),i.restore(),i.fillStyle=j}if(t.patternStroke){i.save();const j=t.strokeColor.getPattern(i,this,Oo(i),Pr.STROKE);_=Fn(i),i.restore(),i.strokeStyle=j}let k=t.lineWidth;const C=t.textMatrixScale;if(C===0||k===0){const j=t.textRenderingMode&xr.FILL_STROKE_MASK;(j===xr.STROKE||j===xr.FILL_STROKE)&&(k=this.getSinglePixelWidth())}else k/=C;if(a!==1&&(i.scale(a,a),k/=a),i.lineWidth=k,n.isInvalidPDFjsFont){const j=[];let T=0;for(const W of e)j.push(W.unicode),T+=W.width;i.fillText(j.join(""),0,0),t.x+=T*y*u,i.restore(),this.compose();return}let B=0,F;for(F=0;F<f;++F){const j=e[F];if(typeof j=="number"){B+=m*j*r/1e3;continue}let T=!1;const W=(j.isSpace?l:0)+o,Y=j.fontChar,I=j.accent;let O,X,K=j.width;if(p){const te=j.vmetric||b,ue=-(j.vmetric?te[1]:K*.5)*y,Z=te[2]*y;K=te?-te[0]:K,O=ue/a,X=(B+Z)/a}else O=B/a,X=0;if(n.remeasure&&K>0){const te=i.measureText(Y).width*1e3/r*a;if(K<te&&this.isFontSubpixelAAEnabled){const ue=K/te;T=!0,i.save(),i.scale(ue,1),O/=ue}else K!==te&&(O+=(K-te)/2e3*r/a)}if(this.contentVisible&&(j.isInFont||n.missingFile)){if(S&&!I)i.fillText(Y,O,X);else if(this.paintChar(Y,O,X,w,_),I){const te=O+r*I.offset.x/a,ue=X-r*I.offset.y/a;this.paintChar(I.fontChar,te,ue,w,_)}}const ne=p?K*y-W*c:K*y+W*c;B+=ne,T&&i.restore()}p?t.y-=B:t.x+=B*u,i.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,r=n.font,i=n.fontSize,a=n.fontDirection,o=r.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,u=n.textHScale*a,f=n.fontMatrix||G_,p=e.length,m=n.textRenderingMode===xr.INVISIBLE;let b,y,S,w;if(!(m||i===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(u,a),b=0;b<p;++b){if(y=e[b],typeof y=="number"){w=o*y*i/1e3,this.ctx.translate(w,0),n.x+=w*u;continue}const _=(y.isSpace?c:0)+l,k=r.charProcOperatorList[y.operatorListId];if(!k){Ot(`Type3 character "${y.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=y,this.save(),t.scale(i,i),t.transform(...f),this.executeOperatorList(k),this.restore()),S=it.applyTransform([y.width,0],f)[0]*i+_,t.translate(S,0),n.x+=S*u}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,r,i,a){this.ctx.rect(n,r,i-n,a-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const n=e[1],r=this.baseTransform||Fn(this.ctx),i={createCanvasGraphics:a=>new k3(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new bA(e,n,this.ctx,i,r)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){this.ctx.strokeStyle=this.current.strokeColor=it.makeHexColor(e,t,n),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,n){this.ctx.fillStyle=this.current.fillColor=it.makeHexColor(e,t,n),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=vF(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,Oo(t),Pr.SHADING);const r=Oo(t);if(r){const{width:i,height:a}=t.canvas,[o,l,c,u]=it.getAxialAlignedBoundingBox([0,0,i,a],r);this.ctx.fillRect(o,l,c-o,u-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){An("Should not call beginInlineImage")}beginImageData(){An("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=Fn(this.ctx),t)){const n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.current.updateRectMinMax(Fn(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||Jw("TODO: Support non-isolated groups."),e.knockout&&Ot("Knockout groups not supported.");const n=Fn(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=it.getAxialAlignedBoundingBox(e.bbox,Fn(t));const i=[0,0,t.canvas.width,t.canvas.height];r=it.intersect(r,i)||[0,0,0,0];const a=Math.floor(r[0]),o=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-o,1);this.current.startNewPathAndClipBox([0,0,l,c]);let u="groupAt"+this.groupLevel;e.smask&&(u+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(u,l,c),p=f.context;p.translate(-a,-o),p.transform(...n),e.smask?this.smaskStack.push({canvas:f.canvas,context:p,offsetX:a,offsetY:o,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,o),t.save()),Vg(t,p),this.ctx=p,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=Fn(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const i=it.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],r);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(i)}}beginAnnotation(e,t,n,r,i){if(z(this,xo,wA).call(this),ab(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const a=t[2]-t[0],o=t[3]-t[1];if(i&&this.annotationCanvasMap){n=n.slice(),n[4]-=t[0],n[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=a,t[3]=o;const[l,c]=it.singularValueDecompose2dScale(Fn(this.ctx)),{viewportScale:u}=this,f=Math.ceil(a*this.outputScaleX*u),p=Math.ceil(o*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:m,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(l,0,0,-c,0,o*c),ab(this.ctx)}else ab(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],a,o),this.ctx.clip(),this.ctx.beginPath()}this.current=new WC(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),z(this,xo,xA).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const n=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=_F(e)),r.compiled)){r.compiled(n);return}const i=this._createMaskCanvas(e),a=i.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(a,i.offsetX,i.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,r=0,i,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const o=this.ctx;o.save();const l=Fn(o);o.transform(t,n,r,i,0,0);const c=this._createMaskCanvas(e);o.setTransform(1,0,0,1,c.offsetX-l[4],c.offsetY-l[5]);for(let u=0,f=a.length;u<f;u+=2){const p=it.transform(l,[t,n,r,i,a[u],a[u+1]]),[m,b]=it.applyTransform([0,0],p);o.drawImage(c.canvas,m,b)}o.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,r=this.current.patternFill;for(const i of e){const{data:a,width:o,height:l,transform:c}=i,u=this.cachedCanvases.getCanvas("maskCanvas",o,l),f=u.context;f.save();const p=this.getObject(a,i);GC(f,p),f.globalCompositeOperation="source-in",f.fillStyle=r?n.getPattern(f,this,Oo(t),Pr.FILL):n,f.fillRect(0,0,o,l),f.restore(),t.save(),t.transform(...c),t.scale(1,-1),ib(t,u.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){Ot("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,n,r){if(!this.contentVisible)return;const i=this.getObject(e);if(!i){Ot("Dependent image isn't ready yet");return}const a=i.width,o=i.height,l=[];for(let c=0,u=r.length;c<u;c+=2)l.push({transform:[t,0,0,n,r[c],r[c+1]],x:0,y:0,w:a,h:o});this.paintInlineImageXObjectGroup(i,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:r}=e,i=this.cachedCanvases.getCanvas("inlineImage",n,r),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,r=this.ctx;if(this.save(),!Tr){const{filter:o}=r;o!=="none"&&o!==""&&(r.filter="none")}r.scale(1/t,-1/n);let i;if(e.bitmap)i=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)i=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,n).context;VC(l,e),i=this.applyTransferMapsToCanvas(l)}const a=this._scaleImage(i,Oo(r));r.imageSmoothingEnabled=XC(Fn(r),e.interpolate),ib(r,a.img,0,0,a.paintWidth,a.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let r;if(e.bitmap)r=e.bitmap;else{const i=e.width,a=e.height,l=this.cachedCanvases.getCanvas("inlineImage",i,a).context;VC(l,e),r=this.applyTransferMapsToCanvas(l)}for(const i of t)n.save(),n.transform(...i.transform),n.scale(1,-1),ib(n,r,i.x,i.y,i.w,i.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===KC?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Fn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:r,d:i}=this.ctx.getTransform();let a,o;if(n===0&&r===0){const l=Math.abs(t),c=Math.abs(i);if(l===c)if(e===0)a=o=1/l;else{const u=l*e;a=o=u<1?1/u:1}else if(e===0)a=1/l,o=1/c;else{const u=l*e,f=c*e;a=u<1?1/u:1,o=f<1?1/f:1}}else{const l=Math.abs(t*i-n*r),c=Math.hypot(t,n),u=Math.hypot(r,i);if(e===0)a=u/l,o=c/l;else{const f=e*l;a=u>f?u/f:1,o=c>f?c/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[r,i]=this.getScaleForStroking();if(t.lineWidth=n||1,r===1&&i===1){t.stroke();return}const a=t.getLineDash();if(e&&t.save(),t.scale(r,i),a.length>0){const o=Math.max(r,i);t.setLineDash(a.map(l=>l/o)),t.lineDashOffset/=o}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};xo=new WeakSet,wA=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},xA=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},_A=function(e,t,n){const r=new Path2D;return r.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),r};let jp=k3;for(const s in Ja)jp.prototype[s]!==void 0&&(jp.prototype[Ja[s]]=jp.prototype[s]);var U1,z1;class oc{static get workerPort(){return d(this,U1)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");E(this,U1,e)}static get workerSrc(){return d(this,z1)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");E(this,z1,e)}}U1=new WeakMap,z1=new WeakMap,$(oc,U1,null),$(oc,z1,"");var uh,q1;class NF{constructor({parsedData:e,rawData:t}){$(this,uh);$(this,q1);E(this,uh,e),E(this,q1,t)}getRaw(){return d(this,q1)}get(e){return d(this,uh).get(e)??null}getAll(){return a3(d(this,uh))}has(e){return d(this,uh).has(e)}}uh=new WeakMap,q1=new WeakMap;const ep=Symbol("INTERNAL");var H1,W1,V1,sm;class CF{constructor(e,{name:t,intent:n,usage:r,rbGroups:i}){$(this,H1,!1);$(this,W1,!1);$(this,V1,!1);$(this,sm,!0);E(this,H1,!!(e&Gi.DISPLAY)),E(this,W1,!!(e&Gi.PRINT)),this.name=t,this.intent=n,this.usage=r,this.rbGroups=i}get visible(){if(d(this,V1))return d(this,sm);if(!d(this,sm))return!1;const{print:e,view:t}=this.usage;return d(this,H1)?(t==null?void 0:t.viewState)!=="OFF":d(this,W1)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,n=!1){e!==ep&&An("Internal method `_setVisible` called."),E(this,V1,n),E(this,sm,t)}}H1=new WeakMap,W1=new WeakMap,V1=new WeakMap,sm=new WeakMap;var pu,hn,rm,im,G1,AA;class EF{constructor(e,t=Gi.DISPLAY){$(this,G1);$(this,pu,null);$(this,hn,new Map);$(this,rm,null);$(this,im,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,E(this,im,e.order);for(const n of e.groups)d(this,hn).set(n.id,new CF(t,n));if(e.baseState==="OFF")for(const n of d(this,hn).values())n._setVisible(ep,!1);for(const n of e.on)d(this,hn).get(n)._setVisible(ep,!0);for(const n of e.off)d(this,hn).get(n)._setVisible(ep,!1);E(this,rm,this.getHash())}}isVisible(e){if(d(this,hn).size===0)return!0;if(!e)return Jw("Optional content group not defined."),!0;if(e.type==="OCG")return d(this,hn).has(e.id)?d(this,hn).get(e.id).visible:(Ot(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return z(this,G1,AA).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!d(this,hn).has(t))return Ot(`Optional content group not found: ${t}`),!0;if(d(this,hn).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!d(this,hn).has(t))return Ot(`Optional content group not found: ${t}`),!0;if(!d(this,hn).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!d(this,hn).has(t))return Ot(`Optional content group not found: ${t}`),!0;if(!d(this,hn).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!d(this,hn).has(t))return Ot(`Optional content group not found: ${t}`),!0;if(d(this,hn).get(t).visible)return!1}return!0}return Ot(`Unknown optional content policy ${e.policy}.`),!0}return Ot(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){var i;const r=d(this,hn).get(e);if(!r){Ot(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(const a of r.rbGroups)for(const o of a)o!==e&&((i=d(this,hn).get(o))==null||i._setVisible(ep,!1,!0));r._setVisible(ep,!!t,!0),E(this,pu,null)}setOCGState({state:e,preserveRB:t}){let n;for(const r of e){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const i=d(this,hn).get(r);if(i)switch(n){case"ON":this.setVisibility(r,!0,t);break;case"OFF":this.setVisibility(r,!1,t);break;case"Toggle":this.setVisibility(r,!i.visible,t);break}}E(this,pu,null)}get hasInitialVisibility(){return d(this,rm)===null||this.getHash()===d(this,rm)}getOrder(){return d(this,hn).size?d(this,im)?d(this,im).slice():[...d(this,hn).keys()]:null}getGroups(){return d(this,hn).size>0?a3(d(this,hn)):null}getGroup(e){return d(this,hn).get(e)||null}getHash(){if(d(this,pu)!==null)return d(this,pu);const e=new JT;for(const[t,n]of d(this,hn))e.update(`${t}:${n.visible}`);return E(this,pu,e.hexdigest())}}pu=new WeakMap,hn=new WeakMap,rm=new WeakMap,im=new WeakMap,G1=new WeakSet,AA=function(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let r=1;r<t;r++){const i=e[r];let a;if(Array.isArray(i))a=z(this,G1,AA).call(this,i);else if(d(this,hn).has(i))a=d(this,hn).get(i).visible;else return Ot(`Optional content group not found: ${i}`),!0;switch(n){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return n==="And"};class PF{constructor(e,{disableRange:t=!1,disableStream:n=!1}){_s(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,c)=>{this._onReceiveData({begin:l,chunk:c})}),e.addProgressListener((l,c)=>{this._onProgress({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(n),!0)});_s(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,n,r,i;e.total===void 0?(n=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||n.call(t,{loaded:e.loaded}):(i=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||i.call(r,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){_s(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new LF(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new TF(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeReaders.slice(0))n.cancel(e);this._pdfDataRangeTransport.abort()}}class LF{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=c3(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class TF{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function IF(s){let e=!0,t=n("filename\\*","i").exec(s);if(t){t=t[1];let u=o(t);return u=unescape(u),u=l(u),u=c(u),i(u)}if(t=a(s),t){const u=c(t);return i(u)}if(t=n("filename","i").exec(s),t){t=t[1];let u=o(t);return u=c(u),i(u)}function n(u,f){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function r(u,f){if(u){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(u,{fatal:!0}),m=Qw(f);f=p.decode(m),e=!1}catch{}}return f}function i(u){return e&&/[\x80-\xff]/.test(u)&&(u=r("utf-8",u),e&&(u=r("iso-8859-1",u))),u}function a(u){const f=[];let p;const m=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=m.exec(u))!==null;){let[,y,S,w]=p;if(y=parseInt(y,10),y in f){if(y===0)break;continue}f[y]=[S,w]}const b=[];for(let y=0;y<f.length&&y in f;++y){let[S,w]=f[y];w=o(w),S&&(w=unescape(w),y===0&&(w=l(w))),b.push(w)}return b.join("")}function o(u){if(u.startsWith('"')){const f=u.slice(1).split('\\"');for(let p=0;p<f.length;++p){const m=f[p].indexOf('"');m!==-1&&(f[p]=f[p].slice(0,m),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}u=f.join('"')}return u}function l(u){const f=u.indexOf("'");if(f===-1)return u;const p=u.slice(0,f),b=u.slice(f+1).replace(/^[^']*'/,"");return r(p,b)}function c(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,m,b){if(m==="q"||m==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,S){return String.fromCharCode(parseInt(S,16))}),r(p,b);try{b=atob(b)}catch{}return r(p,b)})}return""}function d6(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const n in e){const r=e[n];r!==void 0&&t.append(n,r)}return t}function t5(s){try{return new URL(s).origin}catch{}return null}function h6({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(s.get("Content-Length"),10);return!Number.isInteger(i)||(r.suggestedLength=i,i<=2*t)||n||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function f6(s){const e=s.get("Content-Disposition");if(e){let t=IF(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(c3(t))return t}return null}function n5(s,e){return s===404||s===0&&e.startsWith("file:")?new o1('Missing PDF "'+e+'".'):new U2(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s)}function p6(s){return s===200||s===206}function m6(s,e,t){return{method:"GET",headers:s,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function g6(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(Ot(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class YC{constructor(e){gt(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=d6(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return _s(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new jF(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new RF(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class jF{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),r=t.url;fetch(r,m6(n,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=t5(i.url),!p6(i.status))throw n5(i.status,r);this._reader=i.body.getReader(),this._headersCapability.resolve();const a=i.headers,{allowRangeRequests:o,suggestedLength:l}=h6({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=f6(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Gu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:g6(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class RF{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${n-1}`);const a=r.url;fetch(a,m6(i,this._withCredentials,this._abortController)).then(o=>{const l=t5(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!p6(o.status))throw n5(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:g6(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const xx=200,_x=206;function OF(s){const e=s.response;return typeof e!="string"?e:Qw(e).buffer}class MF{constructor({url:e,httpHeaders:t,withCredentials:n}){gt(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=d6(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=_x):r.expectedStatus=xx,t.responseType="arraybuffer",_s(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){var r;const n=this.pendingRequests[e];n&&((r=n.onProgress)==null||r.call(n,t))}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError(r.status);return}const i=r.status||xx;if(!(i===xx&&n.expectedStatus===_x)&&i!==n.expectedStatus){n.onError(r.status);return}const o=OF(r);if(i===_x){const l=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);c?n.onDone({begin:parseInt(c[1],10),chunk:o}):(Ot('Missing or invalid "Content-Range" header.'),n.onError(0))}else o?n.onDone({begin:0,chunk:o}):n.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class FF{constructor(e){this._source=e,this._manager=new MF(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return _s(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new DF(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new BF(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class DF{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=t5(t.responseURL);const n=t.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...c]=o.split(": ");return[l,c.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:a}=h6({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=f6(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=n5(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class BF{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=t5((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=n5(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const $F=/^[a-z][a-z0-9\-+.]+:/i;function UF(s){if($F.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}class zF{constructor(e){this.source=e,this.url=UF(e.url),_s(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return _s(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new qF(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new HF(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const n of this._rangeRequestReaders.slice(0))n.cancel(e)}}class qF{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new o1(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Gu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class HF{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=e.source;this._isStreamingSupported=!r.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const WF=1e5,ci=30,VF=.8;var HE,mu,mi,X1,K1,dh,Wl,Y1,J1,hh,am,om,gu,lm,Q1,cm,fh,Z1,ev,ph,mh,tv,vu,um,yc,v6,y6,SA,ea,Hb,kA,b6,w6;const Ps=class Ps{constructor({textContentSource:e,container:t,viewport:n}){$(this,yc);$(this,mu,Promise.withResolvers());$(this,mi,null);$(this,X1,!1);$(this,K1,!!((HE=globalThis.FontInspector)!=null&&HE.enabled));$(this,dh,null);$(this,Wl,null);$(this,Y1,0);$(this,J1,0);$(this,hh,null);$(this,am,null);$(this,om,0);$(this,gu,0);$(this,lm,Object.create(null));$(this,Q1,[]);$(this,cm,null);$(this,fh,[]);$(this,Z1,new WeakMap);$(this,ev,null);var l;if(e instanceof ReadableStream)E(this,cm,e);else if(typeof e=="object")E(this,cm,new ReadableStream({start(c){c.enqueue(e),c.close()}}));else throw new Error('No "textContentSource" parameter specified.');E(this,mi,E(this,am,t)),E(this,gu,n.scale*(globalThis.devicePixelRatio||1)),E(this,om,n.rotation),E(this,Wl,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:i,pageX:a,pageY:o}=n.rawDims;E(this,ev,[1,0,0,-1,-a,o+i]),E(this,J1,r),E(this,Y1,i),z(l=Ps,ea,b6).call(l),ef(t,n),d(this,mu).promise.finally(()=>{d(Ps,um).delete(this),E(this,Wl,null),E(this,lm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Xr.platform;return zt(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{d(this,hh).read().then(({value:t,done:n})=>{if(n){d(this,mu).resolve();return}d(this,dh)??E(this,dh,t.lang),Object.assign(d(this,lm),t.styles),z(this,yc,v6).call(this,t.items),e()},d(this,mu).reject)};return E(this,hh,d(this,cm).getReader()),d(Ps,um).add(this),e(),d(this,mu).promise}update({viewport:e,onBefore:t=null}){var i;const n=e.scale*(globalThis.devicePixelRatio||1),r=e.rotation;if(r!==d(this,om)&&(t==null||t(),E(this,om,r),ef(d(this,am),{rotation:r})),n!==d(this,gu)){t==null||t(),E(this,gu,n);const a={div:null,properties:null,ctx:z(i=Ps,ea,Hb).call(i,d(this,dh))};for(const o of d(this,fh))a.properties=d(this,Z1).get(o),a.div=o,z(this,yc,SA).call(this,a)}}cancel(){var t;const e=new Gu("TextLayer task cancelled.");(t=d(this,hh))==null||t.cancel(e).catch(()=>{}),E(this,hh,null),d(this,mu).reject(e)}get textDivs(){return d(this,fh)}get textContentItemsStr(){return d(this,Q1)}static cleanup(){if(!(d(this,um).size>0)){d(this,ph).clear();for(const{canvas:e}of d(this,mh).values())e.remove();d(this,mh).clear()}}};mu=new WeakMap,mi=new WeakMap,X1=new WeakMap,K1=new WeakMap,dh=new WeakMap,Wl=new WeakMap,Y1=new WeakMap,J1=new WeakMap,hh=new WeakMap,am=new WeakMap,om=new WeakMap,gu=new WeakMap,lm=new WeakMap,Q1=new WeakMap,cm=new WeakMap,fh=new WeakMap,Z1=new WeakMap,ev=new WeakMap,ph=new WeakMap,mh=new WeakMap,tv=new WeakMap,vu=new WeakMap,um=new WeakMap,yc=new WeakSet,v6=function(e){var r,i;if(d(this,X1))return;(i=d(this,Wl)).ctx??(i.ctx=z(r=Ps,ea,Hb).call(r,d(this,dh)));const t=d(this,fh),n=d(this,Q1);for(const a of e){if(t.length>WF){Ot("Ignoring additional textDivs for performance reasons."),E(this,X1,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=d(this,mi);E(this,mi,document.createElement("span")),d(this,mi).classList.add("markedContent"),a.id!==null&&d(this,mi).setAttribute("id",`${a.id}`),o.append(d(this,mi))}else a.type==="endMarkedContent"&&E(this,mi,d(this,mi).parentNode);continue}n.push(a.str),z(this,yc,y6).call(this,a)}},y6=function(e){var y;const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};d(this,fh).push(t);const r=it.transform(d(this,ev),e.transform);let i=Math.atan2(r[1],r[0]);const a=d(this,lm)[e.fontName];a.vertical&&(i+=Math.PI/2);let o=d(this,K1)&&a.fontSubstitution||a.fontFamily;o=Ps.fontFamilyMap.get(o)||o;const l=Math.hypot(r[2],r[3]),c=l*z(y=Ps,ea,w6).call(y,o,d(this,dh));let u,f;i===0?(u=r[4],f=r[5]-c):(u=r[4]+c*Math.sin(i),f=r[5]-c*Math.cos(i));const p="calc(var(--scale-factor)*",m=t.style;d(this,mi)===d(this,am)?(m.left=`${(100*u/d(this,J1)).toFixed(2)}%`,m.top=`${(100*f/d(this,Y1)).toFixed(2)}%`):(m.left=`${p}${u.toFixed(2)}px)`,m.top=`${p}${f.toFixed(2)}px)`),m.fontSize=`${p}${(d(Ps,vu)*l).toFixed(2)}px)`,m.fontFamily=o,n.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,d(this,K1)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),i!==0&&(n.angle=i*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const S=Math.abs(e.transform[0]),w=Math.abs(e.transform[3]);S!==w&&Math.max(S,w)/Math.min(S,w)>1.5&&(b=!0)}if(b&&(n.canvasWidth=a.vertical?e.height:e.width),d(this,Z1).set(t,n),d(this,Wl).div=t,d(this,Wl).properties=n,z(this,yc,SA).call(this,d(this,Wl)),n.hasText&&d(this,mi).append(t),n.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),d(this,mi).append(S)}},SA=function(e){var o;const{div:t,properties:n,ctx:r}=e,{style:i}=t;let a="";if(d(Ps,vu)>1&&(a=`scale(${1/d(Ps,vu)})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=i,{canvasWidth:c,fontSize:u}=n;z(o=Ps,ea,kA).call(o,r,u*d(this,gu),l);const{width:f}=r.measureText(t.textContent);f>0&&(a=`scaleX(${c*d(this,gu)/f}) ${a}`)}n.angle!==0&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(i.transform=a)},ea=new WeakSet,Hb=function(e=null){let t=d(this,mh).get(e||(e=""));if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),d(this,mh).set(e,t),d(this,tv).set(t,{size:0,family:""})}return t},kA=function(e,t,n){const r=d(this,tv).get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)},b6=function(){if(d(this,vu)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),E(this,vu,e.getBoundingClientRect().height),e.remove()},w6=function(e,t){const n=d(this,ph).get(e);if(n)return n;const r=z(this,ea,Hb).call(this,t);r.canvas.width=r.canvas.height=ci,z(this,ea,kA).call(this,r,ci,e);const i=r.measureText("");let a=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(a){const u=a/(a+o);return d(this,ph).set(e,u),r.canvas.width=r.canvas.height=0,u}r.strokeStyle="red",r.clearRect(0,0,ci,ci),r.strokeText("g",0,0);let l=r.getImageData(0,0,ci,ci).data;o=0;for(let u=l.length-1-3;u>=0;u-=4)if(l[u]>0){o=Math.ceil(u/4/ci);break}r.clearRect(0,0,ci,ci),r.strokeText("A",0,ci),l=r.getImageData(0,0,ci,ci).data,a=0;for(let u=0,f=l.length;u<f;u+=4)if(l[u]>0){a=ci-Math.floor(u/4/ci);break}r.canvas.width=r.canvas.height=0;const c=a?a/(a+o):VF;return d(this,ph).set(e,c),c},$(Ps,ea),$(Ps,ph,new Map),$(Ps,mh,new Map),$(Ps,tv,new WeakMap),$(Ps,vu,null),$(Ps,um,new Set);let l1=Ps;class c1{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function r(i){var l;if(!i)return;let a=null;const o=i.name;if(o==="#text")a=i.value;else if(c1.shouldBuildText(o))(l=i==null?void 0:i.attributes)!=null&&l.textContent?a=i.attributes.textContent:i.value&&(a=i.value);else return;if(a!==null&&t.push({str:a}),!!i.children)for(const c of i.children)r(c)}return r(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const GF=65536,XF=100,KF=5e3,YF=Tr?uF:oF,JF=Tr?dF:i6,QF=Tr?cF:lF,ZF=Tr?hF:c6;function eD(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new NA,{docId:t}=e,n=s.url?tD(s.url):null,r=s.data?nD(s.data):null,i=s.httpHeaders||null,a=s.withCredentials===!0,o=s.password??null,l=s.range instanceof x6?s.range:null,c=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:GF;let u=s.worker instanceof Rp?s.worker:null;const f=s.verbosity,p=typeof s.docBaseUrl=="string"&&!e5(s.docBaseUrl)?s.docBaseUrl:null,m=typeof s.cMapUrl=="string"?s.cMapUrl:null,b=s.cMapPacked!==!1,y=s.CMapReaderFactory||JF,S=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,w=s.StandardFontDataFactory||ZF,_=s.stopAtErrors!==!0,k=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,C=s.isEvalSupported!==!1,B=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!Tr,F=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!Tr&&(Xr.platform.isFirefox||!globalThis.chrome),j=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,T=typeof s.disableFontFace=="boolean"?s.disableFontFace:Tr,W=s.fontExtraProperties===!0,Y=s.enableXfa===!0,I=s.ownerDocument||globalThis.document,O=s.disableRange===!0,X=s.disableStream===!0,K=s.disableAutoFetch===!0,ne=s.pdfBug===!0,te=s.CanvasFactory||YF,ue=s.FilterFactory||QF,Z=s.enableHWA===!0,he=l?l.length:s.length??NaN,me=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!Tr&&!T,Ne=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:y===i6&&w===c6&&m&&S&&l0(m,document.baseURI)&&l0(S,document.baseURI),L=null;BM(f);const V={canvasFactory:new te({ownerDocument:I,enableHWA:Z}),filterFactory:new ue({docId:t,ownerDocument:I}),cMapReaderFactory:Ne?null:new y({baseUrl:m,isCompressed:b}),standardFontDataFactory:Ne?null:new w({baseUrl:S})};if(!u){const re={verbosity:f,port:oc.workerPort};u=re.port?Rp.fromPort(re):new Rp(re),e._worker=u}const Q={docId:t,apiVersion:"4.10.38",data:r,password:o,disableAutoFetch:K,rangeChunkSize:c,length:he,docBaseUrl:p,enableXfa:Y,evaluatorOptions:{maxImageSize:k,disableFontFace:T,ignoreErrors:_,isEvalSupported:C,isOffscreenCanvasSupported:B,isImageDecoderSupported:F,canvasMaxAreaInBytes:j,fontExtraProperties:W,useSystemFonts:me,cMapUrl:Ne?m:null,standardFontDataUrl:Ne?S:null}},se={disableFontFace:T,fontExtraProperties:W,ownerDocument:I,pdfBug:ne,styleElement:L,loadingParams:{disableAutoFetch:K,enableXfa:Y}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const re=u.messageHandler.sendWithPromise("GetDocRequest",Q,r?[r.buffer]:null);let de;if(l)de=new PF(l,{disableRange:O,disableStream:X});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");let le;if(Tr)if(l0(n)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");le=YC}else le=zF;else le=l0(n)?YC:FF;de=new le({url:n,length:he,httpHeaders:i,withCredentials:a,rangeChunkSize:c,disableRange:O,disableStream:X})}return re.then(le=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const we=new h0(t,le,u.port),Le=new aD(we,e,de,se,V);e._transport=Le,we.send("Ready",null)})}).catch(e._capability.reject),e}function tD(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(Tr&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function nD(s){if(Tr&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return Qw(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s==null?void 0:s.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function JC(s){return typeof s=="object"&&Number.isInteger(s==null?void 0:s.num)&&s.num>=0&&Number.isInteger(s==null?void 0:s.gen)&&s.gen>=0}var cw;const uw=class uw{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${$r(uw,cw)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,n,r;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,i}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}};cw=new WeakMap,$(uw,cw,0);let NA=uw;class x6{constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){An("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class sD{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return zt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var yu,Vl,Na,tp,Wb;class rD{constructor(e,t,n,r=!1){$(this,Na);$(this,yu,null);$(this,Vl,!1);this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new FC:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new _6,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:i=!1}={}){return new Yv({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return zt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:r=eu.ENABLE,transform:i=null,background:a=null,optionalContentConfigPromise:o=null,annotationCanvasMap:l=null,pageColors:c=null,printAnnotationStorage:u=null,isEditing:f=!1}){var C,B;(C=this._stats)==null||C.time("Overall");const p=this._transport.getRenderingIntent(n,r,u,f),{renderingIntent:m,cacheKey:b}=p;E(this,Vl,!1),z(this,Na,Wb).call(this),o||(o=this._transport.getOptionalContentConfig(m));let y=this._intentStates.get(b);y||(y=Object.create(null),this._intentStates.set(b,y)),y.streamReaderCancelTimeout&&(clearTimeout(y.streamReaderCancelTimeout),y.streamReaderCancelTimeout=null);const S=!!(m&Gi.PRINT);y.displayReadyCapability||(y.displayReadyCapability=Promise.withResolvers(),y.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(B=this._stats)==null||B.time("Page Request"),this._pumpOperatorList(p));const w=F=>{var j;y.renderTasks.delete(_),(this._maybeCleanupAfterRender||S)&&E(this,Vl,!0),z(this,Na,tp).call(this,!S),F?(_.capability.reject(F),this._abortOperatorList({intentState:y,reason:F instanceof Error?F:new Error(F)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(j=globalThis.Stats)!=null&&j.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new EA({callback:w,params:{canvasContext:e,viewport:t,transform:i,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:y.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:c});(y.renderTasks||(y.renderTasks=new Set)).add(_);const k=_.task;return Promise.all([y.displayReadyCapability.promise,o]).then(([F,j])=>{var T;if(this.destroyed){w();return}if((T=this._stats)==null||T.time("Rendering"),!(j.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:F,optionalContentConfig:j}),_.operatorListChanged()}).catch(w),k}getOperatorList({intent:e="display",annotationMode:t=eu.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){var c;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,n,r,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>c1.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,r){function i(){a.read().then(function({value:l,done:c}){if(c){n(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},r)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),E(this,Vl,!1),z(this,Na,Wb).call(this),Promise.all(e)}cleanup(e=!1){E(this,Vl,!0);const t=z(this,Na,tp).call(this,!1);return e&&t&&this._stats&&(this._stats=new FC),t}_startRenderPage(e,t){var r,i;const n=this._intentStates.get(t);n&&((r=this._stats)==null||r.timeEnd("Page Request"),(i=n.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&z(this,Na,tp).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){const{map:i,transfer:a}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},a).getReader(),c=this._intentStates.get(t);c.streamReader=l;const u=()=>{l.read().then(({value:f,done:p})=>{if(p){c.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,c),u())},f=>{if(c.streamReader=null,!this._transport.destroyed){if(c.operatorList){c.operatorList.lastChunk=!0;for(const p of c.renderTasks)p.operatorListChanged();z(this,Na,tp).call(this,!0)}if(c.displayReadyCapability)c.displayReadyCapability.reject(f);else if(c.opListReadCapability)c.opListReadCapability.reject(f);else throw f}})};u()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof l3){let r=XF;t.extraDelay>0&&t.extraDelay<1e3&&(r+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},r);return}}if(e.streamReader.cancel(new Gu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[r,i]of this._intentStates)if(i===e){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}yu=new WeakMap,Vl=new WeakMap,Na=new WeakSet,tp=function(e=!1){if(z(this,Na,Wb).call(this),!d(this,Vl)||this.destroyed)return!1;if(e)return E(this,yu,setTimeout(()=>{E(this,yu,null),z(this,Na,tp).call(this,!1)},KF)),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),E(this,Vl,!1),!0},Wb=function(){d(this,yu)&&(clearTimeout(d(this,yu)),E(this,yu,null))};var Gl,dw;class iD{constructor(){$(this,Gl,new Map);$(this,dw,Promise.resolve())}postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};d(this,dw).then(()=>{for(const[r]of d(this,Gl))r.call(this,n)})}addEventListener(e,t,n=null){let r=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:i}=n;if(i.aborted){Ot("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}d(this,Gl).set(t,r)}removeEventListener(e,t){const n=d(this,Gl).get(t);n==null||n(),d(this,Gl).delete(t)}terminate(){for(const[,e]of d(this,Gl))e==null||e();d(this,Gl).clear()}}Gl=new WeakMap,dw=new WeakMap;var hw,gh,vh,dm,Vb,hm,Gb;const Mn=class Mn{constructor({name:e=null,port:t=null,verbosity:n=$M()}={}){$(this,dm);var r;if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((r=d(Mn,vh))!=null&&r.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(d(Mn,vh)||E(Mn,vh,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new h0("main","worker",e),this._messageHandler.on("ready",function(){}),z(this,dm,Vb).call(this)}_initialize(){if(d(Mn,gh)||d(Mn,hm,Gb)){this._setupFakeWorker();return}let{workerSrc:e}=Mn;try{Mn._isSameOrigin(window.location.href,e)||(e=Mn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new h0("main","worker",t),r=()=>{i.abort(),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=new AbortController;t.addEventListener("error",()=>{this._webWorker||r()},{signal:i.signal}),n.on("test",o=>{if(i.abort(),this.destroyed||!o){r();return}this._messageHandler=n,this._port=t,this._webWorker=t,z(this,dm,Vb).call(this)}),n.on("ready",o=>{if(i.abort(),this.destroyed){r();return}try{a()}catch{this._setupFakeWorker()}});const a=()=>{const o=new Uint8Array;n.send("test",o,[o.buffer])};a();return}catch{Jw("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){d(Mn,gh)||(Ot("Setting up fake worker."),E(Mn,gh,!0)),Mn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new iD;this._port=t;const n=`fake${$r(Mn,hw)._++}`,r=new h0(n+"_worker",n,t);e.setup(r,t),this._messageHandler=new h0(n,n+"_worker",t),z(this,dm,Vb).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,n;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=d(Mn,vh))==null||t.delete(this._port),this._port=null,(n=this._messageHandler)==null||n.destroy(),this._messageHandler=null}static fromPort(e){var n;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(n=d(this,vh))==null?void 0:n.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Mn(e)}static get workerSrc(){if(oc.workerSrc)return oc.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return zt(this,"_setupFakeWorkerGlobal",(async()=>d(this,hm,Gb)?d(this,hm,Gb):(await import(this.workerSrc)).WorkerMessageHandler)())}};hw=new WeakMap,gh=new WeakMap,vh=new WeakMap,dm=new WeakSet,Vb=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},hm=new WeakSet,Gb=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},$(Mn,hm),$(Mn,hw,0),$(Mn,gh,!1),$(Mn,vh),Tr&&(E(Mn,gh,!0),oc.workerSrc||(oc.workerSrc="./pdf.worker.mjs")),Mn._isSameOrigin=(e,t)=>{let n;try{if(n=new URL(e),!n.origin||n.origin==="null")return!1}catch{return!1}const r=new URL(t,n);return n.origin===r.origin},Mn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let Rp=Mn;var Xl,Zo,fm,pm,Kl,yh,v0;class aD{constructor(e,t,n,r,i){$(this,yh);$(this,Xl,new Map);$(this,Zo,new Map);$(this,fm,new Map);$(this,pm,new Map);$(this,Kl,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new _6,this.fontLoader=new iF({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return zt(this,"annotationStorage",new h3)}getRenderingIntent(e,t=eu.ENABLE,n=null,r=!1,i=!1){let a=Gi.DISPLAY,o=mA;switch(e){case"any":a=Gi.ANY;break;case"display":break;case"print":a=Gi.PRINT;break;default:Ot(`getRenderingIntent - invalid intent: ${e}`)}const l=a&Gi.PRINT&&n instanceof ZT?n:this.annotationStorage;switch(t){case eu.DISABLE:a+=Gi.ANNOTATIONS_DISABLE;break;case eu.ENABLE:break;case eu.ENABLE_FORMS:a+=Gi.ANNOTATIONS_FORMS;break;case eu.ENABLE_STORAGE:a+=Gi.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Ot(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=Gi.IS_EDITING),i&&(a+=Gi.OPLIST);const{ids:c,hash:u}=l.modifiedIds,f=[a,o.hash,u];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:c}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=d(this,Kl))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const r of d(this,Zo).values())e.push(r._destroy());d(this,Zo).clear(),d(this,fm).clear(),d(this,pm).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var r,i;this.commonObjs.clear(),this.fontLoader.clear(),d(this,Xl).clear(),this.filterFactory.destroy(),l1.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new Gu("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,r)=>{_s(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},r.onPull=()=>{this._fullReader.read().then(function({value:i,done:a}){if(a){r.close();return}_s(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{r.error(i)})},r.onCancel=i=>{this._fullReader.cancel(i),r.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async n=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:i,contentLength:a}=this._fullReader;return(!r||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var c;(c=t.onProgress)==null||c.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:r,isRangeSupported:i,contentLength:a}}),e.on("GetRangeReader",(n,r)=>{_s(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(n.begin,n.end);if(!i){r.close();return}r.onPull=()=>{i.read().then(function({value:a,done:o}){if(o){r.close();return}_s(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{i.cancel(a),r.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new sD(n,this))}),e.on("DocException",n=>{t._capability.reject(hi(n))}),e.on("PasswordRequest",n=>{E(this,Kl,Promise.withResolvers());try{if(!t.onPassword)throw hi(n);const r=i=>{i instanceof Error?d(this,Kl).reject(i):d(this,Kl).resolve({password:i})};t.onPassword(r,n.code)}catch(r){d(this,Kl).reject(r)}return d(this,Kl).promise}),e.on("DataLoaded",n=>{var r;(r=t.onProgress)==null||r.call(t,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;d(this,Zo).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,r,i])=>{var a;if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":const{disableFontFace:o,fontExtraProperties:l,pdfBug:c}=this._params;if("error"in i){const m=i.error;Ot(`Error during font loading: ${m}`),this.commonObjs.resolve(n,m);break}const u=c&&((a=globalThis.FontInspector)!=null&&a.enabled)?(m,b)=>globalThis.FontInspector.fontAdded(m,b):null,f=new aF(i,{disableFontFace:o,fontExtraProperties:l,inspectFont:u});this.fontLoader.bind(f).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!l&&f.data&&(f.data=null),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:p}=i;_s(p,"The imageRef must be defined.");for(const m of d(this,Zo).values())for(const[,b]of m.objs)if((b==null?void 0:b.ref)===p)return b.dataLen?(this.commonObjs.resolve(n,structuredClone(b)),b.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,i);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),e.on("obj",([n,r,i,a])=>{var l;if(this.destroyed)return;const o=d(this,Zo).get(r);if(!o.objs.has(n)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(i){case"Image":o.objs.resolve(n,a),(a==null?void 0:a.dataLen)>OM&&(o._maybeCleanupAfterRender=!0);break;case"Pattern":o.objs.resolve(n,a);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",n=>{var r;this.destroyed||(r=t.onProgress)==null||r.call(t,{loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(n)}),e.on("FetchStandardFontData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Ot("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((n=this._fullReader)==null?void 0:n.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=d(this,fm).get(t);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&d(this,pm).set(i.refStr,e);const a=new rD(t,i,this,this._params.pdfBug);return d(this,Zo).set(t,a),a});return d(this,fm).set(t,r),r}getPageIndex(e){return JC(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return z(this,yh,v0).call(this,"GetFieldObjects")}hasJSActions(){return z(this,yh,v0).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return z(this,yh,v0).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return z(this,yh,v0).call(this,"GetOptionalContentConfig").then(t=>new EF(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=d(this,Xl).get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(r=>{var i,a;return{info:r[0],metadata:r[1]?new NF(r[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return d(this,Xl).set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of d(this,Zo).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),d(this,Xl).clear(),this.filterFactory.destroy(!0),l1.cleanup()}}cachedPageNumber(e){if(!JC(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return d(this,pm).get(t)??null}}Xl=new WeakMap,Zo=new WeakMap,fm=new WeakMap,pm=new WeakMap,Kl=new WeakMap,yh=new WeakSet,v0=function(e,t=null){const n=d(this,Xl).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise(e,t);return d(this,Xl).set(e,r),r};const Gg=Symbol("INITIAL_DATA");var Di,nv,CA;class _6{constructor(){$(this,nv);$(this,Di,Object.create(null))}get(e,t=null){if(t){const r=z(this,nv,CA).call(this,e);return r.promise.then(()=>t(r.data)),null}const n=d(this,Di)[e];if(!n||n.data===Gg)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=d(this,Di)[e];return!!t&&t.data!==Gg}delete(e){const t=d(this,Di)[e];return!t||t.data===Gg?!1:(delete d(this,Di)[e],!0)}resolve(e,t=null){const n=z(this,nv,CA).call(this,e);n.data=t,n.resolve()}clear(){var e;for(const t in d(this,Di)){const{data:n}=d(this,Di)[t];(e=n==null?void 0:n.bitmap)==null||e.close()}E(this,Di,Object.create(null))}*[Symbol.iterator](){for(const e in d(this,Di)){const{data:t}=d(this,Di)[e];t!==Gg&&(yield[e,t])}}}Di=new WeakMap,nv=new WeakSet,CA=function(e){var t;return(t=d(this,Di))[e]||(t[e]={...Promise.withResolvers(),data:Gg})};var bu;class oD{constructor(e){$(this,bu,null);E(this,bu,e),this.onContinue=null}get promise(){return d(this,bu).capability.promise}cancel(e=0){d(this,bu).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=d(this,bu).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=d(this,bu);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}bu=new WeakMap;var wu,bh;const Od=class Od{constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:c,useRequestAnimationFrame:u=!1,pdfBug:f=!1,pageColors:p=null}){$(this,wu,null);this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=c,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new oD(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var o,l;if(this.cancelled)return;if(this._canvas){if(d(Od,bh).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");d(Od,bh).add(this._canvas)}this._pdfBug&&((o=globalThis.StepperManager)!=null&&o.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:r,transform:i,background:a}=this.params;this.gfx=new jp(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:i,viewport:r,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var n;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),d(this,wu)&&(window.cancelAnimationFrame(d(this,wu)),E(this,wu,null)),d(Od,bh).delete(this._canvas),this.callback(e||new l3(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?E(this,wu,window.requestAnimationFrame(()=>{E(this,wu,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),d(Od,bh).delete(this._canvas),this.callback())))}};wu=new WeakMap,bh=new WeakMap,$(Od,bh,new WeakSet);let EA=Od;const lD="4.10.38",cD="f9bea397f";function QC(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function Xg(s){return Math.max(0,Math.min(255,255*s))}class ZC{static CMYK_G([e,t,n,r]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Xg(e),[e,e,e]}static G_HTML([e]){const t=QC(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Xg)}static RGB_HTML(e){return`#${e.map(QC).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return["RGB",1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[Xg(1-Math.min(1,e+r)),Xg(1-Math.min(1,n+r)),Xg(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const r=1-e,i=1-t,a=1-n,o=Math.min(r,i,a);return["CMYK",r,i,a,o]}}class uD{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${e}px`),r.setAttribute("height",`${t}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){An("Abstract method `_createSVG` called.")}}class p3 extends uD{_createSVG(e){return document.createElementNS(El,e)}}class A6{static setupStorage(e,t,n,r,i){const a=r.getValue(t,{value:null});switch(n.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(a.value===n.attributes.xfaOn?e.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{r.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),i==="print")break;e.addEventListener("input",o=>{r.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of n.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,c=l.selectedIndex===-1?"":l[l.selectedIndex].value;r.setValue(t,{value:c})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:i}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${r}`);for(const[l,c]of Object.entries(a))if(c!=null)switch(l){case"class":c.length&&e.setAttribute(l,c.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",c);break;case"style":Object.assign(e.style,c);break;case"textContent":e.textContent=c;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,c)}o&&i.addLinkAttributes(e,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(e,a.dataId,t,n)}static render(e){var f,p;const t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,i=e.intent||"display",a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:i,linkService:n});const o=i!=="richText",l=e.div;if(l.append(a),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}o&&l.setAttribute("class","xfaLayer xfaFont");const c=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);a.append(m),o&&c1.shouldBuildText(r.name)&&c.push(m)}return{textDivs:c}}const u=[[r,-1,a]];for(;u.length>0;){const[m,b,y]=u.at(-1);if(b+1===m.children.length){u.pop();continue}const S=m.children[++u.at(-1)[1]];if(S===null)continue;const{name:w}=S;if(w==="#text"){const k=document.createTextNode(S.value);c.push(k),y.append(k);continue}const _=(f=S==null?void 0:S.attributes)!=null&&f.xmlns?document.createElementNS(S.attributes.xmlns,w):document.createElement(w);if(y.append(_),S.attributes&&this.setAttributes({html:_,element:S,storage:t,intent:i,linkService:n}),((p=S.children)==null?void 0:p.length)>0)u.push([S,-1,_]);else if(S.value){const k=document.createTextNode(S.value);o&&c1.shouldBuildText(w)&&c.push(k),_.append(k)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Qv=1e3,dD=9,nf=new WeakSet;function Hu(s){return{width:s[2]-s[0],height:s[3]-s[1]}}class hD{static create(e){switch(e.data.annotationType){case Cs.LINK:return new S6(e);case Cs.TEXT:return new fD(e);case Cs.WIDGET:switch(e.data.fieldType){case"Tx":return new pD(e);case"Btn":return e.data.radioButton?new C6(e):e.data.checkBox?new gD(e):new vD(e);case"Ch":return new yD(e);case"Sig":return new mD(e)}return new of(e);case Cs.POPUP:return new LA(e);case Cs.FREETEXT:return new I6(e);case Cs.LINE:return new wD(e);case Cs.SQUARE:return new xD(e);case Cs.CIRCLE:return new _D(e);case Cs.POLYLINE:return new j6(e);case Cs.CARET:return new SD(e);case Cs.INK:return new m3(e);case Cs.POLYGON:return new AD(e);case Cs.HIGHLIGHT:return new R6(e);case Cs.UNDERLINE:return new kD(e);case Cs.SQUIGGLY:return new ND(e);case Cs.STRIKEOUT:return new CD(e);case Cs.STAMP:return new O6(e);case Cs.FILEATTACHMENT:return new ED(e);default:return new fs(e)}}}var wh,mm,gm,sv,PA;const N3=class N3{constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){$(this,sv);$(this,wh,null);$(this,mm,!1);$(this,gm,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e!=null&&e.str||t!=null&&t.str||n!=null&&n.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return N3._hasPopupData(this.data)}updateEdited(e){var n;if(!this.container)return;d(this,wh)||E(this,wh,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&z(this,sv,PA).call(this,t),(n=d(this,gm))==null||n.popup.updateEdited(e)}resetEdited(){var e;d(this,wh)&&(z(this,sv,PA).call(this,d(this,wh).rect),(e=d(this,gm))==null||e.popup.resetEdited(),E(this,wh,null))}_createContainer(e){const{data:t,parent:{page:n,viewport:r}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),this instanceof of||(i.tabIndex=Qv);const{style:a}=i;if(a.zIndex=this.parent.zIndex++,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof LA){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,i),i}const{width:o,height:l}=Hu(t.rect);if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,S=t.borderStyle.verticalCornerRadius;if(y>0||S>0){const _=`calc(${y}px * var(--scale-factor)) / calc(${S}px * var(--scale-factor))`;a.borderRadius=_}else if(this instanceof C6){const _=`calc(${o}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;a.borderRadius=_}switch(t.borderStyle.style){case Wg.SOLID:a.borderStyle="solid";break;case Wg.DASHED:a.borderStyle="dashed";break;case Wg.BEVELED:Ot("Unimplemented border style: beveled");break;case Wg.INSET:Ot("Unimplemented border style: inset");break;case Wg.UNDERLINE:a.borderBottomStyle="solid";break}const w=t.borderColor||null;w?(E(this,mm,!0),a.borderColor=it.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const c=it.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:u,pageHeight:f,pageX:p,pageY:m}=r.rawDims;a.left=`${100*(c[0]-p)/u}%`,a.top=`${100*(c[1]-m)/f}%`;const{rotation:b}=t;return t.hasOwnCanvas||b===0?(a.width=`${100*o/u}%`,a.height=`${100*l/f}%`):this.setRotation(b,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:i,height:a}=Hu(this.data.rect);let o,l;e%180===0?(o=100*i/n,l=100*a/r):(o=100*a/n,l=100*i/r),t.style.width=`${o}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,r)=>{const i=r.detail[t],a=i[0],o=i.slice(1);r.target.style[n]=ZC[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[n]:ZC[`${a}_rgb`](o)})};return zt(this,"_commonActions",{display:t=>{const{display:n}=t.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const r of Object.keys(t.detail)){const i=e[r]||n[r];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[r,i]of Object.entries(t)){const a=n[r];if(a){const o={detail:{[r]:i},target:e};a(o),delete t[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,r,i]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,S,w,_]=e.subarray(2,6);if(r===y&&i===S&&t===w&&n===_)return}const{style:a}=this.container;let o;if(d(this,mm)){const{borderColor:y,borderWidth:S}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${S}">`],this.container.classList.add("hasBorder")}const l=r-t,c=i-n,{svgFactory:u}=this,f=u.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0);const p=u.createElement("defs");f.append(p);const m=u.createElement("clipPath"),b=`clippath_${this.data.id}`;m.setAttribute("id",b),m.setAttribute("clipPathUnits","objectBoundingBox"),p.append(m);for(let y=2,S=e.length;y<S;y+=8){const w=e[y],_=e[y+1],k=e[y+2],C=e[y+3],B=u.createElement("rect"),F=(k-t)/l,j=(i-_)/c,T=(w-k)/l,W=(_-C)/c;B.setAttribute("x",F),B.setAttribute("y",j),B.setAttribute("width",T),B.setAttribute("height",W),m.append(B),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${F}" y="${j}" width="${T}" height="${W}"/>`)}d(this,mm)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${b})`}_createPopup(){const{data:e}=this,t=E(this,gm,new LA({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){An("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:i,id:a,exportValues:o}of r){if(i===-1||a===t)continue;const l=typeof o=="string"?o:null,c=document.querySelector(`[data-element-id="${a}"]`);if(c&&!nf.has(c)){Ot(`_getElementsByName - element not allowed: ${a}`);continue}n.push({id:a,exportValue:l,domElement:c})}return n}for(const r of document.getElementsByName(e)){const{exportValue:i}=r,a=r.getAttribute("data-element-id");a!==t&&nf.has(r)&&n.push({id:a,exportValue:i,domElement:r})}return n}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};wh=new WeakMap,mm=new WeakMap,gm=new WeakMap,sv=new WeakSet,PA=function(e){const{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}}}=this;n==null||n.splice(0,4,...e);const{width:c,height:u}=Hu(e);t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+l)/a}%`,r===0?(t.width=`${100*c/i}%`,t.height=`${100*u/a}%`):this.setRotation(r)};let fs=N3;var Ki,kd,k6,N6;class S6 extends fs{constructor(t,n=null){super(t,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});$(this,Ki);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:n}=this,r=document.createElement("a");r.setAttribute("data-element-id",t.id);let i=!1;return t.url?(n.addLinkAttributes(r,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(r,t.action),i=!0):t.attachment?(z(this,Ki,k6).call(this,r,t.attachment,t.attachmentDest),i=!0):t.setOCGState?(z(this,Ki,N6).call(this,r,t.setOCGState),i=!0):t.dest?(this._bindLink(r,t.dest),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,t),i=!0),t.resetForm?(this._bindResetFormAction(r,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(r,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(r),this.container}_bindLink(t,n){t.href=this.linkService.getDestinationHash(n),t.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&z(this,Ki,kd).call(this)}_bindNamedAction(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(n),!1),z(this,Ki,kd).call(this)}_bindJSAction(t,n){t.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(n.actions)){const a=r.get(i);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:i}}),!1})}t.onclick||(t.onclick=()=>!1),z(this,Ki,kd).call(this)}_bindResetFormAction(t,n){const r=t.onclick;if(r||(t.href=this.linkService.getAnchorUrl("")),z(this,Ki,kd).call(this),!this._fieldObjects){Ot('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(t.onclick=()=>!1);return}t.onclick=()=>{var f;r==null||r();const{fields:i,refs:a,include:o}=n,l=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const m of i){const b=this._fieldObjects[m]||[];for(const{id:y}of b)p.add(y)}for(const m of Object.values(this._fieldObjects))for(const b of m)p.has(b.id)===o&&l.push(b)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const c=this.annotationStorage,u=[];for(const p of l){const{id:m}=p;switch(u.push(m),p.type){case"text":{const y=p.defaultValue||"";c.setValue(m,{value:y});break}case"checkbox":case"radiobutton":{const y=p.defaultValue===p.exportValues;c.setValue(m,{value:y});break}case"combobox":case"listbox":{const y=p.defaultValue||"";c.setValue(m,{value:y});break}default:continue}const b=document.querySelector(`[data-element-id="${m}"]`);if(b){if(!nf.has(b)){Ot(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;b.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:u,name:"ResetForm"}})),!1}}}Ki=new WeakSet,kd=function(){this.container.setAttribute("data-internal-link","")},k6=function(t,n,r=null){t.href=this.linkService.getAnchorUrl(""),n.description&&(t.title=n.description),t.onclick=()=>{var i;return(i=this.downloadManager)==null||i.openOrDownloadData(n.content,n.filename,r),!1},z(this,Ki,kd).call(this)},N6=function(t,n){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(n),!1),z(this,Ki,kd).call(this)};class fD extends fs{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class of extends fs{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Xr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,i){n.includes("mouse")?e.addEventListener(n,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(n,a=>{var o;if(n==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:i(a)}}))})}_setEventListeners(e,t,n,r){var i,a,o;for(const[l,c]of n)(c==="Action"||(i=this.data.actions)!=null&&i[c])&&((c==="Focus"||c==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,c,r),c==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):c==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":it.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||dD,i=e.style;let a;const o=2,l=c=>Math.round(10*c)/10;if(this.data.multiLine){const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o),u=Math.round(c/(gx*r))||1,f=c/u;a=Math.min(r,l(f/gx))}else{const c=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(r,l(c/gx))}i.fontSize=`calc(${a}px * var(--scale-factor))`,i.color=it.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class pD extends of{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),i.setValue(a.id,{[r]:n})}render(){var r,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=a.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const u={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),nf.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=Qv,this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",p=>{e.setValue(t,{value:p.target.value}),this.setPropertyOnSiblings(n,"value",p.target.value,"value"),u.formattedValue=null}),n.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue??"";n.value=u.userValue=m,u.formattedValue=null});let f=p=>{const{formattedValue:m}=u;m!=null&&(p.target.value=m),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",m=>{var y;if(u.focused)return;const{target:b}=m;u.userValue&&(b.value=u.userValue),u.lastCommittedValue=b.value,u.commitKey=1,(y=this.data.actions)!=null&&y.Focus||(u.focused=!0)}),n.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const b={value(y){u.userValue=y.detail.value??"",e.setValue(t,{value:u.userValue.toString()}),y.target.value=u.userValue},formattedValue(y){const{formattedValue:S}=y.detail;u.formattedValue=S,S!=null&&y.target!==document.activeElement&&(y.target.value=S),e.setValue(t,{formattedValue:S})},selRange(y){y.target.setSelectionRange(...y.detail.selRange)},charLimit:y=>{var k;const{charLimit:S}=y.detail,{target:w}=y;if(S===0){w.removeAttribute("maxLength");return}w.setAttribute("maxLength",S);let _=u.userValue;!_||_.length<=S||(_=_.slice(0,S),w.value=u.userValue=_,e.setValue(t,{value:_}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,willCommit:!0,commitKey:1,selStart:w.selectionStart,selEnd:w.selectionEnd}}))}};this._dispatchEventFromSandbox(b,m)}),n.addEventListener("keydown",m=>{var S;u.commitKey=1;let b=-1;if(m.key==="Escape"?b=0:m.key==="Enter"&&!this.data.multiLine?b=2:m.key==="Tab"&&(u.commitKey=3),b===-1)return;const{value:y}=m.target;u.lastCommittedValue!==y&&(u.lastCommittedValue=y,u.userValue=y,(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:b,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const p=f;f=null,n.addEventListener("blur",m=>{var y,S;if(!u.focused||!m.relatedTarget)return;(y=this.data.actions)!=null&&y.Blur||(u.focused=!1);const{value:b}=m.target;u.userValue=b,u.lastCommittedValue!==b&&((S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:u.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),p(m)}),(i=this.data.actions)!=null&&i.Keystroke&&n.addEventListener("beforeinput",m=>{var B;u.lastCommittedValue=null;const{data:b,target:y}=m,{value:S,selectionStart:w,selectionEnd:_}=y;let k=w,C=_;switch(m.inputType){case"deleteWordBackward":{const F=S.substring(0,w).match(/\w*[^\w]*$/);F&&(k-=F[0].length);break}case"deleteWordForward":{const F=S.substring(w).match(/^[^\w]*\w*/);F&&(C+=F[0].length);break}case"deleteContentBackward":w===_&&(k-=1);break;case"deleteContentForward":w===_&&(C+=1);break}m.preventDefault(),(B=this.linkService.eventBus)==null||B.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,change:b||"",willCommit:!1,selStart:k,selEnd:C}})}),this._setEventListeners(n,u,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(f&&n.addEventListener("blur",f),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class mD extends of{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class gD extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",e.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return nf.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=Qv,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,n)){const u=l&&c.exportValue===t.exportValue;c.domElement&&(c.domElement.checked=u),e.setValue(c.id,{value:u})}e.setValue(n,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(n,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class C6 extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r=="string"&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(const a of this._getElementsByName(t.fieldName,n))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(nf.add(i),i.setAttribute("data-element-id",n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,r&&i.setAttribute("checked",!0),i.tabIndex=Qv,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const c of this._getElementsByName(o,n))e.setValue(c.id,{value:!1});e.setValue(n,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:c=>{const u=a===c.detail.value;for(const f of this._getElementsByName(c.target.name)){const p=u&&f.id===n;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class vD extends S6{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class yD extends of{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement("select");nf.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=Qv;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",u=>{const f=this.data.defaultFieldValue;for(const p of r.options)p.selected=p.value===f});for(const u of this.data.options){const f=document.createElement("option");f.textContent=u.displayValue,f.value=u.exportValue,n.value.includes(u.exportValue)&&(f.setAttribute("selected",!0),i=!1),r.append(f)}let a=null;if(i){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),r.prepend(u),a=()=>{u.remove(),r.removeEventListener("input",a),a=null},r.addEventListener("input",a)}const o=u=>{const f=u?"value":"textContent",{options:p,multiple:m}=r;return m?Array.prototype.filter.call(p,b=>b.selected).map(b=>b[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const c=u=>{const f=u.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",u=>{const f={value(p){a==null||a();const m=p.detail.value,b=new Set(Array.isArray(m)?m:[m]);for(const y of r.options)y.selected=b.has(y.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){r.multiple=!0},remove(p){const m=r.options,b=p.detail.remove;m[b].selected=!1,r.remove(b),m.length>0&&Array.prototype.findIndex.call(m,S=>S.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},clear(p){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:m,displayValue:b,exportValue:y}=p.detail.insert,S=r.children[m],w=document.createElement("option");w.textContent=b,w.value=y,S?S.before(w):r.append(w),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},items(p){const{items:m}=p.detail;for(;r.length!==0;)r.remove(0);for(const b of m){const{displayValue:y,exportValue:S}=b,w=document.createElement("option");w.textContent=y,w.value=S,r.append(w)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(p)}),l=o(!1)},indices(p){const m=new Set(p.detail.indices);for(const b of p.target.options)b.selected=m.has(b.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,u)}),r.addEventListener("input",u=>{var m;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),u.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):r.addEventListener("input",function(u){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class LA extends fs{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:fs._hasPopupData(t)}),this.elements=n,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new bD({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,n.container.ariaHasPopup="dialog",t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(n=>`${o3}${n}`).join(",")),this.container}}var vm,fw,pw,ym,xh,ts,Yl,bm,rv,iv,wm,Jl,so,Ql,av,Zl,ov,_h,Ah,yn,Xb,TA,E6,P6,L6,T6,Kb,Yb,IA;class bD{constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:i,contentsObj:a,richText:o,parent:l,rect:c,parentRect:u,open:f}){$(this,yn);$(this,vm,z(this,yn,L6).bind(this));$(this,fw,z(this,yn,IA).bind(this));$(this,pw,z(this,yn,Yb).bind(this));$(this,ym,z(this,yn,Kb).bind(this));$(this,xh,null);$(this,ts,null);$(this,Yl,null);$(this,bm,null);$(this,rv,null);$(this,iv,null);$(this,wm,null);$(this,Jl,!1);$(this,so,null);$(this,Ql,null);$(this,av,null);$(this,Zl,null);$(this,ov,null);$(this,_h,null);$(this,Ah,!1);var p;E(this,ts,e),E(this,ov,r),E(this,Yl,a),E(this,Zl,o),E(this,iv,l),E(this,xh,t),E(this,av,c),E(this,wm,u),E(this,rv,n),E(this,bm,u3.toDateObject(i)),this.trigger=n.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",d(this,ym)),m.addEventListener("mouseenter",d(this,pw)),m.addEventListener("mouseleave",d(this,fw)),m.classList.add("popupTriggerArea");for(const m of n)(p=m.container)==null||p.addEventListener("keydown",d(this,vm));d(this,ts).hidden=!0,f&&z(this,yn,Kb).call(this)}render(){if(d(this,so))return;const e=E(this,so,document.createElement("div"));if(e.className="popup",d(this,xh)){const i=e.style.outlineColor=it.makeHexColor(...d(this,xh));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`:e.style.backgroundColor=it.makeHexColor(...d(this,xh).map(o=>Math.floor(.7*(255-o)+o)))}const t=document.createElement("span");t.className="header";const n=document.createElement("h1");if(t.append(n),{dir:n.dir,str:n.textContent}=d(this,ov),e.append(t),d(this,bm)){const i=document.createElement("span");i.classList.add("popupDate"),i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:d(this,bm).valueOf()})),t.append(i)}const r=d(this,yn,Xb);if(r)A6.render({xfaHtml:r,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const i=this._formatContents(d(this,Yl));e.append(i)}d(this,ts).append(e)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const r=e.split(/(?:\r\n?|\n)/);for(let i=0,a=r.length;i<a;++i){const o=r[i];n.append(document.createTextNode(o)),i<a-1&&n.append(document.createElement("br"))}return n}updateEdited({rect:e,popupContent:t}){var n;d(this,_h)||E(this,_h,{contentsObj:d(this,Yl),richText:d(this,Zl)}),e&&E(this,Ql,null),t&&(E(this,Zl,z(this,yn,P6).call(this,t)),E(this,Yl,null)),(n=d(this,so))==null||n.remove(),E(this,so,null)}resetEdited(){var e;d(this,_h)&&({contentsObj:$r(this,Yl)._,richText:$r(this,Zl)._}=d(this,_h),E(this,_h,null),(e=d(this,so))==null||e.remove(),E(this,so,null),E(this,Ql,null))}forceHide(){E(this,Ah,this.isVisible),d(this,Ah)&&(d(this,ts).hidden=!0)}maybeShow(){d(this,Ah)&&(d(this,so)||z(this,yn,Yb).call(this),E(this,Ah,!1),d(this,ts).hidden=!1)}get isVisible(){return d(this,ts).hidden===!1}}vm=new WeakMap,fw=new WeakMap,pw=new WeakMap,ym=new WeakMap,xh=new WeakMap,ts=new WeakMap,Yl=new WeakMap,bm=new WeakMap,rv=new WeakMap,iv=new WeakMap,wm=new WeakMap,Jl=new WeakMap,so=new WeakMap,Ql=new WeakMap,av=new WeakMap,Zl=new WeakMap,ov=new WeakMap,_h=new WeakMap,Ah=new WeakMap,yn=new WeakSet,Xb=function(){const e=d(this,Zl),t=d(this,Yl);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&d(this,Zl).html||null},TA=function(){var e,t,n;return((n=(t=(e=d(this,yn,Xb))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.fontSize)||0},E6=function(){var e,t,n;return((n=(t=(e=d(this,yn,Xb))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:n.color)||null},P6=function(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},r={style:{color:d(this,yn,E6),fontSize:d(this,yn,TA)?`calc(${d(this,yn,TA)}px * var(--scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:r});return n},L6=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&d(this,Jl))&&z(this,yn,Kb).call(this)},T6=function(){if(d(this,Ql)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:i}}}=d(this,iv);let a=!!d(this,wm),o=a?d(this,wm):d(this,av);for(const b of d(this,rv))if(!o||it.intersect(b.data.rect,o)!==null){o=b.data.rect,a=!0;break}const l=it.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),u=a?o[2]-o[0]+5:0,f=l[0]+u,p=l[1];E(this,Ql,[100*(f-r)/t,100*(p-i)/n]);const{style:m}=d(this,ts);m.left=`${d(this,Ql)[0]}%`,m.top=`${d(this,Ql)[1]}%`},Kb=function(){E(this,Jl,!d(this,Jl)),d(this,Jl)?(z(this,yn,Yb).call(this),d(this,ts).addEventListener("click",d(this,ym)),d(this,ts).addEventListener("keydown",d(this,vm))):(z(this,yn,IA).call(this),d(this,ts).removeEventListener("click",d(this,ym)),d(this,ts).removeEventListener("keydown",d(this,vm)))},Yb=function(){d(this,so)||this.render(),this.isVisible?d(this,Jl)&&d(this,ts).classList.add("focused"):(z(this,yn,T6).call(this),d(this,ts).hidden=!1,d(this,ts).style.zIndex=parseInt(d(this,ts).style.zIndex)+1e3)},IA=function(){d(this,ts).classList.remove("focused"),!(d(this,Jl)||!this.isVisible)&&(d(this,ts).hidden=!0,d(this,ts).style.zIndex=parseInt(d(this,ts).style.zIndex)-1e3)};class I6 extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Rt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var lv;class wD extends fs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});$(this,lv,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:n,height:r}=Hu(t.rect),i=this.svgFactory.create(n,r,!0),a=E(this,lv,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,lv)}addHighlightArea(){this.container.classList.add("highlightArea")}}lv=new WeakMap;var cv;class xD extends fs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});$(this,cv,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:n,height:r}=Hu(t.rect),i=this.svgFactory.create(n,r,!0),a=t.borderStyle.width,o=E(this,cv,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",n-a),o.setAttribute("height",r-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,cv)}addHighlightArea(){this.container.classList.add("highlightArea")}}cv=new WeakMap;var uv;class _D extends fs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});$(this,uv,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:n,height:r}=Hu(t.rect),i=this.svgFactory.create(n,r,!0),a=t.borderStyle.width,o=E(this,uv,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",n/2),o.setAttribute("cy",r/2),o.setAttribute("rx",n/2-a/2),o.setAttribute("ry",r/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,uv)}addHighlightArea(){this.container.classList.add("highlightArea")}}uv=new WeakMap;var dv;class j6 extends fs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});$(this,dv,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:n,borderStyle:r,popupRef:i}}=this;if(!n)return this.container;const{width:a,height:o}=Hu(t),l=this.svgFactory.create(a,o,!0);let c=[];for(let f=0,p=n.length;f<p;f+=2){const m=n[f]-t[0],b=t[3]-n[f+1];c.push(`${m},${b}`)}c=c.join(" ");const u=E(this,dv,this.svgFactory.createElement(this.svgElementName));return u.setAttribute("points",c),u.setAttribute("stroke-width",r.width||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),l.append(u),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return d(this,dv)}addHighlightArea(){this.container.classList.add("highlightArea")}}dv=new WeakMap;class AD extends j6{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class SD extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var hv,Sh,fv,jA;class m3 extends fs{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});$(this,fv);$(this,hv,null);$(this,Sh,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Rt.HIGHLIGHT:Rt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:n,inkLists:r,borderStyle:i,popupRef:a}}=this,{transform:o,width:l,height:c}=z(this,fv,jA).call(this,n,t),u=this.svgFactory.create(l,c,!0),f=E(this,hv,this.svgFactory.createElement("svg:g"));u.append(f),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,m=r.length;p<m;p++){const b=this.svgFactory.createElement(this.svgElementName);d(this,Sh).push(b),b.setAttribute("points",r[p].join(",")),f.append(b)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(u),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:n,points:r,rect:i}=t,a=d(this,hv);if(n>=0&&a.setAttribute("stroke-width",n||1),r)for(let o=0,l=d(this,Sh).length;o<l;o++)d(this,Sh)[o].setAttribute("points",r[o].join(","));if(i){const{transform:o,width:l,height:c}=z(this,fv,jA).call(this,this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${c}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return d(this,Sh)}addHighlightArea(){this.container.classList.add("highlightArea")}}hv=new WeakMap,Sh=new WeakMap,fv=new WeakSet,jA=function(t,n){switch(t){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class R6 extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Rt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class kD extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class ND extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class CD extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class O6 extends fs{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Rt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var pv,mv,RA;class ED extends fs{constructor(t){var r;super(t,{isRenderable:!0});$(this,mv);$(this,pv,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:n}=this;let r;n.hasAppearance||n.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),r.addEventListener("dblclick",z(this,mv,RA).bind(this)),E(this,pv,r);const{isMac:i}=Xr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&z(this,mv,RA).call(this)}),!n.popupRef&&this.hasPopupData?this._createPopup():r.classList.add("popupTriggerArea"),t.append(r),t}getElementsToTriggerPopup(){return d(this,pv)}addHighlightArea(){this.container.classList.add("highlightArea")}}pv=new WeakMap,mv=new WeakSet,RA=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var gv,kh,Nh,vv,sf,M6,OA;class PD{constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:i,viewport:a,structTreeLayer:o}){$(this,sf);$(this,gv,null);$(this,kh,null);$(this,Nh,new Map);$(this,vv,null);this.div=e,E(this,gv,t),E(this,kh,n),E(this,vv,o||null),this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return d(this,Nh).size>0}async render(e){var a;const{annotations:t}=e,n=this.div;ef(n,this.viewport);const r=new Map,i={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new p3,annotationStorage:e.annotationStorage||new h3,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const o of t){if(o.noHTML)continue;const l=o.annotationType===Cs.POPUP;if(l){const f=r.get(o.id);if(!f)continue;i.elements=f}else{const{width:f,height:p}=Hu(o.rect);if(f<=0||p<=0)continue}i.data=o;const c=hD.create(i);if(!c.isRenderable)continue;if(!l&&o.popupRef){const f=r.get(o.popupRef);f?f.push(c):r.set(o.popupRef,[c])}const u=c.render();o.hidden&&(u.style.visibility="hidden"),await z(this,sf,M6).call(this,u,o.id),c._isEditable&&(d(this,Nh).set(c.data.id,c),(a=this._annotationEditorUIManager)==null||a.renderAnnotationElement(c))}z(this,sf,OA).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,ef(t,{rotation:e.rotation}),z(this,sf,OA).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(d(this,Nh).values())}getEditableAnnotation(e){return d(this,Nh).get(e)}}gv=new WeakMap,kh=new WeakMap,Nh=new WeakMap,vv=new WeakMap,sf=new WeakSet,M6=async function(e,t){var a,o;const n=e.firstChild||e,r=n.id=`${o3}${t}`,i=await((a=d(this,vv))==null?void 0:a.getAriaAttributes(r));if(i)for(const[l,c]of i)n.setAttribute(l,c);this.div.append(e),(o=d(this,gv))==null||o.moveElementInDOM(this.div,e,n,!1)},OA=function(){if(!d(this,kh))return;const e=this.div;for(const[t,n]of d(this,kh)){const r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;n.className="annotationContent";const{firstChild:i}=r;i?i.nodeName==="CANVAS"?i.replaceWith(n):i.classList.contains("annotationContent")?i.after(n):i.before(n):r.append(n)}d(this,kh).clear()};const ob=/\r\n?|\n/g;var ro,Bi,yv,Ch,$i,As,F6,D6,B6,Jb,hc,Qb,Zb,$6,FA,U6;const Cn=class Cn extends Xn{constructor(t){super({...t,name:"freeTextEditor"});$(this,As);$(this,ro);$(this,Bi,"");$(this,yv,`${this.id}-editor`);$(this,Ch,null);$(this,$i);E(this,ro,t.color||Cn._defaultColor||Xn._defaultLineColor),E(this,$i,t.fontSize||Cn._defaultFontSize)}static get _keyboardManager(){const t=Cn.prototype,n=a=>a.isEmpty(),r=tf.TRANSLATE_SMALL,i=tf.TRANSLATE_BIG;return zt(this,"_keyboardManager",new Jv([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:n}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:n}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:n}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:n}]]))}static initialize(t,n){Xn.initialize(t,n);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,n){switch(t){case Gt.FREETEXT_SIZE:Cn._defaultFontSize=n;break;case Gt.FREETEXT_COLOR:Cn._defaultColor=n;break}}updateParams(t,n){switch(t){case Gt.FREETEXT_SIZE:z(this,As,F6).call(this,n);break;case Gt.FREETEXT_COLOR:z(this,As,D6).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Gt.FREETEXT_SIZE,Cn._defaultFontSize],[Gt.FREETEXT_COLOR,Cn._defaultColor||Xn._defaultLineColor]]}get propertiesToUpdate(){return[[Gt.FREETEXT_SIZE,d(this,$i)],[Gt.FREETEXT_COLOR,d(this,ro)]]}_translateEmpty(t,n){this._uiManager.translateSelectedEditors(t,n,!0)}getInitialTranslation(){const t=this.parentScale;return[-Cn._internalPadding*t,-(Cn._internalPadding+d(this,$i))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(Rt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),E(this,Ch,new AbortController);const t=this._uiManager.combinedSignal(d(this,Ch));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",d(this,yv)),this._isDraggable=!0,(t=d(this,Ch))==null||t.abort(),E(this,Ch,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var n;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=d(this,Bi),n=E(this,Bi,z(this,As,B6).call(this).trimEnd());if(t===n)return;const r=i=>{if(E(this,Bi,i),!i){this.remove();return}z(this,As,Zb).call(this),this._uiManager.rebuild(this),z(this,As,Jb).call(this)};this.addCommands({cmd:()=>{r(n)},undo:()=>{r(t)},mustExec:!1}),z(this,As,Jb).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Cn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,n;this.width&&(t=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",d(this,yv)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${d(this,$i)}px * var(--scale-factor))`,r.color=d(this,ro),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),z2(this,this.div,["dblclick","keydown"]),this.width){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,c]=this.getInitialTranslation();[l,c]=this.pageTranslationToScreen(l,c);const[u,f]=this.pageDimensions,[p,m]=this.pageTranslation;let b,y;switch(this.rotation){case 0:b=t+(o[0]-p)/u,y=n+this.height-(o[1]-m)/f;break;case 90:b=t+(o[0]-p)/u,y=n-(o[1]-m)/f,[l,c]=[c,-l];break;case 180:b=t-this.width+(o[0]-p)/u,y=n-(o[1]-m)/f,[l,c]=[-l,-c];break;case 270:b=t+(o[0]-p-this.height*f)/u,y=n+(o[1]-m-this.width*u)/f,[l,c]=[-c,l];break}this.setAt(b*i,y*a,l,c)}else this.setAt(t*i,n*a,this.width*i,this.height*a);z(this,As,Zb).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var b,y,S;const n=t.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]==="text/plain")return;t.preventDefault();const i=z(b=Cn,hc,FA).call(b,n.getData("text")||"").replaceAll(ob,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:c}=o,u=[],f=[];if(l.nodeType===Node.TEXT_NODE){const w=l.parentElement;if(f.push(l.nodeValue.slice(c).replaceAll(ob,"")),w!==this.editorDiv){let _=u;for(const k of this.editorDiv.childNodes){if(k===w){_=f;continue}_.push(z(y=Cn,hc,Qb).call(y,k))}}u.push(l.nodeValue.slice(0,c).replaceAll(ob,""))}else if(l===this.editorDiv){let w=u,_=0;for(const k of this.editorDiv.childNodes)_++===c&&(w=f),w.push(z(S=Cn,hc,Qb).call(S,k))}E(this,Bi,`${u.join(`
`)}${i}${f.join(`
`)}`),z(this,As,Zb).call(this);const p=new Range;let m=u.reduce((w,_)=>w+_.length,0);for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const _=w.nodeValue.length;if(m<=_){p.setStart(w,m),p.setEnd(w,m);break}m-=_}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}static async deserialize(t,n,r){var o;let i=null;if(t instanceof I6){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:u,rotation:f,id:p,popupRef:m},textContent:b,textPosition:y,parent:{page:{pageNumber:S}}}=t;if(!b||b.length===0)return null;i=t={annotationType:Rt.FREETEXT,color:Array.from(c),fontSize:l,value:b.join(`
`),position:y,pageIndex:S-1,rect:u.slice(0),rotation:f,id:p,deleted:!1,popupRef:m}}const a=await super.deserialize(t,n,r);return E(a,$i,t.fontSize),E(a,ro,it.makeHexColor(...t.color)),E(a,Bi,z(o=Cn,hc,FA).call(o,t.value)),a.annotationElementId=t.id||null,a._initialData=i,a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Cn._internalPadding*this.parentScale,r=this.getRect(n,n),i=Xn._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:d(this,ro)),a={annotationType:Rt.FREETEXT,color:i,fontSize:d(this,$i),value:z(this,As,$6).call(this),pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?a:this.annotationElementId&&!z(this,As,U6).call(this,a)?null:(a.id=this.annotationElementId,a)}renderAnnotationElement(t){const n=super.renderAnnotationElement(t);if(this.deleted)return n;const{style:r}=n;r.fontSize=`calc(${d(this,$i)}px * var(--scale-factor))`,r.color=d(this,ro),n.replaceChildren();for(const a of d(this,Bi).split(`
`)){const o=document.createElement("div");o.append(a?document.createTextNode(a):document.createElement("br")),n.append(o)}const i=Cn._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(i,i),popupContent:d(this,Bi)}),n}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ro=new WeakMap,Bi=new WeakMap,yv=new WeakMap,Ch=new WeakMap,$i=new WeakMap,As=new WeakSet,F6=function(t){const n=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--scale-factor))`,this.translate(0,-(i-d(this,$i))*this.parentScale),E(this,$i,i),z(this,As,Jb).call(this)},r=d(this,$i);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},D6=function(t){const n=i=>{E(this,ro,this.editorDiv.style.color=i)},r=d(this,ro);this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},B6=function(){var r;const t=[];this.editorDiv.normalize();let n=null;for(const i of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(z(r=Cn,hc,Qb).call(r,i)),n=i);return t.join(`
`)},Jb=function(){const[t,n]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),r=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=r.width/t,this.height=r.height/n):(this.width=r.height/t,this.height=r.width/n),this.fixAndSetPosition()},hc=new WeakSet,Qb=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(ob,"")},Zb=function(){if(this.editorDiv.replaceChildren(),!!d(this,Bi))for(const t of d(this,Bi).split(`
`)){const n=document.createElement("div");n.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(n)}},$6=function(){return d(this,Bi).replaceAll(" "," ")},FA=function(t){return t.replaceAll(" "," ")},U6=function(t){const{value:n,fontSize:r,color:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||t.value!==n||t.fontSize!==r||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==a},$(Cn,hc),gt(Cn,"_freeTextDefaultContent",""),gt(Cn,"_internalPadding",0),gt(Cn,"_defaultColor",null),gt(Cn,"_defaultFontSize",10),gt(Cn,"_type","freetext"),gt(Cn,"_editorType",Rt.FREETEXT);let MA=Cn;class Qe{toSVGPath(){An("Abstract method `toSVGPath` must be implemented.")}get box(){An("Abstract getter `box` must be implemented.")}serialize(e,t){An("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,r,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*r,a[o+1]=n+e[o+1]*i;return a}static _rescaleAndSwap(e,t,n,r,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*r,a[o+1]=n+e[o]*i;return a}static _translate(e,t,n,r){r||(r=new Float32Array(e.length));for(let i=0,a=e.length;i<a;i+=2)r[i]=t+e[i],r[i+1]=n+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,r,i){switch(i){case 90:return[1-t/n,e/r];case 180:return[1-e/n,1-t/r];case 270:return[t/n,1-e/r];default:return[e/n,t/r]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,r,i,a){return[(e+5*n)/6,(t+5*r)/6,(5*n+i)/6,(5*r+a)/6,(n+i)/2,(r+a)/2]}}gt(Qe,"PRECISION",1e-4);var Ui,io,xm,_m,el,Ut,Eh,Ph,bv,wv,Am,Sm,xu,xv,mw,gw,Os,y0,z6,q6,H6,W6,V6,G6;const Rl=class Rl{constructor({x:e,y:t},n,r,i,a,o=0){$(this,Os);$(this,Ui);$(this,io,[]);$(this,xm);$(this,_m);$(this,el,[]);$(this,Ut,new Float32Array(18));$(this,Eh);$(this,Ph);$(this,bv);$(this,wv);$(this,Am);$(this,Sm);$(this,xu,[]);E(this,Ui,n),E(this,Sm,i*r),E(this,_m,a),d(this,Ut).set([NaN,NaN,NaN,NaN,e,t],6),E(this,xm,o),E(this,wv,d(Rl,xv)*r),E(this,bv,d(Rl,gw)*r),E(this,Am,r),d(this,xu).push(e,t)}isEmpty(){return isNaN(d(this,Ut)[8])}add({x:e,y:t}){var W;E(this,Eh,e),E(this,Ph,t);const[n,r,i,a]=d(this,Ui);let[o,l,c,u]=d(this,Ut).subarray(8,12);const f=e-c,p=t-u,m=Math.hypot(f,p);if(m<d(this,bv))return!1;const b=m-d(this,wv),y=b/m,S=y*f,w=y*p;let _=o,k=l;o=c,l=u,c+=S,u+=w,(W=d(this,xu))==null||W.push(e,t);const C=-w/b,B=S/b,F=C*d(this,Sm),j=B*d(this,Sm);return d(this,Ut).set(d(this,Ut).subarray(2,8),0),d(this,Ut).set([c+F,u+j],4),d(this,Ut).set(d(this,Ut).subarray(14,18),12),d(this,Ut).set([c-F,u-j],16),isNaN(d(this,Ut)[6])?(d(this,el).length===0&&(d(this,Ut).set([o+F,l+j],2),d(this,el).push(NaN,NaN,NaN,NaN,(o+F-n)/i,(l+j-r)/a),d(this,Ut).set([o-F,l-j],14),d(this,io).push(NaN,NaN,NaN,NaN,(o-F-n)/i,(l-j-r)/a)),d(this,Ut).set([_,k,o,l,c,u],6),!this.isEmpty()):(d(this,Ut).set([_,k,o,l,c,u],6),Math.abs(Math.atan2(k-l,_-o)-Math.atan2(w,S))<Math.PI/2?([o,l,c,u]=d(this,Ut).subarray(2,6),d(this,el).push(NaN,NaN,NaN,NaN,((o+c)/2-n)/i,((l+u)/2-r)/a),[o,l,_,k]=d(this,Ut).subarray(14,18),d(this,io).push(NaN,NaN,NaN,NaN,((_+o)/2-n)/i,((k+l)/2-r)/a),!0):([_,k,o,l,c,u]=d(this,Ut).subarray(0,6),d(this,el).push(((_+5*o)/6-n)/i,((k+5*l)/6-r)/a,((5*o+c)/6-n)/i,((5*l+u)/6-r)/a,((o+c)/2-n)/i,((l+u)/2-r)/a),[c,u,o,l,_,k]=d(this,Ut).subarray(12,18),d(this,io).push(((_+5*o)/6-n)/i,((k+5*l)/6-r)/a,((5*o+c)/6-n)/i,((5*l+u)/6-r)/a,((o+c)/2-n)/i,((l+u)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=d(this,el),t=d(this,io);if(isNaN(d(this,Ut)[6])&&!this.isEmpty())return z(this,Os,z6).call(this);const n=[];n.push(`M${e[4]} ${e[5]}`);for(let r=6;r<e.length;r+=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);z(this,Os,H6).call(this,n);for(let r=t.length-6;r>=6;r-=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);return z(this,Os,q6).call(this,n),n.join(" ")}newFreeDrawOutline(e,t,n,r,i,a){return new X6(e,t,n,r,i,a)}getOutlines(){var f;const e=d(this,el),t=d(this,io),n=d(this,Ut),[r,i,a,o]=d(this,Ui),l=new Float32Array((((f=d(this,xu))==null?void 0:f.length)??0)+2);for(let p=0,m=l.length-2;p<m;p+=2)l[p]=(d(this,xu)[p]-r)/a,l[p+1]=(d(this,xu)[p+1]-i)/o;if(l[l.length-2]=(d(this,Eh)-r)/a,l[l.length-1]=(d(this,Ph)-i)/o,isNaN(n[6])&&!this.isEmpty())return z(this,Os,W6).call(this,l);const c=new Float32Array(d(this,el).length+24+d(this,io).length);let u=e.length;for(let p=0;p<u;p+=2){if(isNaN(e[p])){c[p]=c[p+1]=NaN;continue}c[p]=e[p],c[p+1]=e[p+1]}u=z(this,Os,G6).call(this,c,u);for(let p=t.length-6;p>=6;p-=6)for(let m=0;m<6;m+=2){if(isNaN(t[p+m])){c[u]=c[u+1]=NaN,u+=2;continue}c[u]=t[p+m],c[u+1]=t[p+m+1],u+=2}return z(this,Os,V6).call(this,c,u),this.newFreeDrawOutline(c,l,d(this,Ui),d(this,Am),d(this,xm),d(this,_m))}};Ui=new WeakMap,io=new WeakMap,xm=new WeakMap,_m=new WeakMap,el=new WeakMap,Ut=new WeakMap,Eh=new WeakMap,Ph=new WeakMap,bv=new WeakMap,wv=new WeakMap,Am=new WeakMap,Sm=new WeakMap,xu=new WeakMap,xv=new WeakMap,mw=new WeakMap,gw=new WeakMap,Os=new WeakSet,y0=function(){const e=d(this,Ut).subarray(4,6),t=d(this,Ut).subarray(16,18),[n,r,i,a]=d(this,Ui);return[(d(this,Eh)+(e[0]-t[0])/2-n)/i,(d(this,Ph)+(e[1]-t[1])/2-r)/a,(d(this,Eh)+(t[0]-e[0])/2-n)/i,(d(this,Ph)+(t[1]-e[1])/2-r)/a]},z6=function(){const[e,t,n,r]=d(this,Ui),[i,a,o,l]=z(this,Os,y0).call(this);return`M${(d(this,Ut)[2]-e)/n} ${(d(this,Ut)[3]-t)/r} L${(d(this,Ut)[4]-e)/n} ${(d(this,Ut)[5]-t)/r} L${i} ${a} L${o} ${l} L${(d(this,Ut)[16]-e)/n} ${(d(this,Ut)[17]-t)/r} L${(d(this,Ut)[14]-e)/n} ${(d(this,Ut)[15]-t)/r} Z`},q6=function(e){const t=d(this,io);e.push(`L${t[4]} ${t[5]} Z`)},H6=function(e){const[t,n,r,i]=d(this,Ui),a=d(this,Ut).subarray(4,6),o=d(this,Ut).subarray(16,18),[l,c,u,f]=z(this,Os,y0).call(this);e.push(`L${(a[0]-t)/r} ${(a[1]-n)/i} L${l} ${c} L${u} ${f} L${(o[0]-t)/r} ${(o[1]-n)/i}`)},W6=function(e){const t=d(this,Ut),[n,r,i,a]=d(this,Ui),[o,l,c,u]=z(this,Os,y0).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-r)/a],0),this.newFreeDrawOutline(f,e,d(this,Ui),d(this,Am),d(this,xm),d(this,_m))},V6=function(e,t){const n=d(this,io);return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6},G6=function(e,t){const n=d(this,Ut).subarray(4,6),r=d(this,Ut).subarray(16,18),[i,a,o,l]=d(this,Ui),[c,u,f,p]=z(this,Os,y0).call(this);return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-a)/l,NaN,NaN,NaN,NaN,c,u,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(r[0]-i)/o,(r[1]-a)/l],t),t+=24},$(Rl,xv,8),$(Rl,mw,2),$(Rl,gw,d(Rl,xv)+d(Rl,mw));let W2=Rl;var km,Lh,ec,_v,zi,Av,ls,vw,K6;class X6 extends Qe{constructor(t,n,r,i,a,o){super();$(this,vw);$(this,km);$(this,Lh,new Float32Array(4));$(this,ec);$(this,_v);$(this,zi);$(this,Av);$(this,ls);E(this,ls,t),E(this,zi,n),E(this,km,r),E(this,Av,i),E(this,ec,a),E(this,_v,o),this.lastPoint=[NaN,NaN],z(this,vw,K6).call(this,o);const[l,c,u,f]=d(this,Lh);for(let p=0,m=t.length;p<m;p+=2)t[p]=(t[p]-l)/u,t[p+1]=(t[p+1]-c)/f;for(let p=0,m=n.length;p<m;p+=2)n[p]=(n[p]-l)/u,n[p+1]=(n[p+1]-c)/f}toSVGPath(){const t=[`M${d(this,ls)[4]} ${d(this,ls)[5]}`];for(let n=6,r=d(this,ls).length;n<r;n+=6){if(isNaN(d(this,ls)[n])){t.push(`L${d(this,ls)[n+4]} ${d(this,ls)[n+5]}`);continue}t.push(`C${d(this,ls)[n]} ${d(this,ls)[n+1]} ${d(this,ls)[n+2]} ${d(this,ls)[n+3]} ${d(this,ls)[n+4]} ${d(this,ls)[n+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,n,r,i],a){const o=r-t,l=i-n;let c,u;switch(a){case 0:c=Qe._rescale(d(this,ls),t,i,o,-l),u=Qe._rescale(d(this,zi),t,i,o,-l);break;case 90:c=Qe._rescaleAndSwap(d(this,ls),t,n,o,l),u=Qe._rescaleAndSwap(d(this,zi),t,n,o,l);break;case 180:c=Qe._rescale(d(this,ls),r,n,-o,l),u=Qe._rescale(d(this,zi),r,n,-o,l);break;case 270:c=Qe._rescaleAndSwap(d(this,ls),r,i,-o,-l),u=Qe._rescaleAndSwap(d(this,zi),r,i,-o,-l);break}return{outline:Array.from(c),points:[Array.from(u)]}}get box(){return d(this,Lh)}newOutliner(t,n,r,i,a,o=0){return new W2(t,n,r,i,a,o)}getNewOutline(t,n){const[r,i,a,o]=d(this,Lh),[l,c,u,f]=d(this,km),p=a*u,m=o*f,b=r*u+l,y=i*f+c,S=this.newOutliner({x:d(this,zi)[0]*p+b,y:d(this,zi)[1]*m+y},d(this,km),d(this,Av),t,d(this,_v),n??d(this,ec));for(let w=2;w<d(this,zi).length;w+=2)S.add({x:d(this,zi)[w]*p+b,y:d(this,zi)[w+1]*m+y});return S.getOutlines()}}km=new WeakMap,Lh=new WeakMap,ec=new WeakMap,_v=new WeakMap,zi=new WeakMap,Av=new WeakMap,ls=new WeakMap,vw=new WeakSet,K6=function(t){const n=d(this,ls);let r=n[4],i=n[5],a=r,o=i,l=r,c=i,u=r,f=i;const p=t?Math.max:Math.min;for(let b=6,y=n.length;b<y;b+=6){if(isNaN(n[b]))a=Math.min(a,n[b+4]),o=Math.min(o,n[b+5]),l=Math.max(l,n[b+4]),c=Math.max(c,n[b+5]),f<n[b+5]?(u=n[b+4],f=n[b+5]):f===n[b+5]&&(u=p(u,n[b+4]));else{const S=it.bezierBoundingBox(r,i,...n.slice(b,b+6));a=Math.min(a,S[0]),o=Math.min(o,S[1]),l=Math.max(l,S[2]),c=Math.max(c,S[3]),f<S[3]?(u=S[2],f=S[3]):f===S[3]&&(u=p(u,S[2]))}r=n[b+4],i=n[b+5]}const m=d(this,Lh);m[0]=a-d(this,ec),m[1]=o-d(this,ec),m[2]=l-a+2*d(this,ec),m[3]=c-o+2*d(this,ec),this.lastPoint=[u,f]};var Sv,kv,_u,ao,Yr,Y6,e2,J6,Q6,BA;class DA{constructor(e,t=0,n=0,r=!0){$(this,Yr);$(this,Sv);$(this,kv);$(this,_u,[]);$(this,ao,[]);let i=1/0,a=-1/0,o=1/0,l=-1/0;const c=10**-4;for(const{x:S,y:w,width:_,height:k}of e){const C=Math.floor((S-t)/c)*c,B=Math.ceil((S+_+t)/c)*c,F=Math.floor((w-t)/c)*c,j=Math.ceil((w+k+t)/c)*c,T=[C,F,j,!0],W=[B,F,j,!1];d(this,_u).push(T,W),i=Math.min(i,C),a=Math.max(a,B),o=Math.min(o,F),l=Math.max(l,j)}const u=a-i+2*n,f=l-o+2*n,p=i-n,m=o-n,b=d(this,_u).at(r?-1:-2),y=[b[0],b[2]];for(const S of d(this,_u)){const[w,_,k]=S;S[0]=(w-p)/u,S[1]=(_-m)/f,S[2]=(k-m)/f}E(this,Sv,new Float32Array([p,m,u,f])),E(this,kv,y)}getOutlines(){d(this,_u).sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of d(this,_u))t[3]?(e.push(...z(this,Yr,BA).call(this,t)),z(this,Yr,J6).call(this,t)):(z(this,Yr,Q6).call(this,t),e.push(...z(this,Yr,BA).call(this,t)));return z(this,Yr,Y6).call(this,e)}}Sv=new WeakMap,kv=new WeakMap,_u=new WeakMap,ao=new WeakMap,Yr=new WeakSet,Y6=function(e){const t=[],n=new Set;for(const a of e){const[o,l,c]=a;t.push([o,l,a],[o,c,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],c=t[a+1][2];l.push(c),c.push(l),n.add(l),n.add(c)}const r=[];let i;for(;n.size>0;){const a=n.values().next().value;let[o,l,c,u,f]=a;n.delete(a);let p=o,m=l;for(i=[o,c],r.push(i);;){let b;if(n.has(u))b=u;else if(n.has(f))b=f;else break;n.delete(b),[o,l,c,u,f]=b,p!==o&&(i.push(p,m,o,m===l?l:c),p=o),m=m===l?c:l}i.push(p,m)}return new LD(r,d(this,Sv),d(this,kv))},e2=function(e){const t=d(this,ao);let n=0,r=t.length-1;for(;n<=r;){const i=n+r>>1,a=t[i][0];if(a===e)return i;a<e?n=i+1:r=i-1}return r+1},J6=function([,e,t]){const n=z(this,Yr,e2).call(this,e);d(this,ao).splice(n,0,[e,t])},Q6=function([,e,t]){const n=z(this,Yr,e2).call(this,e);for(let r=n;r<d(this,ao).length;r++){const[i,a]=d(this,ao)[r];if(i!==e)break;if(i===e&&a===t){d(this,ao).splice(r,1);return}}for(let r=n-1;r>=0;r--){const[i,a]=d(this,ao)[r];if(i!==e)break;if(i===e&&a===t){d(this,ao).splice(r,1);return}}},BA=function(e){const[t,n,r]=e,i=[[t,n,r]],a=z(this,Yr,e2).call(this,r);for(let o=0;o<a;o++){const[l,c]=d(this,ao)[o];for(let u=0,f=i.length;u<f;u++){const[,p,m]=i[u];if(!(c<=p||m<=l)){if(p>=l){if(m>c)i[u][1]=c;else{if(f===1)return[];i.splice(u,1),u--,f--}continue}i[u][2]=l,m>c&&i.push([t,c,m])}}}return i};var Nv,Nm;class LD extends Qe{constructor(t,n,r){super();$(this,Nv);$(this,Nm);E(this,Nm,t),E(this,Nv,n),this.lastPoint=r}toSVGPath(){const t=[];for(const n of d(this,Nm)){let[r,i]=n;t.push(`M${r} ${i}`);for(let a=2;a<n.length;a+=2){const o=n[a],l=n[a+1];o===r?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),r=o)}t.push("Z")}return t.join(" ")}serialize([t,n,r,i],a){const o=[],l=r-t,c=i-n;for(const u of d(this,Nm)){const f=new Array(u.length);for(let p=0;p<u.length;p+=2)f[p]=t+u[p]*l,f[p+1]=i-u[p+1]*c;o.push(f)}return o}get box(){return d(this,Nv)}get classNamesForOutlining(){return["highlightOutline"]}}Nv=new WeakMap,Nm=new WeakMap;class $A extends W2{newFreeDrawOutline(e,t,n,r,i,a){return new TD(e,t,n,r,i,a)}}class TD extends X6{newOutliner(e,t,n,r,i,a=0){return new $A(e,t,n,r,i,a)}}var oo,Th,Cm,Is,Cv,Em,Ev,Pv,Au,lo,Pm,Lv,vn,UA,zA,qA,Nd,Z6,Xc;const fi=class fi{constructor({editor:e=null,uiManager:t=null}){$(this,vn);$(this,oo,null);$(this,Th,null);$(this,Cm);$(this,Is,null);$(this,Cv,!1);$(this,Em,!1);$(this,Ev,null);$(this,Pv);$(this,Au,null);$(this,lo,null);$(this,Pm);var n;e?(E(this,Em,!1),E(this,Pm,Gt.HIGHLIGHT_COLOR),E(this,Ev,e)):(E(this,Em,!0),E(this,Pm,Gt.HIGHLIGHT_DEFAULT_COLOR)),E(this,lo,(e==null?void 0:e._uiManager)||t),E(this,Pv,d(this,lo)._eventBus),E(this,Cm,(e==null?void 0:e.color)||((n=d(this,lo))==null?void 0:n.highlightColors.values().next().value)||"#FFFF98"),d(fi,Lv)||E(fi,Lv,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return zt(this,"_keyboardManager",new Jv([[["Escape","mac+Escape"],fi.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],fi.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],fi.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],fi.prototype._moveToPrevious],[["Home","mac+Home"],fi.prototype._moveToBeginning],[["End","mac+End"],fi.prototype._moveToEnd]]))}renderButton(){const e=E(this,oo,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=d(this,lo)._signal;e.addEventListener("click",z(this,vn,Nd).bind(this),{signal:t}),e.addEventListener("keydown",z(this,vn,qA).bind(this),{signal:t});const n=E(this,Th,document.createElement("span"));return n.className="swatch",n.setAttribute("aria-hidden",!0),n.style.backgroundColor=d(this,Cm),e.append(n),e}renderMainDropdown(){const e=E(this,Is,z(this,vn,UA).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===d(this,oo)){z(this,vn,Nd).call(this,e);return}const t=e.target.getAttribute("data-color");t&&z(this,vn,zA).call(this,t,e)}_moveToNext(e){var t,n;if(!d(this,vn,Xc)){z(this,vn,Nd).call(this,e);return}if(e.target===d(this,oo)){(t=d(this,Is).firstChild)==null||t.focus();return}(n=e.target.nextSibling)==null||n.focus()}_moveToPrevious(e){var t,n;if(e.target===((t=d(this,Is))==null?void 0:t.firstChild)||e.target===d(this,oo)){d(this,vn,Xc)&&this._hideDropdownFromKeyboard();return}d(this,vn,Xc)||z(this,vn,Nd).call(this,e),(n=e.target.previousSibling)==null||n.focus()}_moveToBeginning(e){var t;if(!d(this,vn,Xc)){z(this,vn,Nd).call(this,e);return}(t=d(this,Is).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!d(this,vn,Xc)){z(this,vn,Nd).call(this,e);return}(t=d(this,Is).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=d(this,Is))==null||e.classList.add("hidden"),(t=d(this,Au))==null||t.abort(),E(this,Au,null)}_hideDropdownFromKeyboard(){var e;if(!d(this,Em)){if(!d(this,vn,Xc)){(e=d(this,Ev))==null||e.unselect();return}this.hideDropdown(),d(this,oo).focus({preventScroll:!0,focusVisible:d(this,Cv)})}}updateColor(e){if(d(this,Th)&&(d(this,Th).style.backgroundColor=e),!d(this,Is))return;const t=d(this,lo).highlightColors.values();for(const n of d(this,Is).children)n.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=d(this,oo))==null||e.remove(),E(this,oo,null),E(this,Th,null),(t=d(this,Is))==null||t.remove(),E(this,Is,null)}};oo=new WeakMap,Th=new WeakMap,Cm=new WeakMap,Is=new WeakMap,Cv=new WeakMap,Em=new WeakMap,Ev=new WeakMap,Pv=new WeakMap,Au=new WeakMap,lo=new WeakMap,Pm=new WeakMap,Lv=new WeakMap,vn=new WeakSet,UA=function(){const e=document.createElement("div"),t=d(this,lo)._signal;e.addEventListener("contextmenu",wo,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[n,r]of d(this,lo).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",r),i.title=n,i.setAttribute("data-l10n-id",d(fi,Lv)[n]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=r,i.setAttribute("aria-selected",r===d(this,Cm)),i.addEventListener("click",z(this,vn,zA).bind(this,r),{signal:t}),e.append(i)}return e.addEventListener("keydown",z(this,vn,qA).bind(this),{signal:t}),e},zA=function(e,t){t.stopPropagation(),d(this,Pv).dispatch("switchannotationeditorparams",{source:this,type:d(this,Pm),value:e})},qA=function(e){fi._keyboardManager.exec(this,e)},Nd=function(e){if(d(this,vn,Xc)){this.hideDropdown();return}if(E(this,Cv,e.detail===0),d(this,Au)||(E(this,Au,new AbortController),window.addEventListener("pointerdown",z(this,vn,Z6).bind(this),{signal:d(this,lo).combinedSignal(d(this,Au))})),d(this,Is)){d(this,Is).classList.remove("hidden");return}const t=E(this,Is,z(this,vn,UA).call(this));d(this,oo).append(t)},Z6=function(e){var t;(t=d(this,Is))!=null&&t.contains(e.target)||this.hideDropdown()},Xc=function(){return d(this,Is)&&!d(this,Is).classList.contains("hidden")},$(fi,Lv,null);let V2=fi;var Lm,Tv,tc,Ih,Tm,gi,Iv,jv,jh,wa,qi,rr,Im,nc,Cr,jm,xa,Rv,jt,HA,t2,eI,tI,nI,WA,Cd,Ca,np,sI,n2,b0,rI,iI,aI,oI,lI;const rn=class rn extends Xn{constructor(t){super({...t,name:"highlightEditor"});$(this,jt);$(this,Lm,null);$(this,Tv,0);$(this,tc);$(this,Ih,null);$(this,Tm,null);$(this,gi,null);$(this,Iv,null);$(this,jv,0);$(this,jh,null);$(this,wa,null);$(this,qi,null);$(this,rr,!1);$(this,Im,null);$(this,nc);$(this,Cr,null);$(this,jm,"");$(this,xa);$(this,Rv,"");this.color=t.color||rn._defaultColor,E(this,xa,t.thickness||rn._defaultThickness),E(this,nc,t.opacity||rn._defaultOpacity),E(this,tc,t.boxes||null),E(this,Rv,t.methodOfCreation||""),E(this,jm,t.text||""),this._isDraggable=!1,t.highlightId>-1?(E(this,rr,!0),z(this,jt,t2).call(this,t),z(this,jt,Cd).call(this)):d(this,tc)&&(E(this,Lm,t.anchorNode),E(this,Tv,t.anchorOffset),E(this,Iv,t.focusNode),E(this,jv,t.focusOffset),z(this,jt,HA).call(this),z(this,jt,Cd).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=rn.prototype;return zt(this,"_keyboardManager",new Jv([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:d(this,rr)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:d(this,xa),methodOfCreation:d(this,Rv)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,n){var r;Xn.initialize(t,n),rn._defaultColor||(rn._defaultColor=((r=n.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(t,n){switch(t){case Gt.HIGHLIGHT_DEFAULT_COLOR:rn._defaultColor=n;break;case Gt.HIGHLIGHT_THICKNESS:rn._defaultThickness=n;break}}translateInPage(t,n){}get toolbarPosition(){return d(this,Im)}updateParams(t,n){switch(t){case Gt.HIGHLIGHT_COLOR:z(this,jt,eI).call(this,n);break;case Gt.HIGHLIGHT_THICKNESS:z(this,jt,tI).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Gt.HIGHLIGHT_DEFAULT_COLOR,rn._defaultColor],[Gt.HIGHLIGHT_THICKNESS,rn._defaultThickness]]}get propertiesToUpdate(){return[[Gt.HIGHLIGHT_COLOR,this.color||rn._defaultColor],[Gt.HIGHLIGHT_THICKNESS,d(this,xa)||rn._defaultThickness],[Gt.HIGHLIGHT_FREE,d(this,rr)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(E(this,Tm,new V2({editor:this})),t.addColorPicker(d(this,Tm))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(z(this,jt,b0).call(this))}getBaseTranslation(){return[0,0]}getRect(t,n){return super.getRect(t,n,z(this,jt,b0).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){z(this,jt,WA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(z(this,jt,Cd).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?z(this,jt,WA).call(this):t&&(z(this,jt,Cd).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),n&&this.select()}rotate(t){var i,a,o;const{drawLayer:n}=this.parent;let r;d(this,rr)?(t=(t-this.rotation+360)%360,r=z(i=rn,Ca,np).call(i,d(this,wa).box,t)):r=z(a=rn,Ca,np).call(a,[this.x,this.y,this.width,this.height],t),n.updateProperties(d(this,qi),{bbox:r,root:{"data-main-rotation":t}}),n.updateProperties(d(this,Cr),{bbox:z(o=rn,Ca,np).call(o,d(this,gi).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();d(this,jm)&&(t.setAttribute("aria-label",d(this,jm)),t.setAttribute("role","mark")),d(this,rr)?t.classList.add("free"):this.div.addEventListener("keydown",z(this,jt,sI).bind(this),{signal:this._uiManager._signal});const n=E(this,jh,document.createElement("div"));t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=d(this,Ih);const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),z2(this,d(this,jh),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,Cr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(d(this,Cr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:z(this,jt,n2).call(this,!0);break;case 1:case 3:z(this,jt,n2).call(this,!1);break}}select(){var t;super.select(),d(this,Cr)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,Cr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),d(this,Cr)&&((t=this.parent)==null||t.drawLayer.updateProperties(d(this,Cr),{rootClass:{selected:!1}}),d(this,rr)||z(this,jt,n2).call(this,!1))}get _mustFixPosition(){return!d(this,rr)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(d(this,qi),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(d(this,Cr),{rootClass:{hidden:!t}}))}static startHighlighting(t,n,{target:r,x:i,y:a}){const{x:o,y:l,width:c,height:u}=r.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),m=b=>{f.abort(),z(this,Ca,oI).call(this,t,b)};window.addEventListener("blur",m,{signal:p}),window.addEventListener("pointerup",m,{signal:p}),window.addEventListener("pointerdown",Yi,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",wo,{signal:p}),r.addEventListener("pointermove",z(this,Ca,aI).bind(this,t),{signal:p}),this._freeHighlight=new $A({x:i,y:a},[o,l,c,u],t.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,n,r){var y,S,w,_;let i=null;if(t instanceof R6){const{data:{quadPoints:k,rect:C,rotation:B,id:F,color:j,opacity:T,popupRef:W},parent:{page:{pageNumber:Y}}}=t;i=t={annotationType:Rt.HIGHLIGHT,color:Array.from(j),opacity:T,quadPoints:k,boxes:null,pageIndex:Y-1,rect:C.slice(0),rotation:B,id:F,deleted:!1,popupRef:W}}else if(t instanceof m3){const{data:{inkLists:k,rect:C,rotation:B,id:F,color:j,borderStyle:{rawWidth:T},popupRef:W},parent:{page:{pageNumber:Y}}}=t;i=t={annotationType:Rt.HIGHLIGHT,color:Array.from(j),thickness:T,inkLists:k,boxes:null,pageIndex:Y-1,rect:C.slice(0),rotation:B,id:F,deleted:!1,popupRef:W}}const{color:a,quadPoints:o,inkLists:l,opacity:c}=t,u=await super.deserialize(t,n,r);u.color=it.makeHexColor(...a),E(u,nc,c||1),l&&E(u,xa,t.thickness),u.annotationElementId=t.id||null,u._initialData=i;const[f,p]=u.pageDimensions,[m,b]=u.pageTranslation;if(o){const k=E(u,tc,[]);for(let C=0;C<o.length;C+=8)k.push({x:(o[C]-m)/f,y:1-(o[C+1]-b)/p,width:(o[C+2]-o[C])/f,height:(o[C+1]-o[C+5])/p});z(y=u,jt,HA).call(y),z(S=u,jt,Cd).call(S),u.rotate(u.rotation)}else if(l){E(u,rr,!0);const k=l[0],C={x:k[0]-m,y:p-(k[1]-b)},B=new $A(C,[0,0,f,p],1,d(u,xa)/2,!0,.001);for(let T=0,W=k.length;T<W;T+=2)C.x=k[T]-m,C.y=p-(k[T+1]-b),B.add(C);const{id:F,clipPathId:j}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:u.color,"fill-opacity":u._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:B.toSVGPath()}},!0,!0);z(w=u,jt,t2).call(w,{highlightOutlines:B.getOutlines(),highlightId:F,clipPathId:j}),z(_=u,jt,Cd).call(_)}return u}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const n=this.getRect(0,0),r=Xn._colorManager.convert(this.color),i={annotationType:Rt.HIGHLIGHT,color:r,opacity:d(this,nc),thickness:d(this,xa),quadPoints:z(this,jt,rI).call(this),outlines:z(this,jt,iI).call(this,n),pageIndex:this.pageIndex,rect:n,rotation:z(this,jt,b0).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!z(this,jt,lI).call(this,i)?null:(i.id=this.annotationElementId,i)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Lm=new WeakMap,Tv=new WeakMap,tc=new WeakMap,Ih=new WeakMap,Tm=new WeakMap,gi=new WeakMap,Iv=new WeakMap,jv=new WeakMap,jh=new WeakMap,wa=new WeakMap,qi=new WeakMap,rr=new WeakMap,Im=new WeakMap,nc=new WeakMap,Cr=new WeakMap,jm=new WeakMap,xa=new WeakMap,Rv=new WeakMap,jt=new WeakSet,HA=function(){const t=new DA(d(this,tc),.001);E(this,wa,t.getOutlines()),[this.x,this.y,this.width,this.height]=d(this,wa).box;const n=new DA(d(this,tc),.0025,.001,this._uiManager.direction==="ltr");E(this,gi,n.getOutlines());const{lastPoint:r}=d(this,gi);E(this,Im,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height])},t2=function({highlightOutlines:t,highlightId:n,clipPathId:r}){var f,p;if(E(this,wa,t),E(this,gi,t.getNewOutline(d(this,xa)/2+1.5,.0025)),n>=0)E(this,qi,n),E(this,Ih,r),this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),E(this,Cr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:d(this,gi).box,path:{d:d(this,gi).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(d(this,qi),{bbox:z(f=rn,Ca,np).call(f,d(this,wa).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(d(this,Cr),{bbox:z(p=rn,Ca,np).call(p,d(this,gi).box,m),path:{d:d(this,gi).toSVGPath()}})}const[a,o,l,c]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=c;break;case 90:{const[m,b]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*b/m,this.height=c*m/b;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=c;break;case 270:{const[m,b]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*b/m,this.height=c*m/b;break}}const{lastPoint:u}=d(this,gi);E(this,Im,[(u[0]-a)/l,(u[1]-o)/c])},eI=function(t){const n=(a,o)=>{var l,c;this.color=a,E(this,nc,o),(l=this.parent)==null||l.drawLayer.updateProperties(d(this,qi),{root:{fill:a,"fill-opacity":o}}),(c=d(this,Tm))==null||c.updateColor(a)},r=this.color,i=d(this,nc);this.addCommands({cmd:n.bind(this,t,rn._defaultOpacity),undo:n.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},tI=function(t){const n=d(this,xa),r=i=>{E(this,xa,i),z(this,jt,nI).call(this,i)};this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Gt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},nI=function(t){if(!d(this,rr))return;z(this,jt,t2).call(this,{highlightOutlines:d(this,wa).getNewOutline(t/2)}),this.fixAndSetPosition();const[n,r]=this.parentDimensions;this.setDims(this.width*n,this.height*r)},WA=function(){d(this,qi)===null||!this.parent||(this.parent.drawLayer.remove(d(this,qi)),E(this,qi,null),this.parent.drawLayer.remove(d(this,Cr)),E(this,Cr,null))},Cd=function(t=this.parent){d(this,qi)===null&&({id:$r(this,qi)._,clipPathId:$r(this,Ih)._}=t.drawLayer.draw({bbox:d(this,wa).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":d(this,nc)},rootClass:{highlight:!0,free:d(this,rr)},path:{d:d(this,wa).toSVGPath()}},!1,!0),E(this,Cr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:d(this,rr)},bbox:d(this,gi).box,path:{d:d(this,gi).toSVGPath()}},d(this,rr))),d(this,jh)&&(d(this,jh).style.clipPath=d(this,Ih)))},Ca=new WeakSet,np=function([t,n,r,i],a){switch(a){case 90:return[1-n-i,t,i,r];case 180:return[1-t-r,1-n-i,r,i];case 270:return[n,1-t-r,i,r]}return[t,n,r,i]},sI=function(t){rn._keyboardManager.exec(this,t)},n2=function(t){if(!d(this,Lm))return;const n=window.getSelection();t?n.setPosition(d(this,Lm),d(this,Tv)):n.setPosition(d(this,Iv),d(this,jv))},b0=function(){return d(this,rr)?this.rotation:0},rI=function(){if(d(this,rr))return null;const[t,n]=this.pageDimensions,[r,i]=this.pageTranslation,a=d(this,tc),o=new Float32Array(a.length*8);let l=0;for(const{x:c,y:u,width:f,height:p}of a){const m=c*t+r,b=(1-u)*n+i;o[l]=o[l+4]=m,o[l+1]=o[l+3]=b,o[l+2]=o[l+6]=m+f*t,o[l+5]=o[l+7]=b-p*n,l+=8}return o},iI=function(t){return d(this,wa).serialize(t,z(this,jt,b0).call(this))},aI=function(t,n){this._freeHighlight.add(n)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},oI=function(t,n){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},lI=function(t){const{color:n}=this._initialData;return t.color.some((r,i)=>r!==n[i])},$(rn,Ca),gt(rn,"_defaultColor",null),gt(rn,"_defaultOpacity",1),gt(rn,"_defaultThickness",12),gt(rn,"_type","highlight"),gt(rn,"_editorType",Rt.HIGHLIGHT),gt(rn,"_freeHighlightId",-1),gt(rn,"_freeHighlight",null),gt(rn,"_freeHighlightClipId","");let G2=rn;var Rh;class ID{constructor(){$(this,Rh,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))this.updateProperty(t,n)}updateSVGProperty(e,t){d(this,Rh)[e]=t}toSVGProperties(){const e=d(this,Rh);return E(this,Rh,Object.create(null)),{root:e}}reset(){E(this,Rh,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){An("Not implemented")}}Rh=new WeakMap;var Hi,Rm,Vs,Oh,Mh,Su,ku,Nu,Fh,Qt,GA,XA,KA,w0,cI,s2,x0,sp;const et=class et extends Xn{constructor(t){super(t);$(this,Qt);$(this,Hi,null);$(this,Rm);gt(this,"_drawId",null);E(this,Rm,t.mustBeCommitted||!1),t.drawOutlines&&(z(this,Qt,GA).call(this,t),z(this,Qt,w0).call(this))}static _mergeSVGProperties(t,n){const r=new Set(Object.keys(t));for(const[i,a]of Object.entries(n))r.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){An("Not implemented")}static get typesMap(){An("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){const r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,n),this._currentParent&&(d(et,Vs).updateProperty(r,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,n){const r=this.constructor.typesMap.get(t);r&&this._updateProperty(t,r,n)}static get defaultPropertiesToUpdate(){const t=[],n=this._defaultDrawingOptions;for(const[r,i]of this.typesMap)t.push([r,n[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:n}=this;for(const[r,i]of this.constructor.typesMap)t.push([r,n[i]]);return t}_updateProperty(t,n,r){const i=this._drawingOptions,a=i[n],o=l=>{var u;i.updateProperty(n,l);const c=d(this,Hi).updateProperty(n,l);c&&z(this,Qt,x0).call(this,c),(u=this.parent)==null||u.drawLayer.updateProperties(this._drawId,i.toSVGProperties())};this.addCommands({cmd:o.bind(this,r),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,et._mergeSVGProperties(d(this,Hi).getPathResizingSVGProperties(z(this,Qt,s2).call(this)),{bbox:z(this,Qt,sp).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,et._mergeSVGProperties(d(this,Hi).getPathResizedSVGProperties(z(this,Qt,s2).call(this)),{bbox:z(this,Qt,sp).call(this)}))}_onTranslating(t,n){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:z(this,Qt,sp).call(this,t,n)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,et._mergeSVGProperties(d(this,Hi).getPathTranslatedSVGProperties(z(this,Qt,s2).call(this),this.parentDimensions),{bbox:z(this,Qt,sp).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,d(this,Rm)&&(E(this,Rm,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){z(this,Qt,KA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(z(this,Qt,w0).call(this),z(this,Qt,x0).call(this,d(this,Hi).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var r;let n=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),z(this,Qt,KA).call(this)):t&&(this._uiManager.addShouldRescale(this),z(this,Qt,w0).call(this,t),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(t),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,et._mergeSVGProperties({bbox:z(this,Qt,sp).call(this)},d(this,Hi).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&z(this,Qt,x0).call(this,d(this,Hi).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const n=document.createElement("div");t.append(n),n.setAttribute("aria-hidden","true"),n.className="internal";const[r,i]=this.parentDimensions;return this.setDims(this.width*r,this.height*i),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,n,r,i,a){An("Not implemented")}static startDrawing(t,n,r,i){var S;const{target:a,offsetX:o,offsetY:l,pointerId:c,pointerType:u}=i;if(d(et,ku)&&d(et,ku)!==u)return;const{viewport:{rotation:f}}=t,{width:p,height:m}=a.getBoundingClientRect(),b=E(et,Oh,new AbortController),y=t.combinedSignal(b);if(d(et,Su)||E(et,Su,c),d(et,ku)??E(et,ku,u),window.addEventListener("pointerup",w=>{var _;d(et,Su)===w.pointerId?this._endDraw(w):(_=d(et,Nu))==null||_.delete(w.pointerId)},{signal:y}),window.addEventListener("pointercancel",w=>{var _;d(et,Su)===w.pointerId?this._currentParent.endDrawingSession():(_=d(et,Nu))==null||_.delete(w.pointerId)},{signal:y}),window.addEventListener("pointerdown",w=>{d(et,ku)===w.pointerType&&((d(et,Nu)||E(et,Nu,new Set)).add(w.pointerId),d(et,Vs).isCancellable()&&(d(et,Vs).removeLastElement(),d(et,Vs).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",wo,{signal:y}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),a.addEventListener("touchmove",w=>{w.timeStamp===d(et,Fh)&&Yi(w)},{signal:y}),t.toggleDrawing(),(S=n._editorUndoBar)==null||S.hide(),d(et,Vs)){t.drawLayer.updateProperties(this._currentDrawId,d(et,Vs).startNew(o,l,p,m,f));return}n.updateUIForDefaultProperties(this),E(et,Vs,this.createDrawerInstance(o,l,p,m,f)),E(et,Mh,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(d(et,Mh).toSVGProperties(),d(et,Vs).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(E(et,Fh,-1),!d(et,Vs))return;const{offsetX:n,offsetY:r,pointerId:i}=t;if(d(et,Su)===i){if(((a=d(et,Nu))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,d(et,Vs).add(n,r)),E(et,Fh,t.timeStamp),Yi(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,E(et,Vs,null),E(et,Mh,null),E(et,ku,null),E(et,Fh,NaN)),d(et,Oh)&&(d(et,Oh).abort(),E(et,Oh,null),E(et,Su,NaN),E(et,Nu,null))}static _endDraw(t){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t&&n.drawLayer.updateProperties(this._currentDrawId,d(et,Vs).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const r=d(et,Vs),i=this._currentDrawId,a=r.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(i,r.setLastElement(a))},undo:()=>{n.drawLayer.updateProperties(i,r.removeLastElement())},mustExec:!1,type:Gt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Gt.DRAW_STEP),!d(et,Vs).isEmpty()){const{pageDimensions:[r,i],scale:a}=n,o=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:d(et,Vs).getOutlines(r*a,i*a,a,this._INNER_MARGIN),drawingOptions:d(et,Mh),mustBeCommitted:!t});return this._cleanup(!0),o}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,n,r,i,a,o){An("Not implemented")}static async deserialize(t,n,r){var f,p;const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}=n.viewport,c=this.deserializeDraw(o,l,i,a,this._INNER_MARGIN,t),u=await super.deserialize(t,n,r);return u.createDrawingOptions(t),z(f=u,Qt,GA).call(f,{drawOutlines:c}),z(p=u,Qt,w0).call(p),u.onScaleChanging(),u.rotate(),u}serializeDraw(t){const[n,r]=this.pageTranslation,[i,a]=this.pageDimensions;return d(this,Hi).serialize([n,r,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Hi=new WeakMap,Rm=new WeakMap,Vs=new WeakMap,Oh=new WeakMap,Mh=new WeakMap,Su=new WeakMap,ku=new WeakMap,Nu=new WeakMap,Fh=new WeakMap,Qt=new WeakSet,GA=function({drawOutlines:t,drawId:n,drawingOptions:r}){E(this,Hi,t),this._drawingOptions||(this._drawingOptions=r),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,t.defaultProperties)):this._drawId=z(this,Qt,XA).call(this,t,this.parent),z(this,Qt,x0).call(this,t.box)},XA=function(t,n){const{id:r}=n.drawLayer.draw(et._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r},KA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},w0=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=z(this,Qt,XA).call(this,d(this,Hi),t)}},cI=function([t,n,r,i]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[n,1-t,r*(o/a),i*(a/o)];case 180:return[1-t,1-n,r,i];case 270:return[1-n,t,r*(o/a),i*(a/o)];default:return[t,n,r,i]}},s2=function(){const{x:t,y:n,width:r,height:i,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-n,t,r*(a/o),i*(o/a)];case 180:return[1-t,1-n,r,i];case 270:return[n,1-t,r*(a/o),i*(o/a)];default:return[t,n,r,i]}},x0=function(t){if([this.x,this.y,this.width,this.height]=z(this,Qt,cI).call(this,t),this.div){this.fixAndSetPosition();const[n,r]=this.parentDimensions;this.setDims(this.width*n,this.height*r)}this._onResized()},sp=function(){const{x:t,y:n,width:r,height:i,rotation:a,parentRotation:o,parentDimensions:[l,c]}=this;switch((a*4+o)/90){case 1:return[1-n-i,t,i,r];case 2:return[1-t-r,1-n-i,r,i];case 3:return[n,1-t-r,i,r];case 4:return[t,n-r*(l/c),i*(c/l),r*(l/c)];case 5:return[1-n,t,r*(l/c),i*(c/l)];case 6:return[1-t-i*(c/l),1-n,i*(c/l),r*(l/c)];case 7:return[n-r*(l/c),1-t-i*(c/l),r*(l/c),i*(c/l)];case 8:return[t-r,n-i,r,i];case 9:return[1-n,t-r,i,r];case 10:return[1-t,1-n,r,i];case 11:return[n-i,1-t,i,r];case 12:return[t-i*(c/l),n,i*(c/l),r*(l/c)];case 13:return[1-n-r*(l/c),t-i*(c/l),r*(l/c),i*(c/l)];case 14:return[1-t,1-n-r*(l/c),i*(c/l),r*(l/c)];case 15:return[n,1-t,r*(l/c),i*(c/l)];default:return[t,n,r,i]}},gt(et,"_currentDrawId",-1),gt(et,"_currentParent",null),$(et,Vs,null),$(et,Oh,null),$(et,Mh,null),$(et,Su,NaN),$(et,ku,null),$(et,Nu,null),$(et,Fh,NaN),gt(et,"_INNER_MARGIN",3);let VA=et;var tl,Gs,Xs,Dh,Om,qr,ir,_a,Bh,$h,Uh,Mm,r2;class jD{constructor(e,t,n,r,i,a){$(this,Mm);$(this,tl,new Float64Array(6));$(this,Gs);$(this,Xs);$(this,Dh);$(this,Om);$(this,qr);$(this,ir,"");$(this,_a,0);$(this,Bh,new X2);$(this,$h);$(this,Uh);E(this,$h,n),E(this,Uh,r),E(this,Dh,i),E(this,Om,a),[e,t]=z(this,Mm,r2).call(this,e,t);const o=E(this,Gs,[NaN,NaN,NaN,NaN,e,t]);E(this,qr,[e,t]),E(this,Xs,[{line:o,points:d(this,qr)}]),d(this,tl).set(o,0)}updateProperty(e,t){e==="stroke-width"&&E(this,Om,t)}isEmpty(){return!d(this,Xs)||d(this,Xs).length===0}isCancellable(){return d(this,qr).length<=10}add(e,t){[e,t]=z(this,Mm,r2).call(this,e,t);const[n,r,i,a]=d(this,tl).subarray(2,6),o=e-i,l=t-a;return Math.hypot(d(this,$h)*o,d(this,Uh)*l)<=2?null:(d(this,qr).push(e,t),isNaN(n)?(d(this,tl).set([i,a,e,t],2),d(this,Gs).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(d(this,tl)[0])&&d(this,Gs).splice(6,6),d(this,tl).set([n,r,i,a,e,t],0),d(this,Gs).push(...Qe.createBezierPoints(n,r,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(d(this,qr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,r,i){E(this,$h,n),E(this,Uh,r),E(this,Dh,i),[e,t]=z(this,Mm,r2).call(this,e,t);const a=E(this,Gs,[NaN,NaN,NaN,NaN,e,t]);E(this,qr,[e,t]);const o=d(this,Xs).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),d(this,Xs).push({line:a,points:d(this,qr)}),d(this,tl).set(a,0),E(this,_a,0),this.toSVGPath(),null}getLastElement(){return d(this,Xs).at(-1)}setLastElement(e){return d(this,Xs)?(d(this,Xs).push(e),E(this,Gs,e.line),E(this,qr,e.points),E(this,_a,0),{path:{d:this.toSVGPath()}}):d(this,Bh).setLastElement(e)}removeLastElement(){if(!d(this,Xs))return d(this,Bh).removeLastElement();d(this,Xs).pop(),E(this,ir,"");for(let e=0,t=d(this,Xs).length;e<t;e++){const{line:n,points:r}=d(this,Xs)[e];E(this,Gs,n),E(this,qr,r),E(this,_a,0),this.toSVGPath()}return{path:{d:d(this,ir)}}}toSVGPath(){const e=Qe.svgRound(d(this,Gs)[4]),t=Qe.svgRound(d(this,Gs)[5]);if(d(this,qr).length===2)return E(this,ir,`${d(this,ir)} M ${e} ${t} Z`),d(this,ir);if(d(this,qr).length<=6){const r=d(this,ir).lastIndexOf("M");E(this,ir,`${d(this,ir).slice(0,r)} M ${e} ${t}`),E(this,_a,6)}if(d(this,qr).length===4){const r=Qe.svgRound(d(this,Gs)[10]),i=Qe.svgRound(d(this,Gs)[11]);return E(this,ir,`${d(this,ir)} L ${r} ${i}`),E(this,_a,12),d(this,ir)}const n=[];d(this,_a)===0&&(n.push(`M ${e} ${t}`),E(this,_a,6));for(let r=d(this,_a),i=d(this,Gs).length;r<i;r+=6){const[a,o,l,c,u,f]=d(this,Gs).slice(r,r+6).map(Qe.svgRound);n.push(`C${a} ${o} ${l} ${c} ${u} ${f}`)}return E(this,ir,d(this,ir)+n.join(" ")),E(this,_a,d(this,Gs).length),d(this,ir)}getOutlines(e,t,n,r){const i=d(this,Xs).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),d(this,Bh).build(d(this,Xs),e,t,n,d(this,Dh),d(this,Om),r),E(this,tl,null),E(this,Gs,null),E(this,Xs,null),E(this,ir,null),d(this,Bh)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}tl=new WeakMap,Gs=new WeakMap,Xs=new WeakMap,Dh=new WeakMap,Om=new WeakMap,qr=new WeakMap,ir=new WeakMap,_a=new WeakMap,Bh=new WeakMap,$h=new WeakMap,Uh=new WeakMap,Mm=new WeakSet,r2=function(e,t){return Qe._normalizePoint(e,t,d(this,$h),d(this,Uh),d(this,Dh))};var Hr,Ov,Mv,Wi,nl,sl,Fm,Dm,Bm,cr,Ll,uI,dI,hI;const C3=class C3 extends Qe{constructor(){super(...arguments);$(this,cr);$(this,Hr);$(this,Ov,0);$(this,Mv);$(this,Wi);$(this,nl);$(this,sl);$(this,Fm);$(this,Dm);$(this,Bm)}build(t,n,r,i,a,o,l){E(this,nl,n),E(this,sl,r),E(this,Fm,i),E(this,Dm,a),E(this,Bm,o),E(this,Mv,l??0),E(this,Wi,t),z(this,cr,dI).call(this)}setLastElement(t){return d(this,Wi).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return d(this,Wi).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:n}of d(this,Wi)){if(t.push(`M${Qe.svgRound(n[4])} ${Qe.svgRound(n[5])}`),n.length===6){t.push("Z");continue}if(n.length===12){t.push(`L${Qe.svgRound(n[10])} ${Qe.svgRound(n[11])}`);continue}for(let r=6,i=n.length;r<i;r+=6){const[a,o,l,c,u,f]=n.subarray(r,r+6).map(Qe.svgRound);t.push(`C${a} ${o} ${l} ${c} ${u} ${f}`)}}return t.join("")}serialize([t,n,r,i],a){const o=[],l=[],[c,u,f,p]=z(this,cr,uI).call(this);let m,b,y,S,w,_,k,C,B;switch(d(this,Dm)){case 0:B=Qe._rescale,m=t,b=n+i,y=r,S=-i,w=t+c*r,_=n+(1-u-p)*i,k=t+(c+f)*r,C=n+(1-u)*i;break;case 90:B=Qe._rescaleAndSwap,m=t,b=n,y=r,S=i,w=t+u*r,_=n+c*i,k=t+(u+p)*r,C=n+(c+f)*i;break;case 180:B=Qe._rescale,m=t+r,b=n,y=-r,S=i,w=t+(1-c-f)*r,_=n+u*i,k=t+(1-c)*r,C=n+(u+p)*i;break;case 270:B=Qe._rescaleAndSwap,m=t+r,b=n+i,y=-r,S=-i,w=t+(1-u-p)*r,_=n+(1-c-f)*i,k=t+(1-u)*r,C=n+(1-c)*i;break}for(const{line:F,points:j}of d(this,Wi))o.push(B(F,m,b,y,S,a?new Array(F.length):null)),l.push(B(j,m,b,y,S,a?new Array(j.length):null));return{lines:o,points:l,rect:[w,_,k,C]}}static deserialize(t,n,r,i,a,{paths:{lines:o,points:l},rotation:c,thickness:u}){const f=[];let p,m,b,y,S;switch(c){case 0:S=Qe._rescale,p=-t/r,m=n/i+1,b=1/r,y=-1/i;break;case 90:S=Qe._rescaleAndSwap,p=-n/i,m=-t/r,b=1/i,y=1/r;break;case 180:S=Qe._rescale,p=t/r+1,m=-n/i,b=-1/r,y=1/i;break;case 270:S=Qe._rescaleAndSwap,p=n/i+1,m=t/r+1,b=-1/i,y=-1/r;break}if(!o){o=[];for(const _ of l){const k=_.length;if(k===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(k===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const C=new Float32Array(3*(k-2));o.push(C);let[B,F,j,T]=_.subarray(0,4);C.set([NaN,NaN,NaN,NaN,B,F],0);for(let W=4;W<k;W+=2){const Y=_[W],I=_[W+1];C.set(Qe.createBezierPoints(B,F,j,T,Y,I),(W-2)*3),[B,F,j,T]=[j,T,Y,I]}}}for(let _=0,k=o.length;_<k;_++)f.push({line:S(o[_].map(C=>C??NaN),p,m,b,y),points:S(l[_].map(C=>C??NaN),p,m,b,y)});const w=new C3;return w.build(f,r,i,1,c,u,a),w}get box(){return d(this,Hr)}updateProperty(t,n){return t==="stroke-width"?z(this,cr,hI).call(this,n):null}updateParentDimensions([t,n],r){const[i,a]=z(this,cr,Ll).call(this);E(this,nl,t),E(this,sl,n),E(this,Fm,r);const[o,l]=z(this,cr,Ll).call(this),c=o-i,u=l-a,f=d(this,Hr);return f[0]-=c,f[1]-=u,f[2]+=2*c,f[3]+=2*u,f}updateRotation(t){return E(this,Ov,t),{path:{transform:this.rotationTransform}}}get viewBox(){return d(this,Hr).map(Qe.svgRound).join(" ")}get defaultProperties(){const[t,n]=d(this,Hr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Qe.svgRound(t)} ${Qe.svgRound(n)}`}}}get rotationTransform(){const[,,t,n]=d(this,Hr);let r=0,i=0,a=0,o=0,l=0,c=0;switch(d(this,Ov)){case 90:i=n/t,a=-t/n,l=t;break;case 180:r=-1,o=-1,l=t,c=n;break;case 270:i=-n/t,a=t/n,c=n;break;default:return""}return`matrix(${r} ${i} ${a} ${o} ${Qe.svgRound(l)} ${Qe.svgRound(c)})`}getPathResizingSVGProperties([t,n,r,i]){const[a,o]=z(this,cr,Ll).call(this),[l,c,u,f]=d(this,Hr);if(Math.abs(u-a)<=Qe.PRECISION||Math.abs(f-o)<=Qe.PRECISION){const S=t+r/2-(l+u/2),w=n+i/2-(c+f/2);return{path:{"transform-origin":`${Qe.svgRound(t)} ${Qe.svgRound(n)}`,transform:`${this.rotationTransform} translate(${S} ${w})`}}}const p=(r-2*a)/(u-2*a),m=(i-2*o)/(f-2*o),b=u/r,y=f/i;return{path:{"transform-origin":`${Qe.svgRound(l)} ${Qe.svgRound(c)}`,transform:`${this.rotationTransform} scale(${b} ${y}) translate(${Qe.svgRound(a)} ${Qe.svgRound(o)}) scale(${p} ${m}) translate(${Qe.svgRound(-a)} ${Qe.svgRound(-o)})`}}}getPathResizedSVGProperties([t,n,r,i]){const[a,o]=z(this,cr,Ll).call(this),l=d(this,Hr),[c,u,f,p]=l;if(l[0]=t,l[1]=n,l[2]=r,l[3]=i,Math.abs(f-a)<=Qe.PRECISION||Math.abs(p-o)<=Qe.PRECISION){const w=t+r/2-(c+f/2),_=n+i/2-(u+p/2);for(const{line:k,points:C}of d(this,Wi))Qe._translate(k,w,_,k),Qe._translate(C,w,_,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Qe.svgRound(t)} ${Qe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(r-2*a)/(f-2*a),b=(i-2*o)/(p-2*o),y=-m*(c+a)+t+a,S=-b*(u+o)+n+o;if(m!==1||b!==1||y!==0||S!==0)for(const{line:w,points:_}of d(this,Wi))Qe._rescale(w,y,S,m,b,w),Qe._rescale(_,y,S,m,b,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Qe.svgRound(t)} ${Qe.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,n],r){const[i,a]=r,o=d(this,Hr),l=t-o[0],c=n-o[1];if(d(this,nl)===i&&d(this,sl)===a)for(const{line:u,points:f}of d(this,Wi))Qe._translate(u,l,c,u),Qe._translate(f,l,c,f);else{const u=d(this,nl)/i,f=d(this,sl)/a;E(this,nl,i),E(this,sl,a);for(const{line:p,points:m}of d(this,Wi))Qe._rescale(p,l,c,u,f,p),Qe._rescale(m,l,c,u,f,m);o[2]*=u,o[3]*=f}return o[0]=t,o[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Qe.svgRound(t)} ${Qe.svgRound(n)}`}}}get defaultSVGProperties(){const t=d(this,Hr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Qe.svgRound(t[0])} ${Qe.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Hr=new WeakMap,Ov=new WeakMap,Mv=new WeakMap,Wi=new WeakMap,nl=new WeakMap,sl=new WeakMap,Fm=new WeakMap,Dm=new WeakMap,Bm=new WeakMap,cr=new WeakSet,Ll=function(t=d(this,Bm)){const n=d(this,Mv)+t/2*d(this,Fm);return d(this,Dm)%180===0?[n/d(this,nl),n/d(this,sl)]:[n/d(this,sl),n/d(this,nl)]},uI=function(){const[t,n,r,i]=d(this,Hr),[a,o]=z(this,cr,Ll).call(this,0);return[t+a,n+o,r-2*a,i-2*o]},dI=function(){const t=E(this,Hr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of d(this,Wi)){if(i.length<=12){for(let l=4,c=i.length;l<c;l+=6){const[u,f]=i.subarray(l,l+2);t[0]=Math.min(t[0],u),t[1]=Math.min(t[1],f),t[2]=Math.max(t[2],u),t[3]=Math.max(t[3],f)}continue}let a=i[4],o=i[5];for(let l=6,c=i.length;l<c;l+=6){const[u,f,p,m,b,y]=i.subarray(l,l+6);it.bezierBoundingBox(a,o,u,f,p,m,b,y,t),a=b,o=y}}const[n,r]=z(this,cr,Ll).call(this);t[0]=Math.min(1,Math.max(0,t[0]-n)),t[1]=Math.min(1,Math.max(0,t[1]-r)),t[2]=Math.min(1,Math.max(0,t[2]+n)),t[3]=Math.min(1,Math.max(0,t[3]+r)),t[2]-=t[0],t[3]-=t[1]},hI=function(t){const[n,r]=z(this,cr,Ll).call(this);E(this,Bm,t);const[i,a]=z(this,cr,Ll).call(this),[o,l]=[i-n,a-r],c=d(this,Hr);return c[0]-=o,c[1]-=l,c[2]+=2*o,c[3]+=2*l,c};let X2=C3;var $m;const E3=class E3 extends ID{constructor(t){super();$(this,$m);E(this,$m,t),super.updateProperties({fill:"none",stroke:Xn._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,n){t==="stroke-width"&&(n??(n=this["stroke-width"]),n*=d(this,$m).realScale),super.updateSVGProperty(t,n)}clone(){const t=new E3(d(this,$m));return t.updateAll(this),t}};$m=new WeakMap;let YA=E3;var yw,fI;const Ap=class Ap extends VA{constructor(t){super({...t,name:"inkEditor"});$(this,yw);this._willKeepAspectRatio=!0}static initialize(t,n){Xn.initialize(t,n),this._defaultDrawingOptions=new YA(n.viewParameters)}static getDefaultDrawingOptions(t){const n=this._defaultDrawingOptions.clone();return n.updateProperties(t),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return zt(this,"typesMap",new Map([[Gt.INK_THICKNESS,"stroke-width"],[Gt.INK_COLOR,"stroke"],[Gt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,n,r,i,a){return new jD(t,n,r,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,n,r,i,a,o){return X2.deserialize(t,n,r,i,a,o)}static async deserialize(t,n,r){let i=null;if(t instanceof m3){const{data:{inkLists:o,rect:l,rotation:c,id:u,color:f,opacity:p,borderStyle:{rawWidth:m},popupRef:b},parent:{page:{pageNumber:y}}}=t;i=t={annotationType:Rt.INK,color:Array.from(f),thickness:m,opacity:p,paths:{points:o},boxes:null,pageIndex:y-1,rect:l.slice(0),rotation:c,id:u,deleted:!1,popupRef:b}}const a=await super.deserialize(t,n,r);return a.annotationElementId=t.id||null,a._initialData=i,a}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:n,parent:r}=this;n.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(t,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:r}){this._drawingOptions=Ap.getDefaultDrawingOptions({stroke:it.makeHexColor(...t),"stroke-width":n,"stroke-opacity":r})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:r,rect:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":o,"stroke-width":l}}=this,c={annotationType:Rt.INK,color:Xn._colorManager.convert(a),opacity:o,thickness:l,paths:{lines:n,points:r},pageIndex:this.pageIndex,rect:i,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?c:this.annotationElementId&&!z(this,yw,fI).call(this,c)?null:(c.id=this.annotationElementId,c)}renderAnnotationElement(t){const{points:n,rect:r}=this.serializeDraw(!1);return t.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:n}),null}};yw=new WeakSet,fI=function(t){const{color:n,thickness:r,opacity:i,pageIndex:a}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==n[l])||t.thickness!==r||t.opacity!==i||t.pageIndex!==a},gt(Ap,"_type","ink"),gt(Ap,"_editorType",Rt.INK),gt(Ap,"_defaultDrawingOptions",null);let JA=Ap;var Vn,ar,Cu,sc,Eu,Um,rl,il,Vi,zm,tn,_0,A0,i2,ZA,a2,eS,o2,pI;const U0=class U0 extends Xn{constructor(t){super({...t,name:"stampEditor"});$(this,tn);$(this,Vn,null);$(this,ar,null);$(this,Cu,null);$(this,sc,null);$(this,Eu,null);$(this,Um,"");$(this,rl,null);$(this,il,null);$(this,Vi,!1);$(this,zm,!1);E(this,sc,t.bitmapUrl),E(this,Eu,t.bitmapFile)}static initialize(t,n){Xn.initialize(t,n)}static get supportedTypes(){return zt(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(n=>`image/${n}`))}static get supportedTypesStr(){return zt(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,n){n.pasteEditor(Rt.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const n=t.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(t=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await r.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const c=l.output;return await this.setGuessedAltText(c),n&&!this.hasAltTextData()&&(this.altTextData={alt:c,decorative:!1}),c}remove(){var t;d(this,ar)&&(E(this,Vn,null),this._uiManager.imageManager.deleteId(d(this,ar)),(t=d(this,rl))==null||t.remove(),E(this,rl,null),d(this,il)&&(clearTimeout(d(this,il)),E(this,il,null))),super.remove()}rebuild(){if(!this.parent){d(this,ar)&&z(this,tn,i2).call(this);return}super.rebuild(),this.div!==null&&(d(this,ar)&&d(this,rl)===null&&z(this,tn,i2).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(d(this,Cu)||d(this,Vn)||d(this,sc)||d(this,Eu)||d(this,ar))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,n;if(this.width&&(t=this.x,n=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),d(this,Vn)?z(this,tn,ZA).call(this):z(this,tn,i2).call(this),this.width&&!this.annotationElementId){const[r,i]=this.parentDimensions;this.setAt(t*r,n*i,this.width*r,this.height*i)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;d(this,il)!==null&&clearTimeout(d(this,il)),E(this,il,setTimeout(()=>{E(this,il,null),z(this,tn,eS).call(this)},200))}copyCanvas(t,n,r=!1){var m;t||(t=224);const{width:i,height:a}=d(this,Vn),o=new Y_;let l=d(this,Vn),c=i,u=a,f=null;if(n){if(i>n||a>n){const T=Math.min(n/i,n/a);c=Math.floor(i*T),u=Math.floor(a*T)}f=document.createElement("canvas");const b=f.width=Math.ceil(c*o.sx),y=f.height=Math.ceil(u*o.sy);d(this,Vi)||(l=z(this,tn,a2).call(this,b,y));const S=f.getContext("2d");S.filter=this._uiManager.hcmFilter;let w="white",_="#cfcfd8";this._uiManager.hcmFilter!=="none"?_="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(w="#8f8f9d",_="#42414d");const k=15,C=k*o.sx,B=k*o.sy,F=new OffscreenCanvas(C*2,B*2),j=F.getContext("2d");j.fillStyle=w,j.fillRect(0,0,C*2,B*2),j.fillStyle=_,j.fillRect(0,0,C,B),j.fillRect(C,B,C,B),S.fillStyle=S.createPattern(F,"repeat"),S.fillRect(0,0,b,y),S.drawImage(l,0,0,l.width,l.height,0,0,b,y)}let p=null;if(r){let b,y;if(o.symmetric&&l.width<t&&l.height<t)b=l.width,y=l.height;else if(l=d(this,Vn),i>t||a>t){const _=Math.min(t/i,t/a);b=Math.floor(i*_),y=Math.floor(a*_),d(this,Vi)||(l=z(this,tn,a2).call(this,b,y))}const w=new OffscreenCanvas(b,y).getContext("2d",{willReadFrequently:!0});w.drawImage(l,0,0,l.width,l.height,0,0,b,y),p={width:b,height:y,data:w.getImageData(0,0,b,y).data}}return{canvas:f,width:c,height:u,imageData:p}}getImageForAltText(){return d(this,rl)}static async deserialize(t,n,r){var y;let i=null;if(t instanceof O6){const{data:{rect:S,rotation:w,id:_,structParent:k,popupRef:C},container:B,parent:{page:{pageNumber:F}}}=t,j=B.querySelector("canvas"),T=r.imageManager.getFromCanvas(B.id,j);j.remove();const W=((y=await n._structTree.getAriaAttributes(`${o3}${_}`))==null?void 0:y.get("aria-label"))||"";i=t={annotationType:Rt.STAMP,bitmapId:T.id,bitmap:T.bitmap,pageIndex:F-1,rect:S.slice(0),rotation:w,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:W},isSvg:!1,structParent:k,popupRef:C}}const a=await super.deserialize(t,n,r),{rect:o,bitmap:l,bitmapUrl:c,bitmapId:u,isSvg:f,accessibilityData:p}=t;u&&r.imageManager.isValidId(u)?(E(a,ar,u),l&&E(a,Vn,l)):E(a,sc,c),E(a,Vi,f);const[m,b]=a.pageDimensions;return a.width=(o[2]-o[0])/m,a.height=(o[3]-o[1])/b,a.annotationElementId=t.id||null,p&&(a.altTextData=p),a._initialData=i,E(a,zm,!!i),a}serialize(t=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r={annotationType:Rt.STAMP,bitmapId:d(this,ar),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:d(this,Vi),structTreeParentId:this._structTreeParentId};if(t)return r.bitmapUrl=z(this,tn,o2).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(r.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=z(this,tn,pI).call(this,r);if(l.isSame)return null;l.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1}if(r.id=this.annotationElementId,n===null)return r;n.stamps||(n.stamps=new Map);const o=d(this,Vi)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!n.stamps.has(d(this,ar)))n.stamps.set(d(this,ar),{area:o,serialized:r}),r.bitmap=z(this,tn,o2).call(this,!1);else if(d(this,Vi)){const l=n.stamps.get(d(this,ar));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=z(this,tn,o2).call(this,!1))}return r}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};Vn=new WeakMap,ar=new WeakMap,Cu=new WeakMap,sc=new WeakMap,Eu=new WeakMap,Um=new WeakMap,rl=new WeakMap,il=new WeakMap,Vi=new WeakMap,zm=new WeakMap,tn=new WeakSet,_0=function(t,n=!1){if(!t){this.remove();return}E(this,Vn,t.bitmap),n||(E(this,ar,t.id),E(this,Vi,t.isSvg)),t.file&&E(this,Um,t.file.name),z(this,tn,ZA).call(this)},A0=function(){if(E(this,Cu,null),this._uiManager.enableWaiting(!1),!!d(this,rl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Vn)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&d(this,Vn)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},i2=function(){if(d(this,ar)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(d(this,ar)).then(r=>z(this,tn,_0).call(this,r,!0)).finally(()=>z(this,tn,A0).call(this));return}if(d(this,sc)){const r=d(this,sc);E(this,sc,null),this._uiManager.enableWaiting(!0),E(this,Cu,this._uiManager.imageManager.getFromUrl(r).then(i=>z(this,tn,_0).call(this,i)).finally(()=>z(this,tn,A0).call(this)));return}if(d(this,Eu)){const r=d(this,Eu);E(this,Eu,null),this._uiManager.enableWaiting(!0),E(this,Cu,this._uiManager.imageManager.getFromFile(r).then(i=>z(this,tn,_0).call(this,i)).finally(()=>z(this,tn,A0).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=U0.supportedTypesStr;const n=this._uiManager._signal;E(this,Cu,new Promise(r=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),z(this,tn,_0).call(this,i)}r()},{signal:n}),t.addEventListener("cancel",()=>{this.remove(),r()},{signal:n})}).finally(()=>z(this,tn,A0).call(this))),t.click()},ZA=function(){var f;const{div:t}=this;let{width:n,height:r}=d(this,Vn);const[i,a]=this.pageDimensions,o=.75;if(this.width)n=this.width*i,r=this.height*a;else if(n>o*i||r>o*a){const p=Math.min(o*i/n,o*a/r);n*=p,r*=p}const[l,c]=this.parentDimensions;this.setDims(n*l/i,r*c/a),this._uiManager.enableWaiting(!1);const u=E(this,rl,document.createElement("canvas"));u.setAttribute("role","img"),this.addContainer(u),this.width=n/i,this.height=r/a,(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),z(this,tn,eS).call(this),d(this,zm)||(this.parent.addUndoableEditor(this),E(this,zm,!0)),this._reportTelemetry({action:"inserted_image"}),d(this,Um)&&u.setAttribute("aria-label",d(this,Um))},a2=function(t,n){const{width:r,height:i}=d(this,Vn);let a=r,o=i,l=d(this,Vn);for(;a>2*t||o>2*n;){const c=a,u=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*n&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,c,u,0,0,a,o),l=f.transferToImageBitmap()}return l},eS=function(){const[t,n]=this.parentDimensions,{width:r,height:i}=this,a=new Y_,o=Math.ceil(r*t*a.sx),l=Math.ceil(i*n*a.sy),c=d(this,rl);if(!c||c.width===o&&c.height===l)return;c.width=o,c.height=l;const u=d(this,Vi)?d(this,Vn):z(this,tn,a2).call(this,o,l),f=c.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(u,0,0,u.width,u.height,0,0,o,l)},o2=function(t){if(t){if(d(this,Vi)){const i=this._uiManager.imageManager.getSvgUrl(d(this,ar));if(i)return i}const n=document.createElement("canvas");return{width:n.width,height:n.height}=d(this,Vn),n.getContext("2d").drawImage(d(this,Vn),0,0),n.toDataURL()}if(d(this,Vi)){const[n,r]=this.pageDimensions,i=Math.round(this.width*n*Xu.PDF_TO_CSS_UNITS),a=Math.round(this.height*r*Xu.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(d(this,Vn),0,0,d(this,Vn).width,d(this,Vn).height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(d(this,Vn))},pI=function(t){var o;const{pageIndex:n,accessibilityData:{altText:r}}=this._initialData,i=t.pageIndex===n,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===r;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}},gt(U0,"_type","stamp"),gt(U0,"_editorType",Rt.STAMP);let QA=U0;var zh,qm,al,Pu,rc,Aa,Lu,Hm,qh,co,ic,Er,ac,rt,Tu,Dn,mI,Do,nS,sS,l2;const Xa=class Xa{constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:r,accessibilityManager:i,annotationLayer:a,drawLayer:o,textLayer:l,viewport:c,l10n:u}){$(this,Dn);$(this,zh);$(this,qm,!1);$(this,al,null);$(this,Pu,null);$(this,rc,null);$(this,Aa,new Map);$(this,Lu,!1);$(this,Hm,!1);$(this,qh,!1);$(this,co,null);$(this,ic,null);$(this,Er,null);$(this,ac,null);$(this,rt);const f=[...d(Xa,Tu).values()];if(!Xa._initialized){Xa._initialized=!0;for(const p of f)p.initialize(u,e)}e.registerEditorTypes(f),E(this,rt,e),this.pageIndex=t,this.div=n,E(this,zh,i),E(this,al,a),this.viewport=c,E(this,Er,l),this.drawLayer=o,this._structTree=r,d(this,rt).addLayer(this)}get isEmpty(){return d(this,Aa).size===0}get isInvisible(){return this.isEmpty&&d(this,rt).getMode()===Rt.NONE}updateToolbar(e){d(this,rt).updateToolbar(e)}updateMode(e=d(this,rt).getMode()){switch(z(this,Dn,l2).call(this),e){case Rt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Rt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Rt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const n of d(Xa,Tu).values())t.toggle(`${n._type}Editing`,e===n._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=d(this,Er))==null?void 0:t.div)}setEditingState(e){d(this,rt).setEditingState(e)}addCommands(e){d(this,rt).addCommands(e)}cleanUndoStack(e){d(this,rt).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=d(this,al))==null||t.div.classList.toggle("disabled",!e)}async enable(){E(this,qh,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const n of d(this,Aa).values())n.enableEditing(),n.show(!0),n.annotationElementId&&(d(this,rt).removeChangedExistingAnnotation(n),e.add(n.annotationElementId));if(!d(this,al)){E(this,qh,!1);return}const t=d(this,al).getEditableAnnotations();for(const n of t){if(n.hide(),d(this,rt).isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const r=await this.deserialize(n);r&&(this.addOrRebuild(r),r.enableEditing())}E(this,qh,!1)}disable(){var r;E(this,Hm,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const i of d(this,Aa).values())if(i.disableEditing(),!!i.annotationElementId){if(i.serialize()!==null){e.set(i.annotationElementId,i);continue}else t.set(i.annotationElementId,i);(r=this.getEditableAnnotation(i.annotationElementId))==null||r.show(),i.remove()}if(d(this,al)){const i=d(this,al).getEditableAnnotations();for(const a of i){const{id:o}=a.data;if(d(this,rt).isDeletedAnnotationElement(o))continue;let l=t.get(o);if(l){l.resetAnnotationElement(a),l.show(!1),a.show();continue}l=e.get(o),l&&(d(this,rt).addChangedExistingAnnotation(l),l.renderAnnotationElement(a)&&l.show(!1)),a.show()}}z(this,Dn,l2).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of d(Xa,Tu).values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),E(this,Hm,!1)}getEditableAnnotation(e){var t;return((t=d(this,al))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){d(this,rt).getActive()!==e&&d(this,rt).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=d(this,Er))!=null&&e.div&&!d(this,ac)){E(this,ac,new AbortController);const t=d(this,rt).combinedSignal(d(this,ac));d(this,Er).div.addEventListener("pointerdown",z(this,Dn,mI).bind(this),{signal:t}),d(this,Er).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=d(this,Er))!=null&&e.div&&d(this,ac)&&(d(this,ac).abort(),E(this,ac,null),d(this,Er).div.classList.remove("highlighting"))}enableClick(){if(d(this,Pu))return;E(this,Pu,new AbortController);const e=d(this,rt).combinedSignal(d(this,Pu));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=d(this,Pu))==null||e.abort(),E(this,Pu,null)}attach(e){d(this,Aa).set(e.id,e);const{annotationElementId:t}=e;t&&d(this,rt).isDeletedAnnotationElement(t)&&d(this,rt).removeDeletedAnnotationElement(e)}detach(e){var t;d(this,Aa).delete(e.id),(t=d(this,zh))==null||t.removePointerInTextLayer(e.contentDiv),!d(this,Hm)&&e.annotationElementId&&d(this,rt).addDeletedAnnotationElement(e)}remove(e){this.detach(e),d(this,rt).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(d(this,rt).addDeletedAnnotationElement(e.annotationElementId),Xn.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),d(this,rt).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!d(this,qh)),d(this,rt).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var n;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!d(this,rc)&&(e._focusEventsAllowed=!1,E(this,rc,setTimeout(()=>{E(this,rc,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:d(this,rt)._signal}),t.focus())},0))),e._structTreeParentId=(n=d(this,zh))==null?void 0:n.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getNextId(){return d(this,rt).getId()}combinedSignal(e){return d(this,rt).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=d(this,Dn,Do))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){d(this,rt).updateToolbar(e),d(this,rt).updateMode(e);const{offsetX:n,offsetY:r}=z(this,Dn,sS).call(this),i=this.getNextId(),a=z(this,Dn,nS).call(this,{parent:this,id:i,x:n,y:r,uiManager:d(this,rt),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=d(Xa,Tu).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,d(this,rt)))||null}createAndAddNewEditor(e,t,n={}){const r=this.getNextId(),i=z(this,Dn,nS).call(this,{parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:d(this,rt),isCentered:t,...n});return i&&this.add(i),i}addNewEditor(){this.createAndAddNewEditor(z(this,Dn,sS).call(this),!0)}setSelected(e){d(this,rt).setSelected(e)}toggleSelected(e){d(this,rt).toggleSelected(e)}unselect(e){d(this,rt).unselect(e)}pointerup(e){var n;const{isMac:t}=Xr.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&d(this,Lu)&&(E(this,Lu,!1),!((n=d(this,Dn,Do))!=null&&n.isDrawer&&d(this,Dn,Do).supportMultipleDrawings))){if(!d(this,qm)){E(this,qm,!0);return}if(d(this,rt).getMode()===Rt.STAMP){d(this,rt).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var r;if(d(this,rt).getMode()===Rt.HIGHLIGHT&&this.enableTextSelection(),d(this,Lu)){E(this,Lu,!1);return}const{isMac:t}=Xr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(E(this,Lu,!0),(r=d(this,Dn,Do))!=null&&r.isDrawer){this.startDrawingSession(e);return}const n=d(this,rt).getActive();E(this,qm,!n||n.isEmpty())}startDrawingSession(e){if(this.div.focus(),d(this,co)){d(this,Dn,Do).startDrawing(this,d(this,rt),!1,e);return}d(this,rt).setCurrentDrawingSession(this),E(this,co,new AbortController);const t=d(this,rt).combinedSignal(d(this,co));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(E(this,ic,null),this.commitOrRemove())},{signal:t}),d(this,Dn,Do).startDrawing(this,d(this,rt),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&E(this,ic,t);return}d(this,ic)&&setTimeout(()=>{var t;(t=d(this,ic))==null||t.focus(),E(this,ic,null)},0)}endDrawingSession(e=!1){return d(this,co)?(d(this,rt).setCurrentDrawingSession(null),d(this,co).abort(),E(this,co,null),E(this,ic,null),d(this,Dn,Do).endDrawing(e)):null}findNewParent(e,t,n){const r=d(this,rt).findParent(t,n);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return d(this,co)?(this.endDrawingSession(),!0):!1}onScaleChanging(){d(this,co)&&d(this,Dn,Do).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=d(this,rt).getActive())==null?void 0:e.parent)===this&&(d(this,rt).commitOrRemove(),d(this,rt).setActiveEditor(null)),d(this,rc)&&(clearTimeout(d(this,rc)),E(this,rc,null));for(const n of d(this,Aa).values())(t=d(this,zh))==null||t.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,d(this,Aa).clear(),d(this,rt).removeLayer(this)}render({viewport:e}){this.viewport=e,ef(this.div,e);for(const t of d(this,rt).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){d(this,rt).commitOrRemove(),z(this,Dn,l2).call(this);const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,ef(this.div,{rotation:n}),t!==n)for(const r of d(this,Aa).values())r.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return d(this,rt).viewParameters.realScale}};zh=new WeakMap,qm=new WeakMap,al=new WeakMap,Pu=new WeakMap,rc=new WeakMap,Aa=new WeakMap,Lu=new WeakMap,Hm=new WeakMap,qh=new WeakMap,co=new WeakMap,ic=new WeakMap,Er=new WeakMap,ac=new WeakMap,rt=new WeakMap,Tu=new WeakMap,Dn=new WeakSet,mI=function(e){d(this,rt).unselectAll();const{target:t}=e;if(t===d(this,Er).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&d(this,Er).div.contains(t)){const{isMac:n}=Xr.platform;if(e.button!==0||e.ctrlKey&&n)return;d(this,rt).showAllEditors("highlight",!0,!0),d(this,Er).div.classList.add("free"),this.toggleDrawing(),G2.startHighlighting(this,d(this,rt).direction==="ltr",{target:d(this,Er).div,x:e.x,y:e.y}),d(this,Er).div.addEventListener("pointerup",()=>{d(this,Er).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:d(this,rt)._signal}),e.preventDefault()}},Do=function(){return d(Xa,Tu).get(d(this,rt).getMode())},nS=function(e){const t=d(this,Dn,Do);return t?new t.prototype.constructor(e):null},sS=function(){const{x:e,y:t,width:n,height:r}=this.div.getBoundingClientRect(),i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+n),l=Math.min(window.innerHeight,t+r),c=(i+o)/2-e,u=(a+l)/2-t,[f,p]=this.viewport.rotation%180===0?[c,u]:[u,c];return{offsetX:f,offsetY:p}},l2=function(){for(const e of d(this,Aa).values())e.isEmpty()&&e.remove()},gt(Xa,"_initialized",!1),$(Xa,Tu,new Map([MA,JA,QA,G2].map(e=>[e._editorType,e])));let tS=Xa;var uo,Fv,Wr,Hh,bw,gI,fl,iS,vI,aS;const Sr=class Sr{constructor({pageIndex:e}){$(this,fl);$(this,uo,null);$(this,Fv,0);$(this,Wr,new Map);$(this,Hh,new Map);this.pageIndex=e}setParent(e){if(!d(this,uo)){E(this,uo,e);return}if(d(this,uo)!==e){if(d(this,Wr).size>0)for(const t of d(this,Wr).values())t.remove(),e.append(t);E(this,uo,e)}}static get _svgFactory(){return zt(this,"_svgFactory",new p3)}draw(e,t=!1,n=!1){const r=$r(this,Fv)._++,i=z(this,fl,iS).call(this),a=Sr._svgFactory.createElement("defs");i.append(a);const o=Sr._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${r}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&d(this,Hh).set(r,o);const c=n?z(this,fl,vI).call(this,a,l):null,u=Sr._svgFactory.createElement("use");return i.append(u),u.setAttribute("href",`#${l}`),this.updateProperties(i,e),d(this,Wr).set(r,i),{id:r,clipPathId:`url(#${c})`}}drawOutline(e,t){const n=$r(this,Fv)._++,r=z(this,fl,iS).call(this),i=Sr._svgFactory.createElement("defs");r.append(i);const a=Sr._svgFactory.createElement("path");i.append(a);const o=`path_p${this.pageIndex}_${n}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=Sr._svgFactory.createElement("mask");i.append(f),l=`mask_p${this.pageIndex}_${n}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=Sr._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const m=Sr._svgFactory.createElement("use");f.append(m),m.setAttribute("href",`#${o}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const c=Sr._svgFactory.createElement("use");r.append(c),c.setAttribute("href",`#${o}`),l&&c.setAttribute("mask",`url(#${l})`);const u=c.cloneNode();return r.append(u),c.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(r,e),d(this,Wr).set(n,r),n}finalizeDraw(e,t){d(this,Hh).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:n,bbox:r,rootClass:i,path:a}=t,o=typeof e=="number"?d(this,Wr).get(e):e;if(o){if(n&&z(this,fl,aS).call(this,o,n),r&&z(l=Sr,bw,gI).call(l,o,r),i){const{classList:c}=o;for(const[u,f]of Object.entries(i))c.toggle(u,f)}if(a){const u=o.firstChild.firstChild;z(this,fl,aS).call(this,u,a)}}}updateParent(e,t){if(t===this)return;const n=d(this,Wr).get(e);n&&(d(t,uo).append(n),d(this,Wr).delete(e),d(t,Wr).set(e,n))}remove(e){d(this,Hh).delete(e),d(this,uo)!==null&&(d(this,Wr).get(e).remove(),d(this,Wr).delete(e))}destroy(){E(this,uo,null);for(const e of d(this,Wr).values())e.remove();d(this,Wr).clear(),d(this,Hh).clear()}};uo=new WeakMap,Fv=new WeakMap,Wr=new WeakMap,Hh=new WeakMap,bw=new WeakSet,gI=function(e,[t,n,r,i]){const{style:a}=e;a.top=`${100*n}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*i}%`},fl=new WeakSet,iS=function(){const e=Sr._svgFactory.create(1,1,!0);return d(this,uo).append(e),e.setAttribute("aria-hidden",!0),e},vI=function(e,t){const n=Sr._svgFactory.createElement("clipPath");e.append(n);const r=`clip_${t}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const i=Sr._svgFactory.createElement("use");return n.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),r},aS=function(e,t){for(const[n,r]of Object.entries(t))r===null?e.removeAttribute(n):e.setAttribute(n,r)},$(Sr,bw);let rS=Sr;globalThis.pdfjsTestingUtils={HighlightOutliner:DA};At.AbortException;At.AnnotationEditorLayer;At.AnnotationEditorParamsType;At.AnnotationEditorType;At.AnnotationEditorUIManager;At.AnnotationLayer;At.AnnotationMode;At.ColorPicker;At.DOMSVGFactory;At.DrawLayer;At.FeatureTest;var RD=At.GlobalWorkerOptions;At.ImageKind;At.InvalidPDFException;At.MissingPDFException;At.OPS;At.OutputScale;At.PDFDataRangeTransport;At.PDFDateString;At.PDFWorker;At.PasswordResponses;At.PermissionFlag;At.PixelsPerInch;At.RenderingCancelledException;At.TextLayer;At.TouchManager;At.UnexpectedResponseException;At.Util;At.VerbosityLevel;At.XfaLayer;At.build;At.createValidAbsoluteUrl;At.fetchData;var OD=At.getDocument;At.getFilenameFromUrl;At.getPdfFilenameFromUrl;At.getXfaPageViewport;At.isDataScheme;At.isPdfFile;At.noContextMenu;At.normalizeUnicode;At.setLayerDimensions;At.shadow;At.stopEvent;At.version;const MD="/assets/pdf.worker.min-BRG_qK7b.js";RD.workerSrc=MD;async function FD(s,e=144){const t=await s.arrayBuffer(),i=await(await OD({data:t}).promise).getPage(1);i.getViewport({scale:1});const a=e/96,o=i.getViewport({scale:a}),l=document.createElement("canvas"),c=l.getContext("2d");if(!c)throw new Error("Canvas 2D context unavailable");return l.width=Math.ceil(o.width),l.height=Math.ceil(o.height),await i.render({canvasContext:c,viewport:o}).promise,l.toDataURL("image/png")}const DD="modulepreload",BD=function(s){return"/"+s},eE={},Ku=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(t.map(l=>{if(l=BD(l),l in eE)return;eE[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":DD,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((p,m)=>{f.addEventListener("load",p),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},$D=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Ku(async()=>{const{default:n}=await Promise.resolve().then(()=>ig);return{default:n}},[]).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class g3 extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class tE extends g3{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class nE extends g3{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sE extends g3{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var oS;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(oS||(oS={}));var UD=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};class zD{constructor(e,{headers:t={},customFetch:n,region:r=oS.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=$D(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return UD(this,arguments,void 0,function*(t,n={}){var r;try{const{headers:i,method:a,body:o,signal:l}=n;let c={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${t}`);u&&u!=="any"&&(c["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let p;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",p=o):typeof o=="string"?(c["Content-Type"]="text/plain",p=o):typeof FormData<"u"&&o instanceof FormData?p=o:(c["Content-Type"]="application/json",p=JSON.stringify(o)));const m=yield this.fetch(f.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:p,signal:l}).catch(w=>{throw w.name==="AbortError"?w:new tE(w)}),b=m.headers.get("x-relay-error");if(b&&b==="true")throw new nE(m);if(!m.ok)throw new sE(m);let y=((r=m.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),S;return y==="application/json"?S=yield m.json():y==="application/octet-stream"?S=yield m.blob():y==="text/event-stream"?S=m:y==="multipart/form-data"?S=yield m.formData():S=yield m.text(),{data:S,error:null,response:m}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new tE(i)}:{data:null,error:i,response:i instanceof sE||i instanceof nE?i.context:void 0}}})}}var bi={},v3={},s5={},Zv={},r5={},i5={},qD=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Qm=qD();const HD=Qm.fetch,yI=Qm.fetch.bind(Qm),bI=Qm.Headers,WD=Qm.Request,VD=Qm.Response,ig=Object.freeze(Object.defineProperty({__proto__:null,Headers:bI,Request:WD,Response:VD,default:yI,fetch:HD},Symbol.toStringTag,{value:"Module"})),GD=Qj(ig);var a5={};Object.defineProperty(a5,"__esModule",{value:!0});let XD=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};a5.default=XD;var wI=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(i5,"__esModule",{value:!0});const KD=wI(GD),YD=wI(a5);let JD=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=KD.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let r=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,l,c;let u=null,f=null,p=null,m=i.status,b=i.statusText;if(i.ok){if(this.method!=="HEAD"){const _=await i.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((a=this.headers.get("Accept"))===null||a===void 0)&&a.includes("application/vnd.pgrst.plan+text"))?f=_:f=JSON.parse(_))}const S=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),w=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");S&&w&&w.length>1&&(p=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(u={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,p=null,m=406,b="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const S=await i.text();try{u=JSON.parse(S),Array.isArray(u)&&i.status===404&&(f=[],u=null,m=200,b="OK")}catch{i.status===404&&S===""?(m=204,b="No Content"):u={message:S}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,m=200,b="OK"),u&&this.shouldThrowOnError)throw new YD.default(u)}return{error:u,data:f,count:p,status:m,statusText:b}});return this.shouldThrowOnError||(r=r.catch(i=>{var a,o,l;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};i5.default=JD;var QD=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(r5,"__esModule",{value:!0});const ZD=QD(i5);let e7=class extends ZD.default{select(e){let t=!1;const n=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:i=r}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:i=!1,format:a="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};r5.default=e7;var t7=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Zv,"__esModule",{value:!0});const n7=t7(r5);let s7=class extends n7.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:r}={}){let i="";r==="plain"?i="pl":r==="phrase"?i="ph":r==="websearch"&&(i="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}};Zv.default=s7;var r7=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(s5,"__esModule",{value:!0});const Kg=r7(Zv);let i7=class{constructor(e,{headers:t={},schema:n,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=n,this.fetch=r}select(e,t){const{head:n=!1,count:r}=t??{},i=n?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new Kg.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:n=!0}={}){var r;const i="POST";if(t&&this.headers.append("Prefer",`count=${t}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Kg.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:i=!0}={}){var a;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Kg.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var n;const r="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Kg.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var t;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Kg.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}};s5.default=i7;var xI=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(v3,"__esModule",{value:!0});const a7=xI(s5),o7=xI(Zv);let l7=class _I{constructor(e,{headers:t={},schema:n,fetch:r}={}){this.url=e,this.headers=new Headers(t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new a7.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new _I(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:r=!1,count:i}={}){var a;let o;const l=new URL(`${this.url}/rpc/${e}`);let c;n||r?(o=n?"HEAD":"GET",Object.entries(t).filter(([f,p])=>p!==void 0).map(([f,p])=>[f,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([f,p])=>{l.searchParams.append(f,p)})):(o="POST",c=t);const u=new Headers(this.headers);return i&&u.set("Prefer",`count=${i}`),new o7.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}};v3.default=l7;var ag=Ia&&Ia.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(bi,"__esModule",{value:!0});bi.PostgrestError=bi.PostgrestBuilder=bi.PostgrestTransformBuilder=bi.PostgrestFilterBuilder=bi.PostgrestQueryBuilder=bi.PostgrestClient=void 0;const AI=ag(v3);bi.PostgrestClient=AI.default;const SI=ag(s5);bi.PostgrestQueryBuilder=SI.default;const kI=ag(Zv);bi.PostgrestFilterBuilder=kI.default;const NI=ag(r5);bi.PostgrestTransformBuilder=NI.default;const CI=ag(i5);bi.PostgrestBuilder=CI.default;const EI=ag(a5);bi.PostgrestError=EI.default;var c7=bi.default={PostgrestClient:AI.default,PostgrestQueryBuilder:SI.default,PostgrestFilterBuilder:kI.default,PostgrestTransformBuilder:NI.default,PostgrestBuilder:CI.default,PostgrestError:EI.default};const{PostgrestClient:u7,PostgrestQueryBuilder:J$,PostgrestFilterBuilder:Q$,PostgrestTransformBuilder:Z$,PostgrestBuilder:eU,PostgrestError:tU}=c7;class d7{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,r=parseInt(n.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const h7="2.75.0",f7=`realtime-js/${h7}`,p7="1.0.0",lS=1e4,m7=1e3,g7=100;var F0;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(F0||(F0={}));var Es;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(Es||(Es={}));var fo;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(fo||(fo={}));var cS;(function(s){s.websocket="websocket"})(cS||(cS={}));var Td;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(Td||(Td={}));class v7{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(e.slice(a,a+r));a=a+r;const l=n.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class PI{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Nn;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(Nn||(Nn={}));const rE=(s,e,t={})=>{var n;const r=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((i,a)=>(i[a]=y7(a,s,e,r),i),{}):{}},y7=(s,e,t,n)=>{const r=e.find(o=>o.name===s),i=r==null?void 0:r.type,a=t[s];return i&&!n.includes(i)?LI(i,a):uS(a)},LI=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return _7(e,t)}switch(s){case Nn.bool:return b7(e);case Nn.float4:case Nn.float8:case Nn.int2:case Nn.int4:case Nn.int8:case Nn.numeric:case Nn.oid:return w7(e);case Nn.json:case Nn.jsonb:return x7(e);case Nn.timestamp:return A7(e);case Nn.abstime:case Nn.date:case Nn.daterange:case Nn.int4range:case Nn.int8range:case Nn.money:case Nn.reltime:case Nn.text:case Nn.time:case Nn.timestamptz:case Nn.timetz:case Nn.tsrange:case Nn.tstzrange:return uS(e);default:return uS(e)}},uS=s=>s,b7=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},w7=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},x7=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},_7=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let i;const a=s.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>LI(e,o))}return s},A7=s=>typeof s=="string"?s.replace(" ","T"):s,TI=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Ax{constructor(e,t,n={},r=lS){this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var iE;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(iE||(iE={}));class D0{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=D0.syncState(this.state,r,i,a),this.pendingDiffs.forEach(l=>{this.state=D0.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=D0.syncDiff(this.state,r,i,a),o())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,r){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const f=i[c];if(f){const p=u.map(S=>S.presence_ref),m=f.map(S=>S.presence_ref),b=u.filter(S=>m.indexOf(S.presence_ref)<0),y=f.filter(S=>p.indexOf(S.presence_ref)<0);b.length>0&&(o[c]=b),y.length>0&&(l[c]=y)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,r)}static syncDiff(e,t,n,r){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const f=e[o].map(m=>m.presence_ref),p=u.filter(m=>f.indexOf(m.presence_ref)<0);e[o].unshift(...p)}n(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),e[o]=c,r(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const r=e[n];return"metas"in r?t[n]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[n]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var aE;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(aE||(aE={}));var B0;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(B0||(B0={}));var Il;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(Il||(Il={}));class y3{constructor(e,t={config:{}},n){var r,i;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=Es.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ax(this,fo.join,this.params,this.timeout),this.rejoinTimer=new PI(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Es.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Es.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Es.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Es.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Es.errored,this.rejoinTimer.scheduleTimeout())}),this._on(fo.reply,{},(a,o)=>{this._trigger(this._replyEventName(o),a)}),this.presence=new D0(this),this.broadcastEndpointURL=TI(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==Es.closed){const{config:{broadcast:a,presence:o,private:l}}=this.params,c=(r=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&r!==void 0?r:[],u=!!this.bindings[B0.PRESENCE]&&this.bindings[B0.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},p={broadcast:a,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>e==null?void 0:e(Il.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(Il.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:m})=>{var b;if(this.socket.setAuth(),m===void 0){e==null||e(Il.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,S=(b=y==null?void 0:y.length)!==null&&b!==void 0?b:0,w=[];for(let _=0;_<S;_++){const k=y[_],{filter:{event:C,schema:B,table:F,filter:j}}=k,T=m&&m[_];if(T&&T.event===C&&T.schema===B&&T.table===F&&T.filter===j)w.push(Object.assign(Object.assign({},k),{id:T.id}));else{this.unsubscribe(),this.state=Es.errored,e==null||e(Il.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(Il.SUBSCRIBED);return}}).receive("error",m=>{this.state=Es.errored,e==null||e(Il.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Il.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===Es.joined&&e===B0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e,t={}){var n,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Es.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(fo.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(r=>{n=new Ax(this,fo.leave,{},e),n.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Es.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const r=new AbortController,i=setTimeout(()=>r.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Ax(this,e,t,n);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>g7){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=fo;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let p=this._onMessage(a,t,n);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(m=>{var b,y,S;return((b=m.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(y=m.filter)===null||y===void 0?void 0:y.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===a}).map(m=>m.callback(p,n)):(i=this.bindings[a])===null||i===void 0||i.filter(m=>{var b,y,S,w,_,k;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in m){const C=m.id,B=(b=m.filter)===null||b===void 0?void 0:b.event;return C&&((y=t.ids)===null||y===void 0?void 0:y.includes(C))&&(B==="*"||(B==null?void 0:B.toLocaleLowerCase())===((S=t.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const C=(_=(w=m==null?void 0:m.filter)===null||w===void 0?void 0:w.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return C==="*"||C===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===a}).map(m=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:y,table:S,commit_timestamp:w,type:_,errors:k}=b;p=Object.assign(Object.assign({},{schema:y,table:S,commit_timestamp:w,eventType:_,new:{},old:{},errors:k}),this._getPayloadRecords(b))}m.callback(p,n)})}_isClosed(){return this.state===Es.closed}_isJoined(){return this.state===Es.joined}_isJoining(){return this.state===Es.joining}_isLeaving(){return this.state===Es.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&y3.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(fo.close,{},e)}_onError(e){this._on(fo.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Es.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=rE(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=rE(e.columns,e.old_record)),t}}const Sx=()=>{},lb={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},S7=[1e3,2e3,5e3,1e4],k7=1e4,N7=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class C7{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=lS,this.transport=null,this.heartbeatIntervalMs=lb.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Sx,this.ref=0,this.reconnectTimer=null,this.logger=Sx,this.conn=null,this.sendBuffer=[],this.serializer=new v7,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let i;return r?i=r:typeof fetch>"u"?i=(...a)=>Ku(async()=>{const{default:o}=await Promise.resolve().then(()=>ig);return{default:o}},void 0).then(({default:o})=>o(...a)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...a)=>i(...a)},!(!((n=t==null?void 0:t.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${cS.websocket}`,this.httpEndpoint=TI(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=d7.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:p7}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case F0.connecting:return Td.Connecting;case F0.open:return Td.Open;case F0.closing:return Td.Closing;default:return Td.Closed}}isConnected(){return this.connectionState()===Td.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===n);if(r)return r;{const i=new y3(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:n,payload:r,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${n} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(m7,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},lb.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:r,payload:i,ref:a}=t,o=a?`(${a})`:"",l=i.status||"";this.log("receive",`${l} ${n} ${r} ${o}`.trim(),i),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(r,i,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(fo.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${n}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([N7],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const r={access_token:t,version:f7};t&&n.updateJoinPayload(r),n.joinedOnce&&n._isJoined()&&n._push(fo.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new PI(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lb.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,r,i,a,o,l,c,u;if(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:lS,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:lb.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(a=e==null?void 0:e.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(o=e==null?void 0:e.heartbeatCallback)!==null&&o!==void 0?o:Sx,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e==null?void 0:e.reconnectAfterMs)!==null&&l!==void 0?l:f=>S7[f-1]||k7,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(f,p)=>p(JSON.stringify(f)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class b3 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function ws(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class E7 extends b3{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class dS extends b3{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var P7=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};const II=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Ku(async()=>{const{default:n}=await Promise.resolve().then(()=>ig);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},L7=()=>P7(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ku(()=>Promise.resolve().then(()=>ig),void 0)).Response:Response}),hS=s=>{if(Array.isArray(s))return s.map(t=>hS(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=hS(n)}),e},T7=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var lf=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};const kx=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),I7=(s,e,t)=>lf(void 0,void 0,void 0,function*(){const n=yield L7();s instanceof n&&!(t!=null&&t.noResolveJson)?s.json().then(r=>{const i=s.status||500,a=(r==null?void 0:r.statusCode)||i+"";e(new E7(kx(r),i,a))}).catch(r=>{e(new dS(kx(r),r))}):e(new dS(kx(s),s))}),j7=(s,e,t,n)=>{const r={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"||!n?r:(T7(n)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(n)):r.body=n,e!=null&&e.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),t))};function ey(s,e,t,n,r,i){return lf(this,void 0,void 0,function*(){return new Promise((a,o)=>{s(t,j7(e,n,r,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>I7(l,o,n))})})}function K2(s,e,t,n){return lf(this,void 0,void 0,function*(){return ey(s,"GET",e,t,n)})}function Uo(s,e,t,n,r){return lf(this,void 0,void 0,function*(){return ey(s,"POST",e,n,r,t)})}function fS(s,e,t,n,r){return lf(this,void 0,void 0,function*(){return ey(s,"PUT",e,n,r,t)})}function R7(s,e,t,n){return lf(this,void 0,void 0,function*(){return ey(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function jI(s,e,t,n,r){return lf(this,void 0,void 0,function*(){return ey(s,"DELETE",e,n,r,t)})}var O7=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};class M7{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return O7(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ws(e))return{data:null,error:e};throw e}})}}var F7=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};class D7{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new M7(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return F7(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ws(e))return{data:null,error:e};throw e}})}}var ui=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};const B7={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},oE={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class $7{constructor(e,t={},n,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=II(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,r){return ui(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},oE),r);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),f=yield(e=="PUT"?fS:Uo)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return{data:{path:c,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(ws(i))return{data:null,error:i};throw i}})}upload(e,t,n){return ui(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,r){return ui(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:oE.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield fS(this.fetch,o.toString(),l,{headers:u});return{data:{path:i,fullPath:f.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(ws(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return ui(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const i=yield Uo(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new b3("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}update(e,t,n){return ui(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return ui(this,void 0,void 0,function*(){try{return{data:yield Uo(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}copy(e,t,n){return ui(this,void 0,void 0,function*(){try{return{data:{path:(yield Uo(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,n){return ui(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield Uo(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,n){return ui(this,void 0,void 0,function*(){try{const r=yield Uo(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"",o=this._getFinalPath(e),l=()=>K2(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0});return new D7(l,this.shouldThrowOnError)}info(e){return ui(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield K2(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:hS(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}exists(e){return ui(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield R7(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n)&&n instanceof dS){const r=n.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(e){return ui(this,void 0,void 0,function*(){try{return{data:yield jI(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}list(e,t,n){return ui(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},B7),t),{prefix:e||""});return{data:yield Uo(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}listV2(e,t){return ui(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Uo(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const U7="2.75.0",z7={"X-Client-Info":`storage-js/${U7}`};var $f=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};class q7{constructor(e,t={},n,r){this.shouldThrowOnError=!1;const i=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},z7),t),this.fetch=II(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return $f(this,void 0,void 0,function*(){try{return{data:yield K2(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(ws(e))return{data:null,error:e};throw e}})}getBucket(e){return $f(this,void 0,void 0,function*(){try{return{data:yield K2(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}createBucket(e){return $f(this,arguments,void 0,function*(t,n={public:!1}){try{return{data:yield Uo(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ws(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return $f(this,void 0,void 0,function*(){try{return{data:yield fS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(ws(n))return{data:null,error:n};throw n}})}emptyBucket(e){return $f(this,void 0,void 0,function*(){try{return{data:yield Uo(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}deleteBucket(e){return $f(this,void 0,void 0,function*(){try{return{data:yield jI(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(ws(t))return{data:null,error:t};throw t}})}}class H7 extends q7{constructor(e,t={},n,r){super(e,t,n,r)}from(e){return new $7(this.url,this.headers,e,this.fetch)}}const W7="2.75.0";let S0="";typeof Deno<"u"?S0="deno":typeof document<"u"?S0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?S0="react-native":S0="node";const V7={"X-Client-Info":`supabase-js-${S0}/${W7}`},G7={headers:V7},X7={schema:"public"},K7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Y7={};var J7=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};const Q7=s=>{let e;return s?e=s:typeof fetch>"u"?e=yI:e=fetch,(...t)=>e(...t)},Z7=()=>typeof Headers>"u"?bI:Headers,e9=(s,e,t)=>{const n=Q7(t),r=Z7();return(i,a)=>J7(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:s;let c=new r(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",s),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},a),{headers:c}))})};var t9=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};function n9(s){return s.endsWith("/")?s:s+"/"}function s9(s,e){var t,n;const{db:r,auth:i,realtime:a,global:o}=s,{db:l,auth:c,realtime:u,global:f}=e,p={db:Object.assign(Object.assign({},l),r),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>t9(this,void 0,void 0,function*(){return""})};return s.accessToken?p.accessToken=s.accessToken:delete p.accessToken,p}function r9(s){const e=s==null?void 0:s.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(n9(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const RI="2.75.0",rp=30*1e3,pS=3,Nx=pS*rp,i9="http://localhost:9999",a9="supabase.auth.token",o9={"X-Client-Info":`gotrue-js/${RI}`},mS="X-Supabase-Api-Version",OI={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},l9=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,c9=10*60*1e3;class u1 extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function ft(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class u9 extends u1{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function d9(s){return ft(s)&&s.name==="AuthApiError"}class Id extends u1{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class id extends u1{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Kc extends id{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function h9(s){return ft(s)&&s.name==="AuthSessionMissingError"}class Uf extends id{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cb extends id{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ub extends id{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function f9(s){return ft(s)&&s.name==="AuthImplicitGrantRedirectError"}class lE extends id{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class gS extends id{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Cx(s){return ft(s)&&s.name==="AuthRetryableFetchError"}class cE extends id{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class vS extends id{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Y2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),uE=` 	
\r=`.split(""),p9=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<uE.length;e+=1)s[uE[e].charCodeAt(0)]=-2;for(let e=0;e<Y2.length;e+=1)s[Y2[e].charCodeAt(0)]=e;return s})();function dE(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Y2[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(Y2[n]),e.queuedBits-=6}}function MI(s,e,t){const n=p9[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function hE(s){const e=[],t=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=a=>{v9(a,n,t)};for(let a=0;a<s.length;a+=1)MI(s.charCodeAt(a),r,i);return e.join("")}function m9(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function g9(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const r=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}m9(n,e)}}function v9(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if(!(s>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Op(s){const e=[],t={queue:0,queuedBits:0},n=r=>{e.push(r)};for(let r=0;r<s.length;r+=1)MI(s.charCodeAt(r),t,n);return new Uint8Array(e)}function y9(s){const e=[];return g9(s,t=>e.push(t)),new Uint8Array(e)}function $d(s){const e=[],t={queue:0,queuedBits:0},n=r=>{e.push(r)};return s.forEach(r=>dE(r,t,n)),dE(null,t,n),e.join("")}function b9(s){return Math.round(Date.now()/1e3)+s}function w9(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const Ri=()=>typeof window<"u"&&typeof document<"u",xd={tested:!1,writable:!1},FI=()=>{if(!Ri())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(xd.tested)return xd.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),xd.tested=!0,xd.writable=!0}catch{xd.tested=!0,xd.writable=!1}return xd.writable};function x9(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((n,r)=>{e[r]=n}),e}const DI=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>Ku(async()=>{const{default:n}=await Promise.resolve().then(()=>ig);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},_9=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",ip=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},_d=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Wc=async(s,e)=>{await s.removeItem(e)};class o5{constructor(){this.promise=new o5.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}o5.promiseConstructor=Promise;function Ex(s){const e=s.split(".");if(e.length!==3)throw new vS("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!l9.test(e[n]))throw new vS("JWT not in base64url format");return{header:JSON.parse(hE(e[0])),payload:JSON.parse(hE(e[1])),signature:Op(e[2]),raw:{header:e[0],payload:e[1]}}}async function A9(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function S9(s,e){return new Promise((n,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await s(i);if(!e(i,null,a)){n(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function k9(s){return("0"+s.toString(16)).substr(-2)}function N9(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*n));return r}return crypto.getRandomValues(e),Array.from(e,k9).join("")}async function C9(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function E9(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await C9(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function zf(s,e,t=!1){const n=N9();let r=n;t&&(r+="/PASSWORD_RECOVERY"),await ip(s,`${e}-code-verifier`,r);const i=await E9(n);return[i,n===i?"plain":"s256"]}const P9=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function L9(s){const e=s.headers.get(mS);if(!e||!e.match(P9))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function T9(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function I9(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const j9=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qf(s){if(!j9.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Px(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function fE(s){return JSON.parse(JSON.stringify(s))}var R9=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t};const Ed=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),O9=[502,503,504];async function pE(s){var e;if(!_9(s))throw new gS(Ed(s),0);if(O9.includes(s.status))throw new gS(Ed(s),s.status);let t;try{t=await s.json()}catch(i){throw new Id(Ed(i),i)}let n;const r=L9(s);if(r&&r.getTime()>=OI["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new cE(Ed(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Kc}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new cE(Ed(t),s.status,t.weak_password.reasons);throw new u9(Ed(t),s.status||500,n)}const M9=(s,e,t,n)=>{const r={method:s,headers:(e==null?void 0:e.headers)||{}};return s==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(n),Object.assign(Object.assign({},r),t))};async function Et(s,e,t,n){var r;const i=Object.assign({},n==null?void 0:n.headers);i[mS]||(i[mS]=OI["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const a=(r=n==null?void 0:n.query)!==null&&r!==void 0?r:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await F9(s,e,t+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function F9(s,e,t,n,r,i){const a=M9(e,n,r,i);let o;try{o=await s(t,Object.assign({},a))}catch(l){throw console.error(l),new gS(Ed(l),0)}if(o.ok||await pE(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await pE(l)}}function Va(s){var e;let t=null;$9(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=b9(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function mE(s){const e=Va(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function tu(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function D9(s){return{data:s,error:null}}function B9(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:r,verification_type:i}=s,a=R9(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:n,redirect_to:r,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function gE(s){return s}function $9(s){return s.access_token&&s.refresh_token&&s.expires_in}const Lx=["global","local","others"];var U9=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t};class z9{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=DI(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Lx[0]){if(Lx.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Lx.join(", ")}`);try{return await Et(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await Et(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tu})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=U9(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=n==null?void 0:n.newEmail,delete r.newEmail),await Et(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:B9,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(ft(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tu})}catch(t){if(ft(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Et(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:gE});if(u.error)throw u.error;const f=await u.json(),p=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);c[`${S}Page`]=y}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(ft(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){qf(e);try{return await Et(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tu})}catch(t){if(ft(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){qf(e);try{return await Et(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tu})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){qf(e);try{return await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tu})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){qf(e.userId);try{const{data:t,error:n}=await Et(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:n}}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _deleteFactor(e){qf(e.userId),qf(e.id);try{return{data:await Et(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,r,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Et(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:gE});if(u.error)throw u.error;const f=await u.json(),p=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,m=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return m.length>0&&(m.forEach(b=>{const y=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);c[`${S}Page`]=y}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(ft(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await Et(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await Et(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await Et(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}}function vE(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const Hf={debug:!!(globalThis&&FI()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BI extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class q9 extends BI{}async function H9(s,e,t){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async r=>{if(r){Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,r.name);try{return await t()}finally{Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,r.name)}}else{if(e===0)throw Hf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new q9(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(Hf.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function W9(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function $I(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function V9(s){return parseInt(s,16)}function G9(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function X9(s){var e;const{chainId:t,domain:n,expirationTime:r,issuedAt:i=new Date,nonce:a,notBefore:o,requestId:l,resources:c,scheme:u,uri:f,version:p}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const m=$I(s.address),b=u?`${u}://${n}`:n,y=s.statement?`${s.statement}
`:"",S=`${b} wants you to sign in with your Ethereum account:
${m}

${y}`;let w=`URI: ${f}
Version: ${p}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${i.toISOString()}`;if(r&&(w+=`
Expiration Time: ${r.toISOString()}`),o&&(w+=`
Not Before: ${o.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let _=`
Resources:`;for(const k of c){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);_+=`
- ${k}`}w+=_}return`${S}
${w}`}class bs extends Error{constructor({message:e,code:t,cause:n,name:r}){var i;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=r??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class J2 extends bs{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function K9({error:s,options:e}){var t,n,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new bs({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new bs({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new bs({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new bs({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new bs({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new bs({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return i.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new bs({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new bs({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const a=window.location.hostname;if(zI(a)){if(i.rp.id!==a)return new bs({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new bs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new bs({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new bs({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new bs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function Y9({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new bs({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new bs({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(zI(n)){if(t.rpId!==n)return new bs({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new bs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new bs({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new bs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}var UI=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(s);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(s,n[r])&&(t[n[r]]=s[n[r]]);return t};class J9{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Q9=new J9;function Z9(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,r=UI(s,["challenge","user","excludeCredentials"]),i=Op(e).buffer,a=Object.assign(Object.assign({},t),{id:Op(t.id).buffer}),o=Object.assign(Object.assign({},r),{challenge:i,user:a});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:Op(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return o}function eB(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=UI(s,["challenge","allowCredentials"]),r=Op(e).buffer,i=Object.assign(Object.assign({},n),{challenge:r});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const o=t[a];i.allowCredentials[a]=Object.assign(Object.assign({},o),{id:Op(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return i}function tB(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:$d(new Uint8Array(s.response.attestationObject)),clientDataJSON:$d(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function nB(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),r=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:$d(new Uint8Array(r.authenticatorData)),clientDataJSON:$d(new Uint8Array(r.clientDataJSON)),signature:$d(new Uint8Array(r.signature)),userHandle:r.userHandle?$d(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function zI(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function yE(){var s,e;return!!(Ri()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator==null?void 0:navigator.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function sB(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new J2("Browser returned unexpected credential type",e)}:{data:null,error:new J2("Empty credential response",e)}}catch(e){return{data:null,error:K9({error:e,options:s})}}}async function rB(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new J2("Browser returned unexpected credential type",e)}:{data:null,error:new J2("Empty credential response",e)}}catch(e){return{data:null,error:Y9({error:e,options:s})}}}const iB={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},aB={userVerification:"preferred",hints:["security-key"]};function Q2(...s){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),n={};for(const r of s)if(r)for(const i in r){const a=r[i];if(a!==void 0)if(Array.isArray(a))n[i]=a;else if(t(a))n[i]=a;else if(e(a)){const o=n[i];e(o)?n[i]=Q2(o,a):n[i]=Q2(a)}else n[i]=a}return n}function oB(s,e){return Q2(iB,s,e||{})}function lB(s,e){return Q2(aB,s,e||{})}class cB{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:r},i){try{const{data:a,error:o}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:o};const l=r??Q9.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:c}=a.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${n}`),c.displayName||(c.displayName=c.name)}switch(a.webauthn.type){case"create":{const c=oB(a.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:f}=await sB({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const c=lB(a.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:f}=await rB(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(a){return ft(a)?{data:null,error:a}:{data:null,error:new Id("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:r}},i){if(!t)return{data:null,error:new u1("rpId is required for WebAuthn authentication")};try{if(!yE())return{data:null,error:new Id("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:r},{request:i});if(!a)return{data:null,error:o};const{webauthn:l}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:n,credential_response:l.credential_response}})}catch(a){return ft(a)?{data:null,error:a}:{data:null,error:new Id("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:r},i){if(!t)return{data:null,error:new u1("rpId is required for WebAuthn registration")};try{if(!yE())return{data:null,error:new Id("Browser does not support WebAuthn",null)};const{data:a,error:o}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:o};const{data:l,error:c}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:r},{create:i});return l?this._verify({factorId:a.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(a){return ft(a)?{data:null,error:a}:{data:null,error:new Id("Unexpected error in register",a)}}}}W9();const uB={url:i9,storageKey:a9,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:o9,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function bE(s,e,t){return await t()}const Wf={};class d1{get jwks(){var e,t;return(t=(e=Wf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Wf[this.storageKey]=Object.assign(Object.assign({},Wf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Wf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Wf[this.storageKey]=Object.assign(Object.assign({},Wf[this.storageKey]),{cachedAt:e})}constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=d1.nextInstanceID,d1.nextInstanceID+=1,this.instanceID>0&&Ri()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},uB),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new z9({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=DI(r.fetch),this.lock=r.lock||bE,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ri()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=H9:this.lock=bE,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new cB(this)},this.persistSession?(r.storage?this.storage=r.storage:FI()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=vE(this.memoryStorage)),r.userStorage&&(this.userStorage=r.userStorage)):(this.memoryStorage={},this.storage=vE(this.memoryStorage)),Ri()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${RI}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=x9(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Ri()&&this.detectSessionInUrl&&n!=="none"){const{data:r,error:i}=await this._getSessionFromURL(t,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),f9(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return ft(t)?{error:t}:{error:new Id("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Va}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ft(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,n,r;try{let i;if("email"in e){const{email:u,password:f,options:p}=e;let m=null,b=null;this.flowType==="pkce"&&([m,b]=await zf(this.storage,this.storageKey)),i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:f,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:m,code_challenge_method:b},xform:Va})}else if("phone"in e){const{phone:u,password:f,options:p}=e;i=await Et(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Va})}else throw new cb("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ft(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mE})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await Et(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:mE})}else throw new cb("You must provide either an email or phone number and a password");const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Uf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r})}catch(t){if(ft(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,r,i,a,o,l,c,u,f,p;let m,b;if("message"in e)m=e.message,b=e.signature;else{const{chain:y,wallet:S,statement:w,options:_}=e;let k;if(Ri())if(typeof S=="object")k=S;else{const W=window;if("ethereum"in W&&typeof W.ethereum=="object"&&"request"in W.ethereum&&typeof W.ethereum.request=="function")k=W.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=S}const C=new URL((t=_==null?void 0:_.url)!==null&&t!==void 0?t:window.location.href),B=await k.request({method:"eth_requestAccounts"}).then(W=>W).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!B||B.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const F=$I(B[0]);let j=(n=_==null?void 0:_.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!j){const W=await k.request({method:"eth_chainId"});j=V9(W)}const T={domain:C.host,address:F,statement:w,uri:C.href,version:"1",chainId:j,nonce:(r=_==null?void 0:_.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(a=(i=_==null?void 0:_.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(o=_==null?void 0:_.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=_==null?void 0:_.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=_==null?void 0:_.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=_==null?void 0:_.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=X9(T),b=await k.request({method:"personal_sign",params:[G9(m),F]})}try{const{data:y,error:S}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:b},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Va});if(S)throw S;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Uf}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:S})}catch(y){if(ft(y))return{data:{user:null,session:null},error:y};throw y}}async signInWithSolana(e){var t,n,r,i,a,o,l,c,u,f,p,m;let b,y;if("message"in e)b=e.message,y=e.signature;else{const{chain:S,wallet:w,statement:_,options:k}=e;let C;if(Ri())if(typeof w=="object")C=w;else{const F=window;if("solana"in F&&typeof F.solana=="object"&&("signIn"in F.solana&&typeof F.solana.signIn=="function"||"signMessage"in F.solana&&typeof F.solana.signMessage=="function"))C=F.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=w}const B=new URL((t=k==null?void 0:k.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const F=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:B.host,uri:B.href}),_?{statement:_}:null));let j;if(Array.isArray(F)&&F[0]&&typeof F[0]=="object")j=F[0];else if(F&&typeof F=="object"&&"signedMessage"in F&&"signature"in F)j=F;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)b=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),y=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${B.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${B.href}`,`Issued At: ${(r=(n=k==null?void 0:k.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=k==null?void 0:k.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((a=k==null?void 0:k.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((f=(u=k==null?void 0:k.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...k.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const F=await C.signMessage(new TextEncoder().encode(b),"utf8");if(!F||!(F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=F}}try{const{data:S,error:w}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:$d(y)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Va});if(w)throw w;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new Uf}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:w})}catch(S){if(ft(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const t=await _d(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(t??"").split("/");try{const{data:i,error:a}=await Et(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:Va});if(await Wc(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Uf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:a})}catch(i){if(ft(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:i,nonce:a}=e,o=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Va}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Uf}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(ft(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,r,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await zf(this.storage,this.storageKey));const{error:f}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await Et(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new cb("You must provide either an email or phone number.")}catch(o){if(ft(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,n;try{let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Et(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Va});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(ft(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,n,r;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await zf(this.storage,this.storageKey)),await Et(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:D9})}catch(i){if(ft(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Kc;const{error:r}=await Et(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(ft(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:i}=e,{error:a}=await Et(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:r,options:i}=e,{data:a,error:o}=await Et(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new cb("You must provide either an email or phone number and a type")}catch(t){if(ft(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await _d(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Nx:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await _d(this.userStorage,this.storageKey+"-user");a!=null&&a.user?e.user=a.user:e.user=Px()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tu}):await this._useSession(async t=>{var n,r,i;const{data:a,error:o}=t;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kc}:await Et(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:tu})})}catch(t){if(ft(t))return h9(t)&&(await this._removeSession(),await Wc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:r,error:i}=n;if(i)throw i;if(!r.session)throw new Kc;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await zf(this.storage,this.storageKey));const{data:c,error:u}=await Et(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:tu});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Kc;const t=Date.now()/1e3;let n=t,r=!0,i=null;const{payload:a}=Ex(e.access_token);if(a.exp&&(n=a.exp,r=n<=t),r){const{data:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(ft(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Kc;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(ft(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ri())throw new ub("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ub(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new lE("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ub("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new lE("No code detected.");const{data:_,error:k}=await this._exchangeCodeForSession(e.code);if(k)throw k;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new ub("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let p=u+f;l&&(p=parseInt(l));const m=p-u;m*1e3<=rp&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const b=p-f;u-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,u):u-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,u);const{data:y,error:S}=await this._getUser(i);if(S)throw S;const w={provider_token:n,provider_refresh_token:r,access_token:i,expires_in:f,expires_at:p,refresh_token:a,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(n){if(ft(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await _d(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:r,error:i}=t;if(i)return{error:i};const a=(n=r.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(d9(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Wc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=w9(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,r;try{const{data:{session:i},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let n=null,r=null;this.flowType==="pkce"&&([n,r]=await zf(this.storage,this.storageKey,!0));try{return await Et(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(ft(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(ft(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:r}=await this._useSession(async i=>{var a,o,l,c,u;const{data:f,error:p}=i;if(p)throw p;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Et(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return Ri()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ft(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:r,data:{session:i}}=t;if(r)throw r;const{options:a,provider:o,token:l,access_token:c,nonce:u}=e,f=await Et(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Va}),{data:p,error:m}=f;return m?{data:{user:null,session:null},error:m}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new Uf}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),{data:p,error:m})}catch(r){if(ft(r))return{data:{user:null,session:null},error:r};throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,r;const{data:i,error:a}=t;if(a)throw a;return await Et(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await S9(async r=>(r>0&&await A9(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Et(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Va})),(r,i)=>{const a=200*Math.pow(2,r);return i&&Cx(i)&&Date.now()+a-n<rp})}catch(n){if(this._debug(t,"error",n),ft(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),Ri()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await _d(this.storage,this.storageKey);if(r&&this.userStorage){let a=await _d(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:r.user},await ip(this.userStorage,this.storageKey+"-user",a)),r.user=(e=a==null?void 0:a.user)!==null&&e!==void 0?e:Px()}else if(r&&!r.user&&!r.user){const a=await _d(this.storage,this.storageKey+"-user");a&&(a!=null&&a.user)?(r.user=a.user,await Wc(this.storage,this.storageKey+"-user"),await ip(this.storage,this.storageKey,r)):r.user=Px()}if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const i=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Nx;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Nx}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Cx(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:o}=await this._getUser(r.access_token);!o&&(a!=null&&a.user)?(r.user=a.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Kc;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new o5;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Kc;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={data:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(r,"error",i),ft(i)){const a={data:null,error:i};return Cx(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,n=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await ip(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const i=fE(r);await ip(this.storage,this.storageKey,i)}else{const r=fE(t);await ip(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await Wc(this.storage,this.storageKey),await Wc(this.storage,this.storageKey+"-code-verifier"),await Wc(this.storage,this.storageKey+"-user"),this.userStorage&&await Wc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ri()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rp);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((n.expires_at*1e3-e)/rp);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${rp}ms, refresh threshold is ${pS} ticks`),r<=pS&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof BI)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ri()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,a]=await zf(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);r.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:r,error:i}=t;return i?{data:null,error:i}:await Et(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=r==null?void 0:r.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,r;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await Et(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&l.type==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(ft(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?tB(e.webauthn.credential_response):nB(e.webauthn.credential_response)})}:{code:e.code}),{data:o,error:l}=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=r==null?void 0:r.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(t){if(ft(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:r,error:i}=t;if(i)return{data:null,error:i};const a=await Et(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=r==null?void 0:r.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:o}=a;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:Z9(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:eB(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(ft(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Ex(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(t=r.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(o=>o.kid===e);if(n)return n;const r=Date.now();if(n=this.jwks.keys.find(o=>o.kid===e),n&&this.jwks_cached_at+c9>r)return n;const{data:i,error:a}=await Et(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,n=i.keys.find(o=>o.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:m,error:b}=await this.getSession();if(b||!m.session)return{data:null,error:b};n=m.session.access_token}const{header:r,payload:i,signature:a,raw:{header:o,payload:l}}=Ex(n);t!=null&&t.allowExpired||T9(i.exp);const c=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!c){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:i,header:r,signature:a},error:null}}const u=I9(r.alg),f=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,y9(`${o}.${l}`)))throw new vS("Invalid JWT signature");return{data:{claims:i,header:r,signature:a},error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}}d1.nextInstanceID=0;const dB=d1;class hB extends dB{constructor(e){super(e)}}var fB=function(s,e,t,n){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(n.next(u))}catch(f){a(f)}}function l(u){try{c(n.throw(u))}catch(f){a(f)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((n=n.apply(s,e||[])).next())})};class pB{constructor(e,t,n){var r,i,a;this.supabaseUrl=e,this.supabaseKey=t;const o=r9(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const l=`sb-${o.hostname.split(".")[0]}-auth-token`,c={db:X7,realtime:Y7,auth:Object.assign(Object.assign({},K7),{storageKey:l}),global:G7},u=s9(n??{},c);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=e9(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new u7(new URL("rest/v1",o).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new H7(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new zD(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return fB(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:i,storageKey:a,flowType:o,lock:l,debug:c},u,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new hB({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:i,flowType:o,lock:l,debug:c,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new C7(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const mB=(s,e,t)=>new pB(s,e,t);function gB(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}gB()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const vB="https://hyrgqrgeshkgvsfwnzzu.supabase.co",yB="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh5cmdxcmdlc2hrZ3ZzZnduenp1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExNTU3NTEsImV4cCI6MjA3NjczMTc1MX0.PpQa22hWN7OAl8LP_h9mhxfogUaV1qmSuOiaBeaLDh4",an=mB(vB,yB);async function Tx(s){const{data:e,error:t}=await an.from("pets").select("id, name, species, color, insurance_company, policy_number, owner_name, owner_address, owner_phone, filing_deadline_days, monthly_premium, deductible_per_claim, coverage_start_date").eq("user_id",s).order("created_at",{ascending:!0});if(t)throw t;const n=(e||[]).map(r=>({id:r.id,name:r.name,species:r.species,color:r.color,insuranceCompany:r.insurance_company,policyNumber:r.policy_number,ownerName:r.owner_name,ownerAddress:r.owner_address,ownerPhone:r.owner_phone,filing_deadline_days:r.filing_deadline_days,monthly_premium:r.monthly_premium??null,deductible_per_claim:r.deductible_per_claim??null,coverage_start_date:r.coverage_start_date||null}));return console.log("[dbLoadPets] userId=",s,"count=",n.length),n}async function wE(s,e){const t=e.color||(e.species==="dog"?"#3B82F6":e.species==="cat"?"#F97316":"#6B7280"),n={id:e.id,user_id:s,name:e.name,species:e.species,color:t,insurance_company:e.insuranceCompany,policy_number:e.policyNumber,owner_name:e.ownerName||"",owner_address:e.ownerAddress||"",owner_phone:e.ownerPhone||"",filing_deadline_days:e.filing_deadline_days||e.filingDeadlineDays||null,monthly_premium:e.monthly_premium??null,deductible_per_claim:e.deductible_per_claim??null,coverage_start_date:e.coverage_start_date||null};console.log("[dbUpsertPet] userId=",s,"payload=",n);const{error:r}=await an.from("pets").upsert(n,{onConflict:"id"}).select();if(r)throw r}async function bB(s,e){console.log("[dbDeletePet] userId=",s,"petId=",e);const{error:t}=await an.from("pets").delete().eq("user_id",s).eq("id",e);if(t)throw t}async function xE(s,e){const t={id:s,email:e??null};console.log("[dbEnsureProfile] upserting profile",t);const{error:n}=await an.from("profiles").upsert(t,{onConflict:"id"}).select();if(n)throw n}async function wB(s){console.log("[createPet] received payload:",s);const{data:e,error:t}=await an.from("pets").insert([{user_id:s.user_id,name:s.name,species:s.species,color:s.color??null,insurance_company:s.insurance_company??null,policy_number:s.policy_number??null,breed:s.breed??null,weight_lbs:s.weight_lbs??null,monthly_premium:s.monthly_premium??null,deductible_per_claim:s.deductible_per_claim??null,coverage_start_date:s.coverage_start_date??null}]).select("*").single();if(console.log("[createPet] insert result:",{data:e,error:t}),t)throw t;return e}function fn(s){"@babel/helpers - typeof";return fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(s)}var Ir=Uint8Array,Qi=Uint16Array,w3=Int32Array,l5=new Ir([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c5=new Ir([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),yS=new Ir([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qI=function(s,e){for(var t=new Qi(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var r=new w3(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)r[i]=i-t[n]<<5|n;return{b:t,r}},HI=qI(l5,2),WI=HI.b,bS=HI.r;WI[28]=258,bS[258]=28;var VI=qI(c5,0),xB=VI.b,_E=VI.r,wS=new Qi(32768);for(var jn=0;jn<32768;++jn){var Vc=(jn&43690)>>1|(jn&21845)<<1;Vc=(Vc&52428)>>2|(Vc&13107)<<2,Vc=(Vc&61680)>>4|(Vc&3855)<<4,wS[jn]=((Vc&65280)>>8|(Vc&255)<<8)>>1}var hl=function(s,e,t){for(var n=s.length,r=0,i=new Qi(e);r<n;++r)s[r]&&++i[s[r]-1];var a=new Qi(e);for(r=1;r<e;++r)a[r]=a[r-1]+i[r-1]<<1;var o;if(t){o=new Qi(1<<e);var l=15-e;for(r=0;r<n;++r)if(s[r])for(var c=r<<4|s[r],u=e-s[r],f=a[s[r]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)o[wS[f]>>l]=c}else for(o=new Qi(n),r=0;r<n;++r)s[r]&&(o[r]=wS[a[s[r]-1]++]>>15-s[r]);return o},Yu=new Ir(288);for(var jn=0;jn<144;++jn)Yu[jn]=8;for(var jn=144;jn<256;++jn)Yu[jn]=9;for(var jn=256;jn<280;++jn)Yu[jn]=7;for(var jn=280;jn<288;++jn)Yu[jn]=8;var h1=new Ir(32);for(var jn=0;jn<32;++jn)h1[jn]=5;var _B=hl(Yu,9,0),AB=hl(Yu,9,1),SB=hl(h1,5,0),kB=hl(h1,5,1),Ix=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},Ha=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},jx=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},x3=function(s){return(s+7)/8|0},GI=function(s,e,t){return(t==null||t>s.length)&&(t=s.length),new Ir(s.subarray(e,t))},NB=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Qa=function(s,e,t){var n=new Error(e||NB[s]);if(n.code=s,Error.captureStackTrace&&Error.captureStackTrace(n,Qa),!t)throw n;return n},CB=function(s,e,t,n){var r=s.length,i=0;if(!r||e.f&&!e.l)return t||new Ir(0);var a=!t,o=a||e.i!=2,l=e.i;a&&(t=new Ir(r*3));var c=function(je){var Fe=t.length;if(je>Fe){var Be=new Ir(Math.max(Fe*2,je));Be.set(t),t=Be}},u=e.f||0,f=e.p||0,p=e.b||0,m=e.l,b=e.d,y=e.m,S=e.n,w=r*8;do{if(!m){u=Ha(s,f,1);var _=Ha(s,f+1,3);if(f+=3,_)if(_==1)m=AB,b=kB,y=9,S=5;else if(_==2){var F=Ha(s,f,31)+257,j=Ha(s,f+10,15)+4,T=F+Ha(s,f+5,31)+1;f+=14;for(var W=new Ir(T),Y=new Ir(19),I=0;I<j;++I)Y[yS[I]]=Ha(s,f+I*3,7);f+=j*3;for(var O=Ix(Y),X=(1<<O)-1,K=hl(Y,O,1),I=0;I<T;){var ne=K[Ha(s,f,X)];f+=ne&15;var k=ne>>4;if(k<16)W[I++]=k;else{var te=0,ue=0;for(k==16?(ue=3+Ha(s,f,3),f+=2,te=W[I-1]):k==17?(ue=3+Ha(s,f,7),f+=3):k==18&&(ue=11+Ha(s,f,127),f+=7);ue--;)W[I++]=te}}var Z=W.subarray(0,F),he=W.subarray(F);y=Ix(Z),S=Ix(he),m=hl(Z,y,1),b=hl(he,S,1)}else Qa(1);else{var k=x3(f)+4,C=s[k-4]|s[k-3]<<8,B=k+C;if(B>r){l&&Qa(0);break}o&&c(p+C),t.set(s.subarray(k,B),p),e.b=p+=C,e.p=f=B*8,e.f=u;continue}if(f>w){l&&Qa(0);break}}o&&c(p+131072);for(var me=(1<<y)-1,Ne=(1<<S)-1,L=f;;L=f){var te=m[jx(s,f)&me],V=te>>4;if(f+=te&15,f>w){l&&Qa(0);break}if(te||Qa(2),V<256)t[p++]=V;else if(V==256){L=f,m=null;break}else{var Q=V-254;if(V>264){var I=V-257,se=l5[I];Q=Ha(s,f,(1<<se)-1)+WI[I],f+=se}var re=b[jx(s,f)&Ne],de=re>>4;re||Qa(3),f+=re&15;var he=xB[de];if(de>3){var se=c5[de];he+=jx(s,f)&(1<<se)-1,f+=se}if(f>w){l&&Qa(0);break}o&&c(p+131072);var le=p+Q;if(p<he){var we=i-he,Le=Math.min(he,le);for(we+p<0&&Qa(3);p<Le;++p)t[p]=n[we+p]}for(;p<le;++p)t[p]=t[p-he]}}e.l=m,e.p=L,e.b=p,e.f=u,m&&(u=1,e.m=y,e.d=b,e.n=S)}while(!u);return p!=t.length&&a?GI(t,0,p):t.subarray(0,p)},Nl=function(s,e,t){t<<=e&7;var n=e/8|0;s[n]|=t,s[n+1]|=t>>8},Yg=function(s,e,t){t<<=e&7;var n=e/8|0;s[n]|=t,s[n+1]|=t>>8,s[n+2]|=t>>16},Rx=function(s,e){for(var t=[],n=0;n<s.length;++n)s[n]&&t.push({s:n,f:s[n]});var r=t.length,i=t.slice();if(!r)return{t:KI,l:0};if(r==1){var a=new Ir(t[0].s+1);return a[t[0].s]=1,{t:a,l:1}}t.sort(function(B,F){return B.f-F.f}),t.push({s:-1,f:25001});var o=t[0],l=t[1],c=0,u=1,f=2;for(t[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=t[t[c].f<t[f].f?c++:f++],l=t[c!=u&&t[c].f<t[f].f?c++:f++],t[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,n=1;n<r;++n)i[n].s>p&&(p=i[n].s);var m=new Qi(p+1),b=xS(t[u-1],m,0);if(b>e){var n=0,y=0,S=b-e,w=1<<S;for(i.sort(function(F,j){return m[j.s]-m[F.s]||F.f-j.f});n<r;++n){var _=i[n].s;if(m[_]>e)y+=w-(1<<b-m[_]),m[_]=e;else break}for(y>>=S;y>0;){var k=i[n].s;m[k]<e?y-=1<<e-m[k]++-1:++n}for(;n>=0&&y;--n){var C=i[n].s;m[C]==e&&(--m[C],++y)}b=e}return{t:new Ir(m),l:b}},xS=function(s,e,t){return s.s==-1?Math.max(xS(s.l,e,t+1),xS(s.r,e,t+1)):e[s.s]=t},AE=function(s){for(var e=s.length;e&&!s[--e];);for(var t=new Qi(++e),n=0,r=s[0],i=1,a=function(l){t[n++]=l},o=1;o<=e;++o)if(s[o]==r&&o!=e)++i;else{if(!r&&i>2){for(;i>138;i-=138)a(32754);i>2&&(a(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(a(r),--i;i>6;i-=6)a(8304);i>2&&(a(i-3<<5|8208),i=0)}for(;i--;)a(r);i=1,r=s[o]}return{c:t.subarray(0,n),n:e}},Jg=function(s,e){for(var t=0,n=0;n<e.length;++n)t+=s[n]*e[n];return t},XI=function(s,e,t){var n=t.length,r=x3(e+2);s[r]=n&255,s[r+1]=n>>8,s[r+2]=s[r]^255,s[r+3]=s[r+1]^255;for(var i=0;i<n;++i)s[r+i+4]=t[i];return(r+4+n)*8},SE=function(s,e,t,n,r,i,a,o,l,c,u){Nl(e,u++,t),++r[256];for(var f=Rx(r,15),p=f.t,m=f.l,b=Rx(i,15),y=b.t,S=b.l,w=AE(p),_=w.c,k=w.n,C=AE(y),B=C.c,F=C.n,j=new Qi(19),T=0;T<_.length;++T)++j[_[T]&31];for(var T=0;T<B.length;++T)++j[B[T]&31];for(var W=Rx(j,7),Y=W.t,I=W.l,O=19;O>4&&!Y[yS[O-1]];--O);var X=c+5<<3,K=Jg(r,Yu)+Jg(i,h1)+a,ne=Jg(r,p)+Jg(i,y)+a+14+3*O+Jg(j,Y)+2*j[16]+3*j[17]+7*j[18];if(l>=0&&X<=K&&X<=ne)return XI(e,u,s.subarray(l,l+c));var te,ue,Z,he;if(Nl(e,u,1+(ne<K)),u+=2,ne<K){te=hl(p,m,0),ue=p,Z=hl(y,S,0),he=y;var me=hl(Y,I,0);Nl(e,u,k-257),Nl(e,u+5,F-1),Nl(e,u+10,O-4),u+=14;for(var T=0;T<O;++T)Nl(e,u+3*T,Y[yS[T]]);u+=3*O;for(var Ne=[_,B],L=0;L<2;++L)for(var V=Ne[L],T=0;T<V.length;++T){var Q=V[T]&31;Nl(e,u,me[Q]),u+=Y[Q],Q>15&&(Nl(e,u,V[T]>>5&127),u+=V[T]>>12)}}else te=_B,ue=Yu,Z=SB,he=h1;for(var T=0;T<o;++T){var se=n[T];if(se>255){var Q=se>>18&31;Yg(e,u,te[Q+257]),u+=ue[Q+257],Q>7&&(Nl(e,u,se>>23&31),u+=l5[Q]);var re=se&31;Yg(e,u,Z[re]),u+=he[re],re>3&&(Yg(e,u,se>>5&8191),u+=c5[re])}else Yg(e,u,te[se]),u+=ue[se]}return Yg(e,u,te[256]),u+ue[256]},EB=new w3([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),KI=new Ir(0),PB=function(s,e,t,n,r,i){var a=i.z||s.length,o=new Ir(n+a+5*(1+Math.ceil(a/7e3))+r),l=o.subarray(n,o.length-r),c=i.l,u=(i.r||0)&7;if(e){u&&(l[0]=i.r>>3);for(var f=EB[e-1],p=f>>13,m=f&8191,b=(1<<t)-1,y=i.p||new Qi(32768),S=i.h||new Qi(b+1),w=Math.ceil(t/3),_=2*w,k=function(at){return(s[at]^s[at+1]<<w^s[at+2]<<_)&b},C=new w3(25e3),B=new Qi(288),F=new Qi(32),j=0,T=0,W=i.i||0,Y=0,I=i.w||0,O=0;W+2<a;++W){var X=k(W),K=W&32767,ne=S[X];if(y[K]=ne,S[X]=K,I<=W){var te=a-W;if((j>7e3||Y>24576)&&(te>423||!c)){u=SE(s,l,0,C,B,F,T,Y,O,W-O,u),Y=j=T=0,O=W;for(var ue=0;ue<286;++ue)B[ue]=0;for(var ue=0;ue<30;++ue)F[ue]=0}var Z=2,he=0,me=m,Ne=K-ne&32767;if(te>2&&X==k(W-Ne))for(var L=Math.min(p,te)-1,V=Math.min(32767,W),Q=Math.min(258,te);Ne<=V&&--me&&K!=ne;){if(s[W+Z]==s[W+Z-Ne]){for(var se=0;se<Q&&s[W+se]==s[W+se-Ne];++se);if(se>Z){if(Z=se,he=Ne,se>L)break;for(var re=Math.min(Ne,se-2),de=0,ue=0;ue<re;++ue){var le=W-Ne+ue&32767,we=y[le],Le=le-we&32767;Le>de&&(de=Le,ne=le)}}}K=ne,ne=y[K],Ne+=K-ne&32767}if(he){C[Y++]=268435456|bS[Z]<<18|_E[he];var je=bS[Z]&31,Fe=_E[he]&31;T+=l5[je]+c5[Fe],++B[257+je],++F[Fe],I=W+Z,++j}else C[Y++]=s[W],++B[s[W]]}}for(W=Math.max(W,I);W<a;++W)C[Y++]=s[W],++B[s[W]];u=SE(s,l,c,C,B,F,T,Y,O,W-O,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=S,i.p=y,i.i=W,i.w=I)}else{for(var W=i.w||0;W<a+c;W+=65535){var Be=W+65535;Be>=a&&(l[u/8|0]=c,Be=a),u=XI(l,u+1,s.subarray(W,Be))}i.i=a}return GI(o,0,n+x3(u)+r)},YI=function(){var s=1,e=0;return{p:function(t){for(var n=s,r=e,i=t.length|0,a=0;a!=i;){for(var o=Math.min(a+2655,i);a<o;++a)r+=n+=t[a];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}s=n,e=r},d:function(){return s%=65521,e%=65521,(s&255)<<24|(s&65280)<<8|(e&255)<<8|e>>8}}},LB=function(s,e,t,n,r){if(!r&&(r={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),a=new Ir(i.length+s.length);a.set(i),a.set(s,i.length),s=a,r.w=i.length}return PB(s,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+e.mem,t,n,r)},JI=function(s,e,t){for(;t;++e)s[e]=t,t>>>=8},TB=function(s,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(s[0]=120,s[1]=n<<6|(e.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,e.dictionary){var r=YI();r.p(e.dictionary),JI(s,2,r.d())}},IB=function(s,e){return((s[0]&15)!=8||s[0]>>4>7||(s[0]<<8|s[1])%31)&&Qa(6,"invalid zlib data"),(s[1]>>5&1)==1&&Qa(6,"invalid zlib data: "+(s[1]&32?"need":"unexpected")+" dictionary"),(s[1]>>3&4)+2};function _S(s,e){e||(e={});var t=YI();t.p(s);var n=LB(s,e,e.dictionary?6:2,4);return TB(n,e),JI(n,n.length-4,t.d()),n}function jB(s,e){return CB(s.subarray(IB(s),-4),{i:2},e,e)}var RB=typeof TextDecoder<"u"&&new TextDecoder,OB=0;try{RB.decode(KI,{stream:!0}),OB=1}catch{}var bt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Ox(){bt.console&&typeof bt.console.log=="function"&&bt.console.log.apply(bt.console,arguments)}var _n={log:Ox,warn:function(s){bt.console&&(typeof bt.console.warn=="function"?bt.console.warn.apply(bt.console,arguments):Ox.call(null,arguments))},error:function(s){bt.console&&(typeof bt.console.error=="function"?bt.console.error.apply(bt.console,arguments):Ox(s))}};function Mx(s,e,t){var n=new XMLHttpRequest;n.open("GET",s),n.responseType="blob",n.onload=function(){Pd(n.response,e,t)},n.onerror=function(){_n.error("could not download file")},n.send()}function kE(s){var e=new XMLHttpRequest;e.open("HEAD",s,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function db(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(e)}}var $0,AS,Pd=bt.saveAs||((typeof window>"u"?"undefined":fn(window))!=="object"||window!==bt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(s,e,t){var n=bt.URL||bt.webkitURL,r=document.createElement("a");e=e||s.name||"download",r.download=e,r.rel="noopener",typeof s=="string"?(r.href=s,r.origin!==location.origin?kE(r.href)?Mx(s,e,t):db(r,r.target="_blank"):db(r)):(r.href=n.createObjectURL(s),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){db(r)},0))}:"msSaveOrOpenBlob"in navigator?function(s,e,t){if(e=e||s.name||"download",typeof s=="string")if(kE(s))Mx(s,e,t);else{var n=document.createElement("a");n.href=s,n.target="_blank",setTimeout(function(){db(n)})}else navigator.msSaveOrOpenBlob(function(r,i){return i===void 0?i={autoBom:!1}:fn(i)!=="object"&&(_n.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}(s,t),e)}:function(s,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof s=="string")return Mx(s,e,t);var r=s.type==="application/octet-stream",i=/constructor/i.test(bt.HTMLElement)||bt.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||r&&i)&&(typeof FileReader>"u"?"undefined":fn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=a?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(s)}else{var l=bt.URL||bt.webkitURL,c=l.createObjectURL(s);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function QI(s){var e;s=s||"",this.ok=!1,s.charAt(0)=="#"&&(s=s.substr(1,6)),s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[s=(s=s.replace(/ /g,"")).toLowerCase()]||s;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<t.length;n++){var r=t[n].re,i=t[n].process,a=r.exec(s);a&&(e=i(a),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Fx(s,e){var t=s[0],n=s[1],r=s[2],i=s[3];t=vr(t,n,r,i,e[0],7,-680876936),i=vr(i,t,n,r,e[1],12,-389564586),r=vr(r,i,t,n,e[2],17,606105819),n=vr(n,r,i,t,e[3],22,-1044525330),t=vr(t,n,r,i,e[4],7,-176418897),i=vr(i,t,n,r,e[5],12,1200080426),r=vr(r,i,t,n,e[6],17,-1473231341),n=vr(n,r,i,t,e[7],22,-45705983),t=vr(t,n,r,i,e[8],7,1770035416),i=vr(i,t,n,r,e[9],12,-1958414417),r=vr(r,i,t,n,e[10],17,-42063),n=vr(n,r,i,t,e[11],22,-1990404162),t=vr(t,n,r,i,e[12],7,1804603682),i=vr(i,t,n,r,e[13],12,-40341101),r=vr(r,i,t,n,e[14],17,-1502002290),t=yr(t,n=vr(n,r,i,t,e[15],22,1236535329),r,i,e[1],5,-165796510),i=yr(i,t,n,r,e[6],9,-1069501632),r=yr(r,i,t,n,e[11],14,643717713),n=yr(n,r,i,t,e[0],20,-373897302),t=yr(t,n,r,i,e[5],5,-701558691),i=yr(i,t,n,r,e[10],9,38016083),r=yr(r,i,t,n,e[15],14,-660478335),n=yr(n,r,i,t,e[4],20,-405537848),t=yr(t,n,r,i,e[9],5,568446438),i=yr(i,t,n,r,e[14],9,-1019803690),r=yr(r,i,t,n,e[3],14,-187363961),n=yr(n,r,i,t,e[8],20,1163531501),t=yr(t,n,r,i,e[13],5,-1444681467),i=yr(i,t,n,r,e[2],9,-51403784),r=yr(r,i,t,n,e[7],14,1735328473),t=br(t,n=yr(n,r,i,t,e[12],20,-1926607734),r,i,e[5],4,-378558),i=br(i,t,n,r,e[8],11,-2022574463),r=br(r,i,t,n,e[11],16,1839030562),n=br(n,r,i,t,e[14],23,-35309556),t=br(t,n,r,i,e[1],4,-1530992060),i=br(i,t,n,r,e[4],11,1272893353),r=br(r,i,t,n,e[7],16,-155497632),n=br(n,r,i,t,e[10],23,-1094730640),t=br(t,n,r,i,e[13],4,681279174),i=br(i,t,n,r,e[0],11,-358537222),r=br(r,i,t,n,e[3],16,-722521979),n=br(n,r,i,t,e[6],23,76029189),t=br(t,n,r,i,e[9],4,-640364487),i=br(i,t,n,r,e[12],11,-421815835),r=br(r,i,t,n,e[15],16,530742520),t=wr(t,n=br(n,r,i,t,e[2],23,-995338651),r,i,e[0],6,-198630844),i=wr(i,t,n,r,e[7],10,1126891415),r=wr(r,i,t,n,e[14],15,-1416354905),n=wr(n,r,i,t,e[5],21,-57434055),t=wr(t,n,r,i,e[12],6,1700485571),i=wr(i,t,n,r,e[3],10,-1894986606),r=wr(r,i,t,n,e[10],15,-1051523),n=wr(n,r,i,t,e[1],21,-2054922799),t=wr(t,n,r,i,e[8],6,1873313359),i=wr(i,t,n,r,e[15],10,-30611744),r=wr(r,i,t,n,e[6],15,-1560198380),n=wr(n,r,i,t,e[13],21,1309151649),t=wr(t,n,r,i,e[4],6,-145523070),i=wr(i,t,n,r,e[11],10,-1120210379),r=wr(r,i,t,n,e[2],15,718787259),n=wr(n,r,i,t,e[9],21,-343485551),s[0]=Ru(t,s[0]),s[1]=Ru(n,s[1]),s[2]=Ru(r,s[2]),s[3]=Ru(i,s[3])}function u5(s,e,t,n,r,i){return e=Ru(Ru(e,s),Ru(n,i)),Ru(e<<r|e>>>32-r,t)}function vr(s,e,t,n,r,i,a){return u5(e&t|~e&n,s,e,r,i,a)}function yr(s,e,t,n,r,i,a){return u5(e&n|t&~n,s,e,r,i,a)}function br(s,e,t,n,r,i,a){return u5(e^t^n,s,e,r,i,a)}function wr(s,e,t,n,r,i,a){return u5(t^(e|~n),s,e,r,i,a)}function ZI(s){var e,t=s.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=s.length;e+=64)Fx(n,MB(s.substring(e-64,e)));s=s.substring(e-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<s.length;e++)r[e>>2]|=s.charCodeAt(e)<<(e%4<<3);if(r[e>>2]|=128<<(e%4<<3),e>55)for(Fx(n,r),e=0;e<16;e++)r[e]=0;return r[14]=8*t,Fx(n,r),n}function MB(s){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=s.charCodeAt(e)+(s.charCodeAt(e+1)<<8)+(s.charCodeAt(e+2)<<16)+(s.charCodeAt(e+3)<<24);return t}$0=bt.atob.bind(bt),AS=bt.btoa.bind(bt);var NE="0123456789abcdef".split("");function FB(s){for(var e="",t=0;t<4;t++)e+=NE[s>>8*t+4&15]+NE[s>>8*t&15];return e}function DB(s){return String.fromCharCode((255&s)>>0,(65280&s)>>8,(16711680&s)>>16,(4278190080&s)>>24)}function SS(s){return ZI(s).map(DB).join("")}var BB=function(s){for(var e=0;e<s.length;e++)s[e]=FB(s[e]);return s.join("")}(ZI("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ru(s,e){if(BB){var t=(65535&s)+(65535&e);return(s>>16)+(e>>16)+(t>>16)<<16|65535&t}return s+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function kS(s,e){var t,n,r,i;if(s!==t){for(var a=(r=s,i=1+(256/s.length>>0),new Array(i+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+a.charCodeAt(l))%256,o[l]=o[c],o[c]=u}t=s,n=o}else o=n;var f=e.length,p=0,m=0,b="";for(l=0;l<f;l++)m=(m+(u=o[p=(p+1)%256]))%256,o[p]=o[m],o[m]=u,a=o[(o[p]+o[m])%256],b+=String.fromCharCode(e.charCodeAt(l)^a);return b}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var CE={print:4,modify:8,copy:16,"annot-forms":32};function ap(s,e,t,n){this.v=1,this.r=2;var r=192;s.forEach(function(o){if(CE.perm!==void 0)throw new Error("Invalid permission: "+o);r+=CE[o]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),a=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,a),this.P=-(1+(255^r)),this.encryptionKey=SS(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=kS(this.encryptionKey,this.padding)}function op(s){if(/[^\u0000-\u00ff]/.test(s))throw new Error("Invalid PDF Name Object: "+s+", Only accept ASCII characters.");for(var e="",t=s.length,n=0;n<t;n++){var r=s.charCodeAt(n);r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?e+="#"+("0"+r.toString(16)).slice(-2):e+=s[n]}return e}function EE(s){if(fn(s)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,r){if(r=r||!1,typeof t!="string"||typeof n!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[n,!!r],i},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var i in e[t]){var a=e[t][i];try{a[0].apply(s,n)}catch(o){bt.console&&_n.error("jsPDF PubSub Error",o.message,o)}a[1]&&r.push(i)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Z2(s){if(!(this instanceof Z2))return new Z2(s);var e="opacity,stroke-opacity".split(",");for(var t in s)s.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=s[t]);this.id="",this.objectNumber=-1}function ej(s,e){this.gState=s,this.matrix=e,this.id="",this.objectNumber=-1}function jd(s,e,t,n,r){if(!(this instanceof jd))return new jd(s,e,t,n,r);this.type=s==="axial"?2:3,this.coords=e,this.colors=t,ej.call(this,n,r)}function xp(s,e,t,n,r){if(!(this instanceof xp))return new xp(s,e,t,n,r);this.boundingBox=s,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,ej.call(this,n,r)}function yt(s){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],r=arguments[2],i=arguments[3],a=[],o=1,l=16,c="S",u=null;fn(s=s||{})==="object"&&(t=s.orientation,n=s.unit||n,r=s.format||r,i=s.compress||s.compressPdf||i,(u=s.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof s.userUnit=="number"?Math.abs(s.userUnit):1,s.precision!==void 0&&(e=s.precision),s.floatPrecision!==void 0&&(l=s.floatPrecision),c=s.defaultPathOperation||"S"),a=s.filters||(i===!0?["FlateEncode"]:a),n=n||"mm",t=(""+(t||"P")).toLowerCase();var f=s.putOnlyUsedFonts||!1,p={},m={internal:{},__private__:{}};m.__private__.PubSub=EE;var b="1.3",y=m.__private__.getPdfVersion=function(){return b};m.__private__.setPdfVersion=function(x){b=x};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return S};var w=m.__private__.getPageFormat=function(x){return S[x]};r=r||"a4";var _={COMPAT:"compat",ADVANCED:"advanced"},k=_.COMPAT;function C(){this.saveGraphicsState(),ee(new lt(qe,0,0,-qe,0,Pc()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),c="n",k=_.ADVANCED}function B(){this.restoreGraphicsState(),c="S",k=_.COMPAT}var F=m.__private__.combineFontStyleAndFontWeight=function(x,M){if(x=="bold"&&M=="normal"||x=="bold"&&M==400||x=="normal"&&M=="italic"||x=="bold"&&M=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return M&&(x=M==400||M==="normal"?x==="italic"?"italic":"normal":M!=700&&M!=="bold"||x!=="normal"?(M==700?"bold":M)+""+x:"bold"),x};m.advancedAPI=function(x){var M=k===_.COMPAT;return M&&C.call(this),typeof x!="function"||(x(this),M&&B.call(this)),this},m.compatAPI=function(x){var M=k===_.ADVANCED;return M&&B.call(this),typeof x!="function"||(x(this),M&&C.call(this)),this},m.isAdvancedAPI=function(){return k===_.ADVANCED};var j,T=function(x){if(k!==_.ADVANCED)throw new Error(x+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=m.roundToPrecision=m.__private__.roundToPrecision=function(x,M){var J=e||M;if(isNaN(x)||isNaN(J))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return x.toFixed(J).replace(/0+$/,"")};j=m.hpf=m.__private__.hpf=typeof l=="number"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return W(x,l)}:l==="smart"?function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return W(x,x>-1&&x<1?16:5)}:function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.hpf");return W(x,16)};var Y=m.f2=m.__private__.f2=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f2");return W(x,2)},I=m.__private__.f3=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.f3");return W(x,3)},O=m.scale=m.__private__.scale=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.scale");return k===_.COMPAT?x*qe:k===_.ADVANCED?x:void 0},X=function(x){return k===_.COMPAT?Pc()-x:k===_.ADVANCED?x:void 0},K=function(x){return O(X(x))};m.__private__.setPrecision=m.setPrecision=function(x){typeof parseInt(x,10)=="number"&&(e=parseInt(x,10))};var ne,te="00000000000000000000000000000000",ue=m.__private__.getFileId=function(){return te},Z=m.__private__.setFileId=function(x){return te=x!==void 0&&/^[a-fA-F0-9]{32}$/.test(x)?x.toUpperCase():te.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Ss=new ap(u.userPermissions,u.userPassword,u.ownerPassword,te)),te};m.setFileId=function(x){return Z(x),this},m.getFileId=function(){return ue()};var he=m.__private__.convertDateToPDFDate=function(x){var M=x.getTimezoneOffset(),J=M<0?"+":"-",ie=Math.floor(Math.abs(M/60)),ge=Math.abs(M%60),ke=[J,Q(ie),"'",Q(ge),"'"].join("");return["D:",x.getFullYear(),Q(x.getMonth()+1),Q(x.getDate()),Q(x.getHours()),Q(x.getMinutes()),Q(x.getSeconds()),ke].join("")},me=m.__private__.convertPDFDateToDate=function(x){var M=parseInt(x.substr(2,4),10),J=parseInt(x.substr(6,2),10)-1,ie=parseInt(x.substr(8,2),10),ge=parseInt(x.substr(10,2),10),ke=parseInt(x.substr(12,2),10),Ie=parseInt(x.substr(14,2),10);return new Date(M,J,ie,ge,ke,Ie,0)},Ne=m.__private__.setCreationDate=function(x){var M;if(x===void 0&&(x=new Date),x instanceof Date)M=he(x);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(x))throw new Error("Invalid argument passed to jsPDF.setCreationDate");M=x}return ne=M},L=m.__private__.getCreationDate=function(x){var M=ne;return x==="jsDate"&&(M=me(ne)),M};m.setCreationDate=function(x){return Ne(x),this},m.getCreationDate=function(x){return L(x)};var V,Q=m.__private__.padd2=function(x){return("0"+parseInt(x)).slice(-2)},se=m.__private__.padd2Hex=function(x){return("00"+(x=x.toString())).substr(x.length)},re=0,de=[],le=[],we=0,Le=[],je=[],Fe=!1,Be=le,at=function(){re=0,we=0,le=[],de=[],Le=[],Oa=On(),Mr=On()};m.__private__.setCustomOutputDestination=function(x){Fe=!0,Be=x};var Se=function(x){Fe||(Be=x)};m.__private__.resetCustomOutputDestination=function(){Fe=!1,Be=le};var ee=m.__private__.out=function(x){return x=x.toString(),we+=x.length+1,Be.push(x),Be},St=m.__private__.write=function(x){return ee(arguments.length===1?x.toString():Array.prototype.join.call(arguments," "))},nt=m.__private__.getArrayBuffer=function(x){for(var M=x.length,J=new ArrayBuffer(M),ie=new Uint8Array(J);M--;)ie[M]=x.charCodeAt(M);return J},Re=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return Re};var $e=s.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(x){return $e=k===_.ADVANCED?x/qe:x,this};var ze,De=m.__private__.getFontSize=m.getFontSize=function(){return k===_.COMPAT?$e:$e*qe},Ke=s.R2L||!1;m.__private__.setR2L=m.setR2L=function(x){return Ke=x,this},m.__private__.getR2L=m.getR2L=function(){return Ke};var kt,_t=m.__private__.setZoomMode=function(x){var M=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(x))ze=x;else if(isNaN(x)){if(M.indexOf(x)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+x+'" is not recognized.');ze=x}else ze=parseInt(x,10)};m.__private__.getZoomMode=function(){return ze};var Tt,Vt=m.__private__.setPageMode=function(x){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(x)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+x+'" is not recognized.');kt=x};m.__private__.getPageMode=function(){return kt};var Mt=m.__private__.setLayoutMode=function(x){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(x)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+x+'" is not recognized.');Tt=x};m.__private__.getLayoutMode=function(){return Tt},m.__private__.setDisplayMode=m.setDisplayMode=function(x,M,J){return _t(x),Mt(M),Vt(J),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(x){if(Object.keys(pt).indexOf(x)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[x]},m.__private__.getDocumentProperties=function(){return pt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(x){for(var M in pt)pt.hasOwnProperty(M)&&x[M]&&(pt[M]=x[M]);return this},m.__private__.setDocumentProperty=function(x,M){if(Object.keys(pt).indexOf(x)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[x]=M};var Ft,qe,Zt,Bt,Zr,on={},bn={},ki=[],Kt={},So={},Pn={},ei={},ra=null,Ln=0,mt=[],Ht=new EE(m),ia=s.hotfixes||[],Qn={},aa={},ti=[],lt=function x(M,J,ie,ge,ke,Ie){if(!(this instanceof x))return new x(M,J,ie,ge,ke,Ie);isNaN(M)&&(M=1),isNaN(J)&&(J=0),isNaN(ie)&&(ie=0),isNaN(ge)&&(ge=1),isNaN(ke)&&(ke=0),isNaN(Ie)&&(Ie=0),this._matrix=[M,J,ie,ge,ke,Ie]};Object.defineProperty(lt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(lt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(lt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(lt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(lt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(lt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(lt.prototype,"a",{get:function(){return this._matrix[0]},set:function(x){this._matrix[0]=x}}),Object.defineProperty(lt.prototype,"b",{get:function(){return this._matrix[1]},set:function(x){this._matrix[1]=x}}),Object.defineProperty(lt.prototype,"c",{get:function(){return this._matrix[2]},set:function(x){this._matrix[2]=x}}),Object.defineProperty(lt.prototype,"d",{get:function(){return this._matrix[3]},set:function(x){this._matrix[3]=x}}),Object.defineProperty(lt.prototype,"e",{get:function(){return this._matrix[4]},set:function(x){this._matrix[4]=x}}),Object.defineProperty(lt.prototype,"f",{get:function(){return this._matrix[5]},set:function(x){this._matrix[5]=x}}),Object.defineProperty(lt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(lt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(lt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(lt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),lt.prototype.join=function(x){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(x)},lt.prototype.multiply=function(x){var M=x.sx*this.sx+x.shy*this.shx,J=x.sx*this.shy+x.shy*this.sy,ie=x.shx*this.sx+x.sy*this.shx,ge=x.shx*this.shy+x.sy*this.sy,ke=x.tx*this.sx+x.ty*this.shx+this.tx,Ie=x.tx*this.shy+x.ty*this.sy+this.ty;return new lt(M,J,ie,ge,ke,Ie)},lt.prototype.decompose=function(){var x=this.sx,M=this.shy,J=this.shx,ie=this.sy,ge=this.tx,ke=this.ty,Ie=Math.sqrt(x*x+M*M),Ge=(x/=Ie)*J+(M/=Ie)*ie;J-=x*Ge,ie-=M*Ge;var ut=Math.sqrt(J*J+ie*ie);return Ge/=ut,x*(ie/=ut)<M*(J/=ut)&&(x=-x,M=-M,Ge=-Ge,Ie=-Ie),{scale:new lt(Ie,0,0,ut,0,0),translate:new lt(1,0,0,1,ge,ke),rotate:new lt(x,M,-M,x,0,0),skew:new lt(1,0,Ge,1,0,0)}},lt.prototype.toString=function(x){return this.join(" ")},lt.prototype.inversed=function(){var x=this.sx,M=this.shy,J=this.shx,ie=this.sy,ge=this.tx,ke=this.ty,Ie=1/(x*ie-M*J),Ge=ie*Ie,ut=-M*Ie,Lt=-J*Ie,Nt=x*Ie;return new lt(Ge,ut,Lt,Nt,-Ge*ge-Lt*ke,-ut*ge-Nt*ke)},lt.prototype.applyToPoint=function(x){var M=x.x*this.sx+x.y*this.shx+this.tx,J=x.x*this.shy+x.y*this.sy+this.ty;return new bf(M,J)},lt.prototype.applyToRectangle=function(x){var M=this.applyToPoint(x),J=this.applyToPoint(new bf(x.x+x.w,x.y+x.h));return new vg(M.x,M.y,J.x-M.x,J.y-M.y)},lt.prototype.clone=function(){var x=this.sx,M=this.shy,J=this.shx,ie=this.sy,ge=this.tx,ke=this.ty;return new lt(x,M,J,ie,ge,ke)},m.Matrix=lt;var Qs=m.matrixMult=function(x,M){return M.multiply(x)},ni=new lt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=ni;var Fs=function(x,M){if(!So[x]){var J=(M instanceof jd?"Sh":"P")+(Object.keys(Kt).length+1).toString(10);M.id=J,So[x]=J,Kt[J]=M,Ht.publish("addPattern",M)}};m.ShadingPattern=jd,m.TilingPattern=xp,m.addShadingPattern=function(x,M){return T("addShadingPattern()"),Fs(x,M),this},m.beginTilingPattern=function(x){T("beginTilingPattern()"),ay(x.boundingBox[0],x.boundingBox[1],x.boundingBox[2]-x.boundingBox[0],x.boundingBox[3]-x.boundingBox[1],x.matrix)},m.endTilingPattern=function(x,M){T("endTilingPattern()"),M.stream=je[V].join(`
`),Fs(x,M),Ht.publish("endTilingPattern",M),ti.pop().restore()};var $n=m.__private__.newObject=function(){var x=On();return Rr(x,!0),x},On=m.__private__.newObjectDeferred=function(){return re++,de[re]=function(){return we},re},Rr=function(x,M){return M=typeof M=="boolean"&&M,de[x]=we,M&&ee(x+" 0 obj"),x},Or=m.__private__.newAdditionalObject=function(){var x={objId:On(),content:""};return Le.push(x),x},Oa=On(),Mr=On(),Un=m.__private__.decodeColorString=function(x){var M=x.split(" ");if(M.length!==2||M[1]!=="g"&&M[1]!=="G")M.length===5&&(M[4]==="k"||M[4]==="K")&&(M=[(1-M[0])*(1-M[3]),(1-M[1])*(1-M[3]),(1-M[2])*(1-M[3]),"r"]);else{var J=parseFloat(M[0]);M=[J,J,J,"r"]}for(var ie="#",ge=0;ge<3;ge++)ie+=("0"+Math.floor(255*parseFloat(M[ge])).toString(16)).slice(-2);return ie},ps=m.__private__.encodeColorString=function(x){var M;typeof x=="string"&&(x={ch1:x});var J=x.ch1,ie=x.ch2,ge=x.ch3,ke=x.ch4,Ie=x.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof J=="string"&&J.charAt(0)!=="#"){var Ge=new QI(J);if(Ge.ok)J=Ge.toHex();else if(!/^\d*\.?\d*$/.test(J))throw new Error('Invalid color "'+J+'" passed to jsPDF.encodeColorString.')}if(typeof J=="string"&&/^#[0-9A-Fa-f]{3}$/.test(J)&&(J="#"+J[1]+J[1]+J[2]+J[2]+J[3]+J[3]),typeof J=="string"&&/^#[0-9A-Fa-f]{6}$/.test(J)){var ut=parseInt(J.substr(1),16);J=ut>>16&255,ie=ut>>8&255,ge=255&ut}if(ie===void 0||ke===void 0&&J===ie&&ie===ge)if(typeof J=="string")M=J+" "+Ie[0];else switch(x.precision){case 2:M=Y(J/255)+" "+Ie[0];break;case 3:default:M=I(J/255)+" "+Ie[0]}else if(ke===void 0||fn(ke)==="object"){if(ke&&!isNaN(ke.a)&&ke.a===0)return M=["1.","1.","1.",Ie[1]].join(" ");if(typeof J=="string")M=[J,ie,ge,Ie[1]].join(" ");else switch(x.precision){case 2:M=[Y(J/255),Y(ie/255),Y(ge/255),Ie[1]].join(" ");break;default:case 3:M=[I(J/255),I(ie/255),I(ge/255),Ie[1]].join(" ")}}else if(typeof J=="string")M=[J,ie,ge,ke,Ie[2]].join(" ");else switch(x.precision){case 2:M=[Y(J),Y(ie),Y(ge),Y(ke),Ie[2]].join(" ");break;case 3:default:M=[I(J),I(ie),I(ge),I(ke),Ie[2]].join(" ")}return M},oa=m.__private__.getFilters=function(){return a},Zs=m.__private__.putStream=function(x){var M=(x=x||{}).data||"",J=x.filters||oa(),ie=x.alreadyAppliedFilters||[],ge=x.addLength1||!1,ke=M.length,Ie=x.objectId,Ge=function(pr){return pr};if(u!==null&&Ie===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Ge=Ss.encryptor(Ie,0));var ut={};J===!0&&(J=["FlateEncode"]);var Lt=x.additionalKeyValues||[],Nt=(ut=yt.API.processDataByFilters!==void 0?yt.API.processDataByFilters(M,J):{data:M,reverseChain:[]}).reverseChain+(Array.isArray(ie)?ie.join(" "):ie.toString());if(ut.data.length!==0&&(Lt.push({key:"Length",value:ut.data.length}),ge===!0&&Lt.push({key:"Length1",value:ke})),Nt.length!=0)if(Nt.split("/").length-1==1)Lt.push({key:"Filter",value:Nt});else{Lt.push({key:"Filter",value:"["+Nt+"]"});for(var Xt=0;Xt<Lt.length;Xt+=1)if(Lt[Xt].key==="DecodeParms"){for(var qn=[],Zn=0;Zn<ut.reverseChain.split("/").length-1;Zn+=1)qn.push("null");qn.push(Lt[Xt].value),Lt[Xt].value="["+qn.join(" ")+"]"}}ee("<<");for(var ms=0;ms<Lt.length;ms++)ee("/"+Lt[ms].key+" "+Lt[ms].value);ee(">>"),ut.data.length!==0&&(ee("stream"),ee(Ge(ut.data)),ee("endstream"))},la=m.__private__.putPage=function(x){var M=x.number,J=x.data,ie=x.objId,ge=x.contentsObjId;Rr(ie,!0),ee("<</Type /Page"),ee("/Parent "+x.rootDictionaryObjId+" 0 R"),ee("/Resources "+x.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(j(x.mediaBox.bottomLeftX))+" "+parseFloat(j(x.mediaBox.bottomLeftY))+" "+j(x.mediaBox.topRightX)+" "+j(x.mediaBox.topRightY)+"]"),x.cropBox!==null&&ee("/CropBox ["+j(x.cropBox.bottomLeftX)+" "+j(x.cropBox.bottomLeftY)+" "+j(x.cropBox.topRightX)+" "+j(x.cropBox.topRightY)+"]"),x.bleedBox!==null&&ee("/BleedBox ["+j(x.bleedBox.bottomLeftX)+" "+j(x.bleedBox.bottomLeftY)+" "+j(x.bleedBox.topRightX)+" "+j(x.bleedBox.topRightY)+"]"),x.trimBox!==null&&ee("/TrimBox ["+j(x.trimBox.bottomLeftX)+" "+j(x.trimBox.bottomLeftY)+" "+j(x.trimBox.topRightX)+" "+j(x.trimBox.topRightY)+"]"),x.artBox!==null&&ee("/ArtBox ["+j(x.artBox.bottomLeftX)+" "+j(x.artBox.bottomLeftY)+" "+j(x.artBox.topRightX)+" "+j(x.artBox.topRightY)+"]"),typeof x.userUnit=="number"&&x.userUnit!==1&&ee("/UserUnit "+x.userUnit),Ht.publish("putPage",{objId:ie,pageContext:mt[M],pageNumber:M,page:J}),ee("/Contents "+ge+" 0 R"),ee(">>"),ee("endobj");var ke=J.join(`
`);return k===_.ADVANCED&&(ke+=`
Q`),Rr(ge,!0),Zs({data:ke,filters:oa(),objectId:ge}),ee("endobj"),ie},si=m.__private__.putPages=function(){var x,M,J=[];for(x=1;x<=Ln;x++)mt[x].objId=On(),mt[x].contentsObjId=On();for(x=1;x<=Ln;x++)J.push(la({number:x,data:je[x],objId:mt[x].objId,contentsObjId:mt[x].contentsObjId,mediaBox:mt[x].mediaBox,cropBox:mt[x].cropBox,bleedBox:mt[x].bleedBox,trimBox:mt[x].trimBox,artBox:mt[x].artBox,userUnit:mt[x].userUnit,rootDictionaryObjId:Oa,resourceDictionaryObjId:Mr}));Rr(Oa,!0),ee("<</Type /Pages");var ie="/Kids [";for(M=0;M<Ln;M++)ie+=J[M]+" 0 R ";ee(ie+"]"),ee("/Count "+Ln),ee(">>"),ee("endobj"),Ht.publish("postPutPages")},ml=function(x){Ht.publish("putFont",{font:x,out:ee,newObject:$n,putStream:Zs}),x.isAlreadyPutted!==!0&&(x.objectNumber=$n(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+op(x.postScriptName)),ee("/Subtype /Type1"),typeof x.encoding=="string"&&ee("/Encoding /"+x.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},Ma=function(){for(var x in on)on.hasOwnProperty(x)&&(f===!1||f===!0&&p.hasOwnProperty(x))&&ml(on[x])},ko=function(x){x.objectNumber=$n();var M=[];M.push({key:"Type",value:"/XObject"}),M.push({key:"Subtype",value:"/Form"}),M.push({key:"BBox",value:"["+[j(x.x),j(x.y),j(x.x+x.width),j(x.y+x.height)].join(" ")+"]"}),M.push({key:"Matrix",value:"["+x.matrix.toString()+"]"});var J=x.pages[1].join(`
`);Zs({data:J,additionalKeyValues:M,objectId:x.objectNumber}),ee("endobj")},gl=function(){for(var x in Qn)Qn.hasOwnProperty(x)&&ko(Qn[x])},ad=function(x,M){var J,ie=[],ge=1/(M-1);for(J=0;J<1;J+=ge)ie.push(J);if(ie.push(1),x[0].offset!=0){var ke={offset:0,color:x[0].color};x.unshift(ke)}if(x[x.length-1].offset!=1){var Ie={offset:1,color:x[x.length-1].color};x.push(Ie)}for(var Ge="",ut=0,Lt=0;Lt<ie.length;Lt++){for(J=ie[Lt];J>x[ut+1].offset;)ut++;var Nt=x[ut].offset,Xt=(J-Nt)/(x[ut+1].offset-Nt),qn=x[ut].color,Zn=x[ut+1].color;Ge+=se(Math.round((1-Xt)*qn[0]+Xt*Zn[0]).toString(16))+se(Math.round((1-Xt)*qn[1]+Xt*Zn[1]).toString(16))+se(Math.round((1-Xt)*qn[2]+Xt*Zn[2]).toString(16))}return Ge.trim()},og=function(x,M){M||(M=21);var J=$n(),ie=ad(x.colors,M),ge=[];ge.push({key:"FunctionType",value:"0"}),ge.push({key:"Domain",value:"[0.0 1.0]"}),ge.push({key:"Size",value:"["+M+"]"}),ge.push({key:"BitsPerSample",value:"8"}),ge.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ge.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Zs({data:ie,additionalKeyValues:ge,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:J}),ee("endobj"),x.objectNumber=$n(),ee("<< /ShadingType "+x.type),ee("/ColorSpace /DeviceRGB");var ke="/Coords ["+j(parseFloat(x.coords[0]))+" "+j(parseFloat(x.coords[1]))+" ";x.type===2?ke+=j(parseFloat(x.coords[2]))+" "+j(parseFloat(x.coords[3])):ke+=j(parseFloat(x.coords[2]))+" "+j(parseFloat(x.coords[3]))+" "+j(parseFloat(x.coords[4]))+" "+j(parseFloat(x.coords[5])),ee(ke+="]"),x.matrix&&ee("/Matrix ["+x.matrix.toString()+"]"),ee("/Function "+J+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},No=function(x,M){var J=On(),ie=$n();M.push({resourcesOid:J,objectOid:ie}),x.objectNumber=ie;var ge=[];ge.push({key:"Type",value:"/Pattern"}),ge.push({key:"PatternType",value:"1"}),ge.push({key:"PaintType",value:"1"}),ge.push({key:"TilingType",value:"1"}),ge.push({key:"BBox",value:"["+x.boundingBox.map(j).join(" ")+"]"}),ge.push({key:"XStep",value:j(x.xStep)}),ge.push({key:"YStep",value:j(x.yStep)}),ge.push({key:"Resources",value:J+" 0 R"}),x.matrix&&ge.push({key:"Matrix",value:"["+x.matrix.toString()+"]"}),Zs({data:x.stream,additionalKeyValues:ge,objectId:x.objectNumber}),ee("endobj")},wc=function(x){var M;for(M in Kt)Kt.hasOwnProperty(M)&&(Kt[M]instanceof jd?og(Kt[M]):Kt[M]instanceof xp&&No(Kt[M],x))},od=function(x){for(var M in x.objectNumber=$n(),ee("<<"),x)switch(M){case"opacity":ee("/ca "+Y(x[M]));break;case"stroke-opacity":ee("/CA "+Y(x[M]))}ee(">>"),ee("endobj")},uf=function(){var x;for(x in Pn)Pn.hasOwnProperty(x)&&od(Pn[x])},Co=function(){for(var x in ee("/XObject <<"),Qn)Qn.hasOwnProperty(x)&&Qn[x].objectNumber>=0&&ee("/"+x+" "+Qn[x].objectNumber+" 0 R");Ht.publish("putXobjectDict"),ee(">>")},lg=function(){Ss.oid=$n(),ee("<<"),ee("/Filter /Standard"),ee("/V "+Ss.v),ee("/R "+Ss.r),ee("/U <"+Ss.toHexString(Ss.U)+">"),ee("/O <"+Ss.toHexString(Ss.O)+">"),ee("/P "+Ss.P),ee(">>"),ee("endobj")},df=function(){for(var x in ee("/Font <<"),on)on.hasOwnProperty(x)&&(f===!1||f===!0&&p.hasOwnProperty(x))&&ee("/"+x+" "+on[x].objectNumber+" 0 R");ee(">>")},cg=function(){if(Object.keys(Kt).length>0){for(var x in ee("/Shading <<"),Kt)Kt.hasOwnProperty(x)&&Kt[x]instanceof jd&&Kt[x].objectNumber>=0&&ee("/"+x+" "+Kt[x].objectNumber+" 0 R");Ht.publish("putShadingPatternDict"),ee(">>")}},xc=function(x){if(Object.keys(Kt).length>0){for(var M in ee("/Pattern <<"),Kt)Kt.hasOwnProperty(M)&&Kt[M]instanceof m.TilingPattern&&Kt[M].objectNumber>=0&&Kt[M].objectNumber<x&&ee("/"+M+" "+Kt[M].objectNumber+" 0 R");Ht.publish("putTilingPatternDict"),ee(">>")}},ug=function(){if(Object.keys(Pn).length>0){var x;for(x in ee("/ExtGState <<"),Pn)Pn.hasOwnProperty(x)&&Pn[x].objectNumber>=0&&ee("/"+x+" "+Pn[x].objectNumber+" 0 R");Ht.publish("putGStateDict"),ee(">>")}},zn=function(x){Rr(x.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),df(),cg(),xc(x.objectOid),ug(),Co(),ee(">>"),ee("endobj")},hf=function(){var x=[];Ma(),uf(),gl(),wc(x),Ht.publish("putResources"),x.forEach(zn),zn({resourcesOid:Mr,objectOid:Number.MAX_SAFE_INTEGER}),Ht.publish("postPutResources")},ld=function(){Ht.publish("putAdditionalObjects");for(var x=0;x<Le.length;x++){var M=Le[x];Rr(M.objId,!0),ee(M.content),ee("endobj")}Ht.publish("postPutAdditionalObjects")},cd=function(x){bn[x.fontName]=bn[x.fontName]||{},bn[x.fontName][x.fontStyle]=x.id},ud=function(x,M,J,ie,ge){var ke={id:"F"+(Object.keys(on).length+1).toString(10),postScriptName:x,fontName:M,fontStyle:J,encoding:ie,isStandardFont:ge||!1,metadata:{}};return Ht.publish("addFont",{font:ke,instance:this}),on[ke.id]=ke,cd(ke),ke.id},dg=function(x){for(var M=0,J=Re.length;M<J;M++){var ie=ud.call(this,x[M][0],x[M][1],x[M][2],Re[M][3],!0);f===!1&&(p[ie]=!0);var ge=x[M][0].split("-");cd({id:ie,fontName:ge[0],fontStyle:ge[1]||""})}Ht.publish("addFonts",{fonts:on,dictionary:bn})},Ni=function(x){return x.foo=function(){try{return x.apply(this,arguments)}catch(ie){var M=ie.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var J="Error in function "+M.split(`
`)[0].split("<")[0]+": "+ie.message;if(!bt.console)throw new Error(J);bt.console.error(J,ie),bt.alert&&alert(J)}},x.foo.bar=x,x.foo},_c=function(x,M){var J,ie,ge,ke,Ie,Ge,ut,Lt,Nt;if(ge=(M=M||{}).sourceEncoding||"Unicode",Ie=M.outputEncoding,(M.autoencode||Ie)&&on[Ft].metadata&&on[Ft].metadata[ge]&&on[Ft].metadata[ge].encoding&&(ke=on[Ft].metadata[ge].encoding,!Ie&&on[Ft].encoding&&(Ie=on[Ft].encoding),!Ie&&ke.codePages&&(Ie=ke.codePages[0]),typeof Ie=="string"&&(Ie=ke[Ie]),Ie)){for(ut=!1,Ge=[],J=0,ie=x.length;J<ie;J++)(Lt=Ie[x.charCodeAt(J)])?Ge.push(String.fromCharCode(Lt)):Ge.push(x[J]),Ge[J].charCodeAt(0)>>8&&(ut=!0);x=Ge.join("")}for(J=x.length;ut===void 0&&J!==0;)x.charCodeAt(J-1)>>8&&(ut=!0),J--;if(!ut)return x;for(Ge=M.noBOM?[]:[254,255],J=0,ie=x.length;J<ie;J++){if((Nt=(Lt=x.charCodeAt(J))>>8)>>8)throw new Error("Character at position "+J+" of string '"+x+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ge.push(Nt),Ge.push(Lt-(Nt<<8))}return String.fromCharCode.apply(void 0,Ge)},fr=m.__private__.pdfEscape=m.pdfEscape=function(x,M){return _c(x,M).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},dd=m.__private__.beginPage=function(x){je[++Ln]=[],mt[Ln]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(x[0]),topRightY:Number(x[1])}},Ac(Ln),Se(je[V])},ff=function(x,M){var J,ie,ge;switch(t=M||t,typeof x=="string"&&(J=w(x.toLowerCase()),Array.isArray(J)&&(ie=J[0],ge=J[1])),Array.isArray(x)&&(ie=x[0]*qe,ge=x[1]*qe),isNaN(ie)&&(ie=r[0],ge=r[1]),(ie>14400||ge>14400)&&(_n.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ie=Math.min(14400,ie),ge=Math.min(14400,ge)),r=[ie,ge],t.substr(0,1)){case"l":ge>ie&&(r=[ge,ie]);break;case"p":ie>ge&&(r=[ge,ie])}dd(r),Cc(Nc),ee(Ba),mg!==0&&ee(mg+" J"),gg!==0&&ee(gg+" j"),Ht.publish("addPage",{pageNumber:Ln})},hg=function(x){x>0&&x<=Ln&&(je.splice(x,1),mt.splice(x,1),Ln--,V>Ln&&(V=Ln),this.setPage(V))},Ac=function(x){x>0&&x<=Ln&&(V=x)},pf=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return je.length-1},mf=function(x,M,J){var ie,ge=void 0;return J=J||{},x=x!==void 0?x:on[Ft].fontName,M=M!==void 0?M:on[Ft].fontStyle,ie=x.toLowerCase(),bn[ie]!==void 0&&bn[ie][M]!==void 0?ge=bn[ie][M]:bn[x]!==void 0&&bn[x][M]!==void 0?ge=bn[x][M]:J.disableWarning===!1&&_n.warn("Unable to look up font label for font '"+x+"', '"+M+"'. Refer to getFontList() for available fonts."),ge||J.noFallback||(ge=bn.times[M])==null&&(ge=bn.times.normal),ge},ty=m.__private__.putInfo=function(){var x=$n(),M=function(ie){return ie};for(var J in u!==null&&(M=Ss.encryptor(x,0)),ee("<<"),ee("/Producer ("+fr(M("jsPDF "+yt.version))+")"),pt)pt.hasOwnProperty(J)&&pt[J]&&ee("/"+J.substr(0,1).toUpperCase()+J.substr(1)+" ("+fr(M(pt[J]))+")");ee("/CreationDate ("+fr(M(ne))+")"),ee(">>"),ee("endobj")},gf=m.__private__.putCatalog=function(x){var M=(x=x||{}).rootDictionaryObjId||Oa;switch($n(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+M+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var J=""+ze;J.substr(J.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+Y(ze)+"]")}switch(Tt||(Tt="continuous"),Tt){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}kt&&ee("/PageMode /"+kt),Ht.publish("putCatalog"),ee(">>"),ee("endobj")},fg=m.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(re+1)),ee("/Root "+re+" 0 R"),ee("/Info "+(re-1)+" 0 R"),u!==null&&ee("/Encrypt "+Ss.oid+" 0 R"),ee("/ID [ <"+te+"> <"+te+"> ]"),ee(">>")},vf=m.__private__.putHeader=function(){ee("%PDF-"+b),ee("%ºß¬à")},Eo=m.__private__.putXRef=function(){var x="0000000000";ee("xref"),ee("0 "+(re+1)),ee("0000000000 65535 f ");for(var M=1;M<=re;M++)typeof de[M]=="function"?ee((x+de[M]()).slice(-10)+" 00000 n "):de[M]!==void 0?ee((x+de[M]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},ri=m.__private__.buildDocument=function(){at(),Se(le),Ht.publish("buildDocument"),vf(),si(),ld(),hf(),u!==null&&lg(),ty(),gf();var x=we;return Eo(),fg(),ee("startxref"),ee(""+x),ee("%%EOF"),Se(je[V]),le.join(`
`)},Sc=m.__private__.getBlob=function(x){return new Blob([nt(x)],{type:"application/pdf"})},kc=m.output=m.__private__.output=Ni(function(x,M){switch(typeof(M=M||{})=="string"?M={filename:M}:M.filename=M.filename||"generated.pdf",x){case void 0:return ri();case"save":m.save(M.filename);break;case"arraybuffer":return nt(ri());case"blob":return Sc(ri());case"bloburi":case"bloburl":if(bt.URL!==void 0&&typeof bt.URL.createObjectURL=="function")return bt.URL&&bt.URL.createObjectURL(Sc(ri()))||void 0;_n.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var J="",ie=ri();try{J=AS(ie)}catch{J=AS(unescape(encodeURIComponent(ie)))}return"data:application/pdf;filename="+M.filename+";base64,"+J;case"pdfobjectnewwindow":if(Object.prototype.toString.call(bt)==="[object Window]"){var ge="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ke=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';M.pdfObjectUrl&&(ge=M.pdfObjectUrl,ke="");var Ie='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+ge+'"'+ke+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(M)+");<\/script></body></html>",Ge=bt.open();return Ge!==null&&Ge.document.write(Ie),Ge}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(bt)==="[object Window]"){var ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(M.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+M.filename+'" width="500px" height="400px" /></body></html>',Lt=bt.open();if(Lt!==null){Lt.document.write(ut);var Nt=this;Lt.document.documentElement.querySelector("#pdfViewer").onload=function(){Lt.document.title=M.filename,Lt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Nt.output("bloburl"))}}return Lt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(bt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",M)+'"></iframe></body></html>',qn=bt.open();if(qn!==null&&(qn.document.write(Xt),qn.document.title=M.filename),qn||typeof safari>"u")return qn;break;case"datauri":case"dataurl":return bt.document.location.href=this.output("datauristring",M);default:return null}}),Ds=function(x){return Array.isArray(ia)===!0&&ia.indexOf(x)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=Ds("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var Ss=null;Ne(),Z();var Po=function(x){return u!==null?Ss.encryptor(x,0):function(M){return M}},Fa=m.__private__.getPageInfo=m.getPageInfo=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:mt[x].objId,pageNumber:x,pageContext:mt[x]}},P=m.__private__.getPageInfoByObjId=function(x){if(isNaN(x)||x%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var M in mt)if(mt[M].objId===x)break;return Fa(M)},fe=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:mt[V].objId,pageNumber:V,pageContext:mt[V]}};m.addPage=function(){return ff.apply(this,arguments),this},m.setPage=function(){return Ac.apply(this,arguments),Se.call(this,je[V]),this},m.insertPage=function(x){return this.addPage(),this.movePage(V,x),this},m.movePage=function(x,M){var J,ie;if(x>M){J=je[x],ie=mt[x];for(var ge=x;ge>M;ge--)je[ge]=je[ge-1],mt[ge]=mt[ge-1];je[M]=J,mt[M]=ie,this.setPage(M)}else if(x<M){J=je[x],ie=mt[x];for(var ke=x;ke<M;ke++)je[ke]=je[ke+1],mt[ke]=mt[ke+1];je[M]=J,mt[M]=ie,this.setPage(M)}return this},m.deletePage=function(){return hg.apply(this,arguments),this},m.__private__.text=m.text=function(x,M,J,ie,ge){var ke,Ie,Ge,ut,Lt,Nt,Xt,qn,Zn,ms=(ie=ie||{}).scope||this;if(typeof x=="number"&&typeof M=="number"&&(typeof J=="string"||Array.isArray(J))){var pr=J;J=M,M=x,x=pr}if(arguments[3]instanceof lt?(T("The transform parameter of text() with a Matrix value"),Zn=ge):(Ge=arguments[4],ut=arguments[5],fn(Xt=arguments[3])==="object"&&Xt!==null||(typeof Ge=="string"&&(ut=Ge,Ge=null),typeof Xt=="string"&&(ut=Xt,Xt=null),typeof Xt=="number"&&(Ge=Xt,Xt=null),ie={flags:Xt,angle:Ge,align:ut})),isNaN(M)||isNaN(J)||x==null)throw new Error("Invalid arguments passed to jsPDF.text");if(x.length===0)return ms;var Bs="",$a=!1,Ci=typeof ie.lineHeightFactor=="number"?ie.lineHeightFactor:ln,To=ms.internal.scaleFactor;function oy(Sn){return Sn=Sn.split("	").join(Array(ie.TabLen||9).join(" ")),fr(Sn,Xt)}function xg(Sn){for(var kn,as=Sn.concat(),ks=[],xl=as.length;xl--;)typeof(kn=as.shift())=="string"?ks.push(kn):Array.isArray(Sn)&&(kn.length===1||kn[1]===void 0&&kn[2]===void 0)?ks.push(kn[0]):ks.push([kn[0],kn[1],kn[2]]);return ks}function _g(Sn,kn){var as;if(typeof Sn=="string")as=kn(Sn)[0];else if(Array.isArray(Sn)){for(var ks,xl,Lg=Sn.concat(),Lf=[],hy=Lg.length;hy--;)typeof(ks=Lg.shift())=="string"?Lf.push(kn(ks)[0]):Array.isArray(ks)&&typeof ks[0]=="string"&&(xl=kn(ks[0],ks[1],ks[2]),Lf.push([xl[0],xl[1],xl[2]]));as=Lf}return as}var xf=!1,Ag=!0;if(typeof x=="string")xf=!0;else if(Array.isArray(x)){var Sg=x.concat();Ie=[];for(var _f,er=Sg.length;er--;)(typeof(_f=Sg.shift())!="string"||Array.isArray(_f)&&typeof _f[0]!="string")&&(Ag=!1);xf=Ag}if(xf===!1)throw new Error('Type of text must be string or Array. "'+x+'" is not recognized.');typeof x=="string"&&(x=x.match(/[\r?\n]/)?x.split(/\r\n|\r|\n/g):[x]);var Af=$e/ms.internal.scaleFactor,Sf=Af*(Ci-1);switch(ie.baseline){case"bottom":J-=Sf;break;case"top":J+=Af-Sf;break;case"hanging":J+=Af-2*Sf;break;case"middle":J+=Af/2-Sf}if((Nt=ie.maxWidth||0)>0&&(typeof x=="string"?x=ms.splitTextToSize(x,Nt):Object.prototype.toString.call(x)==="[object Array]"&&(x=x.reduce(function(Sn,kn){return Sn.concat(ms.splitTextToSize(kn,Nt))},[]))),ke={text:x,x:M,y:J,options:ie,mutex:{pdfEscape:fr,activeFontKey:Ft,fonts:on,activeFontSize:$e}},Ht.publish("preProcessText",ke),x=ke.text,Ge=(ie=ke.options).angle,!(Zn instanceof lt)&&Ge&&typeof Ge=="number"){Ge*=Math.PI/180,ie.rotationDirection===0&&(Ge=-Ge),k===_.ADVANCED&&(Ge=-Ge);var kf=Math.cos(Ge),kg=Math.sin(Ge);Zn=new lt(kf,kg,-kg,kf,0,0)}else Ge&&Ge instanceof lt&&(Zn=Ge);k!==_.ADVANCED||Zn||(Zn=ni),(Lt=ie.charSpace||yf)!==void 0&&(Bs+=j(O(Lt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(qn=ie.horizontalScale)!==void 0&&(Bs+=j(100*qn)+` Tz
`),ie.lang;var ii=-1,m5=ie.renderingMode!==void 0?ie.renderingMode:ie.stroke,Ng=ms.internal.getCurrentPageInfo().pageContext;switch(m5){case 0:case!1:case"fill":ii=0;break;case 1:case!0:case"stroke":ii=1;break;case 2:case"fillThenStroke":ii=2;break;case 3:case"invisible":ii=3;break;case 4:case"fillAndAddForClipping":ii=4;break;case 5:case"strokeAndAddPathForClipping":ii=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ii=6;break;case 7:case"addToPathForClipping":ii=7}var ly=Ng.usedRenderingMode!==void 0?Ng.usedRenderingMode:-1;ii!==-1?Bs+=ii+` Tr
`:ly!==-1&&(Bs+=`0 Tr
`),ii!==-1&&(Ng.usedRenderingMode=ii),ut=ie.align||"left";var ca,Nf=$e*Ci,cy=ms.internal.pageSize.getWidth(),uy=on[Ft];Lt=ie.charSpace||yf,Nt=ie.maxWidth||0,Xt=Object.assign({autoencode:!0,noBOM:!0},ie.flags);var Lc=[],pd=function(Sn){return ms.getStringUnitWidth(Sn,{font:uy,charSpace:Lt,fontSize:$e,doKerning:!1})*$e/To};if(Object.prototype.toString.call(x)==="[object Array]"){var ai;Ie=xg(x),ut!=="left"&&(ca=Ie.map(pd));var Fr,Tc=0;if(ut==="right"){M-=ca[0],x=[],er=Ie.length;for(var yl=0;yl<er;yl++)yl===0?(Fr=Lo(M),ai=vl(J)):(Fr=O(Tc-ca[yl]),ai=-Nf),x.push([Ie[yl],Fr,ai]),Tc=ca[yl]}else if(ut==="center"){M-=ca[0]/2,x=[],er=Ie.length;for(var bl=0;bl<er;bl++)bl===0?(Fr=Lo(M),ai=vl(J)):(Fr=O((Tc-ca[bl])/2),ai=-Nf),x.push([Ie[bl],Fr,ai]),Tc=ca[bl]}else if(ut==="left"){x=[],er=Ie.length;for(var Cf=0;Cf<er;Cf++)x.push(Ie[Cf])}else if(ut==="justify"&&uy.encoding==="Identity-H"){x=[],er=Ie.length,Nt=Nt!==0?Nt:cy;for(var wl=0,is=0;is<er;is++)if(ai=is===0?vl(J):-Nf,Fr=is===0?Lo(M):wl,is<er-1){var Cg=O((Nt-ca[is])/(Ie[is].split(" ").length-1)),Dr=Ie[is].split(" ");x.push([Dr[0]+" ",Fr,ai]),wl=0;for(var ua=1;ua<Dr.length;ua++){var Ef=(pd(Dr[ua-1]+" "+Dr[ua])-pd(Dr[ua]))*To+Cg;ua==Dr.length-1?x.push([Dr[ua],Ef,0]):x.push([Dr[ua]+" ",Ef,0]),wl-=Ef}}else x.push([Ie[is],Fr,ai]);x.push(["",wl,0])}else{if(ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(x=[],er=Ie.length,Nt=Nt!==0?Nt:cy,is=0;is<er;is++)ai=is===0?vl(J):-Nf,Fr=is===0?Lo(M):0,is<er-1?Lc.push(j(O((Nt-ca[is])/(Ie[is].split(" ").length-1)))):Lc.push(0),x.push([Ie[is],Fr,ai])}}var dy=typeof ie.R2L=="boolean"?ie.R2L:Ke;dy===!0&&(x=_g(x,function(Sn,kn,as){return[Sn.split("").reverse().join(""),kn,as]})),ke={text:x,x:M,y:J,options:ie,mutex:{pdfEscape:fr,activeFontKey:Ft,fonts:on,activeFontSize:$e}},Ht.publish("postProcessText",ke),x=ke.text,$a=ke.mutex.isHex||!1;var Eg=on[Ft].encoding;Eg!=="WinAnsiEncoding"&&Eg!=="StandardEncoding"||(x=_g(x,function(Sn,kn,as){return[oy(Sn),kn,as]})),Ie=xg(x),x=[];for(var md,gd,Ic,vd=0,Pf=1,yd=Array.isArray(Ie[0])?Pf:vd,jc="",Pg=function(Sn,kn,as){var ks="";return as instanceof lt?(as=typeof ie.angle=="number"?Qs(as,new lt(1,0,0,1,Sn,kn)):Qs(new lt(1,0,0,1,Sn,kn),as),k===_.ADVANCED&&(as=Qs(new lt(1,0,0,-1,0,0),as)),ks=as.join(" ")+` Tm
`):ks=j(Sn)+" "+j(kn)+` Td
`,ks},da=0;da<Ie.length;da++){switch(jc="",yd){case Pf:Ic=($a?"<":"(")+Ie[da][0]+($a?">":")"),md=parseFloat(Ie[da][1]),gd=parseFloat(Ie[da][2]);break;case vd:Ic=($a?"<":"(")+Ie[da]+($a?">":")"),md=Lo(M),gd=vl(J)}Lc!==void 0&&Lc[da]!==void 0&&(jc=Lc[da]+` Tw
`),da===0?x.push(jc+Pg(md,gd,Zn)+Ic):yd===vd?x.push(jc+Ic):yd===Pf&&x.push(jc+Pg(md,gd,Zn)+Ic)}x=yd===vd?x.join(` Tj
T* `):x.join(` Tj
`),x+=` Tj
`;var ha=`BT
/`;return ha+=Ft+" "+$e+` Tf
`,ha+=j($e*Ci)+` TL
`,ha+=hd+`
`,ha+=Bs,ha+=x,ee(ha+="ET"),p[Ft]=!0,ms};var ve=m.__private__.clip=m.clip=function(x){return ee(x==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return ve("evenodd")},m.__private__.discardPath=m.discardPath=function(){return ee("n"),this};var _e=m.__private__.isValidStyle=function(x){var M=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(x)!==-1&&(M=!0),M};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(x){return _e(x)&&(c=x),this};var Oe=m.__private__.getStyle=m.getStyle=function(x){var M=c;switch(x){case"D":case"S":M="S";break;case"F":M="f";break;case"FD":case"DF":M="B";break;case"f":case"f*":case"B":case"B*":M=x}return M},He=m.close=function(){return ee("h"),this};m.stroke=function(){return ee("S"),this},m.fill=function(x){return ct("f",x),this},m.fillEvenOdd=function(x){return ct("f*",x),this},m.fillStroke=function(x){return ct("B",x),this},m.fillStrokeEvenOdd=function(x){return ct("B*",x),this};var ct=function(x,M){fn(M)==="object"?st(M,x):ee(x)},dt=function(x){x===null||k===_.ADVANCED&&x===void 0||(x=Oe(x),ee(x))};function Je(x,M,J,ie,ge){var ke=new xp(M||this.boundingBox,J||this.xStep,ie||this.yStep,this.gState,ge||this.matrix);ke.stream=this.stream;var Ie=x+"$$"+this.cloneIndex+++"$$";return Fs(Ie,ke),ke}var st=function(x,M){var J=So[x.key],ie=Kt[J];if(ie instanceof jd)ee("q"),ee(wn(M)),ie.gState&&m.setGState(ie.gState),ee(x.matrix.toString()+" cm"),ee("/"+J+" sh"),ee("Q");else if(ie instanceof xp){var ge=new lt(1,0,0,-1,0,Pc());x.matrix&&(ge=ge.multiply(x.matrix||ni),J=Je.call(ie,x.key,x.boundingBox,x.xStep,x.yStep,ge).id),ee("q"),ee("/Pattern cs"),ee("/"+J+" scn"),ie.gState&&m.setGState(ie.gState),ee(M),ee("Q")}},wn=function(x){switch(x){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},nn=m.moveTo=function(x,M){return ee(j(O(x))+" "+j(K(M))+" m"),this},$t=m.lineTo=function(x,M){return ee(j(O(x))+" "+j(K(M))+" l"),this},en=m.curveTo=function(x,M,J,ie,ge,ke){return ee([j(O(x)),j(K(M)),j(O(J)),j(K(ie)),j(O(ge)),j(K(ke)),"c"].join(" ")),this};m.__private__.line=m.line=function(x,M,J,ie,ge){if(isNaN(x)||isNaN(M)||isNaN(J)||isNaN(ie)||!_e(ge))throw new Error("Invalid arguments passed to jsPDF.line");return k===_.COMPAT?this.lines([[J-x,ie-M]],x,M,[1,1],ge||"S"):this.lines([[J-x,ie-M]],x,M,[1,1]).stroke()},m.__private__.lines=m.lines=function(x,M,J,ie,ge,ke){var Ie,Ge,ut,Lt,Nt,Xt,qn,Zn,ms,pr,Bs,$a;if(typeof x=="number"&&($a=J,J=M,M=x,x=$a),ie=ie||[1,1],ke=ke||!1,isNaN(M)||isNaN(J)||!Array.isArray(x)||!Array.isArray(ie)||!_e(ge)||typeof ke!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(nn(M,J),Ie=ie[0],Ge=ie[1],Lt=x.length,pr=M,Bs=J,ut=0;ut<Lt;ut++)(Nt=x[ut]).length===2?(pr=Nt[0]*Ie+pr,Bs=Nt[1]*Ge+Bs,$t(pr,Bs)):(Xt=Nt[0]*Ie+pr,qn=Nt[1]*Ge+Bs,Zn=Nt[2]*Ie+pr,ms=Nt[3]*Ge+Bs,pr=Nt[4]*Ie+pr,Bs=Nt[5]*Ge+Bs,en(Xt,qn,Zn,ms,pr,Bs));return ke&&He(),dt(ge),this},m.path=function(x){for(var M=0;M<x.length;M++){var J=x[M],ie=J.c;switch(J.op){case"m":nn(ie[0],ie[1]);break;case"l":$t(ie[0],ie[1]);break;case"c":en.apply(this,ie);break;case"h":He()}}return this},m.__private__.rect=m.rect=function(x,M,J,ie,ge){if(isNaN(x)||isNaN(M)||isNaN(J)||isNaN(ie)||!_e(ge))throw new Error("Invalid arguments passed to jsPDF.rect");return k===_.COMPAT&&(ie=-ie),ee([j(O(x)),j(K(M)),j(O(J)),j(O(ie)),"re"].join(" ")),dt(ge),this},m.__private__.triangle=m.triangle=function(x,M,J,ie,ge,ke,Ie){if(isNaN(x)||isNaN(M)||isNaN(J)||isNaN(ie)||isNaN(ge)||isNaN(ke)||!_e(Ie))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[J-x,ie-M],[ge-J,ke-ie],[x-ge,M-ke]],x,M,[1,1],Ie,!0),this},m.__private__.roundedRect=m.roundedRect=function(x,M,J,ie,ge,ke,Ie){if(isNaN(x)||isNaN(M)||isNaN(J)||isNaN(ie)||isNaN(ge)||isNaN(ke)||!_e(Ie))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ge=4/3*(Math.SQRT2-1);return ge=Math.min(ge,.5*J),ke=Math.min(ke,.5*ie),this.lines([[J-2*ge,0],[ge*Ge,0,ge,ke-ke*Ge,ge,ke],[0,ie-2*ke],[0,ke*Ge,-ge*Ge,ke,-ge,ke],[2*ge-J,0],[-ge*Ge,0,-ge,-ke*Ge,-ge,-ke],[0,2*ke-ie],[0,-ke*Ge,ge*Ge,-ke,ge,-ke]],x+ge,M,[1,1],Ie,!0),this},m.__private__.ellipse=m.ellipse=function(x,M,J,ie,ge){if(isNaN(x)||isNaN(M)||isNaN(J)||isNaN(ie)||!_e(ge))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ke=4/3*(Math.SQRT2-1)*J,Ie=4/3*(Math.SQRT2-1)*ie;return nn(x+J,M),en(x+J,M-Ie,x+ke,M-ie,x,M-ie),en(x-ke,M-ie,x-J,M-Ie,x-J,M),en(x-J,M+Ie,x-ke,M+ie,x,M+ie),en(x+ke,M+ie,x+J,M+Ie,x+J,M),dt(ge),this},m.__private__.circle=m.circle=function(x,M,J,ie){if(isNaN(x)||isNaN(M)||isNaN(J)||!_e(ie))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(x,M,J,J,ie)},m.setFont=function(x,M,J){return J&&(M=F(M,J)),Ft=mf(x,M,{disableWarning:!1}),this};var rs=m.__private__.getFont=m.getFont=function(){return on[mf.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var x,M,J={};for(x in bn)if(bn.hasOwnProperty(x))for(M in J[x]=[],bn[x])bn[x].hasOwnProperty(M)&&J[x].push(M);return J},m.addFont=function(x,M,J,ie,ge){var ke=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ke.indexOf(arguments[3])!==-1?ge=arguments[3]:arguments[3]&&ke.indexOf(arguments[3])==-1&&(J=F(J,ie)),ge=ge||"Identity-H",ud.call(this,x,M,J,ge)};var ln,Nc=s.lineWidth||.200025,Da=m.__private__.getLineWidth=m.getLineWidth=function(){return Nc},Cc=m.__private__.setLineWidth=m.setLineWidth=function(x){return Nc=x,ee(j(O(x))+" w"),this};m.__private__.setLineDash=yt.API.setLineDash=yt.API.setLineDashPattern=function(x,M){if(x=x||[],M=M||0,isNaN(M)||!Array.isArray(x))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return x=x.map(function(J){return j(O(J))}).join(" "),M=j(O(M)),ee("["+x+"] "+M+" d"),this};var ny=m.__private__.getLineHeight=m.getLineHeight=function(){return $e*ln};m.__private__.getLineHeight=m.getLineHeight=function(){return $e*ln};var sy=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(x){return typeof(x=x||1.15)=="number"&&(ln=x),this},ry=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return ln};sy(s.lineHeight);var Lo=m.__private__.getHorizontalCoordinate=function(x){return O(x)},vl=m.__private__.getVerticalCoordinate=function(x){return k===_.ADVANCED?x:mt[V].mediaBox.topRightY-mt[V].mediaBox.bottomLeftY-O(x)},d5=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(x){return j(Lo(x))},Ec=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(x){return j(vl(x))},Ba=s.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Un(Ba)},m.__private__.setStrokeColor=m.setDrawColor=function(x,M,J,ie){return Ba=ps({ch1:x,ch2:M,ch3:J,ch4:ie,pdfColorType:"draw",precision:2}),ee(Ba),this};var pg=s.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Un(pg)},m.__private__.setFillColor=m.setFillColor=function(x,M,J,ie){return pg=ps({ch1:x,ch2:M,ch3:J,ch4:ie,pdfColorType:"fill",precision:2}),ee(pg),this};var hd=s.textColor||"0 g",h5=m.__private__.getTextColor=m.getTextColor=function(){return Un(hd)};m.__private__.setTextColor=m.setTextColor=function(x,M,J,ie){return hd=ps({ch1:x,ch2:M,ch3:J,ch4:ie,pdfColorType:"text",precision:3}),this};var yf=s.charSpace,f5=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(yf||0)};m.__private__.setCharSpace=m.setCharSpace=function(x){if(isNaN(x))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return yf=x,this};var mg=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(x){var M=m.CapJoinStyles[x];if(M===void 0)throw new Error("Line cap style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return mg=M,ee(M+" J"),this};var gg=0;m.__private__.setLineJoin=m.setLineJoin=function(x){var M=m.CapJoinStyles[x];if(M===void 0)throw new Error("Line join style of '"+x+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gg=M,ee(M+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(x){if(x=x||0,isNaN(x))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(j(O(x))+" M"),this},m.GState=Z2,m.setGState=function(x){(x=typeof x=="string"?Pn[ei[x]]:iy(null,x)).equals(ra)||(ee("/"+x.id+" gs"),ra=x)};var iy=function(x,M){if(!x||!ei[x]){var J=!1;for(var ie in Pn)if(Pn.hasOwnProperty(ie)&&Pn[ie].equals(M)){J=!0;break}if(J)M=Pn[ie];else{var ge="GS"+(Object.keys(Pn).length+1).toString(10);Pn[ge]=M,M.id=ge}return x&&(ei[x]=M.id),Ht.publish("addGState",M),M}};m.addGState=function(x,M){return iy(x,M),this},m.saveGraphicsState=function(){return ee("q"),ki.push({key:Ft,size:$e,color:hd}),this},m.restoreGraphicsState=function(){ee("Q");var x=ki.pop();return Ft=x.key,$e=x.size,hd=x.color,ra=null,this},m.setCurrentTransformationMatrix=function(x){return ee(x.toString()+" cm"),this},m.comment=function(x){return ee("#"+x),this};var bf=function(x,M){var J=x||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return J},set:function(ke){isNaN(ke)||(J=parseFloat(ke))}});var ie=M||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ie},set:function(ke){isNaN(ke)||(ie=parseFloat(ke))}});var ge="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return ge},set:function(ke){ge=ke.toString()}}),this},vg=function(x,M,J,ie){bf.call(this,x,M),this.type="rect";var ge=J||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return ge},set:function(Ie){isNaN(Ie)||(ge=parseFloat(Ie))}});var ke=ie||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ke},set:function(Ie){isNaN(Ie)||(ke=parseFloat(Ie))}}),this},yg=function(){this.page=Ln,this.currentPage=V,this.pages=je.slice(0),this.pagesContext=mt.slice(0),this.x=Zt,this.y=Bt,this.matrix=Zr,this.width=fd(V),this.height=Pc(V),this.outputDestination=Be,this.id="",this.objectNumber=-1};yg.prototype.restore=function(){Ln=this.page,V=this.currentPage,mt=this.pagesContext,je=this.pages,Zt=this.x,Bt=this.y,Zr=this.matrix,bg(V,this.width),wg(V,this.height),Be=this.outputDestination};var ay=function(x,M,J,ie,ge){ti.push(new yg),Ln=V=0,je=[],Zt=x,Bt=M,Zr=ge,dd([J,ie])},p5=function(x){if(aa[x])ti.pop().restore();else{var M=new yg,J="Xo"+(Object.keys(Qn).length+1).toString(10);M.id=J,aa[x]=J,Qn[J]=M,Ht.publish("addFormObject",M),ti.pop().restore()}};for(var wf in m.beginFormObject=function(x,M,J,ie,ge){return ay(x,M,J,ie,ge),this},m.endFormObject=function(x){return p5(x),this},m.doFormObject=function(x,M){var J=Qn[aa[x]];return ee("q"),ee(M.toString()+" cm"),ee("/"+J.id+" Do"),ee("Q"),this},m.getFormObject=function(x){var M=Qn[aa[x]];return{x:M.x,y:M.y,width:M.width,height:M.height,matrix:M.matrix}},m.save=function(x,M){return x=x||"generated.pdf",(M=M||{}).returnPromise=M.returnPromise||!1,M.returnPromise===!1?(Pd(Sc(ri()),x),typeof Pd.unload=="function"&&bt.setTimeout&&setTimeout(Pd.unload,911),this):new Promise(function(J,ie){try{var ge=Pd(Sc(ri()),x);typeof Pd.unload=="function"&&bt.setTimeout&&setTimeout(Pd.unload,911),J(ge)}catch(ke){ie(ke.message)}})},yt.API)yt.API.hasOwnProperty(wf)&&(wf==="events"&&yt.API.events.length?function(x,M){var J,ie,ge;for(ge=M.length-1;ge!==-1;ge--)J=M[ge][0],ie=M[ge][1],x.subscribe.apply(x,[J].concat(typeof ie=="function"?[ie]:ie))}(Ht,yt.API.events):m[wf]=yt.API[wf]);var fd=m.getPageWidth=function(x){return(mt[x=x||V].mediaBox.topRightX-mt[x].mediaBox.bottomLeftX)/qe},bg=m.setPageWidth=function(x,M){mt[x].mediaBox.topRightX=M*qe+mt[x].mediaBox.bottomLeftX},Pc=m.getPageHeight=function(x){return(mt[x=x||V].mediaBox.topRightY-mt[x].mediaBox.bottomLeftY)/qe},wg=m.setPageHeight=function(x,M){mt[x].mediaBox.topRightY=M*qe+mt[x].mediaBox.bottomLeftY};return m.internal={pdfEscape:fr,getStyle:Oe,getFont:rs,getFontSize:De,getCharSpace:f5,getTextColor:h5,getLineHeight:ny,getLineHeightFactor:ry,getLineWidth:Da,write:St,getHorizontalCoordinate:Lo,getVerticalCoordinate:vl,getCoordinateString:d5,getVerticalCoordinateString:Ec,collections:{},newObject:$n,newAdditionalObject:Or,newObjectDeferred:On,newObjectDeferredBegin:Rr,getFilters:oa,putStream:Zs,events:Ht,scaleFactor:qe,pageSize:{getWidth:function(){return fd(V)},setWidth:function(x){bg(V,x)},getHeight:function(){return Pc(V)},setHeight:function(x){wg(V,x)}},encryptionOptions:u,encryption:Ss,getEncryptor:Po,output:kc,getNumberOfPages:pf,pages:je,out:ee,f2:Y,f3:I,getPageInfo:Fa,getPageInfoByObjId:P,getCurrentPageInfo:fe,getPDFVersion:y,Point:bf,Rectangle:vg,Matrix:lt,hasHotfix:Ds},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return fd(V)},set:function(x){bg(V,x)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return Pc(V)},set:function(x){wg(V,x)},enumerable:!0,configurable:!0}),dg.call(m,Re),Ft="F1",ff(r,t),Ht.publish("initialized"),m}ap.prototype.lsbFirstWord=function(s){return String.fromCharCode(s>>0&255,s>>8&255,s>>16&255,s>>24&255)},ap.prototype.toHexString=function(s){return s.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},ap.prototype.hexToBytes=function(s){for(var e=[],t=0;t<s.length;t+=2)e.push(String.fromCharCode(parseInt(s.substr(t,2),16)));return e.join("")},ap.prototype.processOwnerPassword=function(s,e){return kS(SS(e).substr(0,5),s)},ap.prototype.encryptor=function(s,e){var t=SS(this.encryptionKey+String.fromCharCode(255&s,s>>8&255,s>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return kS(t,n)}},Z2.prototype.equals=function(s){var e,t="id,objectNumber,equals";if(!s||fn(s)!==fn(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!s.hasOwnProperty(e)||this[e]!==s[e])return!1;n++}for(e in s)s.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},yt.API={events:[]},yt.version="2.5.2";var ns=yt.API,_3=1,cf=function(s){return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Vf=function(s){return s.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ct=function(s){return s.toFixed(2)},Gc=function(s){return s.toFixed(5)};ns.__acroform__={};var Si=function(s,e){s.prototype=Object.create(e.prototype),s.prototype.constructor=s},PE=function(s){return s*_3},Bo=function(s){var e=new nj,t=tt.internal.getHeight(s)||0,n=tt.internal.getWidth(s)||0;return e.BBox=[0,0,Number(Ct(n)),Number(Ct(t))],e},$B=ns.__acroform__.setBit=function(s,e){if(s=s||0,e=e||0,isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return s|=1<<e},UB=ns.__acroform__.clearBit=function(s,e){if(s=s||0,e=e||0,isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return s&=~(1<<e)},zB=ns.__acroform__.getBit=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return s&1<<e?1:0},us=ns.__acroform__.getBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zB(s,e-1)},ds=ns.__acroform__.setBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return $B(s,e-1)},hs=ns.__acroform__.clearBitForPdf=function(s,e){if(isNaN(s)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return UB(s,e-1)},qB=ns.__acroform__.calculateCoordinates=function(s,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,r=s[0],i=s[1],a=s[2],o=s[3],l={};return l.lowerLeft_X=t(r)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=t(r+a)||0,l.upperRight_Y=n(i)||0,[Number(Ct(l.lowerLeft_X)),Number(Ct(l.lowerLeft_Y)),Number(Ct(l.upperRight_X)),Number(Ct(l.upperRight_Y))]},HB=function(s){if(s.appearanceStreamContent)return s.appearanceStreamContent;if(s.V||s.DV){var e=[],t=s._V||s.DV,n=NS(s,t),r=s.scope.internal.getFont(s.fontName,s.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(s.scope.__private__.encodeColorString(s.color)),e.push("/"+r+" "+Ct(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=Bo(s);return i.scope=s.scope,i.stream=e.join(`
`),i}},NS=function(s,e){var t=s.fontSize===0?s.maxFontSize:s.fontSize,n={text:"",fontSize:""},r=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");r=s.multiline?r.map(function(I){return I.split(`
`)}):r.map(function(I){return[I]});var i=t,a=tt.internal.getHeight(s)||0;a=a<0?-a:a;var o=tt.internal.getWidth(s)||0;o=o<0?-o:o;var l=function(I,O,X){if(I+1<r.length){var K=O+" "+r[I+1][0];return hb(K,s,X).width<=o-4}return!1};i++;e:for(;i>0;){e="",i--;var c,u,f=hb("3",s,i).height,p=s.multiline?a-i:(a-f)/2,m=p+=2,b=0,y=0,S=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+hb(e,s,i=12).width+", FieldWidth:"+o+`
`;break}for(var w="",_=0,k=0;k<r.length;k++)if(r.hasOwnProperty(k)){var C=!1;if(r[k].length!==1&&S!==r[k].length-1){if((f+2)*(_+2)+2>a)continue e;w+=r[k][S],C=!0,y=k,k--}else{w=(w+=r[k][S]+" ").substr(w.length-1)==" "?w.substr(0,w.length-1):w;var B=parseInt(k),F=l(B,w,i),j=k>=r.length-1;if(F&&!j){w+=" ",S=0;continue}if(F||j){if(j)y=B;else if(s.multiline&&(f+2)*(_+2)+2>a)continue e}else{if(!s.multiline||(f+2)*(_+2)+2>a)continue e;y=B}}for(var T="",W=b;W<=y;W++){var Y=r[W];if(s.multiline){if(W===y){T+=Y[S]+" ",S=(S+1)%Y.length;continue}if(W===b){T+=Y[Y.length-1]+" ";continue}}T+=Y[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,u=hb(T,s,i).width,s.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}e+=Ct(c)+" "+Ct(m)+` Td
`,e+="("+cf(T)+`) Tj
`,e+=-Ct(c)+` 0 Td
`,m=-(i+2),u=0,b=C?y:y+1,_++,w=""}break}return n.text=e,n.fontSize=i,n},hb=function(s,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),r=e.scope.getStringUnitWidth(s,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:r}},WB={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},VB=function(s,e){var t={type:"reference",object:s};e.internal.getPageInfo(s.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(s.page).pageContext.annotations.push(t)},GB=function(s,e){for(var t in s)if(s.hasOwnProperty(t)){var n=t,r=s[t];e.internal.newObjectDeferredBegin(r.objId,!0),fn(r)==="object"&&typeof r.putStream=="function"&&r.putStream(),delete s[n]}},XB=function(s,e){if(e.scope=s,s.internal!==void 0&&(s.internal.acroformPlugin===void 0||s.internal.acroformPlugin.isInitialized===!1)){if(_o.FieldNum=0,s.internal.acroformPlugin=JSON.parse(JSON.stringify(WB)),s.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");_3=s.internal.scaleFactor,s.internal.acroformPlugin.acroFormDictionaryRoot=new sj,s.internal.acroformPlugin.acroFormDictionaryRoot.scope=s,s.internal.acroformPlugin.acroFormDictionaryRoot._eventID=s.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(s)}),s.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];i.objId=void 0,i.hasAnnotation&&VB(i,t)}})(s)}),s.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(s)}),s.internal.events.subscribe("postPutPages",function(t){(function(n,r){var i=!n;for(var a in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(a)){var o=n[a],l=[],c=o.Rect;if(o.Rect&&(o.Rect=qB(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=tt.createDefaultAppearanceStream(o),fn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=HB(o);l.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var m=o.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var a in m)if(m.hasOwnProperty(a)){var b=m[a];typeof b=="function"&&(b=b.call(r,o)),f+="/"+a+" "+b+" ",r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b)}}else typeof(b=m)=="function"&&(b=b.call(r,o)),f+="/"+a+" "+b,r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}i&&GB(r.internal.acroformPlugin.xForms,r)})(t,s)}),s.internal.acroformPlugin.isInitialized=!0}},tj=ns.__acroform__.arrayToPdfArray=function(s,e,t){var n=function(a){return a};if(Array.isArray(s)){for(var r="[",i=0;i<s.length;i++)switch(i!==0&&(r+=" "),fn(s[i])){case"boolean":case"number":case"object":r+=s[i].toString();break;case"string":s[i].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),r+="("+cf(n(s[i].toString()))+")"):r+=s[i].toString()}return r+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Dx=function(s,e,t){var n=function(r){return r};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(s=s||"").toString(),s="("+cf(n(s))+")"},cl=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(s){this._objId=s}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};cl.prototype.toString=function(){return this.objId+" 0 R"},cl.prototype.putStream=function(){var s=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:s,objectId:this.objId}),this.scope.internal.out("endobj")},cl.prototype.getKeyValueListForStream=function(){var s=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],r=this[n];r&&(Array.isArray(r)?s.push({key:n,value:tj(r,this.objId,this.scope)}):r instanceof cl?(r.scope=this.scope,s.push({key:n,value:r.objId+" 0 R"})):typeof r!="function"&&s.push({key:n,value:r}))}return s};var nj=function(){cl.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var s,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){s=t.trim()},get:function(){return s||null}})};Si(nj,cl);var sj=function(){cl.call(this);var s,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(s){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+cf(t(s))+")"}},set:function(t){s=t}})};Si(sj,cl);var _o=function s(){cl.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute F supplied.');e=w}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!us(e,3)},set:function(w){w?this.F=ds(e,3):this.F=hs(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(w){if(isNaN(w))throw new Error('Invalid value "'+w+'" for attribute Ff supplied.');t=w}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(w){n=w!==void 0?w:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(w){n[0]=w}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(w){n[1]=w}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(w){n[2]=w}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(w){n[3]=w}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(w){switch(w){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=w;break;default:throw new Error('Invalid value "'+w+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof ew)return;i="FieldObject"+s.FieldNum++}var w=function(_){return _};return this.scope&&(w=this.scope.internal.getEncryptor(this.objId)),"("+cf(w(i))+")"},set:function(w){i=w.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(w){i=w}});var a="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return a},set:function(w){a=w}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(w){o=w}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(w){l=w}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/_3:c},set:function(w){c=w}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(w){u=w}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof ew||this instanceof Gh))return Dx(f,this.objId,this.scope)},set:function(w){w=w.toString(),f=w}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Ys?p:Dx(p,this.objId,this.scope)},set:function(w){w=w.toString(),p=this instanceof Ys?w:w.substr(0,1)==="("?Vf(w.substr(1,w.length-2)):Vf(w)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ys?Vf(p.substr(1,p.length-1)):p},set:function(w){w=w.toString(),p=this instanceof Ys?"/"+w:w}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(w){this.V=w}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Ys?m:Dx(m,this.objId,this.scope)},set:function(w){w=w.toString(),m=this instanceof Ys?w:w.substr(0,1)==="("?Vf(w.substr(1,w.length-2)):Vf(w)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Ys?Vf(m.substr(1,m.length-1)):m},set:function(w){w=w.toString(),m=this instanceof Ys?"/"+w:w}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(w){w=!!w,y=w}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(w){b=w}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,1)},set:function(w){w?this.Ff=ds(this.Ff,1):this.Ff=hs(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,2)},set:function(w){w?this.Ff=ds(this.Ff,2):this.Ff=hs(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,3)},set:function(w){w?this.Ff=ds(this.Ff,3):this.Ff=hs(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(w){if([0,1,2].indexOf(w)===-1)throw new Error('Invalid value "'+w+'" for attribute Q supplied.');S=w}}),Object.defineProperty(this,"textAlign",{get:function(){var w;switch(S){case 0:default:w="left";break;case 1:w="center";break;case 2:w="right"}return w},configurable:!0,enumerable:!0,set:function(w){switch(w){case"right":case 2:S=2;break;case"center":case 1:S=1;break;case"left":case 0:default:S=0}}})};Si(_o,cl);var Mp=function(){_o.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var s=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){s=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return tj(e,this.objId,this.scope)},set:function(t){var n,r;r=[],typeof(n=t)=="string"&&(r=function(i,a,o){o||(o=1);for(var l,c=[];l=a.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),e=r}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,18)},set:function(t){t?this.Ff=ds(this.Ff,18):this.Ff=hs(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=ds(this.Ff,19):this.Ff=hs(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,20)},set:function(t){t?(this.Ff=ds(this.Ff,20),e.sort()):this.Ff=hs(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,22)},set:function(t){t?this.Ff=ds(this.Ff,22):this.Ff=hs(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,23)},set:function(t){t?this.Ff=ds(this.Ff,23):this.Ff=hs(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,27)},set:function(t){t?this.Ff=ds(this.Ff,27):this.Ff=hs(this.Ff,27)}}),this.hasAppearanceStream=!1};Si(Mp,_o);var Fp=function(){Mp.call(this),this.fontName="helvetica",this.combo=!1};Si(Fp,Mp);var Dp=function(){Fp.call(this),this.combo=!0};Si(Dp,Fp);var c2=function(){Dp.call(this),this.edit=!0};Si(c2,Dp);var Ys=function(){_o.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,15)},set:function(t){t?this.Ff=ds(this.Ff,15):this.Ff=hs(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,16)},set:function(t){t?this.Ff=ds(this.Ff,16):this.Ff=hs(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,17)},set:function(t){t?this.Ff=ds(this.Ff,17):this.Ff=hs(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,26)},set:function(t){t?this.Ff=ds(this.Ff,26):this.Ff=hs(this.Ff,26)}});var s,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,r=[];for(n in r.push("<<"),e)r.push("/"+n+" ("+cf(t(e[n]))+")");return r.push(">>"),r.join(`
`)}},set:function(t){fn(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(t){s="/"+t}})};Si(Ys,_o);var u2=function(){Ys.call(this),this.pushButton=!0};Si(u2,Ys);var Bp=function(){Ys.call(this),this.radio=!0,this.pushButton=!1;var s=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){s=e!==void 0?e:[]}})};Si(Bp,Ys);var ew=function(){var s,e;_o.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(r){e=r}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var i,a=[];for(i in a.push("<<"),n)a.push("/"+i+" ("+cf(r(n[i]))+")");return a.push(">>"),a.join(`
`)},set:function(r){fn(r)==="object"&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){typeof r=="string"&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=tt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Si(ew,_o),Bp.prototype.setAppearance=function(s){if(!("createAppearanceStream"in s)||!("getCA"in s))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=s.createAppearanceStream(t.optionName),t.caption=s.getCA()}},Bp.prototype.createOption=function(s){var e=new ew;return e.Parent=this,e.optionName=s,this.Kids.push(e),KB.call(this.scope,e),e};var d2=function(){Ys.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=tt.CheckBox.createAppearanceStream()};Si(d2,Ys);var Gh=function(){_o.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,13)},set:function(e){e?this.Ff=ds(this.Ff,13):this.Ff=hs(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,21)},set:function(e){e?this.Ff=ds(this.Ff,21):this.Ff=hs(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,23)},set:function(e){e?this.Ff=ds(this.Ff,23):this.Ff=hs(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,24)},set:function(e){e?this.Ff=ds(this.Ff,24):this.Ff=hs(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,25)},set:function(e){e?this.Ff=ds(this.Ff,25):this.Ff=hs(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,26)},set:function(e){e?this.Ff=ds(this.Ff,26):this.Ff=hs(this.Ff,26)}});var s=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return s},set:function(e){s=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return s},set:function(e){Number.isInteger(e)&&(s=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Si(Gh,_o);var h2=function(){Gh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!us(this.Ff,14)},set:function(s){s?this.Ff=ds(this.Ff,14):this.Ff=hs(this.Ff,14)}}),this.password=!0};Si(h2,Gh);var tt={CheckBox:{createAppearanceStream:function(){return{N:{On:tt.CheckBox.YesNormal},D:{On:tt.CheckBox.YesPushDown,Off:tt.CheckBox.OffPushDown}}},YesPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=[],n=s.scope.internal.getFont(s.fontName,s.fontStyle).id,r=s.scope.__private__.encodeColorString(s.color),i=NS(s,s.caption);return t.push("0.749023 g"),t.push("0 0 "+Ct(tt.internal.getWidth(s))+" "+Ct(tt.internal.getHeight(s))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+Ct(i.fontSize)+" Tf "+r),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(s){var e=Bo(s);e.scope=s.scope;var t=s.scope.internal.getFont(s.fontName,s.fontStyle).id,n=s.scope.__private__.encodeColorString(s.color),r=[],i=tt.internal.getHeight(s),a=tt.internal.getWidth(s),o=NS(s,s.caption);return r.push("1 g"),r.push("0 0 "+Ct(a)+" "+Ct(i)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+Ct(a-1)+" "+Ct(i-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+t+" "+Ct(o.fontSize)+" Tf "+n),r.push(o.text),r.push("ET"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ct(tt.internal.getWidth(s))+" "+Ct(tt.internal.getHeight(s))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(s){var e={D:{Off:tt.RadioButton.Circle.OffPushDown},N:{}};return e.N[s]=tt.RadioButton.Circle.YesNormal,e.D[s]=tt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(s){var e=Bo(s);e.scope=s.scope;var t=[],n=tt.internal.getWidth(s)<=tt.internal.getHeight(s)?tt.internal.getWidth(s)/4:tt.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var r=tt.internal.Bezier_C,i=Number((n*r).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Gc(tt.internal.getWidth(s)/2)+" "+Gc(tt.internal.getHeight(s)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=[],n=tt.internal.getWidth(s)<=tt.internal.getHeight(s)?tt.internal.getWidth(s)/4:tt.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),i=Number((r*tt.internal.Bezier_C).toFixed(5)),a=Number((n*tt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gc(tt.internal.getWidth(s)/2)+" "+Gc(tt.internal.getHeight(s)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Gc(tt.internal.getWidth(s)/2)+" "+Gc(tt.internal.getHeight(s)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),t.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),t.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),t.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=[],n=tt.internal.getWidth(s)<=tt.internal.getHeight(s)?tt.internal.getWidth(s)/4:tt.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),i=Number((r*tt.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Gc(tt.internal.getWidth(s)/2)+" "+Gc(tt.internal.getHeight(s)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(s){var e={D:{Off:tt.RadioButton.Cross.OffPushDown},N:{}};return e.N[s]=tt.RadioButton.Cross.YesNormal,e.D[s]=tt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(s){var e=Bo(s);e.scope=s.scope;var t=[],n=tt.internal.calculateCross(s);return t.push("q"),t.push("1 1 "+Ct(tt.internal.getWidth(s)-2)+" "+Ct(tt.internal.getHeight(s)-2)+" re"),t.push("W"),t.push("n"),t.push(Ct(n.x1.x)+" "+Ct(n.x1.y)+" m"),t.push(Ct(n.x2.x)+" "+Ct(n.x2.y)+" l"),t.push(Ct(n.x4.x)+" "+Ct(n.x4.y)+" m"),t.push(Ct(n.x3.x)+" "+Ct(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=tt.internal.calculateCross(s),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ct(tt.internal.getWidth(s))+" "+Ct(tt.internal.getHeight(s))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ct(tt.internal.getWidth(s)-2)+" "+Ct(tt.internal.getHeight(s)-2)+" re"),n.push("W"),n.push("n"),n.push(Ct(t.x1.x)+" "+Ct(t.x1.y)+" m"),n.push(Ct(t.x2.x)+" "+Ct(t.x2.y)+" l"),n.push(Ct(t.x4.x)+" "+Ct(t.x4.y)+" m"),n.push(Ct(t.x3.x)+" "+Ct(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(s){var e=Bo(s);e.scope=s.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Ct(tt.internal.getWidth(s))+" "+Ct(tt.internal.getHeight(s))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(s){var e=s.scope.internal.getFont(s.fontName,s.fontStyle).id,t=s.scope.__private__.encodeColorString(s.color);return"/"+e+" "+s.fontSize+" Tf "+t}};tt.internal={Bezier_C:.551915024494,calculateCross:function(s){var e=tt.internal.getWidth(s),t=tt.internal.getHeight(s),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},tt.internal.getWidth=function(s){var e=0;return fn(s)==="object"&&(e=PE(s.Rect[2])),e},tt.internal.getHeight=function(s){var e=0;return fn(s)==="object"&&(e=PE(s.Rect[3])),e};var KB=ns.addField=function(s){if(XB(this,s),!(s instanceof _o))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=s).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),s.page=s.scope.internal.getCurrentPageInfo().pageNumber,this};ns.AcroFormChoiceField=Mp,ns.AcroFormListBox=Fp,ns.AcroFormComboBox=Dp,ns.AcroFormEditBox=c2,ns.AcroFormButton=Ys,ns.AcroFormPushButton=u2,ns.AcroFormRadioButton=Bp,ns.AcroFormCheckBox=d2,ns.AcroFormTextField=Gh,ns.AcroFormPasswordField=h2,ns.AcroFormAppearance=tt,ns.AcroForm={ChoiceField:Mp,ListBox:Fp,ComboBox:Dp,EditBox:c2,Button:Ys,PushButton:u2,RadioButton:Bp,CheckBox:d2,TextField:Gh,PasswordField:h2,Appearance:tt},yt.AcroForm={ChoiceField:Mp,ListBox:Fp,ComboBox:Dp,EditBox:c2,Button:Ys,PushButton:u2,RadioButton:Bp,CheckBox:d2,TextField:Gh,PasswordField:h2,Appearance:tt};yt.AcroForm;function rj(s){return s.reduce(function(e,t,n){return e[t]=n,e},{})}(function(s){s.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=s.__addimage__.getImageFileTypeByImageData=function(I,O){var X,K,ne,te,ue,Z=e;if((O=O||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(F(I))for(ue in t)for(ne=t[ue],X=0;X<ne.length;X+=1){for(te=!0,K=0;K<ne[X].length;K+=1)if(ne[X][K]!==void 0&&ne[X][K]!==I[K]){te=!1;break}if(te===!0){Z=ue;break}}else for(ue in t)for(ne=t[ue],X=0;X<ne.length;X+=1){for(te=!0,K=0;K<ne[X].length;K+=1)if(ne[X][K]!==void 0&&ne[X][K]!==I.charCodeAt(K)){te=!1;break}if(te===!0){Z=ue;break}}return Z===e&&O!==e&&(Z=O),Z},r=function I(O){for(var X=this.internal.write,K=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);O.objectId=this.internal.newObject();var te=[];if(te.push({key:"Type",value:"/XObject"}),te.push({key:"Subtype",value:"/Image"}),te.push({key:"Width",value:O.width}),te.push({key:"Height",value:O.height}),O.colorSpace===S.INDEXED?te.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(O.palette.length/3-1)+" "+("sMask"in O&&O.sMask!==void 0?O.objectId+2:O.objectId+1)+" 0 R]"}):(te.push({key:"ColorSpace",value:"/"+O.colorSpace}),O.colorSpace===S.DEVICE_CMYK&&te.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),te.push({key:"BitsPerComponent",value:O.bitsPerComponent}),"decodeParameters"in O&&O.decodeParameters!==void 0&&te.push({key:"DecodeParms",value:"<<"+O.decodeParameters+">>"}),"transparency"in O&&Array.isArray(O.transparency)){for(var ue="",Z=0,he=O.transparency.length;Z<he;Z++)ue+=O.transparency[Z]+" "+O.transparency[Z]+" ";te.push({key:"Mask",value:"["+ue+"]"})}O.sMask!==void 0&&te.push({key:"SMask",value:O.objectId+1+" 0 R"});var me=O.filter!==void 0?["/"+O.filter]:void 0;if(K({data:O.data,additionalKeyValues:te,alreadyAppliedFilters:me,objectId:O.objectId}),X("endobj"),"sMask"in O&&O.sMask!==void 0){var Ne="/Predictor "+O.predictor+" /Colors 1 /BitsPerComponent "+O.bitsPerComponent+" /Columns "+O.width,L={width:O.width,height:O.height,colorSpace:"DeviceGray",bitsPerComponent:O.bitsPerComponent,decodeParameters:Ne,data:O.sMask};"filter"in O&&(L.filter=O.filter),I.call(this,L)}if(O.colorSpace===S.INDEXED){var V=this.internal.newObject();K({data:T(new Uint8Array(O.palette)),objectId:V}),X("endobj")}},i=function(){var I=this.internal.collections.addImage_images;for(var O in I)r.call(this,I[O])},a=function(){var I,O=this.internal.collections.addImage_images,X=this.internal.write;for(var K in O)X("/I"+(I=O[K]).index,I.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",a))},l=function(){var I=this.internal.collections.addImage_images;return o.call(this),I},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(I){return typeof s["process"+I.toUpperCase()]=="function"},f=function(I){return fn(I)==="object"&&I.nodeType===1},p=function(I,O){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var X=""+I.getAttribute("src");if(X.indexOf("data:image/")===0)return $0(unescape(X).split("base64,").pop());var K=s.loadFile(X,!0);if(K!==void 0)return K}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ne;switch(O){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;case"JPEG":case"JPG":default:ne="image/jpeg"}return $0(I.toDataURL(ne,1).split("base64,").pop())}},m=function(I){var O=this.internal.collections.addImage_images;if(O){for(var X in O)if(I===O[X].alias)return O[X]}},b=function(I,O,X){return I||O||(I=-96,O=-96),I<0&&(I=-1*X.width*72/I/this.internal.scaleFactor),O<0&&(O=-1*X.height*72/O/this.internal.scaleFactor),I===0&&(I=O*X.width/X.height),O===0&&(O=I*X.height/X.width),[I,O]},y=function(I,O,X,K,ne,te){var ue=b.call(this,X,K,ne),Z=this.internal.getCoordinateString,he=this.internal.getVerticalCoordinateString,me=l.call(this);if(X=ue[0],K=ue[1],me[ne.index]=ne,te){te*=Math.PI/180;var Ne=Math.cos(te),L=Math.sin(te),V=function(se){return se.toFixed(4)},Q=[V(Ne),V(L),V(-1*L),V(Ne),0,0,"cm"]}this.internal.write("q"),te?(this.internal.write([1,"0","0",1,Z(I),he(O+K),"cm"].join(" ")),this.internal.write(Q.join(" ")),this.internal.write([Z(X),"0","0",Z(K),"0","0","cm"].join(" "))):this.internal.write([Z(X),"0","0",Z(K),Z(I),he(O+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},S=s.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};s.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=s.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},_=s.__addimage__.sHashCode=function(I){var O,X,K=0;if(typeof I=="string")for(X=I.length,O=0;O<X;O++)K=(K<<5)-K+I.charCodeAt(O),K|=0;else if(F(I))for(X=I.byteLength/2,O=0;O<X;O++)K=(K<<5)-K+I[O],K|=0;return K},k=s.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var O=!0;return I.length===0&&(O=!1),I.length%4!=0&&(O=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(O=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(O=!1),O},C=s.__addimage__.extractImageFromDataUrl=function(I){var O=(I=I||"").split("base64,"),X=null;if(O.length===2){var K=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(O[0]);Array.isArray(K)&&(X={mimeType:K[1],charset:K[2],data:O[1]})}return X},B=s.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};s.__addimage__.isArrayBuffer=function(I){return B()&&I instanceof ArrayBuffer};var F=s.__addimage__.isArrayBufferView=function(I){return B()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},j=s.__addimage__.binaryStringToUint8Array=function(I){for(var O=I.length,X=new Uint8Array(O),K=0;K<O;K++)X[K]=I.charCodeAt(K);return X},T=s.__addimage__.arrayBufferToBinaryString=function(I){for(var O="",X=F(I)?I:new Uint8Array(I),K=0;K<X.length;K+=8192)O+=String.fromCharCode.apply(null,X.subarray(K,K+8192));return O};s.addImage=function(){var I,O,X,K,ne,te,ue,Z,he;if(typeof arguments[1]=="number"?(O=e,X=arguments[1],K=arguments[2],ne=arguments[3],te=arguments[4],ue=arguments[5],Z=arguments[6],he=arguments[7]):(O=arguments[1],X=arguments[2],K=arguments[3],ne=arguments[4],te=arguments[5],ue=arguments[6],Z=arguments[7],he=arguments[8]),fn(I=arguments[0])==="object"&&!f(I)&&"imageData"in I){var me=I;I=me.imageData,O=me.format||O||e,X=me.x||X||0,K=me.y||K||0,ne=me.w||me.width||ne,te=me.h||me.height||te,ue=me.alias||ue,Z=me.compression||Z,he=me.rotation||me.angle||he}var Ne=this.internal.getFilters();if(Z===void 0&&Ne.indexOf("FlateEncode")!==-1&&(Z="SLOW"),isNaN(X)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var L=W.call(this,I,O,ue,Z);return y.call(this,X,K,ne,te,L,he),this};var W=function(I,O,X,K){var ne,te,ue;if(typeof I=="string"&&n(I)===e){I=unescape(I);var Z=Y(I,!1);(Z!==""||(Z=s.loadFile(I,!0))!==void 0)&&(I=Z)}if(f(I)&&(I=p(I,O)),O=n(I,O),!u(O))throw new Error("addImage does not support files of type '"+O+"', please ensure that a plugin for '"+O+"' support is added.");if(((ue=X)==null||ue.length===0)&&(X=function(he){return typeof he=="string"||F(he)?_(he):F(he.data)?_(he.data):null}(I)),(ne=m.call(this,X))||(B()&&(I instanceof Uint8Array||O==="RGBA"||(te=I,I=j(I))),ne=this["process"+O.toUpperCase()](I,c.call(this),X,function(he){return he&&typeof he=="string"&&(he=he.toUpperCase()),he in s.image_compression?he:w.NONE}(K),te)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},Y=s.__addimage__.convertBase64ToBinaryString=function(I,O){var X;O=typeof O!="boolean"||O;var K,ne="";if(typeof I=="string"){K=(X=C(I))!==null?X.data:I;try{ne=$0(K)}catch(te){if(O)throw k(K)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+te.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ne};s.getImageProperties=function(I){var O,X,K="";if(f(I)&&(I=p(I)),typeof I=="string"&&n(I)===e&&((K=Y(I,!1))===""&&(K=s.loadFile(I)||""),I=K),X=n(I),!u(X))throw new Error("addImage does not support files of type '"+X+"', please ensure that a plugin for '"+X+"' support is added.");if(!B()||I instanceof Uint8Array||(I=j(I)),!(O=this["process"+X.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return O.fileType=X,O}})(yt.API),function(s){var e=function(t){if(t!==void 0&&t!="")return!0};yt.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),s.events.push(["putPage",function(t){for(var n,r,i,a=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),c=t.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((n=c[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){n=c[p];var m=this.internal.pdfEscape,b=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),w=this.internal.getEncryptor(y.objId),_=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(r="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+m(w(n.contents))+")",i+=" /Popup "+S.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+m(w(_))+") >>",y.content=i;var k=y.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+a(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+a(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+k,n.open&&(i+=" /Open true"),i+=" >>",S.content=i,this.internal.write(y.objId,"0 R",S.objId,"0 R");break;case"freetext":r="/Rect ["+a(n.bounds.x)+" "+o(n.bounds.y)+" "+a(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var C=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+m(b(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var B=this.annotations._nameMap[n.options.name];n.options.pageNumber=B.page,n.options.top=B.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+m(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var F=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),s.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},s.link=function(t,n,r,i,a){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(t),y:c(n),w:l(t+r),h:c(n+i)},options:a,type:"link"})},s.textWithLink=function(t,n,r,i){var a,o,l=this.getTextWidth(t),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(t,o).length;a=Math.ceil(c*u)}else o=l,a=c;return this.text(t,n,r,i),r+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,r-c,o,a,i),l},s.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(yt.API),function(s){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];s.__arabicParser__={};var i=s.__arabicParser__.isInArabicSubstitutionA=function(y){return e[y.charCodeAt(0)]!==void 0},a=s.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},o=s.__arabicParser__.isArabicEndLetter=function(y){return a(y)&&i(y)&&e[y.charCodeAt(0)].length<=2},l=s.__arabicParser__.isArabicAlfLetter=function(y){return a(y)&&r.indexOf(y.charCodeAt(0))>=0};s.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return a(y)&&i(y)&&e[y.charCodeAt(0)].length>=1};var c=s.__arabicParser__.arabicLetterHasFinalForm=function(y){return a(y)&&i(y)&&e[y.charCodeAt(0)].length>=2};s.__arabicParser__.arabicLetterHasInitialForm=function(y){return a(y)&&i(y)&&e[y.charCodeAt(0)].length>=3};var u=s.__arabicParser__.arabicLetterHasMedialForm=function(y){return a(y)&&i(y)&&e[y.charCodeAt(0)].length==4},f=s.__arabicParser__.resolveLigatures=function(y){var S=0,w=t,_="",k=0;for(S=0;S<y.length;S+=1)w[y.charCodeAt(S)]!==void 0?(k++,typeof(w=w[y.charCodeAt(S)])=="number"&&(_+=String.fromCharCode(w),w=t,k=0),S===y.length-1&&(w=t,_+=y.charAt(S-(k-1)),S-=k-1,k=0)):(w=t,_+=y.charAt(S-k),S-=k,k=0);return _};s.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&n[y.charCodeAt(0)]!==void 0};var p=s.__arabicParser__.getCorrectForm=function(y,S,w){return a(y)?i(y)===!1?-1:!c(y)||!a(S)&&!a(w)||!a(w)&&o(S)||o(y)&&!a(S)||o(y)&&l(S)||o(y)&&o(S)?0:u(y)&&a(S)&&!o(S)&&a(w)&&c(w)?3:o(y)||!a(w)?1:2:-1},m=function(y){var S=0,w=0,_=0,k="",C="",B="",F=(y=y||"").split("\\s+"),j=[];for(S=0;S<F.length;S+=1){for(j.push(""),w=0;w<F[S].length;w+=1)k=F[S][w],C=F[S][w-1],B=F[S][w+1],a(k)?(_=p(k,C,B),j[S]+=_!==-1?String.fromCharCode(e[k.charCodeAt(0)][_]):k):j[S]+=k;j[S]=f(j[S])}return j.join(" ")},b=s.__arabicParser__.processArabic=s.processArabic=function(){var y,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,w=[];if(Array.isArray(S)){var _=0;for(w=[],_=0;_<S.length;_+=1)Array.isArray(S[_])?w.push([m(S[_][0]),S[_][1],S[_][2]]):w.push([m(S[_])]);y=w}else y=m(S);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};s.events.push(["preProcessText",b])}(yt.API),yt.API.autoPrint=function(s){var e;switch((s=s||{}).variant=s.variant||"non-conform",s.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(s){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(o){t=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var a={};Object.defineProperty(this,"style",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var r;if((t=t||"2d")!=="2d")return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},s.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(yt.API),function(s){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(y){l=y}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(y){u=y}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(y){p=y}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(y){b=y}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},s.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},s.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,m=0,b=0,y=0,S=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var w=c.maxWidth;w>0?typeof l=="string"?l=this.splitTextToSize(l,w):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(k,C){return k.concat(S.splitTextToSize(C,w))},[])):l=Array.isArray(l)?l:[l];for(var _=0;_<l.length;_++)m<(y=this.getStringUnitWidth(l[_],{font:f})*u)&&(m=y);return m!==0&&(b=l.length),{w:m/=p,h:Math.max((b*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},s.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var a=s.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,p=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,m&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};s.table=function(l,c,u,f,p){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,b,y,S,w=[],_=[],k=[],C={},B={},F=[],j=[],T=(p=p||{}).autoSize||!1,W=p.printHeaders!==!1,Y=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,I=p.margins||Object.assign({width:this.getPageWidth()},e),O=typeof p.padding=="number"?p.padding:3,X=p.headerBackgroundColor||"#c8c8c8",K=p.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=W,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=Y,this.internal.__cell__.padding=O,this.internal.__cell__.headerBackgroundColor=X,this.internal.__cell__.headerTextColor=K,this.setFontSize(Y),f==null)_=w=Object.keys(u[0]),k=w.map(function(){return"left"});else if(Array.isArray(f)&&fn(f[0])==="object")for(w=f.map(function(me){return me.name}),_=f.map(function(me){return me.prompt||me.name||""}),k=f.map(function(me){return me.align||"left"}),m=0;m<f.length;m+=1)B[f[m].name]=f[m].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(_=w=f,k=w.map(function(){return"left"}));if(T||Array.isArray(f)&&typeof f[0]=="string")for(m=0;m<w.length;m+=1){for(C[S=w[m]]=u.map(function(me){return me[S]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(_[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=C[S],this.setFont(void 0,"normal"),y=0;y<b.length;y+=1)F.push(this.getTextDimensions(b[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[S]=Math.max.apply(null,F)+O+O,F=[]}if(W){var ne={};for(m=0;m<w.length;m+=1)ne[w[m]]={},ne[w[m]].text=_[m],ne[w[m]].align=k[m];var te=o.call(this,ne,B);j=w.map(function(me){return new i(l,c,B[me],te,ne[me].text,void 0,ne[me].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var ue=f.reduce(function(me,Ne){return me[Ne.name]=Ne.align,me},{});for(m=0;m<u.length;m+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:m,data:u[m]},this);var Z=o.call(this,u[m],B);for(y=0;y<w.length;y+=1){var he=u[m][w[y]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:m,col:y,data:he},this),a.call(this,new i(l,c,B[w[y]],Z,he,m+2,ue[w[y]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(m){var b=l[m];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,c[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*f/p+u+u},this).reduce(function(m,b){return Math.max(m,b)},0)};s.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},s.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=l;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),a.call(this,u),this.setTextColor(b)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),t=!1}}(yt.API);var ij={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},aj=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],CS=rj(aj),oj=[100,200,300,400,500,600,700,800,900],YB=rj(oj);function ES(s){var e=s.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return ij[i=i||"normal"]?i:"normal"}(s.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(s.weight),r=function(i){return typeof CS[i=i||"normal"]=="number"?i:"normal"}(s.stretch);return{family:e,style:t,weight:n,stretch:r,src:s.src||[],ref:s.ref||{name:e,style:[r,t,n].join(" ")}}}function LE(s,e,t,n){var r;for(r=t;r>=0&&r<e.length;r+=n)if(s[e[r]])return s[e[r]];for(r=t;r>=0&&r<e.length;r-=n)if(s[e[r]])return s[e[r]]}var JB={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},TE={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function IE(s){return[s.stretch,s.style,s.weight,s.family].join(" ")}function QB(s,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",r=Object.assign({},JB,t.genericFontFamilies||{}),i=null,a=null,o=0;o<e.length;++o)if(r[(i=ES(e[o])).family]&&(i.family=r[i.family]),s.hasOwnProperty(i.family)){a=s[i.family];break}if(!(a=a||s[n]))throw new Error("Could not find a font-family for the rule '"+IE(i)+"' and default family '"+n+"'.");if(a=function(l,c){if(c[l])return c[l];var u=CS[l],f=u<=CS.normal?-1:1,p=LE(c,aj,u,f);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(i.stretch,a),a=function(l,c){if(c[l])return c[l];for(var u=ij[l],f=0;f<u.length;++f)if(c[u[f]])return c[u[f]];throw new Error("Could not find a matching font-style for "+l)}(i.style,a),!(a=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=YB[l],f=LE(c,oj,u,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(i.weight,a)))throw new Error("Failed to resolve a font for the rule '"+IE(i)+"'.");return a}function jE(s){return s.trimLeft()}function ZB(s,e){for(var t=0;t<s.length;){if(s.charAt(t)===e)return[s.substring(0,t),s.substring(t+1)];t+=1}return null}function e$(s){var e=s.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],s.substring(e[0].length)]}var fb,RE,OE,Bx=["times"];(function(s){var e,t,n,r,i,a,o,l,c,u=function(L){return L=L||{},this.isStrokeTransparent=L.isStrokeTransparent||!1,this.strokeOpacity=L.strokeOpacity||1,this.strokeStyle=L.strokeStyle||"#000000",this.fillStyle=L.fillStyle||"#000000",this.isFillTransparent=L.isFillTransparent||!1,this.fillOpacity=L.fillOpacity||1,this.font=L.font||"10px sans-serif",this.textBaseline=L.textBaseline||"alphabetic",this.textAlign=L.textAlign||"left",this.lineWidth=L.lineWidth||1,this.lineJoin=L.lineJoin||"miter",this.lineCap=L.lineCap||"butt",this.path=L.path||[],this.transform=L.transform!==void 0?L.transform.clone():new l,this.globalCompositeOperation=L.globalCompositeOperation||"normal",this.globalAlpha=L.globalAlpha||1,this.clip_path=L.clip_path||[],this.currentPoint=L.currentPoint||new a,this.miterLimit=L.miterLimit||10,this.lastPoint=L.lastPoint||new a,this.lineDashOffset=L.lineDashOffset||0,this.lineDash=L.lineDash||[],this.margin=L.margin||[0,0,0,0],this.prevPageLastElemOffset=L.prevPageLastElemOffset||0,this.ignoreClearRect=typeof L.ignoreClearRect!="boolean"||L.ignoreClearRect,this};s.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,a=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(L){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var V=L;Object.defineProperty(this,"pdf",{get:function(){return V}});var Q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return Q},set:function(Se){Q=!!Se}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(Se){se=!!Se}});var re=0;Object.defineProperty(this,"posX",{get:function(){return re},set:function(Se){isNaN(Se)||(re=Se)}});var de=0;Object.defineProperty(this,"posY",{get:function(){return de},set:function(Se){isNaN(Se)||(de=Se)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Se){var ee;typeof Se=="number"?ee=[Se,Se,Se,Se]:((ee=new Array(4))[0]=Se[0],ee[1]=Se.length>=2?Se[1]:ee[0],ee[2]=Se.length>=3?Se[2]:ee[0],ee[3]=Se.length>=4?Se[3]:ee[1]),c.margin=ee}});var le=!1;Object.defineProperty(this,"autoPaging",{get:function(){return le},set:function(Se){le=Se}});var we=0;Object.defineProperty(this,"lastBreak",{get:function(){return we},set:function(Se){we=Se}});var Le=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Le},set:function(Se){Le=Se}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Se){Se instanceof u&&(c=Se)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Se){c.path=Se}});var je=[];Object.defineProperty(this,"ctxStack",{get:function(){return je},set:function(Se){je=Se}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Se){var ee;ee=p(Se),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Se){var ee=p(Se);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Se){["butt","round","square"].indexOf(Se)!==-1&&(this.ctx.lineCap=Se,this.pdf.setLineCap(Se))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Se){isNaN(Se)||(this.ctx.lineWidth=Se,this.pdf.setLineWidth(Se))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Se){["bevel","round","miter"].indexOf(Se)!==-1&&(this.ctx.lineJoin=Se,this.pdf.setLineJoin(Se))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Se){isNaN(Se)||(this.ctx.miterLimit=Se,this.pdf.setMiterLimit(Se))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Se){this.ctx.textBaseline=Se}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Se){["right","end","center","left","start"].indexOf(Se)!==-1&&(this.ctx.textAlign=Se)}});var Fe=null;function Be(Se,ee){if(Fe===null){var St=function(nt){var Re=[];return Object.keys(nt).forEach(function($e){nt[$e].forEach(function(ze){var De=null;switch(ze){case"bold":De={family:$e,weight:"bold"};break;case"italic":De={family:$e,style:"italic"};break;case"bolditalic":De={family:$e,weight:"bold",style:"italic"};break;case"":case"normal":De={family:$e}}De!==null&&(De.ref={name:$e,style:ze},Re.push(De))})}),Re}(Se.getFontList());Fe=function(nt){for(var Re={},$e=0;$e<nt.length;++$e){var ze=ES(nt[$e]),De=ze.family,Ke=ze.stretch,kt=ze.style,_t=ze.weight;Re[De]=Re[De]||{},Re[De][Ke]=Re[De][Ke]||{},Re[De][Ke][kt]=Re[De][Ke][kt]||{},Re[De][Ke][kt][_t]=ze}return Re}(St.concat(ee))}return Fe}var at=null;Object.defineProperty(this,"fontFaces",{get:function(){return at},set:function(Se){Fe=null,at=Se}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Se){var ee;if(this.ctx.font=Se,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Se))!==null){var St=ee[1],nt=(ee[2],ee[3]),Re=ee[4],$e=(ee[5],ee[6]),ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Re)[2];Re=Math.floor(ze==="px"?parseFloat(Re)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(Re)*this.pdf.getFontSize():parseFloat(Re)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Re);var De=function(pt){var Ft,qe,Zt=[],Bt=pt.trim();if(Bt==="")return Bx;if(Bt in TE)return[TE[Bt]];for(;Bt!=="";){switch(qe=null,Ft=(Bt=jE(Bt)).charAt(0)){case'"':case"'":qe=ZB(Bt.substring(1),Ft);break;default:qe=e$(Bt)}if(qe===null||(Zt.push(qe[0]),(Bt=jE(qe[1]))!==""&&Bt.charAt(0)!==","))return Bx;Bt=Bt.replace(/^,/,"")}return Zt}($e);if(this.fontFaces){var Ke=QB(Be(this.pdf,this.fontFaces),De.map(function(pt){return{family:pt,stretch:"normal",weight:nt,style:St}}));this.pdf.setFont(Ke.ref.name,Ke.ref.style)}else{var kt="";(nt==="bold"||parseInt(nt,10)>=700||St==="bold")&&(kt="bold"),St==="italic"&&(kt+="italic"),kt.length===0&&(kt="normal");for(var _t="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Vt=0;Vt<De.length;Vt++){if(this.pdf.internal.getFont(De[Vt],kt,{noFallback:!0,disableWarning:!0})!==void 0){_t=De[Vt];break}if(kt==="bolditalic"&&this.pdf.internal.getFont(De[Vt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)_t=De[Vt],kt="bold";else if(this.pdf.internal.getFont(De[Vt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){_t=De[Vt],kt="normal";break}}if(_t===""){for(var Mt=0;Mt<De.length;Mt++)if(Tt[De[Mt]]){_t=Tt[De[Mt]];break}}_t=_t===""?"Times":_t,this.pdf.setFont(_t,kt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Se){this.ctx.globalCompositeOperation=Se}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Se){this.ctx.globalAlpha=Se}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Se){this.ctx.lineDashOffset=Se,Ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Se){this.ctx.lineDash=Se,Ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Se){this.ctx.ignoreClearRect=!!Se}})};f.prototype.setLineDash=function(L){this.lineDash=L},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){C.call(this,"fill",!1)},f.prototype.stroke=function(){C.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(L,V){if(isNaN(L)||isNaN(V))throw _n.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var Q=this.ctx.transform.applyToPoint(new a(L,V));this.path.push({type:"mt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new a(L,V)},f.prototype.closePath=function(){var L=new a(0,0),V=0;for(V=this.path.length-1;V!==-1;V--)if(this.path[V].type==="begin"&&fn(this.path[V+1])==="object"&&typeof this.path[V+1].x=="number"){L=new a(this.path[V+1].x,this.path[V+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new a(L.x,L.y)},f.prototype.lineTo=function(L,V){if(isNaN(L)||isNaN(V))throw _n.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var Q=this.ctx.transform.applyToPoint(new a(L,V));this.path.push({type:"lt",x:Q.x,y:Q.y}),this.ctx.lastPoint=new a(Q.x,Q.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},f.prototype.quadraticCurveTo=function(L,V,Q,se){if(isNaN(Q)||isNaN(se)||isNaN(L)||isNaN(V))throw _n.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var re=this.ctx.transform.applyToPoint(new a(Q,se)),de=this.ctx.transform.applyToPoint(new a(L,V));this.path.push({type:"qct",x1:de.x,y1:de.y,x:re.x,y:re.y}),this.ctx.lastPoint=new a(re.x,re.y)},f.prototype.bezierCurveTo=function(L,V,Q,se,re,de){if(isNaN(re)||isNaN(de)||isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se))throw _n.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var le=this.ctx.transform.applyToPoint(new a(re,de)),we=this.ctx.transform.applyToPoint(new a(L,V)),Le=this.ctx.transform.applyToPoint(new a(Q,se));this.path.push({type:"bct",x1:we.x,y1:we.y,x2:Le.x,y2:Le.y,x:le.x,y:le.y}),this.ctx.lastPoint=new a(le.x,le.y)},f.prototype.arc=function(L,V,Q,se,re,de){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se)||isNaN(re))throw _n.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(de=!!de,!this.ctx.transform.isIdentity){var le=this.ctx.transform.applyToPoint(new a(L,V));L=le.x,V=le.y;var we=this.ctx.transform.applyToPoint(new a(0,Q)),Le=this.ctx.transform.applyToPoint(new a(0,0));Q=Math.sqrt(Math.pow(we.x-Le.x,2)+Math.pow(we.y-Le.y,2))}Math.abs(re-se)>=2*Math.PI&&(se=0,re=2*Math.PI),this.path.push({type:"arc",x:L,y:V,radius:Q,startAngle:se,endAngle:re,counterclockwise:de})},f.prototype.arcTo=function(L,V,Q,se,re){throw new Error("arcTo not implemented.")},f.prototype.rect=function(L,V,Q,se){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se))throw _n.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(L,V),this.lineTo(L+Q,V),this.lineTo(L+Q,V+se),this.lineTo(L,V+se),this.lineTo(L,V),this.lineTo(L+Q,V),this.lineTo(L,V)},f.prototype.fillRect=function(L,V,Q,se){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se))throw _n.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var re={};this.lineCap!=="butt"&&(re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(L,V,Q,se),this.fill(),re.hasOwnProperty("lineCap")&&(this.lineCap=re.lineCap),re.hasOwnProperty("lineJoin")&&(this.lineJoin=re.lineJoin)}},f.prototype.strokeRect=function(L,V,Q,se){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se))throw _n.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(L,V,Q,se),this.stroke())},f.prototype.clearRect=function(L,V,Q,se){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se))throw _n.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(L,V,Q,se))},f.prototype.save=function(L){L=typeof L!="boolean"||L;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("q");if(this.pdf.setPage(V),L){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},f.prototype.restore=function(L){L=typeof L!="boolean"||L;for(var V=this.pdf.internal.getCurrentPageInfo().pageNumber,Q=0;Q<this.pdf.internal.getNumberOfPages();Q++)this.pdf.setPage(Q+1),this.pdf.internal.out("Q");this.pdf.setPage(V),L&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(L){var V,Q,se,re;if(L.isCanvasGradient===!0&&(L=L.getColor()),!L)return{r:0,g:0,b:0,a:0,style:L};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(L))V=0,Q=0,se=0,re=0;else{var de=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(L);if(de!==null)V=parseInt(de[1]),Q=parseInt(de[2]),se=parseInt(de[3]),re=1;else if((de=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(L))!==null)V=parseInt(de[1]),Q=parseInt(de[2]),se=parseInt(de[3]),re=parseFloat(de[4]);else{if(re=1,typeof L=="string"&&L.charAt(0)!=="#"){var le=new QI(L);L=le.ok?le.toHex():"#000000"}L.length===4?(V=L.substring(1,2),V+=V,Q=L.substring(2,3),Q+=Q,se=L.substring(3,4),se+=se):(V=L.substring(1,3),Q=L.substring(3,5),se=L.substring(5,7)),V=parseInt(V,16),Q=parseInt(Q,16),se=parseInt(se,16)}}return{r:V,g:Q,b:se,a:re,style:L}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(L,V,Q,se){if(isNaN(V)||isNaN(Q)||typeof L!="string")throw _n.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!m.call(this)){var re=Z(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;O.call(this,{text:L,x:V,y:Q,scale:de,angle:re,align:this.textAlign,maxWidth:se})}},f.prototype.strokeText=function(L,V,Q,se){if(isNaN(V)||isNaN(Q)||typeof L!="string")throw _n.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){se=isNaN(se)?void 0:se;var re=Z(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;O.call(this,{text:L,x:V,y:Q,scale:de,renderingMode:"stroke",angle:re,align:this.textAlign,maxWidth:se})}},f.prototype.measureText=function(L){if(typeof L!="string")throw _n.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var V=this.pdf,Q=this.pdf.internal.scaleFactor,se=V.internal.getFontSize(),re=V.getStringUnitWidth(L)*se/V.internal.scaleFactor,de=function(le){var we=(le=le||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return we}}),this};return new de({width:re*=Math.round(96*Q/72*1e4)/1e4})},f.prototype.scale=function(L,V){if(isNaN(L)||isNaN(V))throw _n.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var Q=new l(L,0,0,V,0,0);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.rotate=function(L){if(isNaN(L))throw _n.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var V=new l(Math.cos(L),Math.sin(L),-Math.sin(L),Math.cos(L),0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.translate=function(L,V){if(isNaN(L)||isNaN(V))throw _n.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var Q=new l(1,0,0,1,L,V);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.transform=function(L,V,Q,se,re,de){if(isNaN(L)||isNaN(V)||isNaN(Q)||isNaN(se)||isNaN(re)||isNaN(de))throw _n.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var le=new l(L,V,Q,se,re,de);this.ctx.transform=this.ctx.transform.multiply(le)},f.prototype.setTransform=function(L,V,Q,se,re,de){L=isNaN(L)?1:L,V=isNaN(V)?0:V,Q=isNaN(Q)?0:Q,se=isNaN(se)?1:se,re=isNaN(re)?0:re,de=isNaN(de)?0:de,this.ctx.transform=new l(L,V,Q,se,re,de)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(L,V,Q,se,re,de,le,we,Le){var je=this.pdf.getImageProperties(L),Fe=1,Be=1,at=1,Se=1;se!==void 0&&we!==void 0&&(at=we/se,Se=Le/re,Fe=je.width/se*we/se,Be=je.height/re*Le/re),de===void 0&&(de=V,le=Q,V=0,Q=0),se!==void 0&&we===void 0&&(we=se,Le=re),se===void 0&&we===void 0&&(we=je.width,Le=je.height);for(var ee,St=this.ctx.transform.decompose(),nt=Z(St.rotate.shx),Re=new l,$e=(Re=(Re=(Re=Re.multiply(St.translate)).multiply(St.skew)).multiply(St.scale)).applyToRectangle(new o(de-V*at,le-Q*Se,se*Fe,re*Be)),ze=S.call(this,$e),De=[],Ke=0;Ke<ze.length;Ke+=1)De.indexOf(ze[Ke])===-1&&De.push(ze[Ke]);if(k(De),this.autoPaging)for(var kt=De[0],_t=De[De.length-1],Tt=kt;Tt<_t+1;Tt++){this.pdf.setPage(Tt);var Vt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=Tt===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],qe=Tt===1?0:pt+(Tt-2)*Ft;if(this.ctx.clip_path.length!==0){var Zt=this.path;ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(ee,this.posX+this.margin[3],-qe+Mt+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=Zt}var Bt=JSON.parse(JSON.stringify($e));Bt=_([Bt],this.posX+this.margin[3],-qe+Mt+this.ctx.prevPageLastElemOffset)[0];var Zr=(Tt>kt||Tt<_t)&&y.call(this);Zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Vt,Ft,null).clip().discardPath()),this.pdf.addImage(L,"JPEG",Bt.x,Bt.y,Bt.w,Bt.h,null,null,nt),Zr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(L,"JPEG",$e.x,$e.y,$e.w,$e.h,null,null,nt)};var S=function(L,V,Q){var se=[];V=V||this.pdf.internal.pageSize.width,Q=Q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var re=this.posY+this.ctx.prevPageLastElemOffset;switch(L.type){default:case"mt":case"lt":se.push(Math.floor((L.y+re)/Q)+1);break;case"arc":se.push(Math.floor((L.y+re-L.radius)/Q)+1),se.push(Math.floor((L.y+re+L.radius)/Q)+1);break;case"qct":var de=he(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x,L.y);se.push(Math.floor((de.y+re)/Q)+1),se.push(Math.floor((de.y+de.h+re)/Q)+1);break;case"bct":var le=me(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x2,L.y2,L.x,L.y);se.push(Math.floor((le.y+re)/Q)+1),se.push(Math.floor((le.y+le.h+re)/Q)+1);break;case"rect":se.push(Math.floor((L.y+re)/Q)+1),se.push(Math.floor((L.y+L.h+re)/Q)+1)}for(var we=0;we<se.length;we+=1)for(;this.pdf.internal.getNumberOfPages()<se[we];)w.call(this);return se},w=function(){var L=this.fillStyle,V=this.strokeStyle,Q=this.font,se=this.lineCap,re=this.lineWidth,de=this.lineJoin;this.pdf.addPage(),this.fillStyle=L,this.strokeStyle=V,this.font=Q,this.lineCap=se,this.lineWidth=re,this.lineJoin=de},_=function(L,V,Q){for(var se=0;se<L.length;se++)switch(L[se].type){case"bct":L[se].x2+=V,L[se].y2+=Q;case"qct":L[se].x1+=V,L[se].y1+=Q;case"mt":case"lt":case"arc":default:L[se].x+=V,L[se].y+=Q}return L},k=function(L){return L.sort(function(V,Q){return V-Q})},C=function(L,V){for(var Q,se,re=this.fillStyle,de=this.strokeStyle,le=this.lineCap,we=this.lineWidth,Le=Math.abs(we*this.ctx.transform.scaleX),je=this.lineJoin,Fe=JSON.parse(JSON.stringify(this.path)),Be=JSON.parse(JSON.stringify(this.path)),at=[],Se=0;Se<Be.length;Se++)if(Be[Se].x!==void 0)for(var ee=S.call(this,Be[Se]),St=0;St<ee.length;St+=1)at.indexOf(ee[St])===-1&&at.push(ee[St]);for(var nt=0;nt<at.length;nt++)for(;this.pdf.internal.getNumberOfPages()<at[nt];)w.call(this);if(k(at),this.autoPaging)for(var Re=at[0],$e=at[at.length-1],ze=Re;ze<$e+1;ze++){this.pdf.setPage(ze),this.fillStyle=re,this.strokeStyle=de,this.lineCap=le,this.lineWidth=Le,this.lineJoin=je;var De=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ke=ze===1?this.posY+this.margin[0]:this.margin[0],kt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=ze===1?0:kt+(ze-2)*_t;if(this.ctx.clip_path.length!==0){var Vt=this.path;Q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Q,this.posX+this.margin[3],-Tt+Ke+this.ctx.prevPageLastElemOffset),B.call(this,L,!0),this.path=Vt}if(se=JSON.parse(JSON.stringify(Fe)),this.path=_(se,this.posX+this.margin[3],-Tt+Ke+this.ctx.prevPageLastElemOffset),V===!1||ze===0){var Mt=(ze>Re||ze<$e)&&y.call(this);Mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,_t,null).clip().discardPath()),B.call(this,L,V),Mt&&this.pdf.restoreGraphicsState()}this.lineWidth=we}else this.lineWidth=Le,B.call(this,L,V),this.lineWidth=we;this.path=Fe},B=function(L,V){if((L!=="stroke"||V||!b.call(this))&&(L==="stroke"||V||!m.call(this))){for(var Q,se,re=[],de=this.path,le=0;le<de.length;le++){var we=de[le];switch(we.type){case"begin":re.push({begin:!0});break;case"close":re.push({close:!0});break;case"mt":re.push({start:we,deltas:[],abs:[]});break;case"lt":var Le=re.length;if(de[le-1]&&!isNaN(de[le-1].x)&&(Q=[we.x-de[le-1].x,we.y-de[le-1].y],Le>0)){for(;Le>=0;Le--)if(re[Le-1].close!==!0&&re[Le-1].begin!==!0){re[Le-1].deltas.push(Q),re[Le-1].abs.push(we);break}}break;case"bct":Q=[we.x1-de[le-1].x,we.y1-de[le-1].y,we.x2-de[le-1].x,we.y2-de[le-1].y,we.x-de[le-1].x,we.y-de[le-1].y],re[re.length-1].deltas.push(Q);break;case"qct":var je=de[le-1].x+2/3*(we.x1-de[le-1].x),Fe=de[le-1].y+2/3*(we.y1-de[le-1].y),Be=we.x+2/3*(we.x1-we.x),at=we.y+2/3*(we.y1-we.y),Se=we.x,ee=we.y;Q=[je-de[le-1].x,Fe-de[le-1].y,Be-de[le-1].x,at-de[le-1].y,Se-de[le-1].x,ee-de[le-1].y],re[re.length-1].deltas.push(Q);break;case"arc":re.push({deltas:[],abs:[],arc:!0}),Array.isArray(re[re.length-1].abs)&&re[re.length-1].abs.push(we)}}se=V?null:L==="stroke"?"stroke":"fill";for(var St=!1,nt=0;nt<re.length;nt++)if(re[nt].arc)for(var Re=re[nt].abs,$e=0;$e<Re.length;$e++){var ze=Re[$e];ze.type==="arc"?T.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,V,!St):X.call(this,ze.x,ze.y),St=!0}else if(re[nt].close===!0)this.pdf.internal.out("h"),St=!1;else if(re[nt].begin!==!0){var De=re[nt].start.x,Ke=re[nt].start.y;K.call(this,re[nt].deltas,De,Ke),St=!0}se&&W.call(this,se),V&&Y.call(this)}},F=function(L){var V=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,Q=V*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return L-Q;case"top":return L+V-Q;case"hanging":return L+V-2*Q;case"middle":return L+V/2-Q;case"ideographic":return L;case"alphabetic":default:return L}},j=function(L){return L+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var L=function(){};return L.colorStops=[],L.addColorStop=function(V,Q){this.colorStops.push([V,Q])},L.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},L.isCanvasGradient=!0,L},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(L,V,Q,se,re,de,le,we,Le){for(var je=te.call(this,Q,se,re,de),Fe=0;Fe<je.length;Fe++){var Be=je[Fe];Fe===0&&(Le?I.call(this,Be.x1+L,Be.y1+V):X.call(this,Be.x1+L,Be.y1+V)),ne.call(this,L,V,Be.x2,Be.y2,Be.x3,Be.y3,Be.x4,Be.y4)}we?Y.call(this):W.call(this,le)},W=function(L){switch(L){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Y=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(L,V){this.pdf.internal.out(t(L)+" "+n(V)+" m")},O=function(L){var V;switch(L.align){case"right":case"end":V="right";break;case"center":V="center";break;case"left":case"start":default:V="left"}var Q=this.pdf.getTextDimensions(L.text),se=F.call(this,L.y),re=j.call(this,se)-Q.h,de=this.ctx.transform.applyToPoint(new a(L.x,se)),le=this.ctx.transform.decompose(),we=new l;we=(we=(we=we.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var Le,je,Fe,Be=this.ctx.transform.applyToRectangle(new o(L.x,se,Q.w,Q.h)),at=we.applyToRectangle(new o(L.x,re,Q.w,Q.h)),Se=S.call(this,at),ee=[],St=0;St<Se.length;St+=1)ee.indexOf(Se[St])===-1&&ee.push(Se[St]);if(k(ee),this.autoPaging)for(var nt=ee[0],Re=ee[ee.length-1],$e=nt;$e<Re+1;$e++){this.pdf.setPage($e);var ze=$e===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ke=this.pdf.internal.pageSize.height-this.margin[2],kt=Ke-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],Tt=_t-this.margin[3],Vt=$e===1?0:De+($e-2)*kt;if(this.ctx.clip_path.length!==0){var Mt=this.path;Le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=_(Le,this.posX+this.margin[3],-1*Vt+ze),B.call(this,"fill",!0),this.path=Mt}var pt=_([JSON.parse(JSON.stringify(at))],this.posX+this.margin[3],-Vt+ze+this.ctx.prevPageLastElemOffset)[0];L.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*L.scale),Fe=this.lineWidth,this.lineWidth=Fe*L.scale);var Ft=this.autoPaging!=="text";if(Ft||pt.y+pt.h<=Ke){if(Ft||pt.y>=ze&&pt.x<=_t){var qe=Ft?L.text:this.pdf.splitTextToSize(L.text,L.maxWidth||_t-pt.x)[0],Zt=_([JSON.parse(JSON.stringify(Be))],this.posX+this.margin[3],-Vt+ze+this.ctx.prevPageLastElemOffset)[0],Bt=Ft&&($e>nt||$e<Re)&&y.call(this);Bt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,kt,null).clip().discardPath()),this.pdf.text(qe,Zt.x,Zt.y,{angle:L.angle,align:V,renderingMode:L.renderingMode}),Bt&&this.pdf.restoreGraphicsState()}}else pt.y<Ke&&(this.ctx.prevPageLastElemOffset+=Ke-pt.y);L.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Fe)}else L.scale>=.01&&(je=this.pdf.internal.getFontSize(),this.pdf.setFontSize(je*L.scale),Fe=this.lineWidth,this.lineWidth=Fe*L.scale),this.pdf.text(L.text,de.x+this.posX,de.y+this.posY,{angle:L.angle,align:V,renderingMode:L.renderingMode,maxWidth:L.maxWidth}),L.scale>=.01&&(this.pdf.setFontSize(je),this.lineWidth=Fe)},X=function(L,V,Q,se){Q=Q||0,se=se||0,this.pdf.internal.out(t(L+Q)+" "+n(V+se)+" l")},K=function(L,V,Q){return this.pdf.lines(L,V,Q,null,null)},ne=function(L,V,Q,se,re,de,le,we){this.pdf.internal.out([e(r(Q+L)),e(i(se+V)),e(r(re+L)),e(i(de+V)),e(r(le+L)),e(i(we+V)),"c"].join(" "))},te=function(L,V,Q,se){for(var re=2*Math.PI,de=Math.PI/2;V>Q;)V-=re;var le=Math.abs(Q-V);le<re&&se&&(le=re-le);for(var we=[],Le=se?-1:1,je=V;le>1e-5;){var Fe=je+Le*Math.min(le,de);we.push(ue.call(this,L,je,Fe)),le-=Math.abs(Fe-je),je=Fe}return we},ue=function(L,V,Q){var se=(Q-V)/2,re=L*Math.cos(se),de=L*Math.sin(se),le=re,we=-de,Le=le*le+we*we,je=Le+le*re+we*de,Fe=4/3*(Math.sqrt(2*Le*je)-je)/(le*de-we*re),Be=le-Fe*we,at=we+Fe*le,Se=Be,ee=-at,St=se+V,nt=Math.cos(St),Re=Math.sin(St);return{x1:L*Math.cos(V),y1:L*Math.sin(V),x2:Be*nt-at*Re,y2:Be*Re+at*nt,x3:Se*nt-ee*Re,y3:Se*Re+ee*nt,x4:L*Math.cos(Q),y4:L*Math.sin(Q)}},Z=function(L){return 180*L/Math.PI},he=function(L,V,Q,se,re,de){var le=L+.5*(Q-L),we=V+.5*(se-V),Le=re+.5*(Q-re),je=de+.5*(se-de),Fe=Math.min(L,re,le,Le),Be=Math.max(L,re,le,Le),at=Math.min(V,de,we,je),Se=Math.max(V,de,we,je);return new o(Fe,at,Be-Fe,Se-at)},me=function(L,V,Q,se,re,de,le,we){var Le,je,Fe,Be,at,Se,ee,St,nt,Re,$e,ze,De,Ke,kt=Q-L,_t=se-V,Tt=re-Q,Vt=de-se,Mt=le-re,pt=we-de;for(je=0;je<41;je++)nt=(ee=(Fe=L+(Le=je/40)*kt)+Le*((at=Q+Le*Tt)-Fe))+Le*(at+Le*(re+Le*Mt-at)-ee),Re=(St=(Be=V+Le*_t)+Le*((Se=se+Le*Vt)-Be))+Le*(Se+Le*(de+Le*pt-Se)-St),je==0?($e=nt,ze=Re,De=nt,Ke=Re):($e=Math.min($e,nt),ze=Math.min(ze,Re),De=Math.max(De,nt),Ke=Math.max(Ke,Re));return new o(Math.round($e),Math.round(ze),Math.round(De-$e),Math.round(Ke-ze))},Ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var L,V,Q=(L=this.ctx.lineDash,V=this.ctx.lineDashOffset,JSON.stringify({lineDash:L,lineDashOffset:V}));this.prevLineDash!==Q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=Q)}}})(yt.API),function(s){var e=function(i){var a,o,l,c,u,f,p,m,b,y;for(o=[],l=0,c=(i+=a="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(u=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(f=(u=((u=((u=((u=(u-(y=u%85))/85)-(b=u%85))/85)-(m=u%85))/85)-(p=u%85))/85)%85,o.push(f+33,p+33,m+33,b+33,y+33)):o.push(122);return function(S,w){for(var _=w;_>0;_--)S.pop()}(o,a.length),String.fromCharCode.apply(String,o)+"~>"},t=function(i){var a,o,l,c,u,f=String,p="length",m=255,b="charCodeAt",y="slice",S="replace";for(i[y](-2),i=i[y](0,-2)[S](/\s/g,"")[S]("z","!!!!!"),l=[],c=0,u=(i+=a="uuuuu"[y](i[p]%5||5))[p];u>c;c+=5)o=52200625*(i[b](c)-33)+614125*(i[b](c+1)-33)+7225*(i[b](c+2)-33)+85*(i[b](c+3)-33)+(i[b](c+4)-33),l.push(m&o>>24,m&o>>16,m&o>>8,m&o);return function(w,_){for(var k=_;k>0;k--)w.pop()}(l,a[p]),f.fromCharCode.apply(f,l)},n=function(i){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),a.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},r=function(i){for(var a=new Uint8Array(i.length),o=i.length;o--;)a[o]=i.charCodeAt(o);return i=(a=_S(a)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};s.processDataByFilters=function(i,a){var o=0,l=i||"",c=[];for(typeof(a=a||[])=="string"&&(a=[a]),o=0;o<a.length;o+=1)switch(a[o]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=r(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(yt.API),function(s){s.loadFile=function(e,t,n){return function(r,i,a){i=i!==!1,a=typeof a=="function"?a:function(){};var o=void 0;try{o=function(l,c,u){var f=new XMLHttpRequest,p=0,m=function(b){var y=b.length,S=[],w=String.fromCharCode;for(p=0;p<y;p+=1)S.push(w(255&b.charCodeAt(p)));return S.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(m(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return m(f.responseText)}(r,i,a)}catch{}return o}(e,t,n)},s.loadImageFile=s.loadFile}(yt.API),function(s){function e(){return(bt.html2canvas?Promise.resolve(bt.html2canvas):Ku(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function t(){return(bt.DOMPurify?Promise.resolve(bt.DOMPurify):Ku(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var n=function(a){var o=fn(a);return o==="undefined"?"undefined":o==="string"||a instanceof String?"string":o==="number"||a instanceof Number?"number":o==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":o==="object"?"object":"unknown"},r=function(a,o){var l=document.createElement(a);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function a(o){var l=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),c=a.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,a,1,[a])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(a,o){return a.__proto__=o||i.prototype,a},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(a,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a)){case"string":return this.then(t).then(function(l){return this.set({src:r("div",{innerHTML:a,dompurify:l})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},i.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(e).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var m=c[p],b=m.src.find(function(y){return y.format==="truetype"});b&&l.addFont(b.url,m.ref.name,m.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(a,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(a,o):this.outputPdf(a,o)},i.prototype.outputPdf=function(a,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,o)})},i.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},i.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(a){if(n(a)!=="object")return this;var o=Object.keys(a||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=a[l]};switch(l){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[l]=a[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(a,o){return this.then(function(){var l=a in i.template.prop?this.prop[a]:this.opt[a];return o?o(l):l})},i.prototype.setMargin=function(a){return this.then(function(){switch(n(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},i.prototype.setPageSize=function(a){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(a=a||yt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:o(a.inner.width,a.k),height:o(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},i.prototype.setProgress=function(a,o,l,c){return a!=null&&(this.progress.val=a),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(a,o,l,c){return this.setProgress(a?this.progress.val+a:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(a,o){var l=this;return this.thenCore(a,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,c),f}).then(c,u).then(function(f){return l.updateProgress(1),f})})},i.prototype.thenCore=function(a,o,l){l=l||Promise.prototype.then,a&&(a=a.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=l.call(c,a,o);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(a,o){return Promise.prototype.then.call(this,a,o)},i.prototype.thenList=function(a){var o=this;return a.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(a){a&&(a=a.bind(this));var o=Promise.prototype.catch.call(this,a);return i.convert(o,this)},i.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},i.prototype.error=function(a){return this.then(function(){throw new Error(a)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,yt.getPageSize=function(a,o,l){if(fn(a)==="object"){var c=a;a=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",a=(""+(a||"P")).toLowerCase();var u,f=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var m,b=0,y=0;if(p.hasOwnProperty(f))b=p[f][1]/u,y=p[f][0]/u;else try{b=l[1],y=l[0]}catch{throw new Error("Invalid format: "+l)}if(a==="p"||a==="portrait")a="p",y>b&&(m=y,y=b,b=m);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",b>y&&(m=y,y=b,b=m)}return{width:y,height:b,unit:o,k:u,orientation:a}},s.html=function(a,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(ES):null;var l=new i(o);return o.worker?l:l.from(a).doCallback()}}(yt.API),yt.API.addJS=function(s){return OE=s,this.internal.events.subscribe("postPutResources",function(){fb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(fb+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),RE=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+OE+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){fb!==void 0&&RE!==void 0&&this.internal.out("/Names <</JavaScript "+fb+" 0 R>>")}),this},function(s){var e;s.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=t.outline.render().split(/\r\n/),i=0;i<r.length;i++){var a=r[i],o=n.exec(a);if(o!=null){var l=o[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(a)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var f=t.internal.newObject();u.push(f);var p=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var m=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<u.length;i++)t.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+m+" 0 R"),t.internal.write(">>","endobj")}}]),s.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),s.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,r,i){var a={title:r,options:i,children:[]};return n==null&&(n=this.root),n.children.push(a),a},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var a=n.children[i];this.objStart(a),this.line("/Title "+this.makeString(a.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1])));var o=this.count=this.count_r({count:0},a);if(o>0&&this.line("/Count "+o),a.options&&a.options.pageNumber){var l=t.internal.getPageInfo(a.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,r){for(var i=0;i<r.children.length;i++)n.count++,this.count_r(n,r.children[i]);return n.count}}])}(yt.API),function(s){var e=[192,193,194,195,196,197,198,199];s.processJPEG=function(t,n,r,i,a,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=a||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(l=function(f){for(var p,m=256*f.charCodeAt(4)+f.charCodeAt(5),b=f.length,y={width:0,height:0,numcomponents:1},S=4;S<b;S+=2){if(S+=m,e.indexOf(f.charCodeAt(S+1))!==-1){p=256*f.charCodeAt(S+5)+f.charCodeAt(S+6),y={width:256*f.charCodeAt(S+7)+f.charCodeAt(S+8),height:p,numcomponents:f.charCodeAt(S+9)};break}m=256*f.charCodeAt(S+2)+f.charCodeAt(S+3)}return y}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:t,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:r}}return u}}(yt.API);var Gf,pb,ME,FE,DE,t$=function(){var s,e,t;function n(i){var a,o,l,c,u,f,p,m,b,y,S,w,_,k;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(a=this.readUInt32(),b=(function(){var C,B;for(B=[],C=0;C<4;++C)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(a);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,f.delay=1e3*u/c,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(b==="fdAT"&&(this.pos+=4,a-=4),i=(f!=null?f.data:void 0)||this.imgData,w=0;0<=a?w<a:w>a;0<=a?++w:--w)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(a),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((y=l-this.transparency.indexed.length)>0)for(_=0;0<=y?_<y:_>y;0<=y?++_:--_)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(a)[0];break;case 2:this.transparency.rgb=this.read(a)}break;case"tEXt":p=(S=this.read(a)).indexOf(0),m=String.fromCharCode.apply(String,S.slice(0,p)),this.text[m]=String.fromCharCode.apply(String,S.slice(p+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(k=this.colorType)===4||k===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=a}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var a,o;for(o=[],a=0;0<=i?a<i:a>i;0<=i?++a:--a)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var a=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*a),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(f,p,m,b){var y,S,w,_,k,C,B,F,j,T,W,Y,I,O,X,K,ne,te,ue,Z,he,me=Math.ceil((c.width-f)/m),Ne=Math.ceil((c.height-p)/b),L=c.width==me&&c.height==Ne;for(O=a*me,Y=L?o:new Uint8Array(O*Ne),C=i.length,I=0,S=0;I<Ne&&l<C;){switch(i[l++]){case 0:for(_=ne=0;ne<O;_=ne+=1)Y[S++]=i[l++];break;case 1:for(_=te=0;te<O;_=te+=1)y=i[l++],k=_<a?0:Y[S-a],Y[S++]=(y+k)%256;break;case 2:for(_=ue=0;ue<O;_=ue+=1)y=i[l++],w=(_-_%a)/a,X=I&&Y[(I-1)*O+w*a+_%a],Y[S++]=(X+y)%256;break;case 3:for(_=Z=0;Z<O;_=Z+=1)y=i[l++],w=(_-_%a)/a,k=_<a?0:Y[S-a],X=I&&Y[(I-1)*O+w*a+_%a],Y[S++]=(y+Math.floor((k+X)/2))%256;break;case 4:for(_=he=0;he<O;_=he+=1)y=i[l++],w=(_-_%a)/a,k=_<a?0:Y[S-a],I===0?X=K=0:(X=Y[(I-1)*O+w*a+_%a],K=w&&Y[(I-1)*O+(w-1)*a+_%a]),B=k+X-K,F=Math.abs(B-k),T=Math.abs(B-X),W=Math.abs(B-K),j=F<=T&&F<=W?k:T<=W?X:K,Y[S++]=(y+j)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!L){var V=((p+I*b)*c.width+f)*a,Q=I*O;for(_=0;_<me;_+=1){for(var se=0;se<a;se+=1)o[V++]=Y[Q++];V+=(m-1)*a}}I++}}return i=jB(i),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var i,a,o,l,c,u,f,p,m;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,i=0,a=f=0,p=o.length;f<p;a=f+=3)c[l++]=o[a],c[l++]=o[a+1],c[l++]=o[a+2],c[l++]=(m=u[i++])!=null?m:255;return c},n.prototype.copyToImageData=function(i,a){var o,l,c,u,f,p,m,b,y,S,w;if(l=this.colors,y=null,o=this.hasAlphaChannel,this.palette.length&&(y=(w=this._decodedPalette)!=null?w:this._decodedPalette=this.decodePalette(),l=4,o=!0),b=(c=i.data||i).length,f=y||a,u=p=0,l===1)for(;u<b;)m=y?4*a[u/4]:p,S=f[m++],c[u++]=S,c[u++]=S,c[u++]=S,c[u++]=o?f[m++]:255,p=m;else for(;u<b;)m=y?4*a[u/4]:p,c[u++]=f[m++],c[u++]=f[m++],c[u++]=f[m++],c[u++]=o?f[m++]:255,p=m},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var r=function(){if(Object.prototype.toString.call(bt)==="[object Window]"){try{e=bt.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return r(),s=function(i){var a;if(r()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(a=new Image).src=e.toDataURL(),a;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var a,o,l,c,u,f,p,m;if(this.animation){for(m=[],o=u=0,f=(p=this.animation.frames).length;u<f;o=++u)a=p[o],l=i.createImageData(a.width,a.height),c=this.decodePixels(new Uint8Array(a.data)),this.copyToImageData(l,c),a.imageData=l,m.push(a.image=s(l));return m}},n.prototype.renderFrame=function(i,a){var o,l,c;return o=(l=this.animation.frames)[a],c=l[a-1],a===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var a,o,l,c,u,f,p=this;return o=0,f=this.animation,c=f.numFrames,l=f.frames,u=f.numPlays,(a=function(){var m,b;if(m=o++%c,b=l[m],p.renderFrame(i,m),c>1&&o/c<u)return p.animation._timeout=setTimeout(a,b.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var a,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,a=i.getContext("2d"),this.animation?(this.decodeFrames(a),this.animate(a)):(o=a.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),a.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function n$(s){var e=0;if(s[e++]!==71||s[e++]!==73||s[e++]!==70||s[e++]!==56||(s[e++]+1&253)!=56||s[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=s[e++]|s[e++]<<8,n=s[e++]|s[e++]<<8,r=s[e++],i=r>>7,a=1<<(7&r)+1;s[e++],s[e++];var o=null,l=null;i&&(o=e,l=a,e+=3*a);var c=!0,u=[],f=0,p=null,m=0,b=null;for(this.width=t,this.height=n;c&&e<s.length;)switch(s[e++]){case 33:switch(s[e++]){case 255:if(s[e]!==11||s[e+1]==78&&s[e+2]==69&&s[e+3]==84&&s[e+4]==83&&s[e+5]==67&&s[e+6]==65&&s[e+7]==80&&s[e+8]==69&&s[e+9]==50&&s[e+10]==46&&s[e+11]==48&&s[e+12]==3&&s[e+13]==1&&s[e+16]==0)e+=14,b=s[e++]|s[e++]<<8,e++;else for(e+=12;;){if(!((I=s[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(s[e++]!==4||s[e+4]!==0)throw new Error("Invalid graphics extension block.");var y=s[e++];f=s[e++]|s[e++]<<8,p=s[e++],!(1&y)&&(p=null),m=y>>2&7,e++;break;case 254:for(;;){if(!((I=s[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+s[e-1].toString(16))}break;case 44:var S=s[e++]|s[e++]<<8,w=s[e++]|s[e++]<<8,_=s[e++]|s[e++]<<8,k=s[e++]|s[e++]<<8,C=s[e++],B=C>>6&1,F=1<<(7&C)+1,j=o,T=l,W=!1;C>>7&&(W=!0,j=e,T=F,e+=3*F);var Y=e;for(e++;;){var I;if(!((I=s[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}u.push({x:S,y:w,width:_,height:k,has_local_palette:W,palette_offset:j,palette_size:T,data_offset:Y,data_length:e-Y,transparent_index:p,interlaced:!!B,delay:f,disposal:m});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+s[e-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return b},this.frameInfo=function(O){if(O<0||O>=u.length)throw new Error("Frame index out of range.");return u[O]},this.decodeAndBlitFrameBGRA=function(O,X){var K=this.frameInfo(O),ne=K.width*K.height,te=new Uint8Array(ne);BE(s,K.data_offset,te,ne);var ue=K.palette_offset,Z=K.transparent_index;Z===null&&(Z=256);var he=K.width,me=t-he,Ne=he,L=4*(K.y*t+K.x),V=4*((K.y+K.height)*t+K.x),Q=L,se=4*me;K.interlaced===!0&&(se+=4*t*7);for(var re=8,de=0,le=te.length;de<le;++de){var we=te[de];if(Ne===0&&(Ne=he,(Q+=se)>=V&&(se=4*me+4*t*(re-1),Q=L+(he+me)*(re<<1),re>>=1)),we===Z)Q+=4;else{var Le=s[ue+3*we],je=s[ue+3*we+1],Fe=s[ue+3*we+2];X[Q++]=Fe,X[Q++]=je,X[Q++]=Le,X[Q++]=255}--Ne}},this.decodeAndBlitFrameRGBA=function(O,X){var K=this.frameInfo(O),ne=K.width*K.height,te=new Uint8Array(ne);BE(s,K.data_offset,te,ne);var ue=K.palette_offset,Z=K.transparent_index;Z===null&&(Z=256);var he=K.width,me=t-he,Ne=he,L=4*(K.y*t+K.x),V=4*((K.y+K.height)*t+K.x),Q=L,se=4*me;K.interlaced===!0&&(se+=4*t*7);for(var re=8,de=0,le=te.length;de<le;++de){var we=te[de];if(Ne===0&&(Ne=he,(Q+=se)>=V&&(se=4*me+4*t*(re-1),Q=L+(he+me)*(re<<1),re>>=1)),we===Z)Q+=4;else{var Le=s[ue+3*we],je=s[ue+3*we+1],Fe=s[ue+3*we+2];X[Q++]=Le,X[Q++]=je,X[Q++]=Fe,X[Q++]=255}--Ne}}}function BE(s,e,t,n){for(var r=s[e++],i=1<<r,a=i+1,o=a+1,l=r+1,c=(1<<l)-1,u=0,f=0,p=0,m=s[e++],b=new Int32Array(4096),y=null;;){for(;u<16&&m!==0;)f|=s[e++]<<u,u+=8,m===1?m=s[e++]:--m;if(u<l)break;var S=f&c;if(f>>=l,u-=l,S!==i){if(S===a)break;for(var w=S<o?S:y,_=0,k=w;k>i;)k=b[k]>>8,++_;var C=k;if(p+_+(w!==S?1:0)>n)return void _n.log("Warning, gif stream longer than expected.");t[p++]=C;var B=p+=_;for(w!==S&&(t[p++]=C),k=w;_--;)k=b[k],t[--B]=255&k,k>>=8;y!==null&&o<4096&&(b[o++]=y<<8|C,o>=c+1&&l<12&&(++l,c=c<<1|1)),y=S}else o=a+1,c=(1<<(l=r+1))-1,y=null}return p!==n&&_n.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function $x(s){var e,t,n,r,i,a=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),p=new Array(65535),m=new Array(64),b=new Array(64),y=[],S=0,w=7,_=new Array(64),k=new Array(64),C=new Array(64),B=new Array(256),F=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],W=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],O=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],X=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function te(L,V){for(var Q=0,se=0,re=new Array,de=1;de<=16;de++){for(var le=1;le<=L[de];le++)re[V[se]]=[],re[V[se]][0]=Q,re[V[se]][1]=de,se++,Q++;Q*=2}return re}function ue(L){for(var V=L[0],Q=L[1]-1;Q>=0;)V&1<<Q&&(S|=1<<w),Q--,--w<0&&(S==255?(Z(255),Z(0)):Z(S),w=7,S=0)}function Z(L){y.push(L)}function he(L){Z(L>>8&255),Z(255&L)}function me(L,V,Q,se,re){for(var de,le=re[0],we=re[240],Le=function(Re,$e){var ze,De,Ke,kt,_t,Tt,Vt,Mt,pt,Ft,qe=0;for(pt=0;pt<8;++pt){ze=Re[qe],De=Re[qe+1],Ke=Re[qe+2],kt=Re[qe+3],_t=Re[qe+4],Tt=Re[qe+5],Vt=Re[qe+6];var Zt=ze+(Mt=Re[qe+7]),Bt=ze-Mt,Zr=De+Vt,on=De-Vt,bn=Ke+Tt,ki=Ke-Tt,Kt=kt+_t,So=kt-_t,Pn=Zt+Kt,ei=Zt-Kt,ra=Zr+bn,Ln=Zr-bn;Re[qe]=Pn+ra,Re[qe+4]=Pn-ra;var mt=.707106781*(Ln+ei);Re[qe+2]=ei+mt,Re[qe+6]=ei-mt;var Ht=.382683433*((Pn=So+ki)-(Ln=on+Bt)),ia=.5411961*Pn+Ht,Qn=1.306562965*Ln+Ht,aa=.707106781*(ra=ki+on),ti=Bt+aa,lt=Bt-aa;Re[qe+5]=lt+ia,Re[qe+3]=lt-ia,Re[qe+1]=ti+Qn,Re[qe+7]=ti-Qn,qe+=8}for(qe=0,pt=0;pt<8;++pt){ze=Re[qe],De=Re[qe+8],Ke=Re[qe+16],kt=Re[qe+24],_t=Re[qe+32],Tt=Re[qe+40],Vt=Re[qe+48];var Qs=ze+(Mt=Re[qe+56]),ni=ze-Mt,Fs=De+Vt,$n=De-Vt,On=Ke+Tt,Rr=Ke-Tt,Or=kt+_t,Oa=kt-_t,Mr=Qs+Or,Un=Qs-Or,ps=Fs+On,oa=Fs-On;Re[qe]=Mr+ps,Re[qe+32]=Mr-ps;var Zs=.707106781*(oa+Un);Re[qe+16]=Un+Zs,Re[qe+48]=Un-Zs;var la=.382683433*((Mr=Oa+Rr)-(oa=$n+ni)),si=.5411961*Mr+la,ml=1.306562965*oa+la,Ma=.707106781*(ps=Rr+$n),ko=ni+Ma,gl=ni-Ma;Re[qe+40]=gl+si,Re[qe+24]=gl-si,Re[qe+8]=ko+ml,Re[qe+56]=ko-ml,qe++}for(pt=0;pt<64;++pt)Ft=Re[pt]*$e[pt],m[pt]=Ft>0?Ft+.5|0:Ft-.5|0;return m}(L,V),je=0;je<64;++je)b[j[je]]=Le[je];var Fe=b[0]-Q;Q=b[0],Fe==0?ue(se[0]):(ue(se[p[de=32767+Fe]]),ue(f[de]));for(var Be=63;Be>0&&b[Be]==0;)Be--;if(Be==0)return ue(le),Q;for(var at,Se=1;Se<=Be;){for(var ee=Se;b[Se]==0&&Se<=Be;)++Se;var St=Se-ee;if(St>=16){at=St>>4;for(var nt=1;nt<=at;++nt)ue(we);St&=15}de=32767+b[Se],ue(re[(St<<4)+p[de]]),ue(f[de]),Se++}return Be!=63&&ue(le),Q}function Ne(L){L=Math.min(Math.max(L,1),100),i!=L&&(function(V){for(var Q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var re=a((Q[se]*V+50)/100);re=Math.min(Math.max(re,1),255),o[j[se]]=re}for(var de=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],le=0;le<64;le++){var we=a((de[le]*V+50)/100);we=Math.min(Math.max(we,1),255),l[j[le]]=we}for(var Le=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],je=0,Fe=0;Fe<8;Fe++)for(var Be=0;Be<8;Be++)c[je]=1/(o[j[je]]*Le[Fe]*Le[Be]*8),u[je]=1/(l[j[je]]*Le[Fe]*Le[Be]*8),je++}(L<50?Math.floor(5e3/L):Math.floor(200-2*L)),i=L)}this.encode=function(L,V){V&&Ne(V),y=new Array,S=0,w=7,he(65496),he(65504),he(16),Z(74),Z(70),Z(73),Z(70),Z(0),Z(1),Z(1),Z(0),he(1),he(1),Z(0),Z(0),function(){he(65499),he(132),Z(0);for(var De=0;De<64;De++)Z(o[De]);Z(1);for(var Ke=0;Ke<64;Ke++)Z(l[Ke])}(),function(De,Ke){he(65472),he(17),Z(8),he(Ke),he(De),Z(3),Z(1),Z(17),Z(0),Z(2),Z(17),Z(1),Z(3),Z(17),Z(1)}(L.width,L.height),function(){he(65476),he(418),Z(0);for(var De=0;De<16;De++)Z(T[De+1]);for(var Ke=0;Ke<=11;Ke++)Z(W[Ke]);Z(16);for(var kt=0;kt<16;kt++)Z(Y[kt+1]);for(var _t=0;_t<=161;_t++)Z(I[_t]);Z(1);for(var Tt=0;Tt<16;Tt++)Z(O[Tt+1]);for(var Vt=0;Vt<=11;Vt++)Z(X[Vt]);Z(17);for(var Mt=0;Mt<16;Mt++)Z(K[Mt+1]);for(var pt=0;pt<=161;pt++)Z(ne[pt])}(),he(65498),he(12),Z(3),Z(1),Z(0),Z(2),Z(17),Z(3),Z(17),Z(0),Z(63),Z(0);var Q=0,se=0,re=0;S=0,w=7,this.encode.displayName="_encode_";for(var de,le,we,Le,je,Fe,Be,at,Se,ee=L.data,St=L.width,nt=L.height,Re=4*St,$e=0;$e<nt;){for(de=0;de<Re;){for(je=Re*$e+de,Be=-1,at=0,Se=0;Se<64;Se++)Fe=je+(at=Se>>3)*Re+(Be=4*(7&Se)),$e+at>=nt&&(Fe-=Re*($e+1+at-nt)),de+Be>=Re&&(Fe-=de+Be-Re+4),le=ee[Fe++],we=ee[Fe++],Le=ee[Fe++],_[Se]=(F[le]+F[we+256>>0]+F[Le+512>>0]>>16)-128,k[Se]=(F[le+768>>0]+F[we+1024>>0]+F[Le+1280>>0]>>16)-128,C[Se]=(F[le+1280>>0]+F[we+1536>>0]+F[Le+1792>>0]>>16)-128;Q=me(_,c,Q,e,n),se=me(k,u,se,t,r),re=me(C,u,re,t,r),de+=32}$e+=8}if(w>=0){var ze=[];ze[1]=w+1,ze[0]=(1<<w+1)-1,ue(ze)}return he(65497),new Uint8Array(y)},s=s||50,function(){for(var L=String.fromCharCode,V=0;V<256;V++)B[V]=L(V)}(),e=te(T,W),t=te(O,X),n=te(Y,I),r=te(K,ne),function(){for(var L=1,V=2,Q=1;Q<=15;Q++){for(var se=L;se<V;se++)p[32767+se]=Q,f[32767+se]=[],f[32767+se][1]=Q,f[32767+se][0]=se;for(var re=-(V-1);re<=-L;re++)p[32767+re]=Q,f[32767+re]=[],f[32767+re][1]=Q,f[32767+re][0]=V-1+re;L<<=1,V<<=1}}(),function(){for(var L=0;L<256;L++)F[L]=19595*L,F[L+256>>0]=38470*L,F[L+512>>0]=7471*L+32768,F[L+768>>0]=-11059*L,F[L+1024>>0]=-21709*L,F[L+1280>>0]=32768*L+8421375,F[L+1536>>0]=-27439*L,F[L+1792>>0]=-5329*L}(),Ne(s)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wa(s,e){if(this.pos=0,this.buffer=s,this.datav=new DataView(s.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function $E(s){function e(T){if(!T)throw Error("assert :P")}function t(T,W,Y){for(var I=0;4>I;I++)if(T[W+I]!=Y.charCodeAt(I))return!0;return!1}function n(T,W,Y,I,O){for(var X=0;X<O;X++)T[W+X]=Y[I+X]}function r(T,W,Y,I){for(var O=0;O<I;O++)T[W+O]=Y}function i(T){return new Int32Array(T)}function a(T,W){for(var Y=[],I=0;I<T;I++)Y.push(new W);return Y}function o(T,W){var Y=[];return function I(O,X,K){for(var ne=K[X],te=0;te<ne&&(O.push(K.length>X+1?[]:new W),!(K.length<X+1));te++)I(O[te],X+1,K)}(Y,0,T),Y}var l=function(){var T=this;function W(h,g){for(var A=1<<g-1>>>0;h&A;)A>>>=1;return A?(h&A-1)+A:h}function Y(h,g,A,N,R){e(!(N%A));do h[g+(N-=A)]=R;while(0<N)}function I(h,g,A,N,R){if(e(2328>=R),512>=R)var D=i(512);else if((D=i(R))==null)return 0;return function(U,q,H,G,ae,ye){var be,pe,Pe=q,Ae=1<<H,oe=i(16),ce=i(16);for(e(ae!=0),e(G!=null),e(U!=null),e(0<H),pe=0;pe<ae;++pe){if(15<G[pe])return 0;++oe[G[pe]]}if(oe[0]==ae)return 0;for(ce[1]=0,be=1;15>be;++be){if(oe[be]>1<<be)return 0;ce[be+1]=ce[be]+oe[be]}for(pe=0;pe<ae;++pe)be=G[pe],0<G[pe]&&(ye[ce[be]++]=pe);if(ce[15]==1)return(G=new O).g=0,G.value=ye[0],Y(U,Pe,1,Ae,G),Ae;var Ce,Te=-1,Ee=Ae-1,Xe=0,Ue=1,ht=1,Ve=1<<H;for(pe=0,be=1,ae=2;be<=H;++be,ae<<=1){if(Ue+=ht<<=1,0>(ht-=oe[be]))return 0;for(;0<oe[be];--oe[be])(G=new O).g=be,G.value=ye[pe++],Y(U,Pe+Xe,ae,Ve,G),Xe=W(Xe,be)}for(be=H+1,ae=2;15>=be;++be,ae<<=1){if(Ue+=ht<<=1,0>(ht-=oe[be]))return 0;for(;0<oe[be];--oe[be]){if(G=new O,(Xe&Ee)!=Te){for(Pe+=Ve,Ce=1<<(Te=be)-H;15>Te&&!(0>=(Ce-=oe[Te]));)++Te,Ce<<=1;Ae+=Ve=1<<(Ce=Te-H),U[q+(Te=Xe&Ee)].g=Ce+H,U[q+Te].value=Pe-q-Te}G.g=be-H,G.value=ye[pe++],Y(U,Pe+(Xe>>H),ae,Ve,G),Xe=W(Xe,be)}}return Ue!=2*ce[15]-1?0:Ae}(h,g,A,N,R,D)}function O(){this.value=this.g=0}function X(){this.value=this.g=0}function K(){this.G=a(5,O),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=a(er,X)}function ne(h,g,A,N){e(h!=null),e(g!=null),e(2147483648>N),h.Ca=254,h.I=0,h.b=-8,h.Ka=0,h.oa=g,h.pa=A,h.Jd=g,h.Yc=A+N,h.Zc=4<=N?A+N-4+1:A,de(h)}function te(h,g){for(var A=0;0<g--;)A|=we(h,128)<<g;return A}function ue(h,g){var A=te(h,g);return le(h)?-A:A}function Z(h,g,A,N){var R,D=0;for(e(h!=null),e(g!=null),e(4294967288>N),h.Sb=N,h.Ra=0,h.u=0,h.h=0,4<N&&(N=4),R=0;R<N;++R)D+=g[A+R]<<8*R;h.Ra=D,h.bb=N,h.oa=g,h.pa=A}function he(h){for(;8<=h.u&&h.bb<h.Sb;)h.Ra>>>=8,h.Ra+=h.oa[h.pa+h.bb]<<kf-8>>>0,++h.bb,h.u-=8;Q(h)&&(h.h=1,h.u=0)}function me(h,g){if(e(0<=g),!h.h&&g<=Sf){var A=V(h)&Af[g];return h.u+=g,he(h),A}return h.h=1,h.u=0}function Ne(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(h){return h.Ra>>>(h.u&kf-1)>>>0}function Q(h){return e(h.bb<=h.Sb),h.h||h.bb==h.Sb&&h.u>kf}function se(h,g){h.u=g,h.h=Q(h)}function re(h){h.u>=kg&&(e(h.u>=kg),he(h))}function de(h){e(h!=null&&h.oa!=null),h.pa<h.Zc?(h.I=(h.oa[h.pa++]|h.I<<8)>>>0,h.b+=8):(e(h!=null&&h.oa!=null),h.pa<h.Yc?(h.b+=8,h.I=h.oa[h.pa++]|h.I<<8):h.Ka?h.b=0:(h.I<<=8,h.b+=8,h.Ka=1))}function le(h){return te(h,1)}function we(h,g){var A=h.Ca;0>h.b&&de(h);var N=h.b,R=A*g>>>8,D=(h.I>>>N>R)+0;for(D?(A-=R,h.I-=R+1<<N>>>0):A=R+1,N=A,R=0;256<=N;)R+=8,N>>=8;return N=7^R+ii[N],h.b-=N,h.Ca=(A<<N)-1,D}function Le(h,g,A){h[g+0]=A>>24&255,h[g+1]=A>>16&255,h[g+2]=A>>8&255,h[g+3]=A>>0&255}function je(h,g){return h[g+0]<<0|h[g+1]<<8}function Fe(h,g){return je(h,g)|h[g+2]<<16}function Be(h,g){return je(h,g)|je(h,g+2)<<16}function at(h,g){var A=1<<g;return e(h!=null),e(0<g),h.X=i(A),h.X==null?0:(h.Mb=32-g,h.Xa=g,1)}function Se(h,g){e(h!=null),e(g!=null),e(h.Xa==g.Xa),n(g.X,0,h.X,0,1<<g.Xa)}function ee(){this.X=[],this.Xa=this.Mb=0}function St(h,g,A,N){e(A!=null),e(N!=null);var R=A[0],D=N[0];return R==0&&(R=(h*D+g/2)/g),D==0&&(D=(g*R+h/2)/h),0>=R||0>=D?0:(A[0]=R,N[0]=D,1)}function nt(h,g){return h+(1<<g)-1>>>g}function Re(h,g){return((4278255360&h)+(4278255360&g)>>>0&4278255360)+((16711935&h)+(16711935&g)>>>0&16711935)>>>0}function $e(h,g){T[g]=function(A,N,R,D,U,q,H){var G;for(G=0;G<U;++G){var ae=T[h](q[H+G-1],R,D+G);q[H+G]=Re(A[N+G],ae)}}}function ze(){this.ud=this.hd=this.jd=0}function De(h,g){return((4278124286&(h^g))>>>1)+(h&g)>>>0}function Ke(h){return 0<=h&&256>h?h:0>h?0:255<h?255:void 0}function kt(h,g){return Ke(h+(h-g+.5>>1))}function _t(h,g,A){return Math.abs(g-A)-Math.abs(h-A)}function Tt(h,g,A,N,R,D,U){for(N=D[U-1],A=0;A<R;++A)D[U+A]=N=Re(h[g+A],N)}function Vt(h,g,A,N,R){var D;for(D=0;D<A;++D){var U=h[g+D],q=U>>8&255,H=16711935&(H=(H=16711935&U)+((q<<16)+q));N[R+D]=(4278255360&U)+H>>>0}}function Mt(h,g){g.jd=h>>0&255,g.hd=h>>8&255,g.ud=h>>16&255}function pt(h,g,A,N,R,D){var U;for(U=0;U<N;++U){var q=g[A+U],H=q>>>8,G=q,ae=255&(ae=(ae=q>>>16)+((h.jd<<24>>24)*(H<<24>>24)>>>5));G=255&(G=(G=G+((h.hd<<24>>24)*(H<<24>>24)>>>5))+((h.ud<<24>>24)*(ae<<24>>24)>>>5)),R[D+U]=(4278255360&q)+(ae<<16)+G}}function Ft(h,g,A,N,R){T[g]=function(D,U,q,H,G,ae,ye,be,pe){for(H=ye;H<be;++H)for(ye=0;ye<pe;++ye)G[ae++]=R(q[N(D[U++])])},T[h]=function(D,U,q,H,G,ae,ye){var be=8>>D.b,pe=D.Ea,Pe=D.K[0],Ae=D.w;if(8>be)for(D=(1<<D.b)-1,Ae=(1<<be)-1;U<q;++U){var oe,ce=0;for(oe=0;oe<pe;++oe)oe&D||(ce=N(H[G++])),ae[ye++]=R(Pe[ce&Ae]),ce>>=be}else T["VP8LMapColor"+A](H,G,Pe,Ae,ae,ye,U,q,pe)}}function qe(h,g,A,N,R){for(A=g+A;g<A;){var D=h[g++];N[R++]=D>>16&255,N[R++]=D>>8&255,N[R++]=D>>0&255}}function Zt(h,g,A,N,R){for(A=g+A;g<A;){var D=h[g++];N[R++]=D>>16&255,N[R++]=D>>8&255,N[R++]=D>>0&255,N[R++]=D>>24&255}}function Bt(h,g,A,N,R){for(A=g+A;g<A;){var D=(U=h[g++])>>16&240|U>>12&15,U=U>>0&240|U>>28&15;N[R++]=D,N[R++]=U}}function Zr(h,g,A,N,R){for(A=g+A;g<A;){var D=(U=h[g++])>>16&248|U>>13&7,U=U>>5&224|U>>3&31;N[R++]=D,N[R++]=U}}function on(h,g,A,N,R){for(A=g+A;g<A;){var D=h[g++];N[R++]=D>>0&255,N[R++]=D>>8&255,N[R++]=D>>16&255}}function bn(h,g,A,N,R,D){if(D==0)for(A=g+A;g<A;)Le(N,((D=h[g++])[0]>>24|D[1]>>8&65280|D[2]<<8&16711680|D[3]<<24)>>>0),R+=32;else n(N,R,h,g,A)}function ki(h,g){T[g][0]=T[h+"0"],T[g][1]=T[h+"1"],T[g][2]=T[h+"2"],T[g][3]=T[h+"3"],T[g][4]=T[h+"4"],T[g][5]=T[h+"5"],T[g][6]=T[h+"6"],T[g][7]=T[h+"7"],T[g][8]=T[h+"8"],T[g][9]=T[h+"9"],T[g][10]=T[h+"10"],T[g][11]=T[h+"11"],T[g][12]=T[h+"12"],T[g][13]=T[h+"13"],T[g][14]=T[h+"0"],T[g][15]=T[h+"0"]}function Kt(h){return h==y5||h==b5||h==yy||h==w5}function So(){this.eb=[],this.size=this.A=this.fb=0}function Pn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ei(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new So,this.f.kb=new Pn,this.sd=null}function ra(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ln(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function mt(h){return alert("todo:WebPSamplerProcessPlane"),h.T}function Ht(h,g){var A=h.T,N=g.ba.f.RGBA,R=N.eb,D=N.fb+h.ka*N.A,U=pa[g.ba.S],q=h.y,H=h.O,G=h.f,ae=h.N,ye=h.ea,be=h.W,pe=g.cc,Pe=g.dc,Ae=g.Mc,oe=g.Nc,ce=h.ka,Ce=h.ka+h.T,Te=h.U,Ee=Te+1>>1;for(ce==0?U(q,H,null,null,G,ae,ye,be,G,ae,ye,be,R,D,null,null,Te):(U(g.ec,g.fc,q,H,pe,Pe,Ae,oe,G,ae,ye,be,R,D-N.A,R,D,Te),++A);ce+2<Ce;ce+=2)pe=G,Pe=ae,Ae=ye,oe=be,ae+=h.Rc,be+=h.Rc,D+=2*N.A,U(q,(H+=2*h.fa)-h.fa,q,H,pe,Pe,Ae,oe,G,ae,ye,be,R,D-N.A,R,D,Te);return H+=h.fa,h.j+Ce<h.o?(n(g.ec,g.fc,q,H,Te),n(g.cc,g.dc,G,ae,Ee),n(g.Mc,g.Nc,ye,be,Ee),A--):1&Ce||U(q,H,null,null,G,ae,ye,be,G,ae,ye,be,R,D+N.A,null,null,Te),A}function ia(h,g,A){var N=h.F,R=[h.J];if(N!=null){var D=h.U,U=g.ba.S,q=U==vy||U==yy;g=g.ba.f.RGBA;var H=[0],G=h.ka;H[0]=h.T,h.Kb&&(G==0?--H[0]:(--G,R[0]-=h.width),h.j+h.ka+h.T==h.o&&(H[0]=h.o-h.j-G));var ae=g.eb;G=g.fb+G*g.A,h=kn(N,R[0],h.width,D,H,ae,G+(q?0:3),g.A),e(A==H),h&&Kt(U)&&ha(ae,G,q,D,H,g.A)}return 0}function Qn(h){var g=h.ma,A=g.ba.S,N=11>A,R=A==my||A==gy||A==vy||A==v5||A==12||Kt(A);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Ag(g.Oa,h,R?11:12))return 0;if(R&&Kt(A)&&Ie(),h.da)alert("todo:use_scaling");else{if(N){if(g.Ib=mt,h.Kb){if(A=h.U+1>>1,g.memory=i(h.U+2*A),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+h.U,g.Mc=g.cc,g.Nc=g.dc+A,g.Ib=Ht,Ie()}}else alert("todo:EmitYUV");R&&(g.Jb=ia,N&&ge())}if(N&&!D3){for(h=0;256>h;++h)Lj[h]=89858*(h-128)+wy>>by,jj[h]=-22014*(h-128)+wy,Ij[h]=-45773*(h-128),Tj[h]=113618*(h-128)+wy>>by;for(h=Ig;h<A5;++h)g=76283*(h-16)+wy>>by,Rj[h-Ig]=Ci(g,255),Oj[h-Ig]=Ci(g+8>>4,15);D3=1}return 1}function aa(h){var g=h.ma,A=h.U,N=h.T;return e(!(1&h.ka)),0>=A||0>=N?0:(A=g.Ib(h,g),g.Jb!=null&&g.Jb(h,g,A),g.Dc+=A,1)}function ti(h){h.ma.memory=null}function lt(h,g,A,N){return me(h,8)!=47?0:(g[0]=me(h,14)+1,A[0]=me(h,14)+1,N[0]=me(h,1),me(h,3)!=0?0:!h.h)}function Qs(h,g){if(4>h)return h+1;var A=h-2>>1;return(2+(1&h)<<A)+me(g,A)+1}function ni(h,g){return 120<g?g-120:1<=(A=((A=gj[g-1])>>4)*h+(8-(15&A)))?A:1;var A}function Fs(h,g,A){var N=V(A),R=h[g+=255&N].g-8;return 0<R&&(se(A,A.u+8),N=V(A),g+=h[g].value,g+=N&(1<<R)-1),se(A,A.u+h[g].g),h[g].value}function $n(h,g,A){return A.g+=h.g,A.value+=h.value<<g>>>0,e(8>=A.g),h.g}function On(h,g,A){var N=h.xc;return e((g=N==0?0:h.vc[h.md*(A>>N)+(g>>N)])<h.Wb),h.Ya[g]}function Rr(h,g,A,N){var R=h.ab,D=h.c*g,U=h.C;g=U+g;var q=A,H=N;for(N=h.Ta,A=h.Ua;0<R--;){var G=h.gc[R],ae=U,ye=g,be=q,pe=H,Pe=(H=N,q=A,G.Ea);switch(e(ae<ye),e(ye<=G.nc),G.hc){case 2:ly(be,pe,(ye-ae)*Pe,H,q);break;case 0:var Ae=ae,oe=ye,ce=H,Ce=q,Te=(Ve=G).Ea;Ae==0&&(m5(be,pe,null,null,1,ce,Ce),Tt(be,pe+1,0,0,Te-1,ce,Ce+1),pe+=Te,Ce+=Te,++Ae);for(var Ee=1<<Ve.b,Xe=Ee-1,Ue=nt(Te,Ve.b),ht=Ve.K,Ve=Ve.w+(Ae>>Ve.b)*Ue;Ae<oe;){var sn=ht,cn=Ve,Yt=1;for(Ng(be,pe,ce,Ce-Te,1,ce,Ce);Yt<Te;){var Wt=(Yt&~Xe)+Ee;Wt>Te&&(Wt=Te),(0,Lc[sn[cn++]>>8&15])(be,pe+ +Yt,ce,Ce+Yt-Te,Wt-Yt,ce,Ce+Yt),Yt=Wt}pe+=Te,Ce+=Te,++Ae&Xe||(Ve+=Ue)}ye!=G.nc&&n(H,q-Pe,H,q+(ye-ae-1)*Pe,Pe);break;case 1:for(Pe=be,oe=pe,Te=(be=G.Ea)-(Ce=be&~(ce=(pe=1<<G.b)-1)),Ae=nt(be,G.b),Ee=G.K,G=G.w+(ae>>G.b)*Ae;ae<ye;){for(Xe=Ee,Ue=G,ht=new ze,Ve=oe+Ce,sn=oe+be;oe<Ve;)Mt(Xe[Ue++],ht),pd(ht,Pe,oe,pe,H,q),oe+=pe,q+=pe;oe<sn&&(Mt(Xe[Ue++],ht),pd(ht,Pe,oe,Te,H,q),oe+=Te,q+=Te),++ae&ce||(G+=Ae)}break;case 3:if(be==H&&pe==q&&0<G.b){for(oe=H,be=Pe=q+(ye-ae)*Pe-(Ce=(ye-ae)*nt(G.Ea,G.b)),pe=H,ce=q,Ae=[],Ce=(Te=Ce)-1;0<=Ce;--Ce)Ae[Ce]=pe[ce+Ce];for(Ce=Te-1;0<=Ce;--Ce)oe[be+Ce]=Ae[Ce];ca(G,ae,ye,H,Pe,H,q)}else ca(G,ae,ye,be,pe,H,q)}q=N,H=A}H!=A&&n(N,A,q,H,D)}function Or(h,g){var A=h.V,N=h.Ba+h.c*h.C,R=g-h.C;if(e(g<=h.l.o),e(16>=R),0<R){var D=h.l,U=h.Ta,q=h.Ua,H=D.width;if(Rr(h,R,A,N),R=q=[q],e((A=h.C)<(N=g)),e(D.v<D.va),N>D.o&&(N=D.o),A<D.j){var G=D.j-A;A=D.j,R[0]+=G*H}if(A>=N?A=0:(R[0]+=4*D.v,D.ka=A-D.j,D.U=D.va-D.v,D.T=N-A,A=1),A){if(q=q[0],11>(A=h.ca).S){var ae=A.f.RGBA,ye=(N=A.S,R=D.U,D=D.T,G=ae.eb,ae.A),be=D;for(ae=ae.fb+h.Ma*ae.A;0<be--;){var pe=U,Pe=q,Ae=R,oe=G,ce=ae;switch(N){case py:ai(pe,Pe,Ae,oe,ce);break;case my:Fr(pe,Pe,Ae,oe,ce);break;case y5:Fr(pe,Pe,Ae,oe,ce),ha(oe,ce,0,Ae,1,0);break;case P3:bl(pe,Pe,Ae,oe,ce);break;case gy:bn(pe,Pe,Ae,oe,ce,1);break;case b5:bn(pe,Pe,Ae,oe,ce,1),ha(oe,ce,0,Ae,1,0);break;case vy:bn(pe,Pe,Ae,oe,ce,0);break;case yy:bn(pe,Pe,Ae,oe,ce,0),ha(oe,ce,1,Ae,1,0);break;case v5:Tc(pe,Pe,Ae,oe,ce);break;case w5:Tc(pe,Pe,Ae,oe,ce),Sn(oe,ce,Ae,1,0);break;case L3:yl(pe,Pe,Ae,oe,ce);break;default:e(0)}q+=H,ae+=ye}h.Ma+=D}else alert("todo:EmitRescaledRowsYUVA");e(h.Ma<=A.height)}}h.C=g,e(h.C<=h.i)}function Oa(h){var g;if(0<h.ua)return 0;for(g=0;g<h.Wb;++g){var A=h.Ya[g].G,N=h.Ya[g].H;if(0<A[1][N[1]+0].g||0<A[2][N[2]+0].g||0<A[3][N[3]+0].g)return 0}return 1}function Mr(h,g,A,N,R,D){if(h.Z!=0){var U=h.qd,q=h.rd;for(e(Oc[h.Z]!=null);g<A;++g)Oc[h.Z](U,q,N,R,N,R,D),U=N,q=R,R+=D;h.qd=U,h.rd=q}}function Un(h,g){var A=h.l.ma,N=A.Z==0||A.Z==1?h.l.j:h.C;if(N=h.C<N?N:h.C,e(g<=h.l.o),g>N){var R=h.l.width,D=A.ca,U=A.tb+R*N,q=h.V,H=h.Ba+h.c*N,G=h.gc;e(h.ab==1),e(G[0].hc==3),cy(G[0],N,g,q,H,D,U),Mr(A,N,g,D,U,R)}h.C=h.Ma=g}function ps(h,g,A,N,R,D,U){var q=h.$/N,H=h.$%N,G=h.m,ae=h.s,ye=A+h.$,be=ye;R=A+N*R;var pe=A+N*D,Pe=280+ae.ua,Ae=h.Pb?q:16777216,oe=0<ae.ua?ae.Wa:null,ce=ae.wc,Ce=ye<pe?On(ae,H,q):null;e(h.C<D),e(pe<=R);var Te=!1;e:for(;;){for(;Te||ye<pe;){var Ee=0;if(q>=Ae){var Xe=ye-A;e((Ae=h).Pb),Ae.wd=Ae.m,Ae.xd=Xe,0<Ae.s.ua&&Se(Ae.s.Wa,Ae.s.vb),Ae=q+yj}if(H&ce||(Ce=On(ae,H,q)),e(Ce!=null),Ce.Qb&&(g[ye]=Ce.qb,Te=!0),!Te)if(re(G),Ce.jc){Ee=G,Xe=g;var Ue=ye,ht=Ce.pd[V(Ee)&er-1];e(Ce.jc),256>ht.g?(se(Ee,Ee.u+ht.g),Xe[Ue]=ht.value,Ee=0):(se(Ee,Ee.u+ht.g-256),e(256<=ht.value),Ee=ht.value),Ee==0&&(Te=!0)}else Ee=Fs(Ce.G[0],Ce.H[0],G);if(G.h)break;if(Te||256>Ee){if(!Te)if(Ce.nd)g[ye]=(Ce.qb|Ee<<8)>>>0;else{if(re(G),Te=Fs(Ce.G[1],Ce.H[1],G),re(G),Xe=Fs(Ce.G[2],Ce.H[2],G),Ue=Fs(Ce.G[3],Ce.H[3],G),G.h)break;g[ye]=(Ue<<24|Te<<16|Ee<<8|Xe)>>>0}if(Te=!1,++ye,++H>=N&&(H=0,++q,U!=null&&q<=D&&!(q%16)&&U(h,q),oe!=null))for(;be<ye;)Ee=g[be++],oe.X[(506832829*Ee&4294967295)>>>oe.Mb]=Ee}else if(280>Ee){if(Ee=Qs(Ee-256,G),Xe=Fs(Ce.G[4],Ce.H[4],G),re(G),Xe=ni(N,Xe=Qs(Xe,G)),G.h)break;if(ye-A<Xe||R-ye<Ee)break e;for(Ue=0;Ue<Ee;++Ue)g[ye+Ue]=g[ye+Ue-Xe];for(ye+=Ee,H+=Ee;H>=N;)H-=N,++q,U!=null&&q<=D&&!(q%16)&&U(h,q);if(e(ye<=R),H&ce&&(Ce=On(ae,H,q)),oe!=null)for(;be<ye;)Ee=g[be++],oe.X[(506832829*Ee&4294967295)>>>oe.Mb]=Ee}else{if(!(Ee<Pe))break e;for(Te=Ee-280,e(oe!=null);be<ye;)Ee=g[be++],oe.X[(506832829*Ee&4294967295)>>>oe.Mb]=Ee;Ee=ye,e(!(Te>>>(Xe=oe).Xa)),g[Ee]=Xe.X[Te],Te=!0}Te||e(G.h==Q(G))}if(h.Pb&&G.h&&ye<R)e(h.m.h),h.a=5,h.m=h.wd,h.$=h.xd,0<h.s.ua&&Se(h.s.vb,h.s.Wa);else{if(G.h)break e;U!=null&&U(h,q>D?D:q),h.a=0,h.$=ye-A}return 1}return h.a=3,0}function oa(h){e(h!=null),h.vc=null,h.yc=null,h.Ya=null;var g=h.Wa;g!=null&&(g.X=null),h.vb=null,e(h!=null)}function Zs(){var h=new p5;return h==null?null:(h.a=0,h.xb=j3,ki("Predictor","VP8LPredictors"),ki("Predictor","VP8LPredictors_C"),ki("PredictorAdd","VP8LPredictorsAdd"),ki("PredictorAdd","VP8LPredictorsAdd_C"),ly=Vt,pd=pt,ai=qe,Fr=Zt,Tc=Bt,yl=Zr,bl=on,T.VP8LMapColor32b=Nf,T.VP8LMapColor8b=uy,h)}function la(h,g,A,N,R){var D=1,U=[h],q=[g],H=N.m,G=N.s,ae=null,ye=0;e:for(;;){if(A)for(;D&&me(H,1);){var be=U,pe=q,Pe=N,Ae=1,oe=Pe.m,ce=Pe.gc[Pe.ab],Ce=me(oe,2);if(Pe.Oc&1<<Ce)D=0;else{switch(Pe.Oc|=1<<Ce,ce.hc=Ce,ce.Ea=be[0],ce.nc=pe[0],ce.K=[null],++Pe.ab,e(4>=Pe.ab),Ce){case 0:case 1:ce.b=me(oe,3)+2,Ae=la(nt(ce.Ea,ce.b),nt(ce.nc,ce.b),0,Pe,ce.K),ce.K=ce.K[0];break;case 3:var Te,Ee=me(oe,8)+1,Xe=16<Ee?0:4<Ee?1:2<Ee?2:3;if(be[0]=nt(ce.Ea,Xe),ce.b=Xe,Te=Ae=la(Ee,1,0,Pe,ce.K)){var Ue,ht=Ee,Ve=ce,sn=1<<(8>>Ve.b),cn=i(sn);if(cn==null)Te=0;else{var Yt=Ve.K[0],Wt=Ve.w;for(cn[0]=Ve.K[0][0],Ue=1;Ue<1*ht;++Ue)cn[Ue]=Re(Yt[Wt+Ue],cn[Ue-1]);for(;Ue<4*sn;++Ue)cn[Ue]=0;Ve.K[0]=null,Ve.K[0]=cn,Te=1}}Ae=Te;break;case 2:break;default:e(0)}D=Ae}}if(U=U[0],q=q[0],D&&me(H,1)&&!(D=1<=(ye=me(H,4))&&11>=ye)){N.a=3;break e}var xn;if(xn=D)t:{var mn,It,gs,oi=N,vs=U,li=q,un=ye,Pi=A,Li=oi.m,$s=oi.s,tr=[null],Br=1,ma=0,Io=vj[un];n:for(;;){if(Pi&&me(Li,1)){var Us=me(Li,3)+2,Al=nt(vs,Us),bd=nt(li,Us),Tf=Al*bd;if(!la(Al,bd,0,oi,tr))break n;for(tr=tr[0],$s.xc=Us,mn=0;mn<Tf;++mn){var Mc=tr[mn]>>8&65535;tr[mn]=Mc,Mc>=Br&&(Br=Mc+1)}}if(Li.h)break n;for(It=0;5>It;++It){var es=T3[It];!It&&0<un&&(es+=1<<un),ma<es&&(ma=es)}var S5=a(Br*Io,O),U3=Br,z3=a(U3,K);if(z3==null)var _y=null;else e(65536>=U3),_y=z3;var jg=i(ma);if(_y==null||jg==null||S5==null){oi.a=1;break n}var Ay=S5;for(mn=gs=0;mn<Br;++mn){var za=_y[mn],If=za.G,jf=za.H,q3=0,Sy=1,H3=0;for(It=0;5>It;++It){es=T3[It],If[It]=Ay,jf[It]=gs,!It&&0<un&&(es+=1<<un);r:{var ky,k5=es,Ny=oi,Rg=jg,Dj=Ay,Bj=gs,N5=0,Fc=Ny.m,$j=me(Fc,1);if(r(Rg,0,0,k5),$j){var Uj=me(Fc,1)+1,zj=me(Fc,1),W3=me(Fc,zj==0?1:8);Rg[W3]=1,Uj==2&&(Rg[W3=me(Fc,8)]=1);var Cy=1}else{var V3=i(19),G3=me(Fc,4)+4;if(19<G3){Ny.a=3;var Ey=0;break r}for(ky=0;ky<G3;++ky)V3[mj[ky]]=me(Fc,3);var C5=void 0,Og=void 0,X3=Ny,qj=V3,Py=k5,K3=Rg,E5=0,Dc=X3.m,Y3=8,J3=a(128,O);s:for(;I(J3,0,7,qj,19);){if(me(Dc,1)){var Hj=2+2*me(Dc,3);if((C5=2+me(Dc,Hj))>Py)break s}else C5=Py;for(Og=0;Og<Py&&C5--;){re(Dc);var Q3=J3[0+(127&V(Dc))];se(Dc,Dc.u+Q3.g);var Rf=Q3.value;if(16>Rf)K3[Og++]=Rf,Rf!=0&&(Y3=Rf);else{var Wj=Rf==16,Z3=Rf-16,Vj=fj[Z3],eN=me(Dc,hj[Z3])+Vj;if(Og+eN>Py)break s;for(var Gj=Wj?Y3:0;0<eN--;)K3[Og++]=Gj}}E5=1;break s}E5||(X3.a=3),Cy=E5}(Cy=Cy&&!Fc.h)&&(N5=I(Dj,Bj,8,Rg,k5)),Cy&&N5!=0?Ey=N5:(Ny.a=3,Ey=0)}if(Ey==0)break n;if(Sy&&pj[It]==1&&(Sy=Ay[gs].g==0),q3+=Ay[gs].g,gs+=Ey,3>=It){var Mg,P5=jg[0];for(Mg=1;Mg<es;++Mg)jg[Mg]>P5&&(P5=jg[Mg]);H3+=P5}}if(za.nd=Sy,za.Qb=0,Sy&&(za.qb=(If[3][jf[3]+0].value<<24|If[1][jf[1]+0].value<<16|If[2][jf[2]+0].value)>>>0,q3==0&&256>If[0][jf[0]+0].value&&(za.Qb=1,za.qb+=If[0][jf[0]+0].value<<8)),za.jc=!za.Qb&&6>H3,za.jc){var Ly,Sl=za;for(Ly=0;Ly<er;++Ly){var Bc=Ly,$c=Sl.pd[Bc],Ty=Sl.G[0][Sl.H[0]+Bc];256<=Ty.value?($c.g=Ty.g+256,$c.value=Ty.value):($c.g=0,$c.value=0,Bc>>=$n(Ty,8,$c),Bc>>=$n(Sl.G[1][Sl.H[1]+Bc],16,$c),Bc>>=$n(Sl.G[2][Sl.H[2]+Bc],0,$c),$n(Sl.G[3][Sl.H[3]+Bc],24,$c))}}}$s.vc=tr,$s.Wb=Br,$s.Ya=_y,$s.yc=S5,xn=1;break t}xn=0}if(!(D=xn)){N.a=3;break e}if(0<ye){if(G.ua=1<<ye,!at(G.Wa,ye)){N.a=1,D=0;break e}}else G.ua=0;var L5=N,tN=U,Xj=q,T5=L5.s,I5=T5.xc;if(L5.c=tN,L5.i=Xj,T5.md=nt(tN,I5),T5.wc=I5==0?-1:(1<<I5)-1,A){N.xb=kj;break e}if((ae=i(U*q))==null){N.a=1,D=0;break e}D=(D=ps(N,ae,0,U,q,q,null))&&!H.h;break e}return D?(R!=null?R[0]=ae:(e(ae==null),e(A)),N.$=0,A||oa(G)):oa(G),D}function si(h,g){var A=h.c*h.i,N=A+g+16*g;return e(h.c<=g),h.V=i(N),h.V==null?(h.Ta=null,h.Ua=0,h.a=1,0):(h.Ta=h.V,h.Ua=h.Ba+A+g,1)}function ml(h,g){var A=h.C,N=g-A,R=h.V,D=h.Ba+h.c*A;for(e(g<=h.l.o);0<N;){var U=16<N?16:N,q=h.l.ma,H=h.l.width,G=H*U,ae=q.ca,ye=q.tb+H*A,be=h.Ta,pe=h.Ua;Rr(h,U,R,D),as(be,pe,ae,ye,G),Mr(q,A,A+U,ae,ye,H),N-=U,R+=U*h.c,A+=U}e(A==g),h.C=h.Ma=g}function Ma(){this.ub=this.yd=this.td=this.Rb=0}function ko(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function gl(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function ad(){this.Yb=function(){var h=[];return function g(A,N,R){for(var D=R[N],U=0;U<D&&(A.push(R.length>N+1?[]:0),!(R.length<N+1));U++)g(A[U],N+1,R)}(h,0,[3,11]),h}()}function og(){this.jb=i(3),this.Wc=o([4,8],ad),this.Xc=o([4,17],ad)}function No(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function wc(){this.ld=this.La=this.dd=this.tc=0}function od(){this.Na=this.la=0}function uf(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Co(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function lg(){this.uc=this.M=this.Nb=0,this.wa=Array(new wc),this.Y=0,this.ya=Array(new Co),this.aa=0,this.l=new xc}function df(){this.y=i(16),this.f=i(8),this.ea=i(8)}function cg(){this.cb=this.a=0,this.sc="",this.m=new Ne,this.Od=new Ma,this.Kc=new ko,this.ed=new No,this.Qa=new gl,this.Ic=this.$c=this.Aa=0,this.D=new lg,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=a(8,Ne),this.ia=0,this.pb=a(4,uf),this.Pa=new og,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new df),this.Hd=0,this.rb=Array(new od),this.sb=0,this.wa=Array(new wc),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Co),this.L=this.aa=0,this.gd=o([4,2],wc),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function xc(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ug(){var h=new cg;return h!=null&&(h.a=0,h.sc="OK",h.cb=0,h.Xb=0,Tg||(Tg=cd)),h}function zn(h,g,A){return h.a==0&&(h.a=g,h.sc=A,h.cb=0),0}function hf(h,g,A){return 3<=A&&h[g+0]==157&&h[g+1]==1&&h[g+2]==42}function ld(h,g){if(h==null)return 0;if(h.a=0,h.sc="OK",g==null)return zn(h,2,"null VP8Io passed to VP8GetHeaders()");var A=g.data,N=g.w,R=g.ha;if(4>R)return zn(h,7,"Truncated header.");var D=A[N+0]|A[N+1]<<8|A[N+2]<<16,U=h.Od;if(U.Rb=!(1&D),U.td=D>>1&7,U.yd=D>>4&1,U.ub=D>>5,3<U.td)return zn(h,3,"Incorrect keyframe parameters.");if(!U.yd)return zn(h,4,"Frame not displayable.");N+=3,R-=3;var q=h.Kc;if(U.Rb){if(7>R)return zn(h,7,"cannot parse picture header");if(!hf(A,N,R))return zn(h,3,"Bad code word");q.c=16383&(A[N+4]<<8|A[N+3]),q.Td=A[N+4]>>6,q.i=16383&(A[N+6]<<8|A[N+5]),q.Ud=A[N+6]>>6,N+=7,R-=7,h.za=q.c+15>>4,h.Ub=q.i+15>>4,g.width=q.c,g.height=q.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,r((D=h.Pa).jb,0,255,D.jb.length),e((D=h.Qa)!=null),D.Cb=0,D.Bb=0,D.Fb=1,r(D.Zb,0,0,D.Zb.length),r(D.Lb,0,0,D.Lb)}if(U.ub>R)return zn(h,7,"bad partition length");ne(D=h.m,A,N,U.ub),N+=U.ub,R-=U.ub,U.Rb&&(q.Ld=le(D),q.Kd=le(D)),q=h.Qa;var H,G=h.Pa;if(e(D!=null),e(q!=null),q.Cb=le(D),q.Cb){if(q.Bb=le(D),le(D)){for(q.Fb=le(D),H=0;4>H;++H)q.Zb[H]=le(D)?ue(D,7):0;for(H=0;4>H;++H)q.Lb[H]=le(D)?ue(D,6):0}if(q.Bb)for(H=0;3>H;++H)G.jb[H]=le(D)?te(D,8):255}else q.Bb=0;if(D.Ka)return zn(h,3,"cannot parse segment header");if((q=h.ed).zd=le(D),q.Tb=te(D,6),q.wb=te(D,3),q.Pc=le(D),q.Pc&&le(D)){for(G=0;4>G;++G)le(D)&&(q.vd[G]=ue(D,6));for(G=0;4>G;++G)le(D)&&(q.od[G]=ue(D,6))}if(h.L=q.Tb==0?0:q.zd?1:2,D.Ka)return zn(h,3,"cannot parse filter header");var ae=R;if(R=H=N,N=H+ae,q=ae,h.Xb=(1<<te(h.m,2))-1,ae<3*(G=h.Xb))A=7;else{for(H+=3*G,q-=3*G,ae=0;ae<G;++ae){var ye=A[R+0]|A[R+1]<<8|A[R+2]<<16;ye>q&&(ye=q),ne(h.Jc[+ae],A,H,ye),H+=ye,q-=ye,R+=3}ne(h.Jc[+G],A,H,q),A=H<N?0:5}if(A!=0)return zn(h,A,"cannot parse partitions");for(A=te(H=h.m,7),R=le(H)?ue(H,4):0,N=le(H)?ue(H,4):0,q=le(H)?ue(H,4):0,G=le(H)?ue(H,4):0,H=le(H)?ue(H,4):0,ae=h.Qa,ye=0;4>ye;++ye){if(ae.Cb){var be=ae.Zb[ye];ae.Fb||(be+=A)}else{if(0<ye){h.pb[ye]=h.pb[0];continue}be=A}var pe=h.pb[ye];pe.Sc[0]=x5[Ci(be+R,127)],pe.Sc[1]=_5[Ci(be+0,127)],pe.Eb[0]=2*x5[Ci(be+N,127)],pe.Eb[1]=101581*_5[Ci(be+q,127)]>>16,8>pe.Eb[1]&&(pe.Eb[1]=8),pe.Qc[0]=x5[Ci(be+G,117)],pe.Qc[1]=_5[Ci(be+H,127)],pe.lc=be+H}if(!U.Rb)return zn(h,4,"Not a key frame.");for(le(D),U=h.Pa,A=0;4>A;++A){for(R=0;8>R;++R)for(N=0;3>N;++N)for(q=0;11>q;++q)G=we(D,Aj[A][R][N][q])?te(D,8):xj[A][R][N][q],U.Wc[A][R].Yb[N][q]=G;for(R=0;17>R;++R)U.Xc[A][R]=U.Wc[A][Sj[R]]}return h.kc=le(D),h.kc&&(h.Bd=te(D,8)),h.cb=1}function cd(h,g,A,N,R,D,U){var q=g[R].Yb[A];for(A=0;16>R;++R){if(!we(h,q[A+0]))return R;for(;!we(h,q[A+1]);)if(q=g[++R].Yb[0],A=0,R==16)return 16;var H=g[R+1].Yb;if(we(h,q[A+2])){var G=h,ae=0;if(we(G,(be=q)[(ye=A)+3]))if(we(G,be[ye+6])){for(q=0,ye=2*(ae=we(G,be[ye+8]))+(be=we(G,be[ye+9+ae])),ae=0,be=bj[ye];be[q];++q)ae+=ae+we(G,be[q]);ae+=3+(8<<ye)}else we(G,be[ye+7])?(ae=7+2*we(G,165),ae+=we(G,145)):ae=5+we(G,159);else ae=we(G,be[ye+4])?3+we(G,be[ye+5]):2;q=H[2]}else ae=1,q=H[1];H=U+wj[R],0>(G=h).b&&de(G);var ye,be=G.b,pe=(ye=G.Ca>>1)-(G.I>>be)>>31;--G.b,G.Ca+=pe,G.Ca|=1,G.I-=(ye+1&pe)<<be,D[H]=((ae^pe)-pe)*N[(0<R)+0]}return 16}function ud(h){var g=h.rb[h.sb-1];g.la=0,g.Na=0,r(h.zc,0,0,h.zc.length),h.ja=0}function dg(h,g){if(h==null)return 0;if(g==null)return zn(h,2,"NULL VP8Io parameter in VP8Decode().");if(!h.cb&&!ld(h,g))return 0;if(e(h.cb),g.ac==null||g.ac(g)){g.ob&&(h.L=0);var A=xy[h.L];if(h.L==2?(h.yb=0,h.zb=0):(h.yb=g.v-A>>4,h.zb=g.j-A>>4,0>h.yb&&(h.yb=0),0>h.zb&&(h.zb=0)),h.Va=g.o+15+A>>4,h.Hb=g.va+15+A>>4,h.Hb>h.za&&(h.Hb=h.za),h.Va>h.Ub&&(h.Va=h.Ub),0<h.L){var N=h.ed;for(A=0;4>A;++A){var R;if(h.Qa.Cb){var D=h.Qa.Lb[A];h.Qa.Fb||(D+=N.Tb)}else D=N.Tb;for(R=0;1>=R;++R){var U=h.gd[A][R],q=D;if(N.Pc&&(q+=N.vd[0],R&&(q+=N.od[0])),0<(q=0>q?0:63<q?63:q)){var H=q;0<N.wb&&(H=4<N.wb?H>>2:H>>1)>9-N.wb&&(H=9-N.wb),1>H&&(H=1),U.dd=H,U.tc=2*q+H,U.ld=40<=q?2:15<=q?1:0}else U.tc=0;U.La=R}}}A=0}else zn(h,6,"Frame setup failed"),A=h.a;if(A=A==0){if(A){h.$c=0,0<h.Aa||(h.Ic=Fj);e:{A=h.Ic,N=4*(H=h.za);var G=32*H,ae=H+1,ye=0<h.L?H*(0<h.Aa?2:1):0,be=(h.Aa==2?2:1)*H;if((U=N+832+(R=3*(16*A+xy[h.L])/2*G)+(D=h.Fa!=null&&0<h.Fa.length?h.Kc.c*h.Kc.i:0))!=U)A=0;else{if(U>h.Vb){if(h.Vb=0,h.Ec=i(U),h.Fc=0,h.Ec==null){A=zn(h,1,"no memory during frame initialization.");break e}h.Vb=U}U=h.Ec,q=h.Fc,h.Ac=U,h.Bc=q,q+=N,h.Gd=a(G,df),h.Hd=0,h.rb=a(ae+1,od),h.sb=1,h.wa=ye?a(ye,wc):null,h.Y=0,h.D.Nb=0,h.D.wa=h.wa,h.D.Y=h.Y,0<h.Aa&&(h.D.Y+=H),e(!0),h.oc=U,h.pc=q,q+=832,h.ya=a(be,Co),h.aa=0,h.D.ya=h.ya,h.D.aa=h.aa,h.Aa==2&&(h.D.aa+=H),h.R=16*H,h.B=8*H,H=(G=xy[h.L])*h.R,G=G/2*h.B,h.sa=U,h.ta=q+H,h.qa=h.sa,h.ra=h.ta+16*A*h.R+G,h.Ha=h.qa,h.Ia=h.ra+8*A*h.B+G,h.$c=0,q+=R,h.mb=D?U:null,h.nb=D?q:null,e(q+D<=h.Fc+h.Vb),ud(h),r(h.Ac,h.Bc,0,N),A=1}}if(A){if(g.ka=0,g.y=h.sa,g.O=h.ta,g.f=h.qa,g.N=h.ra,g.ea=h.Ha,g.Vd=h.Ia,g.fa=h.R,g.Rc=h.B,g.F=null,g.J=0,!hy){for(A=-255;255>=A;++A)ks[255+A]=0>A?-A:A;for(A=-1020;1020>=A;++A)xl[1020+A]=-128>A?-128:127<A?127:A;for(A=-112;112>=A;++A)Lg[112+A]=-16>A?-16:15<A?15:A;for(A=-255;510>=A;++A)Lf[255+A]=0>A?0:255<A?255:A;hy=1}Cf=ty,wl=hg,Cg=Ac,Dr=pf,ua=mf,is=ff,Ef=pg,dy=hd,Eg=f5,md=mg,gd=h5,Ic=yf,vd=gg,Pf=iy,yd=ry,jc=Lo,Pg=vl,da=d5,Ua[0]=_e,Ua[1]=fg,Ua[2]=fe,Ua[3]=ve,Ua[4]=Oe,Ua[5]=ct,Ua[6]=He,Ua[7]=dt,Ua[8]=st,Ua[9]=Je,Rc[0]=Ds,Rc[1]=Eo,Rc[2]=ri,Rc[3]=Sc,Rc[4]=Ss,Rc[5]=Po,Rc[6]=Fa,_l[0]=en,_l[1]=vf,_l[2]=wn,_l[3]=nn,_l[4]=ln,_l[5]=rs,_l[6]=Nc,A=1}else A=0}A&&(A=function(pe,Pe){for(pe.M=0;pe.M<pe.Va;++pe.M){var Ae,oe=pe.Jc[pe.M&pe.Xb],ce=pe.m,Ce=pe;for(Ae=0;Ae<Ce.za;++Ae){var Te=ce,Ee=Ce,Xe=Ee.Ac,Ue=Ee.Bc+4*Ae,ht=Ee.zc,Ve=Ee.ya[Ee.aa+Ae];if(Ee.Qa.Bb?Ve.$b=we(Te,Ee.Pa.jb[0])?2+we(Te,Ee.Pa.jb[2]):we(Te,Ee.Pa.jb[1]):Ve.$b=0,Ee.kc&&(Ve.Ad=we(Te,Ee.Bd)),Ve.Za=!we(Te,145)+0,Ve.Za){var sn=Ve.Ob,cn=0;for(Ee=0;4>Ee;++Ee){var Yt,Wt=ht[0+Ee];for(Yt=0;4>Yt;++Yt){Wt=_j[Xe[Ue+Yt]][Wt];for(var xn=I3[we(Te,Wt[0])];0<xn;)xn=I3[2*xn+we(Te,Wt[xn])];Wt=-xn,Xe[Ue+Yt]=Wt}n(sn,cn,Xe,Ue,4),cn+=4,ht[0+Ee]=Wt}}else Wt=we(Te,156)?we(Te,128)?1:3:we(Te,163)?2:0,Ve.Ob[0]=Wt,r(Xe,Ue,Wt,4),r(ht,0,Wt,4);Ve.Dd=we(Te,142)?we(Te,114)?we(Te,183)?1:3:2:0}if(Ce.m.Ka)return zn(pe,7,"Premature end-of-partition0 encountered.");for(;pe.ja<pe.za;++pe.ja){if(Ce=oe,Te=(ce=pe).rb[ce.sb-1],Xe=ce.rb[ce.sb+ce.ja],Ae=ce.ya[ce.aa+ce.ja],Ue=ce.kc?Ae.Ad:0)Te.la=Xe.la=0,Ae.Za||(Te.Na=Xe.Na=0),Ae.Hc=0,Ae.Gc=0,Ae.ia=0;else{var mn,It;if(Te=Xe,Xe=Ce,Ue=ce.Pa.Xc,ht=ce.ya[ce.aa+ce.ja],Ve=ce.pb[ht.$b],Ee=ht.ad,sn=0,cn=ce.rb[ce.sb-1],Wt=Yt=0,r(Ee,sn,0,384),ht.Za)var gs=0,oi=Ue[3];else{xn=i(16);var vs=Te.Na+cn.Na;if(vs=Tg(Xe,Ue[1],vs,Ve.Eb,0,xn,0),Te.Na=cn.Na=(0<vs)+0,1<vs)Cf(xn,0,Ee,sn);else{var li=xn[0]+3>>3;for(xn=0;256>xn;xn+=16)Ee[sn+xn]=li}gs=1,oi=Ue[0]}var un=15&Te.la,Pi=15&cn.la;for(xn=0;4>xn;++xn){var Li=1&Pi;for(li=It=0;4>li;++li)un=un>>1|(Li=(vs=Tg(Xe,oi,vs=Li+(1&un),Ve.Sc,gs,Ee,sn))>gs)<<7,It=It<<2|(3<vs?3:1<vs?2:Ee[sn+0]!=0),sn+=16;un>>=4,Pi=Pi>>1|Li<<7,Yt=(Yt<<8|It)>>>0}for(oi=un,gs=Pi>>4,mn=0;4>mn;mn+=2){for(It=0,un=Te.la>>4+mn,Pi=cn.la>>4+mn,xn=0;2>xn;++xn){for(Li=1&Pi,li=0;2>li;++li)vs=Li+(1&un),un=un>>1|(Li=0<(vs=Tg(Xe,Ue[2],vs,Ve.Qc,0,Ee,sn)))<<3,It=It<<2|(3<vs?3:1<vs?2:Ee[sn+0]!=0),sn+=16;un>>=2,Pi=Pi>>1|Li<<5}Wt|=It<<4*mn,oi|=un<<4<<mn,gs|=(240&Pi)<<mn}Te.la=oi,cn.la=gs,ht.Hc=Yt,ht.Gc=Wt,ht.ia=43690&Wt?0:Ve.ia,Ue=!(Yt|Wt)}if(0<ce.L&&(ce.wa[ce.Y+ce.ja]=ce.gd[Ae.$b][Ae.Za],ce.wa[ce.Y+ce.ja].La|=!Ue),Ce.Ka)return zn(pe,7,"Premature end-of-file encountered.")}if(ud(pe),ce=Pe,Ce=1,Ae=(oe=pe).D,Te=0<oe.L&&oe.M>=oe.zb&&oe.M<=oe.Va,oe.Aa==0)e:{if(Ae.M=oe.M,Ae.uc=Te,_g(oe,Ae),Ce=1,Ae=(It=oe.D).Nb,Te=(Wt=xy[oe.L])*oe.R,Xe=Wt/2*oe.B,xn=16*Ae*oe.R,li=8*Ae*oe.B,Ue=oe.sa,ht=oe.ta-Te+xn,Ve=oe.qa,Ee=oe.ra-Xe+li,sn=oe.Ha,cn=oe.Ia-Xe+li,Pi=(un=It.M)==0,Yt=un>=oe.Va-1,oe.Aa==2&&_g(oe,It),It.uc)for(Li=(vs=oe).D.M,e(vs.D.uc),It=vs.yb;It<vs.Hb;++It){gs=It,oi=Li;var $s=(tr=(es=vs).D).Nb;mn=es.R;var tr=tr.wa[tr.Y+gs],Br=es.sa,ma=es.ta+16*$s*mn+16*gs,Io=tr.dd,Us=tr.tc;if(Us!=0)if(e(3<=Us),es.L==1)0<gs&&jc(Br,ma,mn,Us+4),tr.La&&da(Br,ma,mn,Us),0<oi&&yd(Br,ma,mn,Us+4),tr.La&&Pg(Br,ma,mn,Us);else{var Al=es.B,bd=es.qa,Tf=es.ra+8*$s*Al+8*gs,Mc=es.Ha,es=es.Ia+8*$s*Al+8*gs;$s=tr.ld,0<gs&&(dy(Br,ma,mn,Us+4,Io,$s),md(bd,Tf,Mc,es,Al,Us+4,Io,$s)),tr.La&&(Ic(Br,ma,mn,Us,Io,$s),Pf(bd,Tf,Mc,es,Al,Us,Io,$s)),0<oi&&(Ef(Br,ma,mn,Us+4,Io,$s),Eg(bd,Tf,Mc,es,Al,Us+4,Io,$s)),tr.La&&(gd(Br,ma,mn,Us,Io,$s),vd(bd,Tf,Mc,es,Al,Us,Io,$s))}}if(oe.ia&&alert("todo:DitherRow"),ce.put!=null){if(It=16*un,un=16*(un+1),Pi?(ce.y=oe.sa,ce.O=oe.ta+xn,ce.f=oe.qa,ce.N=oe.ra+li,ce.ea=oe.Ha,ce.W=oe.Ia+li):(It-=Wt,ce.y=Ue,ce.O=ht,ce.f=Ve,ce.N=Ee,ce.ea=sn,ce.W=cn),Yt||(un-=Wt),un>ce.o&&(un=ce.o),ce.F=null,ce.J=null,oe.Fa!=null&&0<oe.Fa.length&&It<un&&(ce.J=wg(oe,ce,It,un-It),ce.F=oe.mb,ce.F==null&&ce.F.length==0)){Ce=zn(oe,3,"Could not decode alpha data.");break e}It<ce.j&&(Wt=ce.j-It,It=ce.j,e(!(1&Wt)),ce.O+=oe.R*Wt,ce.N+=oe.B*(Wt>>1),ce.W+=oe.B*(Wt>>1),ce.F!=null&&(ce.J+=ce.width*Wt)),It<un&&(ce.O+=ce.v,ce.N+=ce.v>>1,ce.W+=ce.v>>1,ce.F!=null&&(ce.J+=ce.v),ce.ka=It-ce.j,ce.U=ce.va-ce.v,ce.T=un-It,Ce=ce.put(ce))}Ae+1!=oe.Ic||Yt||(n(oe.sa,oe.ta-Te,Ue,ht+16*oe.R,Te),n(oe.qa,oe.ra-Xe,Ve,Ee+8*oe.B,Xe),n(oe.Ha,oe.Ia-Xe,sn,cn+8*oe.B,Xe))}if(!Ce)return zn(pe,6,"Output aborted.")}return 1}(h,g)),g.bc!=null&&g.bc(g),A&=1}return A?(h.cb=0,A):0}function Ni(h,g,A,N,R){R=h[g+A+32*N]+(R>>3),h[g+A+32*N]=-256&R?0>R?0:255:R}function _c(h,g,A,N,R,D){Ni(h,g,0,A,N+R),Ni(h,g,1,A,N+D),Ni(h,g,2,A,N-D),Ni(h,g,3,A,N-R)}function fr(h){return(20091*h>>16)+h}function dd(h,g,A,N){var R,D=0,U=i(16);for(R=0;4>R;++R){var q=h[g+0]+h[g+8],H=h[g+0]-h[g+8],G=(35468*h[g+4]>>16)-fr(h[g+12]),ae=fr(h[g+4])+(35468*h[g+12]>>16);U[D+0]=q+ae,U[D+1]=H+G,U[D+2]=H-G,U[D+3]=q-ae,D+=4,g++}for(R=D=0;4>R;++R)q=(h=U[D+0]+4)+U[D+8],H=h-U[D+8],G=(35468*U[D+4]>>16)-fr(U[D+12]),Ni(A,N,0,0,q+(ae=fr(U[D+4])+(35468*U[D+12]>>16))),Ni(A,N,1,0,H+G),Ni(A,N,2,0,H-G),Ni(A,N,3,0,q-ae),D++,N+=32}function ff(h,g,A,N){var R=h[g+0]+4,D=35468*h[g+4]>>16,U=fr(h[g+4]),q=35468*h[g+1]>>16;_c(A,N,0,R+U,h=fr(h[g+1]),q),_c(A,N,1,R+D,h,q),_c(A,N,2,R-D,h,q),_c(A,N,3,R-U,h,q)}function hg(h,g,A,N,R){dd(h,g,A,N),R&&dd(h,g+16,A,N+4)}function Ac(h,g,A,N){wl(h,g+0,A,N,1),wl(h,g+32,A,N+128,1)}function pf(h,g,A,N){var R;for(h=h[g+0]+4,R=0;4>R;++R)for(g=0;4>g;++g)Ni(A,N,g,R,h)}function mf(h,g,A,N){h[g+0]&&Dr(h,g+0,A,N),h[g+16]&&Dr(h,g+16,A,N+4),h[g+32]&&Dr(h,g+32,A,N+128),h[g+48]&&Dr(h,g+48,A,N+128+4)}function ty(h,g,A,N){var R,D=i(16);for(R=0;4>R;++R){var U=h[g+0+R]+h[g+12+R],q=h[g+4+R]+h[g+8+R],H=h[g+4+R]-h[g+8+R],G=h[g+0+R]-h[g+12+R];D[0+R]=U+q,D[8+R]=U-q,D[4+R]=G+H,D[12+R]=G-H}for(R=0;4>R;++R)U=(h=D[0+4*R]+3)+D[3+4*R],q=D[1+4*R]+D[2+4*R],H=D[1+4*R]-D[2+4*R],G=h-D[3+4*R],A[N+0]=U+q>>3,A[N+16]=G+H>>3,A[N+32]=U-q>>3,A[N+48]=G-H>>3,N+=64}function gf(h,g,A){var N,R=g-32,D=Ei,U=255-h[R-1];for(N=0;N<A;++N){var q,H=D,G=U+h[g-1];for(q=0;q<A;++q)h[g+q]=H[G+h[R+q]];g+=32}}function fg(h,g){gf(h,g,4)}function vf(h,g){gf(h,g,8)}function Eo(h,g){gf(h,g,16)}function ri(h,g){var A;for(A=0;16>A;++A)n(h,g+32*A,h,g-32,16)}function Sc(h,g){var A;for(A=16;0<A;--A)r(h,g,h[g-1],16),g+=32}function kc(h,g,A){var N;for(N=0;16>N;++N)r(g,A+32*N,h,16)}function Ds(h,g){var A,N=16;for(A=0;16>A;++A)N+=h[g-1+32*A]+h[g+A-32];kc(N>>5,h,g)}function Ss(h,g){var A,N=8;for(A=0;16>A;++A)N+=h[g-1+32*A];kc(N>>4,h,g)}function Po(h,g){var A,N=8;for(A=0;16>A;++A)N+=h[g+A-32];kc(N>>4,h,g)}function Fa(h,g){kc(128,h,g)}function P(h,g,A){return h+2*g+A+2>>2}function fe(h,g){var A,N=g-32;for(N=new Uint8Array([P(h[N-1],h[N+0],h[N+1]),P(h[N+0],h[N+1],h[N+2]),P(h[N+1],h[N+2],h[N+3]),P(h[N+2],h[N+3],h[N+4])]),A=0;4>A;++A)n(h,g+32*A,N,0,N.length)}function ve(h,g){var A=h[g-1],N=h[g-1+32],R=h[g-1+64],D=h[g-1+96];Le(h,g+0,16843009*P(h[g-1-32],A,N)),Le(h,g+32,16843009*P(A,N,R)),Le(h,g+64,16843009*P(N,R,D)),Le(h,g+96,16843009*P(R,D,D))}function _e(h,g){var A,N=4;for(A=0;4>A;++A)N+=h[g+A-32]+h[g-1+32*A];for(N>>=3,A=0;4>A;++A)r(h,g+32*A,N,4)}function Oe(h,g){var A=h[g-1+0],N=h[g-1+32],R=h[g-1+64],D=h[g-1-32],U=h[g+0-32],q=h[g+1-32],H=h[g+2-32],G=h[g+3-32];h[g+0+96]=P(N,R,h[g-1+96]),h[g+1+96]=h[g+0+64]=P(A,N,R),h[g+2+96]=h[g+1+64]=h[g+0+32]=P(D,A,N),h[g+3+96]=h[g+2+64]=h[g+1+32]=h[g+0+0]=P(U,D,A),h[g+3+64]=h[g+2+32]=h[g+1+0]=P(q,U,D),h[g+3+32]=h[g+2+0]=P(H,q,U),h[g+3+0]=P(G,H,q)}function He(h,g){var A=h[g+1-32],N=h[g+2-32],R=h[g+3-32],D=h[g+4-32],U=h[g+5-32],q=h[g+6-32],H=h[g+7-32];h[g+0+0]=P(h[g+0-32],A,N),h[g+1+0]=h[g+0+32]=P(A,N,R),h[g+2+0]=h[g+1+32]=h[g+0+64]=P(N,R,D),h[g+3+0]=h[g+2+32]=h[g+1+64]=h[g+0+96]=P(R,D,U),h[g+3+32]=h[g+2+64]=h[g+1+96]=P(D,U,q),h[g+3+64]=h[g+2+96]=P(U,q,H),h[g+3+96]=P(q,H,H)}function ct(h,g){var A=h[g-1+0],N=h[g-1+32],R=h[g-1+64],D=h[g-1-32],U=h[g+0-32],q=h[g+1-32],H=h[g+2-32],G=h[g+3-32];h[g+0+0]=h[g+1+64]=D+U+1>>1,h[g+1+0]=h[g+2+64]=U+q+1>>1,h[g+2+0]=h[g+3+64]=q+H+1>>1,h[g+3+0]=H+G+1>>1,h[g+0+96]=P(R,N,A),h[g+0+64]=P(N,A,D),h[g+0+32]=h[g+1+96]=P(A,D,U),h[g+1+32]=h[g+2+96]=P(D,U,q),h[g+2+32]=h[g+3+96]=P(U,q,H),h[g+3+32]=P(q,H,G)}function dt(h,g){var A=h[g+0-32],N=h[g+1-32],R=h[g+2-32],D=h[g+3-32],U=h[g+4-32],q=h[g+5-32],H=h[g+6-32],G=h[g+7-32];h[g+0+0]=A+N+1>>1,h[g+1+0]=h[g+0+64]=N+R+1>>1,h[g+2+0]=h[g+1+64]=R+D+1>>1,h[g+3+0]=h[g+2+64]=D+U+1>>1,h[g+0+32]=P(A,N,R),h[g+1+32]=h[g+0+96]=P(N,R,D),h[g+2+32]=h[g+1+96]=P(R,D,U),h[g+3+32]=h[g+2+96]=P(D,U,q),h[g+3+64]=P(U,q,H),h[g+3+96]=P(q,H,G)}function Je(h,g){var A=h[g-1+0],N=h[g-1+32],R=h[g-1+64],D=h[g-1+96];h[g+0+0]=A+N+1>>1,h[g+2+0]=h[g+0+32]=N+R+1>>1,h[g+2+32]=h[g+0+64]=R+D+1>>1,h[g+1+0]=P(A,N,R),h[g+3+0]=h[g+1+32]=P(N,R,D),h[g+3+32]=h[g+1+64]=P(R,D,D),h[g+3+64]=h[g+2+64]=h[g+0+96]=h[g+1+96]=h[g+2+96]=h[g+3+96]=D}function st(h,g){var A=h[g-1+0],N=h[g-1+32],R=h[g-1+64],D=h[g-1+96],U=h[g-1-32],q=h[g+0-32],H=h[g+1-32],G=h[g+2-32];h[g+0+0]=h[g+2+32]=A+U+1>>1,h[g+0+32]=h[g+2+64]=N+A+1>>1,h[g+0+64]=h[g+2+96]=R+N+1>>1,h[g+0+96]=D+R+1>>1,h[g+3+0]=P(q,H,G),h[g+2+0]=P(U,q,H),h[g+1+0]=h[g+3+32]=P(A,U,q),h[g+1+32]=h[g+3+64]=P(N,A,U),h[g+1+64]=h[g+3+96]=P(R,N,A),h[g+1+96]=P(D,R,N)}function wn(h,g){var A;for(A=0;8>A;++A)n(h,g+32*A,h,g-32,8)}function nn(h,g){var A;for(A=0;8>A;++A)r(h,g,h[g-1],8),g+=32}function $t(h,g,A){var N;for(N=0;8>N;++N)r(g,A+32*N,h,8)}function en(h,g){var A,N=8;for(A=0;8>A;++A)N+=h[g+A-32]+h[g-1+32*A];$t(N>>4,h,g)}function rs(h,g){var A,N=4;for(A=0;8>A;++A)N+=h[g+A-32];$t(N>>3,h,g)}function ln(h,g){var A,N=4;for(A=0;8>A;++A)N+=h[g-1+32*A];$t(N>>3,h,g)}function Nc(h,g){$t(128,h,g)}function Da(h,g,A){var N=h[g-A],R=h[g+0],D=3*(R-N)+g5[1020+h[g-2*A]-h[g+A]],U=fy[112+(D+4>>3)];h[g-A]=Ei[255+N+fy[112+(D+3>>3)]],h[g+0]=Ei[255+R-U]}function Cc(h,g,A,N){var R=h[g+0],D=h[g+A];return fa[255+h[g-2*A]-h[g-A]]>N||fa[255+D-R]>N}function ny(h,g,A,N){return 4*fa[255+h[g-A]-h[g+0]]+fa[255+h[g-2*A]-h[g+A]]<=N}function sy(h,g,A,N,R){var D=h[g-3*A],U=h[g-2*A],q=h[g-A],H=h[g+0],G=h[g+A],ae=h[g+2*A],ye=h[g+3*A];return 4*fa[255+q-H]+fa[255+U-G]>N?0:fa[255+h[g-4*A]-D]<=R&&fa[255+D-U]<=R&&fa[255+U-q]<=R&&fa[255+ye-ae]<=R&&fa[255+ae-G]<=R&&fa[255+G-H]<=R}function ry(h,g,A,N){var R=2*N+1;for(N=0;16>N;++N)ny(h,g+N,A,R)&&Da(h,g+N,A)}function Lo(h,g,A,N){var R=2*N+1;for(N=0;16>N;++N)ny(h,g+N*A,1,R)&&Da(h,g+N*A,1)}function vl(h,g,A,N){var R;for(R=3;0<R;--R)ry(h,g+=4*A,A,N)}function d5(h,g,A,N){var R;for(R=3;0<R;--R)Lo(h,g+=4,A,N)}function Ec(h,g,A,N,R,D,U,q){for(D=2*D+1;0<R--;){if(sy(h,g,A,D,U))if(Cc(h,g,A,q))Da(h,g,A);else{var H=h,G=g,ae=A,ye=H[G-2*ae],be=H[G-ae],pe=H[G+0],Pe=H[G+ae],Ae=H[G+2*ae],oe=27*(Ce=g5[1020+3*(pe-be)+g5[1020+ye-Pe]])+63>>7,ce=18*Ce+63>>7,Ce=9*Ce+63>>7;H[G-3*ae]=Ei[255+H[G-3*ae]+Ce],H[G-2*ae]=Ei[255+ye+ce],H[G-ae]=Ei[255+be+oe],H[G+0]=Ei[255+pe-oe],H[G+ae]=Ei[255+Pe-ce],H[G+2*ae]=Ei[255+Ae-Ce]}g+=N}}function Ba(h,g,A,N,R,D,U,q){for(D=2*D+1;0<R--;){if(sy(h,g,A,D,U))if(Cc(h,g,A,q))Da(h,g,A);else{var H=h,G=g,ae=A,ye=H[G-ae],be=H[G+0],pe=H[G+ae],Pe=fy[112+((Ae=3*(be-ye))+4>>3)],Ae=fy[112+(Ae+3>>3)],oe=Pe+1>>1;H[G-2*ae]=Ei[255+H[G-2*ae]+oe],H[G-ae]=Ei[255+ye+Ae],H[G+0]=Ei[255+be-Pe],H[G+ae]=Ei[255+pe-oe]}g+=N}}function pg(h,g,A,N,R,D){Ec(h,g,A,1,16,N,R,D)}function hd(h,g,A,N,R,D){Ec(h,g,1,A,16,N,R,D)}function h5(h,g,A,N,R,D){var U;for(U=3;0<U;--U)Ba(h,g+=4*A,A,1,16,N,R,D)}function yf(h,g,A,N,R,D){var U;for(U=3;0<U;--U)Ba(h,g+=4,1,A,16,N,R,D)}function f5(h,g,A,N,R,D,U,q){Ec(h,g,R,1,8,D,U,q),Ec(A,N,R,1,8,D,U,q)}function mg(h,g,A,N,R,D,U,q){Ec(h,g,1,R,8,D,U,q),Ec(A,N,1,R,8,D,U,q)}function gg(h,g,A,N,R,D,U,q){Ba(h,g+4*R,R,1,8,D,U,q),Ba(A,N+4*R,R,1,8,D,U,q)}function iy(h,g,A,N,R,D,U,q){Ba(h,g+4,1,R,8,D,U,q),Ba(A,N+4,1,R,8,D,U,q)}function bf(){this.ba=new ei,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ln,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function vg(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function yg(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ay(){this.ua=0,this.Wa=new ee,this.vb=new ee,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new O}function p5(){this.xb=this.a=0,this.l=new xc,this.ca=new ei,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ay,this.ab=0,this.gc=a(4,yg),this.Oc=0}function wf(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new xc,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function fd(h,g,A,N,R,D,U){for(h=h==null?0:h[g+0],g=0;g<U;++g)R[D+g]=h+A[N+g]&255,h=R[D+g]}function bg(h,g,A,N,R,D,U){var q;if(h==null)fd(null,null,A,N,R,D,U);else for(q=0;q<U;++q)R[D+q]=h[g+q]+A[N+q]&255}function Pc(h,g,A,N,R,D,U){if(h==null)fd(null,null,A,N,R,D,U);else{var q,H=h[g+0],G=H,ae=H;for(q=0;q<U;++q)G=ae+(H=h[g+q])-G,ae=A[N+q]+(-256&G?0>G?0:255:G)&255,G=H,R[D+q]=ae}}function wg(h,g,A,N){var R=g.width,D=g.o;if(e(h!=null&&g!=null),0>A||0>=N||A+N>D)return null;if(!h.Cc){if(h.ga==null){var U;if(h.ga=new wf,(U=h.ga==null)||(U=g.width*g.o,e(h.Gb.length==0),h.Gb=i(U),h.Uc=0,h.Gb==null?U=0:(h.mb=h.Gb,h.nb=h.Uc,h.rc=null,U=1),U=!U),!U){U=h.ga;var q=h.Fa,H=h.P,G=h.qc,ae=h.mb,ye=h.nb,be=H+1,pe=G-1,Pe=U.l;if(e(q!=null&&ae!=null&&g!=null),Oc[0]=null,Oc[1]=fd,Oc[2]=bg,Oc[3]=Pc,U.ca=ae,U.tb=ye,U.c=g.width,U.i=g.height,e(0<U.c&&0<U.i),1>=G)g=0;else if(U.$a=q[H+0]>>0&3,U.Z=q[H+0]>>2&3,U.Lc=q[H+0]>>4&3,H=q[H+0]>>6&3,0>U.$a||1<U.$a||4<=U.Z||1<U.Lc||H)g=0;else if(Pe.put=aa,Pe.ac=Qn,Pe.bc=ti,Pe.ma=U,Pe.width=g.width,Pe.height=g.height,Pe.Da=g.Da,Pe.v=g.v,Pe.va=g.va,Pe.j=g.j,Pe.o=g.o,U.$a)e:{e(U.$a==1),g=Zs();t:for(;;){if(g==null){g=0;break e}if(e(U!=null),U.mc=g,g.c=U.c,g.i=U.i,g.l=U.l,g.l.ma=U,g.l.width=U.c,g.l.height=U.i,g.a=0,Z(g.m,q,be,pe),!la(U.c,U.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&Oa(g.s)?(U.ic=1,q=g.c*g.i,g.Ta=null,g.Ua=0,g.V=i(q),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(U.ic=0,g=si(g,U.c)),!g))break t;g=1;break e}U.mc=null,g=0}else g=pe>=U.c*U.i;U=!g}if(U)return null;h.ga.Lc!=1?h.Ga=0:N=D-A}e(h.ga!=null),e(A+N<=D);e:{if(g=(q=h.ga).c,D=q.l.o,q.$a==0){if(be=h.rc,pe=h.Vc,Pe=h.Fa,H=h.P+1+A*g,G=h.mb,ae=h.nb+A*g,e(H<=h.P+h.qc),q.Z!=0)for(e(Oc[q.Z]!=null),U=0;U<N;++U)Oc[q.Z](be,pe,Pe,H,G,ae,g),be=G,pe=ae,ae+=g,H+=g;else for(U=0;U<N;++U)n(G,ae,Pe,H,g),be=G,pe=ae,ae+=g,H+=g;h.rc=be,h.Vc=pe}else{if(e(q.mc!=null),g=A+N,e((U=q.mc)!=null),e(g<=U.i),U.C>=g)g=1;else if(q.ic||ge(),q.ic){q=U.V,be=U.Ba,pe=U.c;var Ae=U.i,oe=(Pe=1,H=U.$/pe,G=U.$%pe,ae=U.m,ye=U.s,U.$),ce=pe*Ae,Ce=pe*g,Te=ye.wc,Ee=oe<Ce?On(ye,G,H):null;e(oe<=ce),e(g<=Ae),e(Oa(ye));t:for(;;){for(;!ae.h&&oe<Ce;){if(G&Te||(Ee=On(ye,G,H)),e(Ee!=null),re(ae),256>(Ae=Fs(Ee.G[0],Ee.H[0],ae)))q[be+oe]=Ae,++oe,++G>=pe&&(G=0,++H<=g&&!(H%16)&&Un(U,H));else{if(!(280>Ae)){Pe=0;break t}Ae=Qs(Ae-256,ae);var Xe,Ue=Fs(Ee.G[4],Ee.H[4],ae);if(re(ae),!(oe>=(Ue=ni(pe,Ue=Qs(Ue,ae)))&&ce-oe>=Ae)){Pe=0;break t}for(Xe=0;Xe<Ae;++Xe)q[be+oe+Xe]=q[be+oe+Xe-Ue];for(oe+=Ae,G+=Ae;G>=pe;)G-=pe,++H<=g&&!(H%16)&&Un(U,H);oe<Ce&&G&Te&&(Ee=On(ye,G,H))}e(ae.h==Q(ae))}Un(U,H>g?g:H);break t}!Pe||ae.h&&oe<ce?(Pe=0,U.a=ae.h?5:3):U.$=oe,g=Pe}else g=ps(U,U.V,U.Ba,U.c,U.i,g,ml);if(!g){N=0;break e}}A+N>=D&&(h.Cc=1),N=1}if(!N)return null;if(h.Cc&&((N=h.ga)!=null&&(N.mc=null),h.ga=null,0<h.Ga))return alert("todo:WebPDequantizeLevels"),null}return h.nb+A*R}function x(h,g,A,N,R,D){for(;0<R--;){var U,q=h,H=g+(A?1:0),G=h,ae=g+(A?0:3);for(U=0;U<N;++U){var ye=G[ae+4*U];ye!=255&&(ye*=32897,q[H+4*U+0]=q[H+4*U+0]*ye>>23,q[H+4*U+1]=q[H+4*U+1]*ye>>23,q[H+4*U+2]=q[H+4*U+2]*ye>>23)}g+=D}}function M(h,g,A,N,R){for(;0<N--;){var D;for(D=0;D<A;++D){var U=h[g+2*D+0],q=15&(G=h[g+2*D+1]),H=4369*q,G=(240&G|G>>4)*H>>16;h[g+2*D+0]=(240&U|U>>4)*H>>16&240|(15&U|U<<4)*H>>16>>4&15,h[g+2*D+1]=240&G|q}g+=R}}function J(h,g,A,N,R,D,U,q){var H,G,ae=255;for(G=0;G<R;++G){for(H=0;H<N;++H){var ye=h[g+H];D[U+4*H]=ye,ae&=ye}g+=A,U+=q}return ae!=255}function ie(h,g,A,N,R){var D;for(D=0;D<R;++D)A[N+D]=h[g+D]>>8}function ge(){ha=x,Sn=M,kn=J,as=ie}function ke(h,g,A){T[h]=function(N,R,D,U,q,H,G,ae,ye,be,pe,Pe,Ae,oe,ce,Ce,Te){var Ee,Xe=Te-1>>1,Ue=q[H+0]|G[ae+0]<<16,ht=ye[be+0]|pe[Pe+0]<<16;e(N!=null);var Ve=3*Ue+ht+131074>>2;for(g(N[R+0],255&Ve,Ve>>16,Ae,oe),D!=null&&(Ve=3*ht+Ue+131074>>2,g(D[U+0],255&Ve,Ve>>16,ce,Ce)),Ee=1;Ee<=Xe;++Ee){var sn=q[H+Ee]|G[ae+Ee]<<16,cn=ye[be+Ee]|pe[Pe+Ee]<<16,Yt=Ue+sn+ht+cn+524296,Wt=Yt+2*(sn+ht)>>3;Ve=Wt+Ue>>1,Ue=(Yt=Yt+2*(Ue+cn)>>3)+sn>>1,g(N[R+2*Ee-1],255&Ve,Ve>>16,Ae,oe+(2*Ee-1)*A),g(N[R+2*Ee-0],255&Ue,Ue>>16,Ae,oe+(2*Ee-0)*A),D!=null&&(Ve=Yt+ht>>1,Ue=Wt+cn>>1,g(D[U+2*Ee-1],255&Ve,Ve>>16,ce,Ce+(2*Ee-1)*A),g(D[U+2*Ee+0],255&Ue,Ue>>16,ce,Ce+(2*Ee+0)*A)),Ue=sn,ht=cn}1&Te||(Ve=3*Ue+ht+131074>>2,g(N[R+Te-1],255&Ve,Ve>>16,Ae,oe+(Te-1)*A),D!=null&&(Ve=3*ht+Ue+131074>>2,g(D[U+Te-1],255&Ve,Ve>>16,ce,Ce+(Te-1)*A)))}}function Ie(){pa[py]=Nj,pa[my]=R3,pa[P3]=Cj,pa[gy]=O3,pa[vy]=M3,pa[v5]=F3,pa[L3]=Ej,pa[y5]=R3,pa[b5]=O3,pa[yy]=M3,pa[w5]=F3}function Ge(h){return h&-16384?0>h?0:255:h>>Pj}function ut(h,g){return Ge((19077*h>>8)+(26149*g>>8)-14234)}function Lt(h,g,A){return Ge((19077*h>>8)-(6419*g>>8)-(13320*A>>8)+8708)}function Nt(h,g){return Ge((19077*h>>8)+(33050*g>>8)-17685)}function Xt(h,g,A,N,R){N[R+0]=ut(h,A),N[R+1]=Lt(h,g,A),N[R+2]=Nt(h,g)}function qn(h,g,A,N,R){N[R+0]=Nt(h,g),N[R+1]=Lt(h,g,A),N[R+2]=ut(h,A)}function Zn(h,g,A,N,R){var D=Lt(h,g,A);g=D<<3&224|Nt(h,g)>>3,N[R+0]=248&ut(h,A)|D>>5,N[R+1]=g}function ms(h,g,A,N,R){var D=240&Nt(h,g)|15;N[R+0]=240&ut(h,A)|Lt(h,g,A)>>4,N[R+1]=D}function pr(h,g,A,N,R){N[R+0]=255,Xt(h,g,A,N,R+1)}function Bs(h,g,A,N,R){qn(h,g,A,N,R),N[R+3]=255}function $a(h,g,A,N,R){Xt(h,g,A,N,R),N[R+3]=255}function Ci(h,g){return 0>h?0:h>g?g:h}function To(h,g,A){T[h]=function(N,R,D,U,q,H,G,ae,ye){for(var be=ae+(-2&ye)*A;ae!=be;)g(N[R+0],D[U+0],q[H+0],G,ae),g(N[R+1],D[U+0],q[H+0],G,ae+A),R+=2,++U,++H,ae+=2*A;1&ye&&g(N[R+0],D[U+0],q[H+0],G,ae)}}function oy(h,g,A){return A==0?h==0?g==0?6:5:g==0?4:0:A}function xg(h,g,A,N,R){switch(h>>>30){case 3:wl(g,A,N,R,0);break;case 2:is(g,A,N,R);break;case 1:Dr(g,A,N,R)}}function _g(h,g){var A,N,R=g.M,D=g.Nb,U=h.oc,q=h.pc+40,H=h.oc,G=h.pc+584,ae=h.oc,ye=h.pc+600;for(A=0;16>A;++A)U[q+32*A-1]=129;for(A=0;8>A;++A)H[G+32*A-1]=129,ae[ye+32*A-1]=129;for(0<R?U[q-1-32]=H[G-1-32]=ae[ye-1-32]=129:(r(U,q-32-1,127,21),r(H,G-32-1,127,9),r(ae,ye-32-1,127,9)),N=0;N<h.za;++N){var be=g.ya[g.aa+N];if(0<N){for(A=-1;16>A;++A)n(U,q+32*A-4,U,q+32*A+12,4);for(A=-1;8>A;++A)n(H,G+32*A-4,H,G+32*A+4,4),n(ae,ye+32*A-4,ae,ye+32*A+4,4)}var pe=h.Gd,Pe=h.Hd+N,Ae=be.ad,oe=be.Hc;if(0<R&&(n(U,q-32,pe[Pe].y,0,16),n(H,G-32,pe[Pe].f,0,8),n(ae,ye-32,pe[Pe].ea,0,8)),be.Za){var ce=U,Ce=q-32+16;for(0<R&&(N>=h.za-1?r(ce,Ce,pe[Pe].y[15],4):n(ce,Ce,pe[Pe+1].y,0,4)),A=0;4>A;A++)ce[Ce+128+A]=ce[Ce+256+A]=ce[Ce+384+A]=ce[Ce+0+A];for(A=0;16>A;++A,oe<<=2)ce=U,Ce=q+B3[A],Ua[be.Ob[A]](ce,Ce),xg(oe,Ae,16*+A,ce,Ce)}else if(ce=oy(N,R,be.Ob[0]),Rc[ce](U,q),oe!=0)for(A=0;16>A;++A,oe<<=2)xg(oe,Ae,16*+A,U,q+B3[A]);for(A=be.Gc,ce=oy(N,R,be.Dd),_l[ce](H,G),_l[ce](ae,ye),oe=Ae,ce=H,Ce=G,255&(be=A>>0)&&(170&be?Cg(oe,256,ce,Ce):ua(oe,256,ce,Ce)),be=ae,oe=ye,255&(A>>=8)&&(170&A?Cg(Ae,320,be,oe):ua(Ae,320,be,oe)),R<h.Ub-1&&(n(pe[Pe].y,0,U,q+480,16),n(pe[Pe].f,0,H,G+224,8),n(pe[Pe].ea,0,ae,ye+224,8)),A=8*D*h.B,pe=h.sa,Pe=h.ta+16*N+16*D*h.R,Ae=h.qa,be=h.ra+8*N+A,oe=h.Ha,ce=h.Ia+8*N+A,A=0;16>A;++A)n(pe,Pe+A*h.R,U,q+32*A,16);for(A=0;8>A;++A)n(Ae,be+A*h.B,H,G+32*A,8),n(oe,ce+A*h.B,ae,ye+32*A,8)}}function xf(h,g,A,N,R,D,U,q,H){var G=[0],ae=[0],ye=0,be=H!=null?H.kd:0,pe=H??new vg;if(h==null||12>A)return 7;pe.data=h,pe.w=g,pe.ha=A,g=[g],A=[A],pe.gb=[pe.gb];e:{var Pe=g,Ae=A,oe=pe.gb;if(e(h!=null),e(Ae!=null),e(oe!=null),oe[0]=0,12<=Ae[0]&&!t(h,Pe[0],"RIFF")){if(t(h,Pe[0]+8,"WEBP")){oe=3;break e}var ce=Be(h,Pe[0]+4);if(12>ce||4294967286<ce){oe=3;break e}if(be&&ce>Ae[0]-8){oe=7;break e}oe[0]=ce,Pe[0]+=12,Ae[0]-=12}oe=0}if(oe!=0)return oe;for(ce=0<pe.gb[0],A=A[0];;){e:{var Ce=h;Ae=g,oe=A;var Te=G,Ee=ae,Xe=Pe=[0];if((Ve=ye=[ye])[0]=0,8>oe[0])oe=7;else{if(!t(Ce,Ae[0],"VP8X")){if(Be(Ce,Ae[0]+4)!=10){oe=3;break e}if(18>oe[0]){oe=7;break e}var Ue=Be(Ce,Ae[0]+8),ht=1+Fe(Ce,Ae[0]+12);if(2147483648<=ht*(Ce=1+Fe(Ce,Ae[0]+15))){oe=3;break e}Xe!=null&&(Xe[0]=Ue),Te!=null&&(Te[0]=ht),Ee!=null&&(Ee[0]=Ce),Ae[0]+=18,oe[0]-=18,Ve[0]=1}oe=0}}if(ye=ye[0],Pe=Pe[0],oe!=0)return oe;if(Ae=!!(2&Pe),!ce&&ye)return 3;if(D!=null&&(D[0]=!!(16&Pe)),U!=null&&(U[0]=Ae),q!=null&&(q[0]=0),U=G[0],Pe=ae[0],ye&&Ae&&H==null){oe=0;break}if(4>A){oe=7;break}if(ce&&ye||!ce&&!ye&&!t(h,g[0],"ALPH")){A=[A],pe.na=[pe.na],pe.P=[pe.P],pe.Sa=[pe.Sa];e:{Ue=h,oe=g,ce=A;var Ve=pe.gb;Te=pe.na,Ee=pe.P,Xe=pe.Sa,ht=22,e(Ue!=null),e(ce!=null),Ce=oe[0];var sn=ce[0];for(e(Te!=null),e(Xe!=null),Te[0]=null,Ee[0]=null,Xe[0]=0;;){if(oe[0]=Ce,ce[0]=sn,8>sn){oe=7;break e}var cn=Be(Ue,Ce+4);if(4294967286<cn){oe=3;break e}var Yt=8+cn+1&-2;if(ht+=Yt,0<Ve&&ht>Ve){oe=3;break e}if(!t(Ue,Ce,"VP8 ")||!t(Ue,Ce,"VP8L")){oe=0;break e}if(sn[0]<Yt){oe=7;break e}t(Ue,Ce,"ALPH")||(Te[0]=Ue,Ee[0]=Ce+8,Xe[0]=cn),Ce+=Yt,sn-=Yt}}if(A=A[0],pe.na=pe.na[0],pe.P=pe.P[0],pe.Sa=pe.Sa[0],oe!=0)break}A=[A],pe.Ja=[pe.Ja],pe.xa=[pe.xa];e:if(Ve=h,oe=g,ce=A,Te=pe.gb[0],Ee=pe.Ja,Xe=pe.xa,Ue=oe[0],Ce=!t(Ve,Ue,"VP8 "),ht=!t(Ve,Ue,"VP8L"),e(Ve!=null),e(ce!=null),e(Ee!=null),e(Xe!=null),8>ce[0])oe=7;else{if(Ce||ht){if(Ve=Be(Ve,Ue+4),12<=Te&&Ve>Te-12){oe=3;break e}if(be&&Ve>ce[0]-8){oe=7;break e}Ee[0]=Ve,oe[0]+=8,ce[0]-=8,Xe[0]=ht}else Xe[0]=5<=ce[0]&&Ve[Ue+0]==47&&!(Ve[Ue+4]>>5),Ee[0]=ce[0];oe=0}if(A=A[0],pe.Ja=pe.Ja[0],pe.xa=pe.xa[0],g=g[0],oe!=0)break;if(4294967286<pe.Ja)return 3;if(q==null||Ae||(q[0]=pe.xa?2:1),U=[U],Pe=[Pe],pe.xa){if(5>A){oe=7;break}q=U,be=Pe,Ae=D,h==null||5>A?h=0:5<=A&&h[g+0]==47&&!(h[g+4]>>5)?(ce=[0],Ve=[0],Te=[0],Z(Ee=new L,h,g,A),lt(Ee,ce,Ve,Te)?(q!=null&&(q[0]=ce[0]),be!=null&&(be[0]=Ve[0]),Ae!=null&&(Ae[0]=Te[0]),h=1):h=0):h=0}else{if(10>A){oe=7;break}q=Pe,h==null||10>A||!hf(h,g+3,A-3)?h=0:(be=h[g+0]|h[g+1]<<8|h[g+2]<<16,Ae=16383&(h[g+7]<<8|h[g+6]),h=16383&(h[g+9]<<8|h[g+8]),1&be||3<(be>>1&7)||!(be>>4&1)||be>>5>=pe.Ja||!Ae||!h?h=0:(U&&(U[0]=Ae),q&&(q[0]=h),h=1))}if(!h||(U=U[0],Pe=Pe[0],ye&&(G[0]!=U||ae[0]!=Pe)))return 3;H!=null&&(H[0]=pe,H.offset=g-H.w,e(4294967286>g-H.w),e(H.offset==H.ha-A));break}return oe==0||oe==7&&ye&&H==null?(D!=null&&(D[0]|=pe.na!=null&&0<pe.na.length),N!=null&&(N[0]=U),R!=null&&(R[0]=Pe),0):oe}function Ag(h,g,A){var N=g.width,R=g.height,D=0,U=0,q=N,H=R;if(g.Da=h!=null&&0<h.Da,g.Da&&(q=h.cd,H=h.bd,D=h.v,U=h.j,11>A||(D&=-2,U&=-2),0>D||0>U||0>=q||0>=H||D+q>N||U+H>R))return 0;if(g.v=D,g.j=U,g.va=D+q,g.o=U+H,g.U=q,g.T=H,g.da=h!=null&&0<h.da,g.da){if(!St(q,H,A=[h.ib],D=[h.hb]))return 0;g.ib=A[0],g.hb=D[0]}return g.ob=h!=null&&h.ob,g.Kb=h==null||!h.Sd,g.da&&(g.ob=g.ib<3*N/4&&g.hb<3*R/4,g.Kb=0),1}function Sg(h){if(h==null)return 2;if(11>h.S){var g=h.f.RGBA;g.fb+=(h.height-1)*g.A,g.A=-g.A}else g=h.f.kb,h=h.height,g.O+=(h-1)*g.fa,g.fa=-g.fa,g.N+=(h-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(h-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(h-1)*g.lb,g.lb=-g.lb);return 0}function _f(h,g,A,N){if(N==null||0>=h||0>=g)return 2;if(A!=null){if(A.Da){var R=A.cd,D=A.bd,U=-2&A.v,q=-2&A.j;if(0>U||0>q||0>=R||0>=D||U+R>h||q+D>g)return 2;h=R,g=D}if(A.da){if(!St(h,g,R=[A.ib],D=[A.hb]))return 2;h=R[0],g=D[0]}}N.width=h,N.height=g;e:{var H=N.width,G=N.height;if(h=N.S,0>=H||0>=G||!(h>=py&&13>h))h=2;else{if(0>=N.Rd&&N.sd==null){U=D=R=g=0;var ae=(q=H*$3[h])*G;if(11>h||(D=(G+1)/2*(g=(H+1)/2),h==12&&(U=(R=H)*G)),(G=i(ae+2*D+U))==null){h=1;break e}N.sd=G,11>h?((H=N.f.RGBA).eb=G,H.fb=0,H.A=q,H.size=ae):((H=N.f.kb).y=G,H.O=0,H.fa=q,H.Fd=ae,H.f=G,H.N=0+ae,H.Ab=g,H.Cd=D,H.ea=G,H.W=0+ae+D,H.Db=g,H.Ed=D,h==12&&(H.F=G,H.J=0+ae+2*D),H.Tc=U,H.lb=R)}if(g=1,R=N.S,D=N.width,U=N.height,R>=py&&13>R)if(11>R)h=N.f.RGBA,g&=(q=Math.abs(h.A))*(U-1)+D<=h.size,g&=q>=D*$3[R],g&=h.eb!=null;else{h=N.f.kb,q=(D+1)/2,ae=(U+1)/2,H=Math.abs(h.fa),G=Math.abs(h.Ab);var ye=Math.abs(h.Db),be=Math.abs(h.lb),pe=be*(U-1)+D;g&=H*(U-1)+D<=h.Fd,g&=G*(ae-1)+q<=h.Cd,g=(g&=ye*(ae-1)+q<=h.Ed)&H>=D&G>=q&ye>=q,g&=h.y!=null,g&=h.f!=null,g&=h.ea!=null,R==12&&(g&=be>=D,g&=pe<=h.Tc,g&=h.F!=null)}else g=0;h=g?0:2}}return h!=0||A!=null&&A.fd&&(h=Sg(N)),h}var er=64,Af=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Sf=24,kf=32,kg=8,ii=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];$e("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(h){return h},T.Predictor2=function(h,g,A){return g[A+0]},T.Predictor3=function(h,g,A){return g[A+1]},T.Predictor4=function(h,g,A){return g[A-1]},T.Predictor5=function(h,g,A){return De(De(h,g[A+1]),g[A+0])},T.Predictor6=function(h,g,A){return De(h,g[A-1])},T.Predictor7=function(h,g,A){return De(h,g[A+0])},T.Predictor8=function(h,g,A){return De(g[A-1],g[A+0])},T.Predictor9=function(h,g,A){return De(g[A+0],g[A+1])},T.Predictor10=function(h,g,A){return De(De(h,g[A-1]),De(g[A+0],g[A+1]))},T.Predictor11=function(h,g,A){var N=g[A+0];return 0>=_t(N>>24&255,h>>24&255,(g=g[A-1])>>24&255)+_t(N>>16&255,h>>16&255,g>>16&255)+_t(N>>8&255,h>>8&255,g>>8&255)+_t(255&N,255&h,255&g)?N:h},T.Predictor12=function(h,g,A){var N=g[A+0];return(Ke((h>>24&255)+(N>>24&255)-((g=g[A-1])>>24&255))<<24|Ke((h>>16&255)+(N>>16&255)-(g>>16&255))<<16|Ke((h>>8&255)+(N>>8&255)-(g>>8&255))<<8|Ke((255&h)+(255&N)-(255&g)))>>>0},T.Predictor13=function(h,g,A){var N=g[A-1];return(kt((h=De(h,g[A+0]))>>24&255,N>>24&255)<<24|kt(h>>16&255,N>>16&255)<<16|kt(h>>8&255,N>>8&255)<<8|kt(h>>0&255,N>>0&255))>>>0};var m5=T.PredictorAdd0;T.PredictorAdd1=Tt,$e("Predictor2","PredictorAdd2"),$e("Predictor3","PredictorAdd3"),$e("Predictor4","PredictorAdd4"),$e("Predictor5","PredictorAdd5"),$e("Predictor6","PredictorAdd6"),$e("Predictor7","PredictorAdd7"),$e("Predictor8","PredictorAdd8"),$e("Predictor9","PredictorAdd9"),$e("Predictor10","PredictorAdd10"),$e("Predictor11","PredictorAdd11"),$e("Predictor12","PredictorAdd12"),$e("Predictor13","PredictorAdd13");var Ng=T.PredictorAdd2;Ft("ColorIndexInverseTransform","MapARGB","32b",function(h){return h>>8&255},function(h){return h}),Ft("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(h){return h},function(h){return h>>8&255});var ly,ca=T.ColorIndexInverseTransform,Nf=T.MapARGB,cy=T.VP8LColorIndexInverseTransformAlpha,uy=T.MapAlpha,Lc=T.VP8LPredictorsAdd=[];Lc.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var pd,ai,Fr,Tc,yl,bl,Cf,wl,is,Cg,Dr,ua,Ef,dy,Eg,md,gd,Ic,vd,Pf,yd,jc,Pg,da,ha,Sn,kn,as,ks=i(511),xl=i(2041),Lg=i(225),Lf=i(767),hy=0,g5=xl,fy=Lg,Ei=Lf,fa=ks,py=0,my=1,P3=2,gy=3,vy=4,v5=5,L3=6,y5=7,b5=8,yy=9,w5=10,hj=[2,3,7],fj=[3,3,11],T3=[280,256,256,256,40],pj=[0,1,1,1,0],mj=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],gj=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],vj=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],yj=8,x5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],_5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Tg=null,bj=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],wj=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],I3=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xj=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],_j=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Aj=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Sj=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Rc=[],Ua=[],_l=[],kj=1,j3=2,Oc=[],pa=[];ke("UpsampleRgbLinePair",Xt,3),ke("UpsampleBgrLinePair",qn,3),ke("UpsampleRgbaLinePair",$a,4),ke("UpsampleBgraLinePair",Bs,4),ke("UpsampleArgbLinePair",pr,4),ke("UpsampleRgba4444LinePair",ms,2),ke("UpsampleRgb565LinePair",Zn,2);var Nj=T.UpsampleRgbLinePair,Cj=T.UpsampleBgrLinePair,R3=T.UpsampleRgbaLinePair,O3=T.UpsampleBgraLinePair,M3=T.UpsampleArgbLinePair,F3=T.UpsampleRgba4444LinePair,Ej=T.UpsampleRgb565LinePair,by=16,wy=1<<by-1,Ig=-227,A5=482,Pj=6,D3=0,Lj=i(256),Tj=i(256),Ij=i(256),jj=i(256),Rj=i(A5-Ig),Oj=i(A5-Ig);To("YuvToRgbRow",Xt,3),To("YuvToBgrRow",qn,3),To("YuvToRgbaRow",$a,4),To("YuvToBgraRow",Bs,4),To("YuvToArgbRow",pr,4),To("YuvToRgba4444Row",ms,2),To("YuvToRgb565Row",Zn,2);var B3=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],xy=[0,2,8],Mj=[8,7,6,4,4,2,2,2,1,1,1,1],Fj=1;this.WebPDecodeRGBA=function(h,g,A,N,R){var D=my,U=new bf,q=new ei;U.ba=q,q.S=D,q.width=[q.width],q.height=[q.height];var H=q.width,G=q.height,ae=new ra;if(ae==null||h==null)var ye=2;else e(ae!=null),ye=xf(h,g,A,ae.width,ae.height,ae.Pd,ae.Qd,ae.format,null);if(ye!=0?H=0:(H!=null&&(H[0]=ae.width[0]),G!=null&&(G[0]=ae.height[0]),H=1),H){q.width=q.width[0],q.height=q.height[0],N!=null&&(N[0]=q.width),R!=null&&(R[0]=q.height);e:{if(N=new xc,(R=new vg).data=h,R.w=g,R.ha=A,R.kd=1,g=[0],e(R!=null),((h=xf(R.data,R.w,R.ha,null,null,null,g,null,R))==0||h==7)&&g[0]&&(h=4),(g=h)==0){if(e(U!=null),N.data=R.data,N.w=R.w+R.offset,N.ha=R.ha-R.offset,N.put=aa,N.ac=Qn,N.bc=ti,N.ma=U,R.xa){if((h=Zs())==null){U=1;break e}if(function(be,pe){var Pe=[0],Ae=[0],oe=[0];t:for(;;){if(be==null)return 0;if(pe==null)return be.a=2,0;if(be.l=pe,be.a=0,Z(be.m,pe.data,pe.w,pe.ha),!lt(be.m,Pe,Ae,oe)){be.a=3;break t}if(be.xb=j3,pe.width=Pe[0],pe.height=Ae[0],!la(Pe[0],Ae[0],1,be,null))break t;return 1}return e(be.a!=0),0}(h,N)){if(N=(g=_f(N.width,N.height,U.Oa,U.ba))==0){t:{N=h;n:for(;;){if(N==null){N=0;break t}if(e(N.s.yc!=null),e(N.s.Ya!=null),e(0<N.s.Wb),e((A=N.l)!=null),e((R=A.ma)!=null),N.xb!=0){if(N.ca=R.ba,N.tb=R.tb,e(N.ca!=null),!Ag(R.Oa,A,gy)){N.a=2;break n}if(!si(N,A.width)||A.da)break n;if((A.da||Kt(N.ca.S))&&ge(),11>N.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),N.ca.f.kb.F!=null&&ge()),N.Pb&&0<N.s.ua&&N.s.vb.X==null&&!at(N.s.vb,N.s.Wa.Xa)){N.a=1;break n}N.xb=0}if(!ps(N,N.V,N.Ba,N.c,N.i,A.o,Or))break n;R.Dc=N.Ma,N=1;break t}e(N.a!=0),N=0}N=!N}N&&(g=h.a)}else g=h.a}else{if((h=new ug)==null){U=1;break e}if(h.Fa=R.na,h.P=R.P,h.qc=R.Sa,ld(h,N)){if((g=_f(N.width,N.height,U.Oa,U.ba))==0){if(h.Aa=0,A=U.Oa,e((R=h)!=null),A!=null){if(0<(H=0>(H=A.Md)?0:100<H?255:255*H/100)){for(G=ae=0;4>G;++G)12>(ye=R.pb[G]).lc&&(ye.ia=H*Mj[0>ye.lc?0:ye.lc]>>3),ae|=ye.ia;ae&&(alert("todo:VP8InitRandom"),R.ia=1)}R.Ga=A.Id,100<R.Ga?R.Ga=100:0>R.Ga&&(R.Ga=0)}dg(h,N)||(g=h.a)}}else g=h.a}g==0&&U.Oa!=null&&U.Oa.fd&&(g=Sg(U.ba))}U=g}D=U!=0?null:11>D?q.f.RGBA.eb:q.f.kb.y}else D=null;return D};var $3=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(T,W){for(var Y="",I=0;I<4;I++)Y+=String.fromCharCode(T[W++]);return Y}function u(T,W){return(T[W+0]<<0|T[W+1]<<8|T[W+2]<<16)>>>0}function f(T,W){return(T[W+0]<<0|T[W+1]<<8|T[W+2]<<16|T[W+3]<<24)>>>0}new l;var p=[0],m=[0],b=[],y=new l,S=s,w=function(T,W){var Y={},I=0,O=!1,X=0,K=0;if(Y.frames=[],!function(V,Q,se,re){for(var de=0;de<re;de++)if(V[Q+de]!=se.charCodeAt(de))return!0;return!1}(T,W,"RIFF",4)){var ne,te;for(f(T,W+=4),W+=8;W<T.length;){var ue=c(T,W),Z=f(T,W+=4);W+=4;var he=Z+(1&Z);switch(ue){case"VP8 ":case"VP8L":Y.frames[I]===void 0&&(Y.frames[I]={}),(L=Y.frames[I]).src_off=O?K:W-8,L.src_size=X+Z+8,I++,O&&(O=!1,X=0,K=0);break;case"VP8X":(L=Y.header={}).feature_flags=T[W];var me=W+4;L.canvas_width=1+u(T,me),me+=3,L.canvas_height=1+u(T,me),me+=3;break;case"ALPH":O=!0,X=he+8,K=W-8;break;case"ANIM":(L=Y.header).bgcolor=f(T,W),me=W+4,L.loop_count=(ne=T)[(te=me)+0]<<0|ne[te+1]<<8,me+=2;break;case"ANMF":var Ne,L;(L=Y.frames[I]={}).offset_x=2*u(T,W),W+=3,L.offset_y=2*u(T,W),W+=3,L.width=1+u(T,W),W+=3,L.height=1+u(T,W),W+=3,L.duration=u(T,W),W+=3,Ne=T[W++],L.dispose=1&Ne,L.blend=Ne>>1&1}ue!="ANMF"&&(W+=he)}return Y}}(S,0);w.response=S,w.rgbaoutput=!0,w.dataurl=!1;var _=w.header?w.header:null,k=w.frames?w.frames:null;if(_){_.loop_counter=_.loop_count,p=[_.canvas_height],m=[_.canvas_width];for(var C=0;C<k.length&&k[C].blend!=0;C++);}var B=k[0],F=y.WebPDecodeRGBA(S,B.src_off,B.src_size,m,p);B.rgba=F,B.imgwidth=m[0],B.imgheight=p[0];for(var j=0;j<m[0]*p[0]*4;j++)b[j]=F[j];return this.width=m,this.height=p,this.data=b,this}(function(s){var e=function(){return typeof _S=="function"},t=function(p,m,b,y){var S=4,w=a;switch(y){case s.image_compression.FAST:S=1,w=i;break;case s.image_compression.MEDIUM:S=6,w=o;break;case s.image_compression.SLOW:S=9,w=l}p=n(p,m,b,w);var _=_S(p,{level:S});return s.__addimage__.arrayBufferToBinaryString(_)},n=function(p,m,b,y){for(var S,w,_,k=p.length/m,C=new Uint8Array(p.length+k),B=u(),F=0;F<k;F+=1){if(_=F*m,S=p.subarray(_,_+m),y)C.set(y(S,b,w),_+F);else{for(var j,T=B.length,W=[];j<T;j+=1)W[j]=B[j](S,b,w);var Y=f(W.concat());C.set(W[Y],_+F)}w=S}return C},r=function(p){var m=Array.apply([],p);return m.unshift(0),m},i=function(p,m){var b,y=[],S=p.length;y[0]=1;for(var w=0;w<S;w+=1)b=p[w-m]||0,y[w+1]=p[w]-b+256&255;return y},a=function(p,m,b){var y,S=[],w=p.length;S[0]=2;for(var _=0;_<w;_+=1)y=b&&b[_]||0,S[_+1]=p[_]-y+256&255;return S},o=function(p,m,b){var y,S,w=[],_=p.length;w[0]=3;for(var k=0;k<_;k+=1)y=p[k-m]||0,S=b&&b[k]||0,w[k+1]=p[k]+256-(y+S>>>1)&255;return w},l=function(p,m,b){var y,S,w,_,k=[],C=p.length;k[0]=4;for(var B=0;B<C;B+=1)y=p[B-m]||0,S=b&&b[B]||0,w=b&&b[B-m]||0,_=c(y,S,w),k[B+1]=p[B]-_+256&255;return k},c=function(p,m,b){if(p===m&&m===b)return p;var y=Math.abs(m-b),S=Math.abs(p-b),w=Math.abs(p+m-b-b);return y<=S&&y<=w?p:S<=w?m:b},u=function(){return[r,i,a,o,l]},f=function(p){var m=p.map(function(b){return b.reduce(function(y,S){return y+Math.abs(S)},0)});return m.indexOf(Math.min.apply(null,m))};s.processPNG=function(p,m,b,y){var S,w,_,k,C,B,F,j,T,W,Y,I,O,X,K,ne=this.decode.FLATE_DECODE,te="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(_=new t$(p)).imgData,w=_.bits,S=_.colorSpace,C=_.colors,[4,6].indexOf(_.colorType)!==-1){if(_.bits===8){T=(j=_.pixelBitlength==32?new Uint32Array(_.decodePixels().buffer):_.pixelBitlength==16?new Uint16Array(_.decodePixels().buffer):new Uint8Array(_.decodePixels().buffer)).length,Y=new Uint8Array(T*_.colors),W=new Uint8Array(T);var ue,Z=_.pixelBitlength-_.bits;for(X=0,K=0;X<T;X++){for(O=j[X],ue=0;ue<Z;)Y[K++]=O>>>ue&255,ue+=_.bits;W[X]=O>>>ue&255}}if(_.bits===16){T=(j=new Uint32Array(_.decodePixels().buffer)).length,Y=new Uint8Array(T*(32/_.pixelBitlength)*_.colors),W=new Uint8Array(T*(32/_.pixelBitlength)),I=_.colors>1,X=0,K=0;for(var he=0;X<T;)O=j[X++],Y[K++]=O>>>0&255,I&&(Y[K++]=O>>>16&255,O=j[X++],Y[K++]=O>>>0&255),W[he++]=O>>>16&255;w=8}y!==s.image_compression.NONE&&e()?(p=t(Y,_.width*_.colors,_.colors,y),F=t(W,_.width,1,y)):(p=Y,F=W,ne=void 0)}if(_.colorType===3&&(S=this.color_spaces.INDEXED,B=_.palette,_.transparency.indexed)){var me=_.transparency.indexed,Ne=0;for(X=0,T=me.length;X<T;++X)Ne+=me[X];if((Ne/=255)===T-1&&me.indexOf(0)!==-1)k=[me.indexOf(0)];else if(Ne!==T){for(j=_.decodePixels(),W=new Uint8Array(j.length),X=0,T=j.length;X<T;X++)W[X]=me[j[X]];F=t(W,_.width,1)}}var L=function(V){var Q;switch(V){case s.image_compression.FAST:Q=11;break;case s.image_compression.MEDIUM:Q=13;break;case s.image_compression.SLOW:Q=14;break;default:Q=12}return Q}(y);return ne===this.decode.FLATE_DECODE&&(te="/Predictor "+L+" "),te+="/Colors "+C+" /BitsPerComponent "+w+" /Columns "+_.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(F&&this.__addimage__.isArrayBuffer(F)||this.__addimage__.isArrayBufferView(F))&&(F=this.__addimage__.arrayBufferToBinaryString(F)),{alias:b,data:p,index:m,filter:ne,decodeParameters:te,transparency:k,palette:B,sMask:F,predictor:L,width:_.width,height:_.height,bitsPerComponent:w,colorSpace:S}}}})(yt.API),function(s){s.processGIF89A=function(e,t,n,r){var i=new n$(e),a=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:a,height:o},u=new $x(100).encode(c,100);return s.processJPEG.call(this,u,t,n,r)},s.processGIF87A=s.processGIF89A}(yt.API),Wa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var s=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(s);for(var e=0;e<s;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:r,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wa.prototype.parseBGR=function(){this.pos=this.offset;try{var s="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[s]()}catch(t){_n.log("bit decode error:"+t)}},Wa.prototype.bit1=function(){var s,e=Math.ceil(this.width/8),t=e%4;for(s=this.height-1;s>=0;s--){for(var n=this.bottom_up?s:this.height-1-s,r=0;r<e;r++)for(var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[a+4*o]=l.blue,this.data[a+4*o+1]=l.green,this.data[a+4*o+2]=l.red,this.data[a+4*o+3]=255}t!==0&&(this.pos+=4-t)}},Wa.prototype.bit4=function(){for(var s=Math.ceil(this.width/2),e=s%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<s;r++){var i=this.datav.getUint8(this.pos++,!0),a=n*this.width*4+2*r*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[a]=c.blue,this.data[a+1]=c.green,this.data[a+2]=c.red,this.data[a+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[a+4]=c.blue,this.data[a+4+1]=c.green,this.data[a+4+2]=c.red,this.data[a+4+3]=255}e!==0&&(this.pos+=4-e)}},Wa.prototype.bit8=function(){for(var s=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(r<this.palette.length){var a=this.palette[r];this.data[i]=a.red,this.data[i+1]=a.green,this.data[i+2]=a.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}s!==0&&(this.pos+=4-s)}},Wa.prototype.bit15=function(){for(var s=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,o=(i>>5&e)/e*255|0,l=(i>>10&e)/e*255|0,c=i>>15?255:0,u=n*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=a,this.data[u+3]=c}this.pos+=s}},Wa.prototype.bit16=function(){for(var s=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,l=(a>>5&t)/t*255|0,c=(a>>11)/e*255|0,u=r*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=s}},Wa.prototype.bit24=function(){for(var s=this.height-1;s>=0;s--){for(var e=this.bottom_up?s:this.height-1-s,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=i,this.data[a+1]=r,this.data[a+2]=n,this.data[a+3]=255}this.pos+=this.width%4}},Wa.prototype.bit32=function(){for(var s=this.height-1;s>=0;s--)for(var e=this.bottom_up?s:this.height-1-s,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=r,this.data[o+2]=n,this.data[o+3]=a}},Wa.prototype.getData=function(){return this.data},function(s){s.processBMP=function(e,t,n,r){var i=new Wa(e,!1),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new $x(100).encode(l,100);return s.processJPEG.call(this,c,t,n,r)}}(yt.API),$E.prototype.getData=function(){return this.data},function(s){s.processWEBP=function(e,t,n,r){var i=new $E(e),a=i.width,o=i.height,l={data:i.getData(),width:a,height:o},c=new $x(100).encode(l,100);return s.processJPEG.call(this,c,t,n,r)}}(yt.API),yt.API.processRGBA=function(s,e,t){for(var n=s.data,r=n.length,i=new Uint8Array(r/4*3),a=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=n[c],f=n[c+1],p=n[c+2],m=n[c+3];i[o++]=u,i[o++]=f,i[o++]=p,a[l++]=m}var b=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(a),data:b,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:s.width,height:s.height}},yt.API.setLanguage=function(s){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[s]!==void 0&&(this.internal.languageSettings.languageCode=s,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Gf=yt.API,pb=Gf.getCharWidthsArray=function(s,e){var t,n,r=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),a=e.charSpace||this.internal.getCharSpace(),o=e.widths?e.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=e.kerning?e.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=e.doKerning!==!1,p=0,m=s.length,b=0,y=o[0]||l,S=[];for(t=0;t<m;t++)n=s.charCodeAt(t),typeof r.metadata.widthOfString=="function"?S.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+a*(1e3/i)||0)/1e3):(p=f&&fn(c[n])==="object"&&!isNaN(parseInt(c[n][b],10))?c[n][b]/u:0,S.push((o[n]||y)/l+p)),b=n;return S},ME=Gf.getStringUnitWidth=function(s,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),r=e.charSpace||this.internal.getCharSpace();return Gf.processArabic&&(s=Gf.processArabic(s)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(s,t,r)/t:pb.apply(this,arguments).reduce(function(i,a){return i+a},0)},FE=function(s,e,t,n){for(var r=[],i=0,a=s.length,o=0;i!==a&&o+e[i]<t;)o+=e[i],i++;r.push(s.slice(0,i));var l=i;for(o=0;i!==a;)o+e[i]>n&&(r.push(s.slice(l,i)),o=0,l=i),o+=e[i],i++;return l!==i&&r.push(s.slice(l,i)),r},DE=function(s,e,t){t||(t={});var n,r,i,a,o,l,c,u=[],f=[u],p=t.textIndent||0,m=0,b=0,y=s.split(" "),S=pb.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?y[0].length+2:t.lineIndent||0){var w=Array(l).join(" "),_=[];y.map(function(C){(C=C.split(/\s*\n/)).length>1?_=_.concat(C.map(function(B,F){return(F&&B.length?`
`:"")+B})):_.push(C[0])}),y=_,l=ME.apply(this,[w,t])}for(i=0,a=y.length;i<a;i++){var k=0;if(n=y[i],l&&n[0]==`
`&&(n=n.substr(1),k=1),p+m+(b=(r=pb.apply(this,[n,t])).reduce(function(C,B){return C+B},0))>e||k){if(b>e){for(o=FE.apply(this,[n,r,e-(p+m),e]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);b=r.slice(n.length-(u[0]?u[0].length:0)).reduce(function(C,B){return C+B},0)}else u=[n];f.push(u),p=b+l,m=S}else u.push(n),p+=m+b,m=S}return c=l?function(C,B){return(B?w:"")+C.join(" ")}:function(C){return C.join(" ")},f.map(c)},Gf.splitTextToSize=function(s,e,t){var n,r=(t=t||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);n=Array.isArray(s)?s:String(s).split(/\r?\n/);var a=1*this.internal.scaleFactor*e/r;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/r:0,i.lineIndent=t.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(DE.apply(this,[n[o],a,i]));return c},function(s){s.__fontmetrics__=s.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},r=0;r<e.length;r++)t[e[r]]="0123456789abcdef"[r],n["0123456789abcdef"[r]]=e[r];var i=function(f){return"0x"+parseInt(f,10).toString(16)},a=s.__fontmetrics__.compress=function(f){var p,m,b,y,S=["{"];for(var w in f){if(p=f[w],isNaN(parseInt(w,10))?m="'"+w+"'":(w=parseInt(w,10),m=(m=i(w).slice(2)).slice(0,-1)+n[m.slice(-1)]),typeof p=="number")p<0?(b=i(p).slice(3),y="-"):(b=i(p).slice(2),y=""),b=y+b.slice(0,-1)+n[b.slice(-1)];else{if(fn(p)!=="object")throw new Error("Don't know what to do with value type "+fn(p)+".");b=a(p)}S.push(m+b)}return S.push("}"),S.join("")},o=s.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,b,y,S={},w=1,_=S,k=[],C="",B="",F=f.length-1,j=1;j<F;j+=1)(y=f[j])=="'"?p?(b=p.join(""),p=void 0):p=[]:p?p.push(y):y=="{"?(k.push([_,b]),_={},b=void 0):y=="}"?((m=k.pop())[0][m[1]]=_,b=void 0,_=m[0]):y=="-"?w=-1:b===void 0?t.hasOwnProperty(y)?(C+=t[y],b=parseInt(C,16)*w,w=1,C=""):C+=y:t.hasOwnProperty(y)?(B+=t[y],_[b]=parseInt(B,16)*w,w=1,b=void 0,B=""):B+=y;return S},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};s.events.push(["addFont",function(f){var p=f.font,m=u.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var b=c.Unicode[p.postScriptName];b&&(p.metadata.Unicode.encoding=b,p.encoding=b.codePages[0])}])}(yt.API),function(s){var e=function(t){for(var n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r};s.API.events.push(["addFont",function(t){var n=void 0,r=t.font,i=t.instance;if(!r.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(n=i.existsFileInVFS(r.postScriptName)===!1?i.loadFile(r.postScriptName):i.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(a,o){o=/^\x00\x01\x00\x00/.test(o)?e(o):e($0(o)),a.metadata=s.API.TTFFont.open(o),a.metadata.Unicode=a.metadata.Unicode||{encoding:{},kerning:{},widths:[]},a.metadata.glyIdsUsed=[0]})(r,n)}}])}(yt),function(s){function e(){return(bt.canvg?Promise.resolve(bt.canvg):Ku(()=>import("./index.es-CO81Co2h.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}yt.API.addSvgAsImage=function(t,n,r,i,a,o,l,c){if(isNaN(n)||isNaN(r))throw _n.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(a))throw _n.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=a;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},m=this;return e().then(function(b){return b.fromString(f,t,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(p)}).then(function(){m.addImage(u.toDataURL("image/jpeg",1),n,r,i,a,l,c)})}}(),yt.API.putTotalPages=function(s){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(s,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(s,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(e,t);return this},yt.API.viewerPreferences=function(s,e){var t;s=s||{},e=e||!1;var n,r,i,a={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(a),l=[],c=0,u=0,f=0;function p(b,y){var S,w=!1;for(S=0;S<b.length;S+=1)b[S]===y&&(w=!0);return w}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(a)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,s==="reset"||e===!0){var m=o.length;for(f=0;f<m;f+=1)t[o[f]].value=t[o[f]].defaultValue,t[o[f]].explicitSet=!1}if(fn(s)==="object"){for(r in s)if(i=s[r],p(o,r)&&i!==void 0){if(t[r].type==="boolean"&&typeof i=="boolean")t[r].value=i;else if(t[r].type==="name"&&p(t[r].valueSet,i))t[r].value=i;else if(t[r].type==="integer"&&Number.isInteger(i))t[r].value=i;else if(t[r].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}t[r].value="["+l.join(" ")+"]"}else t[r].value=t[r].defaultValue;t[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,y=[];for(b in t)t[b].explicitSet===!0&&(t[b].type==="name"?y.push("/"+b+" /"+t[b].value):y.push("/"+b+" "+t[b].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(s){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+a.length+o.length+r.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(r+i+a+o+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};s.addMetadata=function(n,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(yt.API),function(s){var e=s.API,t=e.pdfEscape16=function(i,a){for(var o,l=a.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,p=i.length;f<p;++f){if(o=a.metadata.characterToGlyph(i.charCodeAt(f)),a.metadata.glyIdsUsed.push(o),a.metadata.toUnicode[o]=i.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(a.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var a,o,l,c,u,f,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,p=(o=Object.keys(i).sort(function(m,b){return m-b})).length;f<p;f++)a=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[a]!==void 0&&i[a]!==null&&typeof i[a].toString=="function"&&(c=("0000"+i[a].toString(16)).slice(-4),a=("0000"+(+a).toString(16)).slice(-4),l.push("<"+a+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof s.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),m="",b=0;b<p.length;b++)m+=String.fromCharCode(p[b]);var y=c();u({data:m,addLength1:!0,objectId:y}),l("endobj");var S=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:S}),l("endobj");var w=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+op(o.fontName)),l("/FontFile2 "+y+" 0 R"),l("/FontBBox "+s.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var _=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+op(o.fontName)),l("/FontDescriptor "+w+" 0 R"),l("/W "+s.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+S+" 0 R"),l("/BaseFont /"+op(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+_+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(a){var o=a.font,l=a.out,c=a.newObject,u=a.putStream;if(o.metadata instanceof s.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,p="",m=0;m<f.length;m++)p+=String.fromCharCode(f[m]);var b=c();u({data:p,addLength1:!0,objectId:b}),l("endobj");var y=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var S=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+b+" 0 R"),l("/Flags 96"),l("/FontBBox "+s.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+op(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var w=0;w<o.metadata.hmtx.widths.length;w++)o.metadata.hmtx.widths[w]=parseInt(o.metadata.hmtx.widths[w]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+op(o.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+s.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var r=function(i){var a,o=i.text||"",l=i.x,c=i.y,u=i.options||{},f=i.mutex||{},p=f.pdfEscape,m=f.activeFontKey,b=f.fonts,y=m,S="",w=0,_="",k=b[y].encoding;if(b[y].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(_=o,y=m,Array.isArray(o)&&(_=o[0]),w=0;w<_.length;w+=1)b[y].metadata.hasOwnProperty("cmap")&&(a=b[y].metadata.cmap.unicode.codeMap[_[w].charCodeAt(0)]),a||_[w].charCodeAt(0)<256&&b[y].metadata.hasOwnProperty("Unicode")?S+=_[w]:S+="";var C="";return parseInt(y.slice(1))<14||k==="WinAnsiEncoding"?C=p(S,y).split("").map(function(B){return B.charCodeAt(0).toString(16)}).join(""):k==="Identity-H"&&(C=t(S,b[y])),f.isHex=!0,{text:C,x:l,y:c,options:u,mutex:f}};e.events.push(["postProcessText",function(i){var a=i.text||"",o=[],l={text:a,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(a)){var c=0;for(c=0;c<a.length;c+=1)Array.isArray(a[c])&&a[c].length===3?o.push([r(Object.assign({},l,{text:a[c][0]})).text,a[c][1],a[c][2]]):o.push(r(Object.assign({},l,{text:a[c]})).text);i.text=o}else i.text=r(Object.assign({},l,{text:a})).text}])}(yt),function(s){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};s.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},s.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},s.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(yt.API),function(s){s.__bidiEngine__=s.prototype.__bidiEngine__=function(n){var r,i,a,o,l,c,u,f=e,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],w=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),_=!1,k=0;this.__bidiEngine__={};var C=function(I){var O=I.charCodeAt(),X=O>>8,K=y[X];return K!==void 0?f[256*K+(255&O)]:X===252||X===253?"AL":w.test(X)?"L":X===8?"R":"N"},B=function(I){for(var O,X=0;X<I.length;X++){if((O=C(I.charAt(X)))==="L")return!1;if(O==="R")return!0}return!1},F=function(I,O,X,K){var ne,te,ue,Z,he=O[K];switch(he){case"L":case"R":_=!1;break;case"N":case"AN":break;case"EN":_&&(he="AN");break;case"AL":_=!0,he="R";break;case"WS":he="N";break;case"CS":K<1||K+1>=O.length||(ne=X[K-1])!=="EN"&&ne!=="AN"||(te=O[K+1])!=="EN"&&te!=="AN"?he="N":_&&(te="AN"),he=te===ne?te:"N";break;case"ES":he=(ne=K>0?X[K-1]:"B")==="EN"&&K+1<O.length&&O[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&X[K-1]==="EN"){he="EN";break}if(_){he="N";break}for(ue=K+1,Z=O.length;ue<Z&&O[ue]==="ET";)ue++;he=ue<Z&&O[ue]==="EN"?"EN":"N";break;case"NSM":if(a&&!o){for(Z=O.length,ue=K+1;ue<Z&&O[ue]==="NSM";)ue++;if(ue<Z){var me=I[K],Ne=me>=1425&&me<=2303||me===64286;if(ne=O[ue],Ne&&(ne==="R"||ne==="AL")){he="R";break}}}he=K<1||(ne=O[K-1])==="B"?"N":X[K-1];break;case"B":_=!1,r=!0,he=k;break;case"S":i=!0,he="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":_=!1;break;case"BN":he="N"}return he},j=function(I,O,X){var K=I.split("");return X&&T(K,X,{hiLevel:k}),K.reverse(),O&&O.reverse(),K.join("")},T=function(I,O,X){var K,ne,te,ue,Z,he=-1,me=I.length,Ne=0,L=[],V=k?m:p,Q=[];for(_=!1,r=!1,i=!1,ne=0;ne<me;ne++)Q[ne]=C(I[ne]);for(te=0;te<me;te++){if(Z=Ne,L[te]=F(I,Q,L,te),K=240&(Ne=V[Z][b[L[te]]]),Ne&=15,O[te]=ue=V[Ne][5],K>0)if(K===16){for(ne=he;ne<te;ne++)O[ne]=1;he=-1}else he=-1;if(V[Ne][6])he===-1&&(he=te);else if(he>-1){for(ne=he;ne<te;ne++)O[ne]=ue;he=-1}Q[te]==="B"&&(O[te]=0),X.hiLevel|=ue}i&&function(se,re,de){for(var le=0;le<de;le++)if(se[le]==="S"){re[le]=k;for(var we=le-1;we>=0&&se[we]==="WS";we--)re[we]=k}}(Q,O,me)},W=function(I,O,X,K,ne){if(!(ne.hiLevel<I)){if(I===1&&k===1&&!r)return O.reverse(),void(X&&X.reverse());for(var te,ue,Z,he,me=O.length,Ne=0;Ne<me;){if(K[Ne]>=I){for(Z=Ne+1;Z<me&&K[Z]>=I;)Z++;for(he=Ne,ue=Z-1;he<ue;he++,ue--)te=O[he],O[he]=O[ue],O[ue]=te,X&&(te=X[he],X[he]=X[ue],X[ue]=te);Ne=Z}Ne++}}},Y=function(I,O,X){var K=I.split(""),ne={hiLevel:k};return X||(X=[]),T(K,X,ne),function(te,ue,Z){if(Z.hiLevel!==0&&u)for(var he,me=0;me<te.length;me++)ue[me]===1&&(he=S.indexOf(te[me]))>=0&&(te[me]=S[he+1])}(K,X,ne),W(2,K,O,X,ne),W(1,K,O,X,ne),K.join("")};return this.__bidiEngine__.doBidiReorder=function(I,O,X){if(function(ne,te){if(te)for(var ue=0;ue<ne.length;ue++)te[ue]=ue;o===void 0&&(o=B(ne)),c===void 0&&(c=B(ne))}(I,O),a||!l||c)if(a&&l&&o^c)k=o?1:0,I=j(I,O,X);else if(!a&&l&&c)k=o?1:0,I=Y(I,O,X),I=j(I,O);else if(!a||o||l||c){if(a&&!l&&o^c)I=j(I,O),o?(k=0,I=Y(I,O,X)):(k=1,I=Y(I,O,X),I=j(I,O));else if(a&&o&&!l&&c)k=1,I=Y(I,O,X),I=j(I,O);else if(!a&&!l&&o^c){var K=u;o?(k=1,I=Y(I,O,X),k=0,u=!1,I=Y(I,O,X),u=K):(k=0,I=Y(I,O,X),I=j(I,O),k=1,u=!1,I=Y(I,O,X),u=K,I=j(I,O))}}else k=0,I=Y(I,O,X);else k=o?1:0,I=Y(I,O,X);return I},this.__bidiEngine__.setOptions=function(I){I&&(a=I.isInputVisual,l=I.isOutputVisual,o=I.isInputRtl,c=I.isOutputRtl,u=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new s.__bidiEngine__({isInputVisual:!0});s.API.events.push(["postProcessText",function(n){var r=n.text,i=(n.x,n.y,n.options||{}),a=(n.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(a=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?a.push([t.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):a.push([t.doBidiReorder(r[o])]);n.text=a}else n.text=t.doBidiReorder(r);t.setOptions({isInputVisual:!0})}])}(yt),yt.API.TTFFont=function(){function s(e){var t;if(this.rawData=e,t=this.contents=new Ju(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new v$(this),this.registerTTF()}return s.open=function(e){return new s(e)},s.prototype.parse=function(){return this.directory=new s$(this.contents),this.head=new i$(this),this.name=new u$(this),this.cmap=new lj(this),this.toUnicode={},this.hhea=new a$(this),this.maxp=new d$(this),this.hmtx=new h$(this),this.post=new l$(this),this.os2=new o$(this),this.loca=new g$(this),this.glyf=new f$(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},s.prototype.registerTTF=function(){var e,t,n,r,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var a,o,l,c;for(c=[],a=0,o=(l=this.bbox).length;a<o;a++)e=l[a],c.push(Math.round(e*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(t=r>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},s.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},s.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},s.prototype.widthOfString=function(e,t,n){var r,i,a,o;for(a=0,i=0,o=(e=""+e).length;0<=o?i<o:i>o;i=0<=o?++i:--i)r=e.charCodeAt(i),a+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/t)||0;return a*(t/1e3)},s.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},s}();var Ao,Ju=function(){function s(e){this.data=e??[],this.pos=0,this.length=this.data.length}return s.prototype.readByte=function(){return this.data[this.pos++]},s.prototype.writeByte=function(e){return this.data[this.pos++]=e},s.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},s.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},s.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},s.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},s.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},s.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},s.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},s.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},s.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},s.prototype.writeString=function(e){var t,n,r;for(r=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)r.push(this.writeByte(e.charCodeAt(t)));return r},s.prototype.readShort=function(){return this.readInt16()},s.prototype.writeShort=function(e){return this.writeInt16(e)},s.prototype.readLongLong=function(){var e,t,n,r,i,a,o,l;return e=this.readByte(),t=this.readByte(),n=this.readByte(),r=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^i)+65536*(255^a)+256*(255^o)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*r+16777216*i+65536*a+256*o+l},s.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},s.prototype.readInt=function(){return this.readInt32()},s.prototype.writeInt=function(e){return this.writeInt32(e)},s.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},s.prototype.write=function(e){var t,n,r,i;for(i=[],n=0,r=e.length;n<r;n++)t=e[n],i.push(this.writeByte(t));return i},s}(),s$=function(){var s;function e(t){var n,r,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},r=0,i=this.tableCount;0<=i?r<i:r>i;r=0<=i?++r:--r)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,r,i,a,o,l,c,u,f,p,m,b,y;for(y in m=Object.keys(t).length,l=Math.log(2),f=16*Math.floor(Math.log(m)/l),a=Math.floor(f/l),u=16*m-f,(r=new Ju).writeInt(this.scalarType),r.writeShort(m),r.writeShort(f),r.writeShort(a),r.writeShort(u),i=16*m,c=r.pos+i,o=null,b=[],t)for(p=t[y],r.writeString(y),r.writeInt(s(p)),r.writeInt(c),r.writeInt(p.length),b=b.concat(p),y==="head"&&(o=c),c+=p.length;c%4;)b.push(0),c++;return r.write(b),n=2981146554-s(r.data),r.pos=o+8,r.writeUInt32(n),r.data},s=function(t){var n,r,i,a;for(t=cj.call(t);t.length%4;)t.push(0);for(i=new Ju(t),r=0,n=0,a=t.length;n<a;n=n+=4)r+=i.readUInt32();return 4294967295&r},e}(),r$={}.hasOwnProperty,pl=function(s,e){for(var t in e)r$.call(e,t)&&(s[t]=e[t]);function n(){this.constructor=s}return n.prototype=e.prototype,s.prototype=new n,s.__super__=e.prototype,s};Ao=function(){function s(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return s.prototype.parse=function(){},s.prototype.encode=function(){},s.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},s}();var i$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new Ju).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),UE=function(){function s(e,t){var n,r,i,a,o,l,c,u,f,p,m,b,y,S,w,_,k;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(m=e.readUInt16(),p=m/2,e.pos+=6,i=function(){var C,B;for(B=[],l=C=0;0<=p?C<p:C>p;l=0<=p?++C:--C)B.push(e.readUInt16());return B}(),e.pos+=2,y=function(){var C,B;for(B=[],l=C=0;0<=p?C<p:C>p;l=0<=p?++C:--C)B.push(e.readUInt16());return B}(),c=function(){var C,B;for(B=[],l=C=0;0<=p?C<p:C>p;l=0<=p?++C:--C)B.push(e.readUInt16());return B}(),u=function(){var C,B;for(B=[],l=C=0;0<=p?C<p:C>p;l=0<=p?++C:--C)B.push(e.readUInt16());return B}(),r=(this.length-e.pos+this.offset)/2,o=function(){var C,B;for(B=[],l=C=0;0<=r?C<r:C>r;l=0<=r?++C:--C)B.push(e.readUInt16());return B}(),l=w=0,k=i.length;w<k;l=++w)for(S=i[l],n=_=b=y[l];b<=S?_<=S:_>=S;n=b<=S?++_:--_)u[l]===0?a=n+c[l]:(a=o[u[l]/2+(n-b)-(p-l)]||0)!==0&&(a+=c[l]),this.codeMap[n]=65535&a}e.pos=f}return s.encode=function(e,t){var n,r,i,a,o,l,c,u,f,p,m,b,y,S,w,_,k,C,B,F,j,T,W,Y,I,O,X,K,ne,te,ue,Z,he,me,Ne,L,V,Q,se,re,de,le,we,Le,je,Fe;switch(K=new Ju,a=Object.keys(e).sort(function(Be,at){return Be-at}),t){case"macroman":for(y=0,S=function(){var Be=[];for(b=0;b<256;++b)Be.push(0);return Be}(),_={0:0},i={},ne=0,he=a.length;ne<he;ne++)_[we=e[r=a[ne]]]==null&&(_[we]=++y),i[r]={old:e[r],new:_[e[r]]},S[r]=_[e[r]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(S),{charMap:i,subtable:K.data,maxGlyphID:y+1};case"unicode":for(O=[],f=[],k=0,_={},n={},w=c=null,te=0,me=a.length;te<me;te++)_[B=e[r=a[te]]]==null&&(_[B]=++k),n[r]={old:B,new:_[B]},o=_[B]-r,w!=null&&o===c||(w&&f.push(w),O.push(r),c=o),w=r;for(w&&f.push(w),f.push(65535),O.push(65535),Y=2*(W=O.length),T=2*Math.pow(Math.log(W)/Math.LN2,2),p=Math.log(T/2)/Math.LN2,j=2*W-T,l=[],F=[],m=[],b=ue=0,Ne=O.length;ue<Ne;b=++ue){if(I=O[b],u=f[b],I===65535){l.push(0),F.push(0);break}if(I-(X=n[I].new)>=32768)for(l.push(0),F.push(2*(m.length+W-b)),r=Z=I;I<=u?Z<=u:Z>=u;r=I<=u?++Z:--Z)m.push(n[r].new);else l.push(X-I),F.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*W+2*m.length),K.writeUInt16(0),K.writeUInt16(Y),K.writeUInt16(T),K.writeUInt16(p),K.writeUInt16(j),de=0,L=f.length;de<L;de++)r=f[de],K.writeUInt16(r);for(K.writeUInt16(0),le=0,V=O.length;le<V;le++)r=O[le],K.writeUInt16(r);for(Le=0,Q=l.length;Le<Q;Le++)o=l[Le],K.writeUInt16(o);for(je=0,se=F.length;je<se;je++)C=F[je],K.writeUInt16(C);for(Fe=0,re=m.length;Fe<re;Fe++)y=m[Fe],K.writeUInt16(y);return{charMap:n,subtable:K.data,maxGlyphID:k+1}}},s}(),lj=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,r,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=i?r<i:r>i;r=0<=i?++r:--r)n=new UE(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var r,i;return n==null&&(n="macroman"),r=UE.encode(t,n),(i=new Ju).writeUInt16(0),i.writeUInt16(1),r.table=i.data.concat(r.subtable),r},e}(),a$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),o$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(t.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),l$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="post",e.prototype.parse=function(t){var n,r,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var a;for(r=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)n=t.readByte(),i.push(this.names.push(t.readString(n)));return i;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],a=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;a=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),c$=function(s,e){this.raw=s,this.length=s.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},u$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="name",e.prototype.parse=function(t){var n,r,i,a,o,l,c,u,f,p,m;for(t.pos=this.offset,t.readShort(),n=t.readShort(),l=t.readShort(),r=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},a=f=0,p=r.length;f<p;a=++f)i=r[a],t.pos=i.offset,u=t.readString(i.length),o=new c$(u,i),c[m=i.nameID]==null&&(c[m]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),d$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),h$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,r,i,a,o,l,c;for(t.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(t.readInt16());return f}(),this.widths=(function(){var u,f,p,m;for(m=[],u=0,f=(p=this.metrics).length;u<f;u++)a=p[u],m.push(a.advance);return m}).call(this),r=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(r));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),cj=[].slice,f$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,r,i,a,o,l,c,u,f,p;return t in this.cache?this.cache[t]:(a=this.file.loca,n=this.file.contents,r=a.indexOf(t),(i=a.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+r,o=(l=new Ju(n.read(i))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[t]=o===-1?new m$(l,u,p,c,f):new p$(l,o,u,p,c,f),this.cache[t]))},e.prototype.encode=function(t,n,r){var i,a,o,l,c;for(o=[],a=[],l=0,c=n.length;l<c;l++)i=t[n[l]],a.push(o.length),i&&(o=o.concat(i.encode(r)));return a.push(o.length),{table:o,offsets:a}},e}(),p$=function(){function s(e,t,n,r,i,a){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=r,this.xMax=i,this.yMax=a,this.compound=!1}return s.prototype.encode=function(){return this.raw.data},s}(),m$=function(){function s(e,t,n,r,i){var a,o;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=r,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],a=this.raw;o=a.readShort(),this.glyphOffsets.push(a.pos),this.glyphIDs.push(a.readUInt16()),32&o;)a.pos+=1&o?4:2,128&o?a.pos+=8:64&o?a.pos+=4:8&o&&(a.pos+=2)}return s.prototype.encode=function(){var e,t,n;for(t=new Ju(cj.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},s}(),g$=function(s){function e(){return e.__super__.constructor.apply(this,arguments)}return pl(e,Ao),e.prototype.tag="loca",e.prototype.parse=function(t){var n,r;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,a;for(a=[],r=0,i=this.length;r<i;r+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],r=0,i=this.length;r<i;r+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var r=new Uint32Array(this.offsets.length),i=0,a=0,o=0;o<r.length;++o)if(r[o]=i,a<n.length&&n[a]==o){++a,r[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*r.length),f=0;f<r.length;++f)u[4*f+3]=255&r[f],u[4*f+2]=(65280&r[f])>>8,u[4*f+1]=(16711680&r[f])>>16,u[4*f]=(4278190080&r[f])>>24;return u},e}(),v$=function(){function s(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return s.prototype.generateCmap=function(){var e,t,n,r,i;for(t in r=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=r[n];return e},s.prototype.glyphsFor=function(e){var t,n,r,i,a,o,l;for(r={},a=0,o=e.length;a<o;a++)r[i=e[a]]=this.font.glyf.glyphFor(i);for(i in t=[],r)(n=r[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in l=this.glyphsFor(t))n=l[i],r[i]=n;return r},s.prototype.encode=function(e,t){var n,r,i,a,o,l,c,u,f,p,m,b,y,S,w;for(r in n=lj.encode(this.generateCmap(),"unicode"),a=this.glyphsFor(e),m={0:0},w=n.charMap)m[(l=w[r]).old]=l.new;for(b in p=n.maxGlyphID,a)b in m||(m[b]=p++);return u=function(_){var k,C;for(k in C={},_)C[_[k]]=k;return C}(m),f=Object.keys(u).sort(function(_,k){return _-k}),y=function(){var _,k,C;for(C=[],_=0,k=f.length;_<k;_++)o=f[_],C.push(u[o]);return C}(),i=this.font.glyf.encode(a,y,m),c=this.font.loca.encode(i.offsets,y),S={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},s}();yt.API.PDFObject=function(){var s;function e(){}return s=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,r,i,a;if(Array.isArray(t))return"["+function(){var o,l,c;for(c=[],o=0,l=t.length;o<l;o++)n=t[o],c.push(e.convert(n));return c}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+s(t.getUTCFullYear(),4)+s(t.getUTCMonth(),2)+s(t.getUTCDate(),2)+s(t.getUTCHours(),2)+s(t.getUTCMinutes(),2)+s(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(r in i=["<<"],t)a=t[r],i.push("/"+r+" "+e.convert(a));return i.push(">>"),i.join(`
`)}return""+t},e}();function zE(s){const e=new Date(s);return Number.isNaN(e.getTime())?new Date().toISOString().slice(0,10):e.toISOString().slice(0,10)}function y$(s){if(!s)return"N/A";const e=s.toLowerCase();return e==="dog"?"Dog":e==="cat"?"Cat":s}function uj(s){const e=parseFloat(String(s||"").replace(/[^0-9.\-]/g,""));return Number.isFinite(e)?e:0}function b$(s){return`$${uj(s).toFixed(2)}`}function w$(s){return`$${(Number.isFinite(s)?s:0).toFixed(2)}`}function x$(s,e){const t=new yt({unit:"pt",format:"letter"}),n=56,r=556,i=r-n;let a=64;const o=F=>{t.setFont("helvetica","bold"),t.setFontSize(18),t.text(F,n,a),a+=18,t.setDrawColor(64),t.setLineWidth(1),t.line(n,a+10,r,a+10),a+=24},l=(F,j)=>{t.setFont("helvetica","bold"),t.setFontSize(11),t.text(F,n,a),t.setFont("helvetica","normal"),t.setFontSize(11),t.text(j||"—",n+160,a),a+=18},c=F=>{t.setFont("helvetica","bold"),t.setFontSize(13),t.text(F,n,a),a+=14};o("Pet Insurance Claim Form"),c("Insurance Information"),l("Company",(e==null?void 0:e.insuranceCompany)||"N/A"),l("Policy Number",(e==null?void 0:e.policyNumber)||"N/A"),l("Invoice Number",s.invoiceNumber||"N/A"),a+=8,c("Pet Owner Information"),l("Owner Name",(e==null?void 0:e.ownerName)||"N/A"),l("Address",(e==null?void 0:e.ownerAddress)||"N/A"),l("Phone",(e==null?void 0:e.ownerPhone)||"N/A"),a+=8,c("Pet Information"),l("Pet Name",s.petName||(e==null?void 0:e.name)||"N/A"),l("Species",y$(e==null?void 0:e.species)),a+=8,c("Veterinary Clinic"),l("Clinic Name",s.clinicName||"N/A"),l("Clinic Address",s.clinicAddress||"N/A"),a+=8,c("Service Details"),l("Date of Service",s.dateOfService||zE(new Date().toISOString())),l("Diagnosis / Reason",s.diagnosis||"N/A"),a+=8,c("Itemized Charges");const u=Math.floor(i*.7),f=n,p=r,m=14;t.setFont("helvetica","bold"),t.text("Description",f,a),t.text("Amount",p,a,{align:"right"}),a+=14,t.setDrawColor(200),t.line(n,a,r,a),a+=10,s.lineItems.forEach(F=>{const j=F.description||"—",T=b$(F.amount);t.setFont("helvetica","normal"),t.setFontSize(11);const W=t.splitTextToSize(j,u);t.setFont("courier","normal"),t.text(T,p,a,{align:"right"}),t.setFont("helvetica","normal"),W.forEach((Y,I)=>{t.text(Y,f,a+I*m)}),a+=Math.max(m,W.length*m),a+=2}),s.lineItems.length===0&&(t.setFont("helvetica","normal"),t.text("No items",f,a),a+=16),a+=6,t.setDrawColor(64),t.line(n,a,r,a),a+=14,t.setFont("helvetica","bold"),t.text("Total",f,a),t.setFont("courier","bold"),t.text(w$(uj(s.totalAmount)),p,a,{align:"right"}),a+=24,t.setFont("helvetica","normal"),t.setFontSize(9),t.setTextColor(120);const b=742;t.setTextColor(40),t.setFont("helvetica","bold"),t.text("Filing Deadline Reminder",n,b),t.setFont("helvetica","normal"),t.setTextColor(80),t.setFontSize(9);const S=t.splitTextToSize("Most pet insurance requires claims to be filed within 60–180 days of service. This is a general reminder only. Always verify your specific deadline with your insurance provider.",r-n);t.text(S,n,b+14),t.setTextColor(120),t.text("Generated by Pet Claim Helper - petclaimhelper.com",n,760);const w=zE(s.dateOfService||new Date().toISOString()),_=(s.petName||(e==null?void 0:e.name)||"Pet").replace(/[^a-z0-9_\- ]/gi,"").replace(/\s+/g,"_"),k=((e==null?void 0:e.insuranceCompany)||"Insurance").replace(/[^a-z0-9_\- ]/gi,"").replace(/\s+/g,"_"),C=`${_}_${k}_claim_${w}.pdf`,B=new Blob([t.output("arraybuffer")],{type:"application/pdf"});return{filename:C,blob:B}}function _$(s,e){const t={clinicName:s.clinicName,clinicAddress:s.clinicAddress,petName:s.petName,dateOfService:s.dateOfService,totalAmount:s.subtotal,diagnosis:s.diagnosis,lineItems:s.lineItems,invoiceNumber:s.invoiceNumber};return x$(t,e)}function dj({open:s,onClose:e,onSaved:t,userId:n,pets:r,defaultPetId:i}){const[a,o]=xe.useState(""),[l,c]=xe.useState(""),[u,f]=xe.useState(""),[p,m]=xe.useState("1x daily"),[b,y]=xe.useState(["07:00"]),[S,w]=xe.useState("7"),[_,k]=xe.useState(7),[C,B]=xe.useState(!1),[F,j]=xe.useState(null);xe.useEffect(()=>{var O;s&&(o(i||(((O=r[0])==null?void 0:O.id)??"")),c(""),f(""),m("1x daily"),y(["07:00"]),w("7"),k(7),B(!1),j(null))},[s,i,r]),xe.useEffect(()=>{p==="1x daily"&&y(["07:00"]),p==="2x daily"&&y(["07:00","19:00"]),p==="3x daily"&&y(["08:00","14:00","20:00"])},[p]);const T=xe.useMemo(()=>p==="1x daily"?1:p==="2x daily"?2:3,[p]),W=(O,X)=>{const K=(X||"").slice(0,5),ne=[...b];ne[O]=K,y(ne)},Y=()=>{const O=new Date,X=O.toISOString().slice(0,10);let K=S==="custom"?Math.max(1,Number(_||1)):Number(S);(!Number.isFinite(K)||K<1)&&(K=1);const ne=new Date(O.getTime());ne.setDate(ne.getDate()+(K-1));const te=ne.toISOString().slice(0,10);return{start:X,end:te}},I=async O=>{if(O.preventDefault(),!n){j("You must be logged in.");return}if(!a){j("Please select a pet.");return}if(!l.trim()){j("Enter medication name.");return}if(b.some(X=>!/^\d{2}:\d{2}$/.test(X))){j("Please select valid reminder times.");return}if(b.length!==T){j("Reminder times do not match selected frequency.");return}B(!0),j(null);try{const{start:X,end:K}=Y(),ne={user_id:n,pet_id:a,claim_id:null,medication_name:l.trim(),dosage:u.trim()||null,frequency:p,reminder_times:b,start_date:X,end_date:K},{error:te}=await an.from("medications").insert(ne);if(te)throw te;t&&t(),e()}catch(X){j((X==null?void 0:X.message)||"Failed to save medication")}finally{B(!1)}};return s?v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:e,children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:O=>O.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-lg font-semibold",children:"Add Medication"}),v.jsx("button",{type:"button",className:"text-sm",onClick:e,children:"Close"})]}),F&&v.jsx("div",{className:"mt-3 rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-800",children:F}),v.jsxs("form",{className:"mt-4 space-y-4",onSubmit:I,children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Pet"}),v.jsxs("select",{value:a,onChange:O=>o(O.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",children:[v.jsx("option",{value:"",children:"— Select —"}),r.map(O=>v.jsxs("option",{value:O.id,children:[O.name," (",O.species,")"]},O.id))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Medication name"}),v.jsx("input",{value:l,onChange:O=>c(O.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"Amoxicillin"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Dosage"}),v.jsx("input",{value:u,onChange:O=>f(O.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"1 pill"})]}),v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Frequency"}),v.jsxs("select",{value:p,onChange:O=>m(O.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",children:[v.jsx("option",{children:"1x daily"}),v.jsx("option",{children:"2x daily"}),v.jsx("option",{children:"3x daily"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Duration"}),v.jsxs("select",{value:S,onChange:O=>w(O.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",children:[v.jsx("option",{value:"7",children:"7 days"}),v.jsx("option",{value:"10",children:"10 days"}),v.jsx("option",{value:"14",children:"14 days"}),v.jsx("option",{value:"30",children:"30 days"}),v.jsx("option",{value:"custom",children:"Custom"})]})]})]}),S==="custom"&&v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Custom days"}),v.jsx("input",{type:"number",min:1,value:_,onChange:O=>k(Number(O.target.value)),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Reminder times"}),v.jsx("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-3 gap-3",children:Array.from({length:T}).map((O,X)=>v.jsx("input",{type:"time",value:b[X]||"",onChange:K=>W(X,K.target.value),className:"w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3"},X))})]}),v.jsxs("div",{className:"pt-2 border-t border-slate-200 dark:border-slate-800 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",onClick:e,className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",children:"Cancel"}),v.jsx("button",{type:"submit",disabled:C,className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 disabled:opacity-60",children:C?"Saving…":"Save Medication"})]})]})]})}):null}function A$({open:s,onClose:e,userId:t}){const[n,r]=xe.useState(1),[i,a]=xe.useState(!1),[o,l]=xe.useState(null),[c,u]=xe.useState(""),[f,p]=xe.useState(""),[m,b]=xe.useState(""),[y,S]=xe.useState(""),[w,_]=xe.useState(""),[k,C]=xe.useState(""),[B,F]=xe.useState(""),[j,T]=xe.useState(""),[W,Y]=xe.useState(""),[I,O]=xe.useState(""),[X,K]=xe.useState(""),[ne,te]=xe.useState("");xe.useEffect(()=>{s&&(r(1),a(!1),l(null),u(""),p(""),b(""),S(""),_(""),C(""),F(""),T(""),Y(""),O(""),K(""),te(""))},[s]);const ue=xe.useMemo(()=>c.trim().length>0,[c]),Z=xe.useMemo(()=>m.trim().length>0&&!!y,[m,y]),he=xe.useMemo(()=>!!(j&&W.trim()&&Number.isFinite(Number(I))&&Number(I)>0&&Number.isFinite(Number(X))&&Number(X)>=0),[j,W,I,X]);xe.useEffect(()=>{if(s&&n===4){const L=setTimeout(()=>e(),1e3);return()=>clearTimeout(L)}},[s,n,e]);const me=async()=>{a(!0),l(null);try{const{error:L}=await an.from("profiles").update({full_name:c.trim(),address:f.trim()||null}).eq("id",t);if(L)throw L;const V={user_id:t,name:m.trim(),species:y||"other",color:B.trim()||null,insurance_company:j||null,policy_number:W.trim()||null,breed:w.trim()||null,weight_lbs:k===""?null:Number(k),monthly_premium:I===""?null:parseFloat(I),deductible_per_claim:X===""?null:parseFloat(X),coverage_start_date:ne||null};console.log("[OnboardingModal] petPayload about to send:",{monthlyPremium:I,deductiblePerClaim:X,coverageStartDate:ne,fullPayload:V});const Q=await wB(V);r(4)}catch(L){l((L==null?void 0:L.message)||"Failed to save your info. Please try again.")}finally{a(!1)}};if(!s)return null;const Ne=n===1?"Step 1 of 3":n===2?"Step 2 of 3":n===3?"Step 3 of 3":"";return v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:e,children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:L=>L.stopPropagation(),children:[n!==4&&v.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mb-2",children:Ne}),o&&v.jsx("div",{className:"mb-3 rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-sm text-rose-800",children:o}),n===1&&v.jsxs("div",{children:[v.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Welcome to Pet Claim Helper!"}),v.jsxs("div",{className:"mt-4 space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Full Name"}),v.jsx("input",{value:c,onChange:L=>u(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"Jane Doe"})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:["Address ",v.jsx("span",{className:"text-xs text-slate-500",children:"(optional)"})]}),v.jsx("input",{value:f,onChange:L=>p(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"123 Maple St, City, ST"})]})]}),v.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",onClick:e,children:"Cancel"}),v.jsx("button",{type:"button",disabled:!ue,className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 disabled:opacity-60",onClick:()=>r(2),children:"Next"})]})]}),n===2&&v.jsxs("div",{children:[v.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Let's add your first pet"}),v.jsxs("div",{className:"mt-4 space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Pet Name"}),v.jsx("input",{value:m,onChange:L=>b(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"Bo"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Species"}),v.jsxs("select",{value:y,onChange:L=>S(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",children:[v.jsx("option",{value:"",children:"— Select —"}),v.jsx("option",{value:"dog",children:"Dog"}),v.jsx("option",{value:"cat",children:"Cat"}),v.jsx("option",{value:"other",children:"Other"})]})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:["Breed ",v.jsx("span",{className:"text-xs text-slate-500",children:"(optional)"})]}),v.jsx("input",{value:w,onChange:L=>_(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"Golden Retriever"})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:["Weight (lbs) ",v.jsx("span",{className:"text-xs text-slate-500",children:"(optional)"})]}),v.jsx("input",{type:"number",min:0,value:k,onChange:L=>C(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"65"})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:["Color/Markings ",v.jsx("span",{className:"text-xs text-slate-500",children:"(optional)"})]}),v.jsx("input",{value:B,onChange:L=>F(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"Brown with white chest"})]})]}),v.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",onClick:e,children:"Cancel"}),v.jsx("button",{type:"button",disabled:!Z,className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 disabled:opacity-60",onClick:()=>r(3),children:"Next"})]})]}),n===3&&v.jsxs("div",{children:[v.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Insurance Details"}),v.jsxs("div",{className:"mt-4 space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Insurance Company"}),v.jsxs("select",{value:j,onChange:L=>T(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",children:[v.jsx("option",{value:"",children:"— Select —"}),v.jsx("option",{value:"Nationwide",children:"Nationwide"}),v.jsx("option",{value:"Trupanion",children:"Trupanion"}),v.jsx("option",{value:"Fetch",children:"Fetch"}),v.jsx("option",{value:"Healthy Paws",children:"Healthy Paws"}),v.jsx("option",{value:"Custom",children:"Custom"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:"Policy Number"}),v.jsx("input",{value:W,onChange:L=>Y(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"ABC-12345"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-200",children:"Monthly Premium (USD)"}),v.jsx("input",{type:"number",min:0,value:I,onChange:L=>O(L.target.value),className:"mt-2 w-full rounded-md border border-emerald-300 dark:border-emerald-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"45"}),v.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"We need this to calculate your true insurance ROI."})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-200",children:"Deductible per Claim (USD)"}),v.jsx("input",{type:"number",min:0,value:X,onChange:L=>K(L.target.value),className:"mt-2 w-full rounded-md border border-emerald-300 dark:border-emerald-700 bg-white/90 dark:bg-slate-900 px-3 py-3",placeholder:"250"}),v.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"This affects your actual out-of-pocket costs."})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-200",children:["Coverage Start Date ",v.jsx("span",{className:"text-xs text-slate-500",children:"(optional)"})]}),v.jsx("input",{type:"date",value:ne,onChange:L=>te(L.target.value),className:"mt-2 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/90 dark:bg-slate-900 px-3 py-3"})]})]}),v.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",onClick:e,children:"Cancel"}),v.jsx("button",{type:"button",disabled:!he||i,className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 disabled:opacity-60",onClick:me,children:i?"Saving…":"Finish"})]})]}),n===4&&v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"text-2xl",children:"✅"}),v.jsx("div",{className:"mt-2 text-lg font-semibold text-gray-900 dark:text-gray-100",children:"All set! Your first pet is added."})]})]})})}function S$({userId:s}){const[e,t]=xe.useState(!1),[n,r]=xe.useState(null),[i,a]=xe.useState([]),[o,l]=xe.useState([]);xe.useEffect(()=>{s&&(t(!0),r(null),Promise.all([an.from("claims").select("id, pet_id, total_amount, reimbursed_amount, filing_status").eq("user_id",s),an.from("pets").select("id, name, species, monthly_premium, deductible_per_claim, coverage_start_date").eq("user_id",s)]).then(([b,y])=>{if(b.error)throw b.error;if(y.error)throw y.error;console.log("[FinancialSummary] claims fetched:",b.data),console.log("[FinancialSummary] pets fetched:",y.data),a(b.data||[]),l(y.data||[])}).catch(b=>r((b==null?void 0:b.message)||"Failed to load financial data")).finally(()=>t(!1)))},[s]);const c=xe.useMemo(()=>{const b={};for(const y of o)b[y.id]=y;return b},[o]),u=b=>{if(!b)return 0;const y=new Date(b);if(isNaN(y.getTime()))return 0;const S=new Date,w=S.getFullYear(),_=y.getFullYear(),k=y.getMonth(),C=y.getDate(),B=_<w?0:k+1;let F=S.getMonth();S.getDate()<C&&(F-=1);let j=F-B+1;return j<0&&(j=0),console.log("[FinancialSummary] monthsYTD",{startIso:b,now:S.toISOString().slice(0,10),startIndex:B,endIndex:F,months:j}),j},f=b=>{const y=String(b||"").toLowerCase();return y==="filed"||y==="submitted"||y==="approved"||y==="paid"},p=xe.useMemo(()=>{const b=i.reduce((k,C)=>k+(Number(C.total_amount)||0),0),y=i.reduce((k,C)=>k+(Number(C.reimbursed_amount)||0),0),S=o.reduce((k,C)=>k+(Number(C.monthly_premium)||0)*u(C.coverage_start_date||null),0),w=i.reduce((k,C)=>{if(!f(C.filing_status))return k;const B=C.pet_id?c[C.pet_id]:void 0,F=B&&Number(B.deductible_per_claim)||0;return k+F},0),_=S+w-y;return console.log("[FinancialSummary] overall calc",{totalClaimed:b,totalReimbursed:y,premiumsYTD:S,deductiblesPaid:w,netCost:_,pets:o,claims:i}),{totalClaimed:b,totalReimbursed:y,premiumsYTD:S,deductiblesPaid:w,netCost:_}},[i,o,c]),m=xe.useMemo(()=>{const b={};for(const y of o)b[y.id]={claimed:0,reimbursed:0,premiums:(Number(y.monthly_premium)||0)*u(y.coverage_start_date||null),deductibles:0};for(const y of i){const S=y.pet_id||"";if(b[S]&&(b[S].claimed+=Number(y.total_amount)||0,b[S].reimbursed+=Number(y.reimbursed_amount)||0,f(y.filing_status))){const w=c[S];b[S].deductibles+=w&&Number(w.deductible_per_claim)||0}}return console.log("[FinancialSummary] perPet calc",b),b},[i,o,c]);return s?v.jsxs("section",{className:"mt-6",children:[v.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-lg font-semibold",children:"Financial Summary"}),e&&v.jsx("div",{className:"mt-2 text-sm text-slate-500",children:"Loading…"}),n&&v.jsx("div",{className:"mt-2 rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-rose-800 text-sm",children:n}),!e&&!n&&v.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 text-sm",children:[v.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4",children:[v.jsx("div",{className:"text-emerald-700",children:"Total Claimed"}),v.jsxs("div",{className:"mt-1 text-xl font-bold text-emerald-800",children:["$",p.totalClaimed.toFixed(2)]})]}),v.jsxs("div",{className:"rounded-xl border border-emerald-200 bg-emerald-50 p-4",children:[v.jsx("div",{className:"text-emerald-700",children:"Total Reimbursed"}),v.jsxs("div",{className:"mt-1 text-xl font-bold text-emerald-800",children:["$",p.totalReimbursed.toFixed(2)]})]}),v.jsxs("div",{className:"rounded-xl border border-blue-200 bg-blue-50 p-4",children:[v.jsx("div",{className:"text-blue-700",children:"Premiums Paid YTD"}),v.jsxs("div",{className:"mt-1 text-xl font-bold text-blue-800",children:["$",p.premiumsYTD.toFixed(2)]})]}),v.jsxs("div",{className:"rounded-xl border border-amber-200 bg-amber-50 p-4",children:[v.jsx("div",{className:"text-amber-700",children:"Deductibles Paid"}),v.jsxs("div",{className:"mt-1 text-xl font-bold text-amber-800",children:["$",p.deductiblesPaid.toFixed(2)]})]}),v.jsxs("div",{className:"rounded-xl border border-rose-200 bg-rose-50 p-4",children:[v.jsx("div",{className:"text-rose-700",children:"NET COST"}),v.jsxs("div",{className:"mt-1 text-xl font-bold text-rose-800",children:["$",p.netCost.toFixed(2)]})]})]})]}),v.jsxs("div",{className:"mt-6 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-base font-semibold",children:"Per-Pet Breakdown"}),v.jsx("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(b=>{const y=m[b.id]||{claimed:0,reimbursed:0,premiums:0,deductibles:0},S=y.premiums+y.deductibles-y.reimbursed;b.species==="cat"||b.species;const w=b.species==="cat"?"🐱":b.species==="dog"?"🐶":"🐾";return v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[v.jsxs("div",{className:"flex items-center gap-2 text-slate-800 dark:text-slate-100",children:[v.jsx("span",{children:w}),v.jsxs("span",{className:"font-semibold",children:[b.name," (",b.species,")"]})]}),v.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Total Claimed"}),v.jsxs("div",{className:"font-semibold",children:["$",y.claimed.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Total Reimbursed"}),v.jsxs("div",{className:"font-semibold",children:["$",y.reimbursed.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Premiums YTD"}),v.jsxs("div",{className:"font-semibold",children:["$",y.premiums.toFixed(2)]})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Deductibles"}),v.jsxs("div",{className:"font-semibold",children:["$",y.deductibles.toFixed(2)]})]})]}),v.jsxs("div",{className:"mt-3 rounded-lg border border-slate-200 dark:border-slate-800 p-3 text-sm",children:[v.jsx("div",{className:"text-slate-500",children:"Effective Cost"}),v.jsxs("div",{className:"font-semibold",children:["$",S.toFixed(2)]})]})]},b.id)})})]})]}):null}function k$({medicationId:s,userId:e,onClose:t,onDoseRecorded:n}){const[r,i]=xe.useState(!0),[a,o]=xe.useState(!1),[l,c]=xe.useState(null),[u,f]=xe.useState(null),[p,m]=xe.useState(null),[b,y]=xe.useState(""),[S,w]=xe.useState(0),_=xe.useMemo(()=>p?Array.isArray(p.reminder_times)&&p.reminder_times.length>0?p.reminder_times.length:p.frequency==="1x daily"?1:p.frequency==="2x daily"?2:3:0,[p]),k=xe.useMemo(()=>{if(!p)return 0;const T=new Date(p.start_date),W=p.end_date?new Date(p.end_date):null,Y=new Date(T.getFullYear(),T.getMonth(),T.getDate()),I=W?new Date(W.getFullYear(),W.getMonth(),W.getDate()):null;return(I?Math.max(1,Math.round((I.getTime()-Y.getTime())/(1e3*60*60*24))+1):1)*_},[p,_]),C=xe.useMemo(()=>k>0?Math.round(S/k*100):0,[S,k]),B=async()=>{i(!0),c(null);try{const{data:T,error:W}=await an.from("medications").select("*").eq("id",s).single();if(W)throw W;const Y={id:T.id,user_id:T.user_id,pet_id:T.pet_id,medication_name:T.medication_name,dosage:T.dosage??null,frequency:T.frequency,reminder_times:Array.isArray(T.reminder_times)?T.reminder_times:[],start_date:T.start_date,end_date:T.end_date??null};if(m(Y),T.pet_id){const{data:X,error:K}=await an.from("pets").select("name").eq("id",T.pet_id).single();!K&&(X!=null&&X.name)&&y(X.name)}const{count:I,error:O}=await an.from("medication_doses").select("*",{count:"exact",head:!0}).eq("medication_id",s).eq("status","given");if(O)throw O;w(I||0)}catch(T){c((T==null?void 0:T.message)||"Failed to load medication")}finally{i(!1)}};xe.useEffect(()=>{B()},[s]);const F=T=>{const[W,Y]=T.split(":");let I=Number(W);const O=I>=12?"PM":"AM";return I=I%12,I===0&&(I=12),`${I}:${Y} ${O}`},j=async()=>{if(!e){c("You must be logged in to record a dose.");return}o(!0),c(null);try{const W=new Date().toISOString(),{error:Y}=await an.from("medication_doses").insert({medication_id:s,user_id:e,scheduled_time:W,given_time:W,status:"given"});if(Y)throw Y;w(I=>I+1),f("Dose recorded ✓"),n&&n(),setTimeout(()=>{t()},2e3)}catch(T){c((T==null?void 0:T.message)||"Failed to record dose")}finally{o(!1)}};return v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t,children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:T=>T.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-lg font-semibold",children:"Track Dose"}),v.jsx("button",{type:"button",className:"text-sm",onClick:t,children:"Close"})]}),r&&v.jsx("div",{className:"mt-4 text-sm text-slate-600",children:"Loading…"}),l&&v.jsx("div",{className:"mt-4 rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-rose-800 text-sm",children:l}),!r&&p&&v.jsxs("div",{className:"mt-4 space-y-3",children:[v.jsxs("div",{className:"text-sm text-slate-600",children:["Pet: ",v.jsx("span",{className:"font-medium text-slate-800 dark:text-slate-100",children:b||"—"})]}),v.jsx("div",{className:"text-lg font-semibold",children:p.medication_name}),p.dosage&&v.jsx("div",{className:"text-sm text-slate-600",children:p.dosage}),v.jsxs("div",{className:"mt-2 rounded-lg border border-slate-200 dark:border-slate-800 p-3 text-sm space-y-1.5",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Progress:"})," ",`${S}/${k} doses (${C}%)`]}),v.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[v.jsx("span",{className:"text-slate-500",children:"Reminder times:"}),v.jsx("div",{className:"flex flex-wrap gap-2",children:(Array.isArray(p.reminder_times)?p.reminder_times:[]).map((T,W)=>v.jsx("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-xs text-slate-700",children:F(T)},W))})]})]}),u&&v.jsx("div",{className:"rounded-md border border-emerald-200 bg-emerald-50 px-3 py-2 text-emerald-800 text-sm",children:u}),v.jsx("div",{className:"pt-2 flex flex-col sm:flex-row gap-3 sm:justify-end",children:v.jsx("button",{type:"button",disabled:a||!e,onClick:j,className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 disabled:opacity-60",children:a?"Saving…":"✓ MARK AS GIVEN"})})]})]})})}function N$({userId:s,pets:e}){const[t,n]=xe.useState(!1),[r,i]=xe.useState(null),[a,o]=xe.useState([]),[l,c]=xe.useState({}),[u,f]=xe.useState(!1),[p,m]=xe.useState({}),[b,y]=xe.useState(null),S=xe.useMemo(()=>{const F={};for(const j of e)F[j.id]=j;return F},[e]),w=async()=>{if(s){n(!0),i(null);try{const{data:F,error:j}=await an.from("medications").select("*").eq("user_id",s).order("created_at",{ascending:!1});if(j)throw j;const T=(F||[]).map(Y=>({...Y,reminder_times:Array.isArray(Y.reminder_times)?Y.reminder_times:[]}));o(T);const W=T.map(Y=>Y.id);if(W.length>0){const{data:Y,error:I}=await an.from("medication_doses").select("id, medication_id, user_id, scheduled_time, given_time, status").in("medication_id",W).eq("user_id",s).eq("status","given");if(I)throw I;const O={};for(const X of Y||[])O[X.medication_id]=(O[X.medication_id]||0)+1;c(O)}else c({})}catch(F){i((F==null?void 0:F.message)||"Failed to load medications")}finally{n(!1)}}};xe.useEffect(()=>{w()},[s]);const _=xe.useMemo(()=>{const F={};for(const j of a)F[j.pet_id]||(F[j.pet_id]=[]),F[j.pet_id].push(j);return F},[a]),k=F=>Array.isArray(F.reminder_times)&&F.reminder_times.length>0?F.reminder_times.length:F.frequency==="1x daily"?1:F.frequency==="2x daily"?2:3,C=(F,j)=>{const T=new Date(F.getFullYear(),F.getMonth(),F.getDate()),W=new Date(j.getFullYear(),j.getMonth(),j.getDate()),Y=Math.round((T.getTime()-W.getTime())/(1e3*60*60*24)),I=Y===0?"Today":Y===1?"Tomorrow":F.toLocaleDateString("en-US",{month:"short",day:"numeric"}),O=F.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});return`${I} ${O}`},B=F=>{const j=new Date(F.start_date),T=F.end_date?new Date(F.end_date):null,W=new Date,Y=new Date(j.getFullYear(),j.getMonth(),j.getDate()),I=T?new Date(T.getFullYear(),T.getMonth(),T.getDate()):null,O=new Date(W.getFullYear(),W.getMonth(),W.getDate()),X=I?Math.max(1,Math.round((I.getTime()-Y.getTime())/(1e3*60*60*24))+1):1,K=k(F),ne=X*K,te=l[F.id]||0,ue=ne>0?Math.round(te/ne*100):0,Z=I?Math.max(0,Math.round((I.getTime()-O.getTime())/(1e3*60*60*24))+1):0,he=F.reminder_times&&F.reminder_times.length>0?F.reminder_times:F.frequency==="1x daily"?["07:00"]:F.frequency==="2x daily"?["07:00","19:00"]:["08:00","14:00","20:00"];let me=null;const Ne=new Date(W);for(let L=0;L<7;L++){const V=new Date(Ne.getFullYear(),Ne.getMonth(),Ne.getDate());if(V<Y){Ne.setDate(Ne.getDate()+1);continue}if(I&&V>I)break;for(const Q of he){const[se,re]=Q.split(":").map(le=>Number(le)),de=new Date(V.getFullYear(),V.getMonth(),V.getDate(),se,re,0);if(de.getTime()>W.getTime()){me=de;break}}if(me)break;Ne.setDate(Ne.getDate()+1)}return{totalDoses:ne,given:te,pct:ue,daysRemaining:Z,nextDoseLabel:me?C(me,W):I&&O>I?"Completed":"—",endLabel:I?I.toISOString().slice(0,10):"—"}};return v.jsxs("section",{className:"mt-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Medications"}),v.jsx("button",{type:"button",onClick:()=>f(!0),className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-sm",disabled:!s,children:"+ ADD MEDICATION"})]}),t&&v.jsx("div",{className:"mt-4 text-sm text-slate-500",children:"Loading medications…"}),r&&v.jsx("div",{className:"mt-4 rounded-md border border-rose-200 bg-rose-50 px-3 py-2 text-rose-800 text-sm",children:r}),!t&&a.length===0&&v.jsx("div",{className:"mt-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 text-sm text-slate-600",children:'No medications yet. Click "+ ADD MEDICATION" to create one.'}),v.jsx("div",{className:"mt-4 space-y-6",children:Object.entries(_).map(([F,j])=>{const T=S[F];return v.jsxs("div",{children:[v.jsxs("button",{type:"button",onClick:()=>m(W=>({...W,[F]:!W[F]})),className:"group w-full text-left text-base font-semibold mb-2 flex items-center justify-between gap-2 h-12 px-4 rounded-lg cursor-pointer hover:bg-blue-50 dark:hover:bg-slate-800 hover:shadow-sm transition transform hover:scale-[1.01]",title:"Click to toggle medications",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full",style:{backgroundColor:(T==null?void 0:T.color)||((T==null?void 0:T.species)==="dog"?"#3B82F6":(T==null?void 0:T.species)==="cat"?"#F97316":"#6B7280")}}),v.jsx("span",{className:"font-semibold",children:T?`${T.name} (${T.species})`:"Unknown Pet"})]}),v.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[v.jsx("svg",{className:["h-4 w-4 transition-transform duration-150",p[F]?"rotate-90":""].join(" "),viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":!0,children:v.jsx("path",{fillRule:"evenodd",d:"M7.21 14.77a.75.75 0 0 1-.02-1.06L10.17 10 7.2 6.3a.75.75 0 1 1 1.1-1.02l3.5 3.75c.27.29.27.74 0 1.03l-3.5 3.75a.75.75 0 0 1-1.09.01Z",clipRule:"evenodd"})}),v.jsx("span",{className:"text-sm text-slate-600 font-medium",children:p[F]?"Hide medications":"Show medications"})]})]}),p[F]!==!1&&v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(W=>{const Y=B(W);return v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4 shadow-sm cursor-pointer hover:shadow-md",onClick:()=>y(W.id),children:[v.jsx("div",{className:"text-lg font-semibold",children:W.medication_name}),W.dosage&&v.jsx("div",{className:"text-sm text-slate-600 mt-0.5",children:W.dosage}),v.jsxs("div",{className:"mt-3 space-y-1.5 text-sm",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Progress:"})," ",`${Y.given}/${Y.totalDoses} doses (${Y.pct}%)`]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Next dose:"})," ",Y.nextDoseLabel]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Days remaining:"})," ",Y.daysRemaining]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"End date:"})," ",Y.endLabel]})]})]},W.id)})})]},F)})}),v.jsx(dj,{open:u,onClose:()=>f(!1),onSaved:()=>{f(!1),w()},userId:s,pets:e}),b&&v.jsx(k$,{medicationId:b,userId:s,onClose:()=>y(null),onDoseRecorded:()=>w()})]})}async function qE(s){console.log("[createClaim] inserting",s);const{data:e,error:t}=await an.from("claims").insert(s).select("*").single();if(t)throw t;return e}async function Fo(s){const{data:e,error:t}=await an.from("claims").select("*, pets(id, name, species)").eq("user_id",s).order("service_date",{ascending:!1});if(t)throw t;return e}async function Xf(s,e){const{error:t}=await an.from("claims").update(e).eq("id",s);if(t)throw t}async function C$(s){const{error:e}=await an.from("claims").delete().eq("id",s);if(e)throw e}function E$(){const s=xe.useRef(null),[e,t]=xe.useState(null),[n,r]=xe.useState(!1),[i,a]=xe.useState(!1),[o,l]=xe.useState(null),[c,u]=xe.useState(null),[f,p]=xe.useState([]),[m,b]=xe.useState(null),y=xe.useMemo(()=>f.find(P=>P.id===m)??null,[f,m]),[S,w]=xe.useState(""),[_,k]=xe.useState(""),[C,B]=xe.useState("insured"),[F,j]=xe.useState(!1),[T,W]=xe.useState({name:"",species:"dog",insuranceCompany:"",policyNumber:"",ownerName:"",ownerAddress:"",ownerPhone:"",filing_deadline_days:""}),[Y,I]=xe.useState(null),[O,X]=xe.useState(null),[K,ne]=xe.useState(""),[te,ue]=xe.useState(""),[Z,he]=xe.useState(""),[me,Ne]=xe.useState(""),[L,V]=xe.useState(""),[Q,se]=xe.useState(""),[re,de]=xe.useState(null),[le,we]=xe.useState(null),[Le,je]=xe.useState("app"),[Fe,Be]=xe.useState(null),[at,Se]=xe.useState([]),[ee,St]=xe.useState(!1),[nt,Re]=xe.useState(null),$e=xe.useRef(null),ze=xe.useRef(null),[De,Ke]=xe.useState([]),[kt,_t]=xe.useState(!1),[Tt,Vt]=xe.useState("urgent"),[Mt,pt]=xe.useState("all"),[Ft,qe]=xe.useState("app"),[Zt,Bt]=xe.useState(null),[Zr,on]=xe.useState(null),[bn,ki]=xe.useState(""),[Kt,So]=xe.useState(""),[Pn,ei]=xe.useState(""),[ra,Ln]=xe.useState(""),[mt,Ht]=xe.useState([]),[ia,Qn]=xe.useState("insured"),[aa,ti]=xe.useState(!1),[lt,Qs]=xe.useState(null),[ni,Fs]=xe.useState(""),[$n,On]=xe.useState(new Date().toISOString().split("T")[0]),[Rr,Or]=xe.useState(!1),[Oa,Mr]=xe.useState(!1),[Un,ps]=xe.useState(null),[oa,Zs]=xe.useState(!1),[la,si]=xe.useState(!1),[ml,Ma]=xe.useState([]),[ko,gl]=xe.useState([]),[ad,og]=xe.useState(null),[No,wc]=xe.useState(null),[od,uf]=xe.useState(!1),Co=P=>P.trim().toLowerCase(),lg=(P,fe)=>{const ve=Co(P),_e=Co(fe),Oe=ve.length,He=_e.length;if(Oe===0)return He;if(He===0)return Oe;const ct=Array.from({length:Oe+1},()=>Array(He+1).fill(0));for(let dt=0;dt<=Oe;dt++)ct[dt][0]=dt;for(let dt=0;dt<=He;dt++)ct[0][dt]=dt;for(let dt=1;dt<=Oe;dt++)for(let Je=1;Je<=He;Je++){const st=ve[dt-1]===_e[Je-1]?0:1;ct[dt][Je]=Math.min(ct[dt-1][Je]+1,ct[dt][Je-1]+1,ct[dt-1][Je-1]+st)}return ct[Oe][He]},df=(P,fe)=>{const ve=Co(P),_e=Co(fe);if(!ve||!_e)return 0;if(ve===_e)return 1;if(ve.includes(_e)||_e.includes(ve))return .92;const Oe=lg(ve,_e),He=Math.max(ve.length,_e.length);return 1-Oe/(He||1)},cg=(P,fe)=>{const ve=Array(P.length).fill(null),_e=new Set;return P.forEach((Oe,He)=>{const dt=fe.map(Je=>({id:Je.id,score:df(Oe.petName||"",Je.name||"")})).sort((Je,st)=>st.score-Je.score).find(Je=>Je.score>=.8&&!_e.has(Je.id));dt&&(ve[He]=dt.id,_e.add(dt.id))}),ve};xe.useEffect(()=>{an.auth.getSession().then(({data:fe})=>{const ve=fe.session;ve!=null&&ve.user?(de(ve.user.email??null),we(ve.user.id),xE(ve.user.id,ve.user.email??null).catch(()=>{}),je("app"),Tx(ve.user.id).then(_e=>{p(_e),(_e||[]).length===0&&Mr(!0)}).catch(()=>p([])),Fo(ve.user.id).then(Ke).catch(()=>Ke([]))):je("signup")});const{data:P}=an.auth.onAuthStateChange((fe,ve)=>{ve!=null&&ve.user?(de(ve.user.email??null),we(ve.user.id),xE(ve.user.id,ve.user.email??null).catch(()=>{}),je("app"),Tx(ve.user.id).then(_e=>{p(_e),(_e||[]).length===0&&Mr(!0)}).catch(()=>p([])),Fo(ve.user.id).then(Ke).catch(()=>Ke([]))):(de(null),we(null),p([]),je("signup"))});return()=>{P.subscription.unsubscribe()}},[]),xe.useEffect(()=>{try{const P=localStorage.getItem("pch.finPeriod");P&&pt(P)}catch{}},[]),xe.useEffect(()=>{try{localStorage.setItem("pch.finPeriod",Mt)}catch{}},[Mt]),xe.useEffect(()=>{Zt&&(on(Zt.pet_id||null),ki(Zt.service_date||""),ei(Zt.visit_title||""),So(Zt.diagnosis||""),Ln(Zt.visit_notes||""),Ht(Array.isArray(Zt.line_items)?Zt.line_items:[]),Qn(Zt.expense_category||"insured"))},[Zt]);const xc=()=>{var Oe,He;const P=T.name.trim();if(!P)return;if(!K){alert("Please select an insurance company");return}if(K==="Custom Insurance"){const ct=Z.trim(),dt=Number(me);if(!ct){alert("Enter custom insurance company name");return}if(!Number.isFinite(dt)||dt<1||dt>365){alert("Deadline must be 1-365 days");return}T.insuranceCompany=ct,T.filing_deadline_days=dt}else T.insuranceCompany=K,T.filing_deadline_days=90;const fe=((He=(Oe=globalThis.crypto)==null?void 0:Oe.randomUUID)==null?void 0:He.call(Oe))??String(Date.now()),ve={id:fe,name:P,species:T.species,insuranceCompany:T.insuranceCompany,policyNumber:T.policyNumber.trim(),ownerName:T.ownerName.trim(),ownerAddress:T.ownerAddress.trim(),ownerPhone:T.ownerPhone.trim(),filing_deadline_days:T.filing_deadline_days},_e=[...f,ve];if(p(_e),le&&wE(le,ve).catch(ct=>{console.error("[addPet] upsert error",ct)}),nt!==null){const ct=[...at];ct[nt]=fe,Se(ct),Re(null)}else b(fe);j(!1),W({name:"",species:"dog",insuranceCompany:"",policyNumber:"",ownerName:"",ownerAddress:"",ownerPhone:"",filing_deadline_days:""}),ne(""),he(""),Ne("")},ug=P=>{I(P.id),X({name:P.name,species:P.species,insuranceCompany:P.insuranceCompany,policyNumber:P.policyNumber,ownerName:P.ownerName||"",ownerAddress:P.ownerAddress||"",ownerPhone:P.ownerPhone||"",filing_deadline_days:P.filing_deadline_days||"",monthly_premium:P.monthly_premium??"",deductible_per_claim:P.deductible_per_claim??"",coverage_start_date:P.coverage_start_date||""}),["Trupanion","Nationwide","Healthy Paws","Fetch"].includes(P.insuranceCompany)?(ue(P.insuranceCompany),V(""),se(String(P.filing_deadline_days||""))):(ue("Custom Insurance"),V(P.insuranceCompany),se(String(P.filing_deadline_days||"")))},zn=()=>{if(!Y||!O)return;if(!te){alert("Please select an insurance company");return}let P="",fe="";if(te==="Custom Insurance"){const _e=L.trim(),Oe=Number(Q);if(!_e){alert("Enter custom insurance company name");return}if(!Number.isFinite(Oe)||Oe<1||Oe>365){alert("Deadline must be 1-365 days");return}P=_e,fe=Oe}else P=te,fe=90;const ve=f.map(_e=>_e.id===Y?{..._e,name:O.name.trim(),species:O.species,insuranceCompany:P,policyNumber:O.policyNumber.trim(),ownerName:O.ownerName.trim(),ownerAddress:O.ownerAddress.trim(),ownerPhone:O.ownerPhone.trim(),filing_deadline_days:fe,monthly_premium:O.monthly_premium===""?null:Number(O.monthly_premium),deductible_per_claim:O.deductible_per_claim===""?null:Number(O.deductible_per_claim),coverage_start_date:O.coverage_start_date||null}:_e);if(p(ve),le){const _e=ve.find(Oe=>Oe.id===Y);_e&&wE(le,_e).catch(Oe=>{console.error("[saveEdit] upsert error",Oe)})}I(null),X(null)},hf=()=>{var P;return(P=s.current)==null?void 0:P.click()},ld=async()=>{await an.auth.signOut()},cd=P=>{if(!P){t(null);return}if(!(P.type.startsWith("image/")||P.type==="application/pdf")){t(null);return}const _e=P.type.startsWith("image/")?URL.createObjectURL(P):void 0;t({file:P,objectUrl:_e}),u(null),l(null)},ud=P=>{var fe;cd((fe=P.target.files)==null?void 0:fe[0])},dg=P=>{P.preventDefault(),P.stopPropagation(),r(!0)},Ni=P=>{P.preventDefault(),P.stopPropagation(),r(!0)},_c=P=>{P.preventDefault(),P.stopPropagation(),r(!1)},fr=P=>{var _e;P.preventDefault(),P.stopPropagation(),r(!1);const fe=P.dataTransfer;if(!fe)return;const ve=((_e=fe.files)==null?void 0:_e[0])??null;cd(ve)},dd=xe.useMemo(()=>{if(!e)return"";const{size:P}=e.file,fe=1024,ve=fe*1024;return P<fe?`${P} B`:P<ve?`${(P/fe).toFixed(1)} KB`:`${(P/ve).toFixed(2)} MB`},[e]),ff=P=>{const fe=typeof(P==null?void 0:P.clinicName)=="string"?P.clinicName:typeof(P==null?void 0:P.clinic_name)=="string"?P.clinic_name:"",ve=typeof(P==null?void 0:P.clinicAddress)=="string"?P.clinicAddress:typeof(P==null?void 0:P.clinic_address)=="string"?P.clinic_address:"",_e=typeof(P==null?void 0:P.petName)=="string"?P.petName:typeof(P==null?void 0:P.pet_name)=="string"?P.pet_name:"",Oe=typeof(P==null?void 0:P.dateOfService)=="string"?P.dateOfService:typeof(P==null?void 0:P.service_date)=="string"?P.service_date:"",He=typeof(P==null?void 0:P.totalAmount)=="string"?P.totalAmount:(P==null?void 0:P.total_amount)!=null?String(P.total_amount):"",ct=typeof(P==null?void 0:P.invoiceNumber)=="string"?P.invoiceNumber:typeof(P==null?void 0:P.invoice_number)=="string"?P.invoice_number:void 0,Je=(Array.isArray(P==null?void 0:P.lineItems)?P.lineItems:Array.isArray(P==null?void 0:P.line_items)?P.line_items:[]).map(st=>({description:typeof(st==null?void 0:st.description)=="string"?st.description:"",amount:typeof(st==null?void 0:st.amount)=="string"?st.amount:(st==null?void 0:st.amount)!=null?String(st.amount):""}));return{clinicName:fe,clinicAddress:ve,petName:_e,dateOfService:Oe,totalAmount:He,diagnosis:typeof(P==null?void 0:P.diagnosis)=="string"?P.diagnosis:"",lineItems:Je,invoiceNumber:ct}},hg=P=>{if(!P||!Array.isArray(P.pets))return null;const fe=P.pets.map(ve=>({petName:typeof(ve==null?void 0:ve.petName)=="string"?ve.petName:"",petSpecies:typeof(ve==null?void 0:ve.petSpecies)=="string"?ve.petSpecies:void 0,lineItems:Array.isArray(ve==null?void 0:ve.lineItems)?ve.lineItems.map(_e=>({description:typeof(_e==null?void 0:_e.description)=="string"?_e.description:"",amount:typeof(_e==null?void 0:_e.amount)=="string"?_e.amount:String((_e==null?void 0:_e.amount)??"")})):[],subtotal:typeof(ve==null?void 0:ve.subtotal)=="string"?ve.subtotal:void 0}));return{clinicName:typeof(P==null?void 0:P.clinicName)=="string"?P.clinicName:"",clinicAddress:typeof(P==null?void 0:P.clinicAddress)=="string"?P.clinicAddress:"",dateOfService:typeof(P==null?void 0:P.dateOfService)=="string"?P.dateOfService:"",diagnosis:typeof(P==null?void 0:P.diagnosis)=="string"?P.diagnosis:"",pets:fe,invoiceNumber:typeof(P==null?void 0:P.invoiceNumber)=="string"?P.invoiceNumber:void 0}},Ac=P=>{const fe=(P||"").replace(/[^0-9.\-]/g,""),ve=parseFloat(fe);return Number.isFinite(ve)?ve:0},pf=P=>`$${P.reduce((ve,_e)=>ve+Ac(_e.amount),0).toFixed(2)}`,mf=async(P,fe,ve)=>{try{const _e=`${P}/${fe}.pdf`,{error:Oe}=await an.storage.from("claim-pdfs").upload(_e,ve,{upsert:!0,contentType:"application/pdf"});if(Oe)throw Oe;return await Xf(fe,{pdf_path:_e}),_e}catch(_e){return console.error("[uploadClaimPdf] error",_e),null}},[ty,gf]=xe.useState(!1),fg=async()=>{var P,fe,ve,_e,Oe;if(e){a(!0),l(null);try{console.log("[extract] starting, file type:",e.file.type);let He;e.file.type==="application/pdf"?(console.log("[extract] converting PDF to image data URL…"),He=await FD(e.file)):(console.log("[extract] reading image as data URL…"),He=await NO(e.file));const ct=`Extract ALL fields from this veterinary invoice and return as JSON:
{
  "clinic_name": "full clinic name",
  "clinic_address": "complete address with city, state, zip",
  "pet_name": "pet's name",
  "service_date": "YYYY-MM-DD format",
  "total_amount": numeric value,
  "invoice_number": "invoice number if visible",
  "diagnosis": "reason for visit or diagnosis",
  "line_items": [{"description": "service name", "amount": numeric value}]
}

Extract EVERY visible field from the image. Look carefully at the entire document. If a field is not clearly visible, use null. Return ONLY valid JSON, no markdown formatting.`,dt=new AbortController,Je=9e4,st=setTimeout(()=>{try{dt.abort()}catch{}},Je);console.log("[extract] sending request to OpenAI… (timeout",Je,"ms)");const wn=await RM.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"user",content:[{type:"text",text:ct},{type:"image_url",image_url:{url:He}}]}],temperature:0,max_tokens:2e3},{timeout:Je,signal:dt.signal});clearTimeout(st),console.log("[extract] response received from OpenAI.");const nn=((ve=(fe=(P=wn.choices)==null?void 0:P[0])==null?void 0:fe.message)==null?void 0:ve.content)??"";let $t=null;try{let ln=nn.trim();ln.startsWith("```")&&(ln=ln.replace(/^```json\s*/i,""),ln=ln.replace(/^```\s*/i,""),ln=ln.replace(/\s*```\s*$/,"")),$t=JSON.parse(ln)}catch{const ln=nn.match(/\{[\s\S]*\}/);if(ln)try{$t=JSON.parse(ln[0])}catch{}}if(!$t)throw console.error("[openai extraction] raw response could not be parsed:",nn),new Error("Could not parse JSON from AI response.");const en=hg($t);if(en&&en.pets.length>1){Be(en),u(null);const ln=cg(en.pets,f);Se(ln);return}const rs=ff($t);y&&(rs.petName=y.name),u(rs),Be(null)}catch(He){const ct=String((He==null?void 0:He.message)||""),Je=String((He==null?void 0:He.name)||"")==="AbortError"||/aborted|timeout/i.test(ct),st=/NetworkError|Failed to fetch|TypeError: Failed to fetch/i.test(ct),wn=(He==null?void 0:He.error)&&(He.error.message||((Oe=(_e=He.error)==null?void 0:_e.error)==null?void 0:Oe.message))||ct;l(Je?"Extraction timed out. Mobile networks can be slow — please try again. We now wait up to 90 seconds.":st?"Network error during extraction. Please check your connection and try again.":wn||"AI extraction failed. Please try again."),console.error("[extract] error:",{name:He==null?void 0:He.name,message:He==null?void 0:He.message,cause:He==null?void 0:He.cause});const nn={clinicName:"",clinicAddress:"",petName:y?y.name:"",dateOfService:"",totalAmount:"",diagnosis:"",lineItems:[]};u(nn),Be(null)}finally{a(!1)}}},vf=P=>typeof P.filing_deadline_days=="number"&&P.filing_deadline_days>0?P.filing_deadline_days:90,Eo=P=>{if(!P.service_date)return null;const fe=new Date(P.service_date);return Number.isNaN(fe.getTime())?null:fe},ri=P=>{const fe=Eo(P);if(!fe)return null;const ve=new Date(fe.getTime());ve.setDate(ve.getDate()+vf(P));const _e=new Date,Oe=ve.getTime()-_e.getTime();return Math.ceil(Oe/(1e3*60*60*24))},Sc=P=>{switch((P||"not_submitted").toLowerCase()){case"filed":case"submitted":return{text:"Submitted",cls:"bg-blue-50 text-blue-700"};case"approved":return{text:"Approved",cls:"bg-emerald-50 text-emerald-700"};case"paid":return{text:"Paid",cls:"bg-emerald-50 text-emerald-700"};case"denied":return{text:"Denied",cls:"bg-rose-50 text-rose-700"};case"not_filed":default:return{text:"Not Submitted",cls:"bg-slate-100 text-slate-700"}}},kc=P=>{const fe=ri(P),ve=(P.filing_status||"not_submitted").toLowerCase(),_e=ve==="filed"?"submitted":ve;return _e==="submitted"?{text:"📤 Submitted - Pending",cls:"bg-blue-100 text-blue-800 border border-blue-200"}:_e==="approved"?{text:"✅ Approved",cls:"bg-green-100 text-green-800 border border-green-200"}:_e==="paid"?{text:"💰 Paid",cls:"bg-green-100 text-green-800 border border-green-200"}:_e==="denied"?{text:"❌ Denied",cls:"bg-red-100 text-red-800 border border-red-200"}:fe===null?{text:"No date",cls:"bg-slate-100 text-slate-600"}:fe>=15?{text:"✅ Plenty of time",cls:"bg-emerald-50 text-emerald-700 border border-emerald-200"}:fe>=7?{text:`⚠️ Due soon - ${fe} days`,cls:"bg-yellow-100 text-yellow-800 border border-yellow-300 font-semibold"}:fe>=1?{text:`🚨 ${fe} days left!`,cls:"bg-red-100 text-red-800 border border-red-300 font-bold animate-pulse"}:{text:"❌ Deadline passed",cls:"bg-slate-200 text-slate-700 font-medium"}},Ds=P=>`$${(typeof P=="number"&&Number.isFinite(P)?P:0).toFixed(2)}`,Ss=xe.useMemo(()=>{const P=[...De],fe=Tt,ve=_e=>{const Oe=(_e.filing_status||"not_submitted").toLowerCase(),He=ri(_e);return Oe!=="not_submitted"&&Oe!=="not_filed"?9999:He===null?9998:He};return P.sort((_e,Oe)=>{var He,ct,dt,Je,st,wn;switch(fe){case"date_newest":{const nn=((He=Eo(_e))==null?void 0:He.getTime())||0;return(((ct=Eo(Oe))==null?void 0:ct.getTime())||0)-nn}case"date_oldest":{const nn=((dt=Eo(_e))==null?void 0:dt.getTime())||0,$t=((Je=Eo(Oe))==null?void 0:Je.getTime())||0;return nn-$t}case"amount_high":{const nn=_e.total_amount||0;return(Oe.total_amount||0)-nn}case"amount_low":{const nn=_e.total_amount||0,$t=Oe.total_amount||0;return nn-$t}case"pet":return(((st=_e.pets)==null?void 0:st.name)||"").localeCompare(((wn=Oe.pets)==null?void 0:wn.name)||"");case"status":return(_e.filing_status||"").localeCompare(Oe.filing_status||"");case"urgent":default:return ve(_e)-ve(Oe)}}),P},[De,Tt]),Po=xe.useMemo(()=>{const P=De.length,fe=De.filter(He=>(He.filing_status||"not_filed").toLowerCase()==="not_filed"),ve=fe.reduce((He,ct)=>He+(ct.total_amount||0),0),_e=De.filter(He=>["filed"].includes((He.filing_status||"").toLowerCase())).length,Oe=fe.filter(He=>{const ct=ri(He);return ct!==null&&ct>=1&&ct<=14}).length;return{total:P,notFiledCount:fe.length,notFiledSum:ve,filedPending:_e,expiringSoon:Oe}},[De]),Fa=xe.useMemo(()=>{var nn;const P=De.filter($t=>{const en=$t.service_date?new Date($t.service_date):null;if(!en||Number.isNaN(en.getTime()))return!1;if(Mt==="all")return!0;if(Mt==="2025")return en.getFullYear()===2025;if(Mt==="2024")return en.getFullYear()===2024;if(Mt==="last12"){const rs=new Date,ln=new Date(rs.getTime());return ln.setDate(ln.getDate()-365),en>=ln&&en<=rs}return!0}),fe={insured:{sum:0,count:0},not_insured:{sum:0,count:0},maybe_insured:{sum:0,count:0}};let ve=0,_e=0,Oe=0,He=0;const ct={};let dt=0,Je=0,st=0;for(const $t of P){const en=Number($t.total_amount||0),rs=String($t.filing_status||"not_filed").toLowerCase(),ln=$t.expense_category||"insured",Nc=$t.service_date?new Date($t.service_date):null;if(He+=en,fe[ln].sum+=en,fe[ln].count+=1,rs==="paid"){const Cc=Number($t.reimbursed_amount||0);ve+=Cc}else(rs==="filed"||rs==="approved")&&(_e+=en);if((rs==="denied"||ln==="not_insured")&&(Oe+=en),rs==="approved"&&(dt+=en),Nc&&!Number.isNaN(Nc.getTime())&&(Je+=en,rs==="paid")){const Cc=Number($t.reimbursed_amount||0);st+=Cc}const Da=((nn=$t.pets)==null?void 0:nn.name)||"Unknown Pet";ct[Da]||(ct[Da]={sum:0,count:0}),ct[Da].sum+=en,ct[Da].count+=1}const wn=Je-st;return{byCategory:fe,reimbursed:ve,awaiting:_e,outOfPocket:Oe,grandTotal:He,perPet:ct,awaitingInsured:dt,periodSpent:Je,periodReimbursed:st,periodNet:wn}},[De,Mt]);return v.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-800 dark:from-slate-900 dark:to-slate-950 dark:text-slate-100",children:[v.jsx("header",{className:"px-6 py-5",children:v.jsxs("div",{className:"mx-auto max-w-6xl flex items-center justify-between",children:[v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsx("img",{src:"/pch-logo.png",alt:"Pet Claim Helper",className:"h-14 w-14 object-contain"}),v.jsx("span",{className:"text-xl font-semibold tracking-tight",children:"Pet Claim Helper"})]}),v.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[Le==="app"&&v.jsxs("button",{type:"button",onClick:()=>{var P;return(P=ze.current)==null?void 0:P.scrollIntoView({behavior:"smooth"})},className:"relative inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-1.5 text-xs hover:shadow",children:["Claims (",De.length,")",Po.expiringSoon>0&&v.jsx("span",{className:"ml-2 inline-block h-2 w-2 rounded-full bg-rose-500","aria-hidden":!0})]}),Le==="app"&&v.jsx("button",{type:"button",onClick:()=>qe(P=>P==="app"?"settings":"app"),className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-1.5 text-xs hover:shadow",children:"⚙️ Settings"}),Le==="app"&&v.jsx("button",{type:"button",onClick:()=>qe(P=>P==="medications"?"app":"medications"),className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-1.5 text-xs hover:shadow",children:"💊 Medications"}),Le==="app"&&v.jsx("button",{type:"button",onClick:async()=>{try{const fe=await(await fetch("http://localhost:8787/api/send-reminders",{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`✅ ${fe.message}

Emails sent: ${fe.sent}
Total expiring claims: ${fe.totalClaims}`)}catch(P){alert("❌ Error sending reminders: "+P.message)}},className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-1.5 text-xs hover:shadow",children:"📧 Send Reminders"}),re&&v.jsxs("span",{className:"text-xs text-slate-600 dark:text-slate-300",children:["Logged in as: ",re]}),re&&v.jsx("button",{onClick:ld,className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-1.5 text-xs hover:shadow",children:"Logout"})]}),v.jsx("div",{className:"md:hidden",children:v.jsx("button",{type:"button",className:"inline-flex items-center rounded-lg border border-slate-200 dark:border-slate-800 bg-white/60 dark:bg-white/5 px-3 py-2 text-sm",onClick:()=>Or(!0),"aria-label":"Open menu",children:"☰"})})]})}),Rr&&v.jsxs("div",{className:"fixed inset-0 z-50",children:[v.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>Or(!1)}),v.jsxs("div",{className:"absolute right-0 top-0 h-full w-80 max-w-[85vw] bg-white dark:bg-slate-900 shadow-xl p-6 flex flex-col gap-4",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("div",{className:"text-lg font-semibold",children:"Menu"}),v.jsx("button",{type:"button",className:"text-sm",onClick:()=>Or(!1),children:"Close"})]}),Le==="app"&&v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg border border-slate-200 dark:border-slate-700 text-left px-4",onClick:()=>{var P;Or(!1),(P=ze.current)==null||P.scrollIntoView({behavior:"smooth"})},children:"Pet Claims"}),v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg border border-slate-200 dark:border-slate-700 text-left px-4",onClick:()=>{Or(!1),qe("medications")},children:"Medications"}),v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg border border-slate-200 dark:border-slate-700 text-left px-4",onClick:()=>{Or(!1),qe(P=>P==="app"?"settings":"app")},children:"Settings"}),v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg border border-slate-200 dark:border-slate-700 text-left px-4",onClick:async()=>{try{const fe=await(await fetch("http://localhost:8787/api/send-reminders",{method:"POST",headers:{"Content-Type":"application/json"}})).json();alert(`✅ ${fe.message}

Emails sent: ${fe.sent}
Total expiring claims: ${fe.totalClaims}`)}catch(P){alert("❌ Error sending reminders: "+P.message)}finally{Or(!1)}},children:"Send Reminders"}),re&&v.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 mt-2",children:["Logged in as: ",re]}),re&&v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg bg-rose-600 hover:bg-rose-700 text-white",onClick:()=>{Or(!1),ld()},children:"Logout"})]})]})]}),v.jsxs("main",{className:"px-6",children:[Le==="app"&&Ft==="settings"&&v.jsx(T$,{userId:le,userEmail:re,onClose:()=>qe("app"),onDefaultExpenseChange:P=>B(P),onDefaultPeriodChange:P=>pt(P)}),Le==="app"&&Ft==="medications"&&v.jsx("section",{className:"mx-auto mt-8 max-w-6xl px-2",children:v.jsx(N$,{userId:le,pets:f})}),Le!=="app"&&v.jsx("section",{className:"mx-auto max-w-md mt-8",children:v.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/60 shadow-sm",children:[v.jsx("div",{className:"px-6 pt-4",children:v.jsxs("div",{className:"flex items-center gap-6 border-b border-slate-200 dark:border-slate-800",children:[v.jsx("button",{type:"button",onClick:()=>je("signup"),className:["pb-3 text-sm font-medium transition-colors",Le==="signup"?"text-emerald-600 border-b-2 border-emerald-600":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"].join(" "),children:"Sign Up"}),v.jsx("button",{type:"button",onClick:()=>je("login"),className:["pb-3 text-sm font-medium transition-colors",Le==="login"?"text-emerald-600 border-b-2 border-emerald-600":"text-slate-500 hover:text-slate-700 dark:hover:text-slate-300"].join(" "),children:"Log In"})]})}),v.jsx("div",{className:"p-6",children:v.jsx(P$,{mode:Le,onSwitch:P=>je(P)})})]})}),Le==="app"&&v.jsxs("section",{className:"mx-auto max-w-4xl",ref:$e,children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-lg font-semibold",children:"Your Pets"}),v.jsx("button",{type:"button",onClick:()=>j(P=>!P),className:"inline-flex items-center rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-1.5 text-sm hover:shadow",children:"+ Add Pet"})]}),F&&v.jsxs("div",{className:"mt-4 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/60 p-4",children:[v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-3",children:[v.jsxs("div",{className:"sm:col-span-1",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Name"}),v.jsx("input",{value:T.name,onChange:P=>W({...T,name:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{className:"sm:col-span-1",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Species"}),v.jsxs("select",{value:T.species,onChange:P=>W({...T,species:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"dog",children:"Dog"}),v.jsx("option",{value:"cat",children:"Cat"})]})]}),v.jsx("div",{className:"sm:col-span-2",children:v.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 p-3",children:[v.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:"Insurance Information"}),v.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company"}),v.jsxs("select",{value:K,onChange:P=>{const fe=P.target.value;ne(fe),fe==="Custom Insurance"?W({...T,insuranceCompany:"",filing_deadline_days:""}):fe&&W({...T,insuranceCompany:fe,filing_deadline_days:90})},className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"",children:"— Select —"}),v.jsx("option",{value:"Trupanion",children:"Trupanion (90 days)"}),v.jsx("option",{value:"Nationwide",children:"Nationwide (90 days)"}),v.jsx("option",{value:"Healthy Paws",children:"Healthy Paws (90 days)"}),v.jsx("option",{value:"Fetch",children:"Fetch (90 days)"}),v.jsx("option",{value:"Custom Insurance",children:"Custom Insurance"})]})]}),K==="Custom Insurance"?v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company Name"}),v.jsx("input",{value:Z,onChange:P=>he(P.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Filing Deadline (days)"}),v.jsx("input",{type:"number",min:1,max:365,value:me,onChange:P=>Ne(P.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]})]}):v.jsx("div",{className:"sm:col-span-1 flex items-end text-xs text-slate-600",children:K?"Filing Deadline: 90 days":""})]})]})}),v.jsxs("div",{className:"sm:col-span-1",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Policy #"}),v.jsx("input",{value:T.policyNumber,onChange:P=>W({...T,policyNumber:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Owner Name"}),v.jsx("input",{value:T.ownerName,onChange:P=>W({...T,ownerName:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Owner Address"}),v.jsx("input",{value:T.ownerAddress,onChange:P=>W({...T,ownerAddress:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Owner Phone"}),v.jsx("input",{value:T.ownerPhone,onChange:P=>W({...T,ownerPhone:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]})]}),v.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[v.jsx("button",{type:"button",onClick:xc,className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm",children:"Save Pet"}),v.jsx("button",{type:"button",onClick:()=>j(!1),className:"text-sm text-slate-600 dark:text-slate-300",children:"Cancel"})]})]}),v.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[f.length===0&&v.jsx("div",{className:"col-span-full text-sm text-slate-500 dark:text-slate-400",children:'No pets saved yet. Click "+ Add Pet" to create one.'}),f.map(P=>v.jsxs("div",{className:["rounded-xl border p-6 text-left bg-white dark:bg-slate-900/60 shadow-sm relative",m===P.id?"border-emerald-400":"border-slate-200 dark:border-slate-800"].join(" "),style:{border:`2px solid ${P.color||(P.species==="dog"?"#3B82F6":P.species==="cat"?"#F97316":"#6B7280")}`},children:[v.jsxs("div",{className:"flex items-start justify-between",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"text-base font-semibold flex items-center gap-2",children:[v.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-full",style:{backgroundColor:P.color||(P.species==="dog"?"#3B82F6":P.species==="cat"?"#F97316":"#6B7280")}}),P.name]}),v.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400 capitalize",children:P.species})]}),v.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch gap-3 w-32 sm:w-auto",children:[v.jsx("button",{type:"button",onClick:()=>b(P.id),className:["inline-flex items-center justify-center rounded-lg px-3 py-1.5 h-12 text-sm hover:shadow w-full sm:w-auto",m===P.id?P.species==="dog"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white":"border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900"].join(" "),children:m===P.id?"Selected":"Use This Pet"}),v.jsx("button",{type:"button",onClick:()=>ug(P),className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 text-sm text-slate-700 dark:text-slate-200 w-full sm:w-auto px-3",children:"Edit"})]})]}),v.jsxs("div",{className:"mt-4 text-sm text-slate-700 dark:text-slate-300 space-y-1.5",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Insurance:"})," ",P.insuranceCompany]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Policy #:"})," ",P.policyNumber||"—"]}),(P.ownerName||P.ownerAddress||P.ownerPhone)&&v.jsxs("div",{className:"mt-3 space-y-1.5",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Owner:"})," ",P.ownerName||""]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Address:"})," ",P.ownerAddress||""]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500",children:"Phone:"})," ",P.ownerPhone||""]})]})]}),Y===P.id&&O&&v.jsxs("div",{className:"mt-4 rounded-lg border border-slate-200 dark:border-slate-800 p-3",children:[v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Name"}),v.jsx("input",{value:O.name,onChange:fe=>X({...O,name:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Species"}),v.jsxs("select",{value:O.species,onChange:fe=>X({...O,species:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"dog",children:"Dog"}),v.jsx("option",{value:"cat",children:"Cat"})]})]}),v.jsx("div",{className:"sm:col-span-2",children:v.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 p-3",children:[v.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:"Insurance Information"}),v.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company"}),v.jsxs("select",{value:te,onChange:fe=>{const ve=fe.target.value;ue(ve),ve==="Custom Insurance"?X({...O,insuranceCompany:"",filing_deadline_days:""}):ve&&X({...O,insuranceCompany:ve,filing_deadline_days:90})},className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"",children:"— Select —"}),v.jsx("option",{value:"Trupanion",children:"Trupanion (90 days)"}),v.jsx("option",{value:"Nationwide",children:"Nationwide (90 days)"}),v.jsx("option",{value:"Healthy Paws",children:"Healthy Paws (90 days)"}),v.jsx("option",{value:"Fetch",children:"Fetch (90 days)"}),v.jsx("option",{value:"Custom Insurance",children:"Custom Insurance"})]})]}),te==="Custom Insurance"?v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company Name"}),v.jsx("input",{value:L,onChange:fe=>V(fe.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Filing Deadline (days)"}),v.jsx("input",{type:"number",min:1,max:365,value:Q,onChange:fe=>se(fe.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]})]}):v.jsx("div",{className:"sm:col-span-1 flex items-end text-xs text-slate-600",children:te?"Filing Deadline: 90 days":""})]})]})}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Policy #"}),v.jsx("input",{value:O.policyNumber,onChange:fe=>X({...O,policyNumber:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Monthly Premium (USD)"}),v.jsx("input",{type:"number",step:"0.01",placeholder:"e.g., 38.00",value:String(O.monthly_premium??""),onChange:fe=>X({...O,monthly_premium:fe.target.value===""?"":Number(fe.target.value)}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"}),v.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:"Monthly insurance premium cost"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Deductible per Claim (USD)"}),v.jsx("input",{type:"number",step:"0.01",placeholder:"e.g., 250.00",value:String(O.deductible_per_claim??""),onChange:fe=>X({...O,deductible_per_claim:fe.target.value===""?"":Number(fe.target.value)}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"}),v.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:"Deductible amount per claim"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Coverage Start Date"}),v.jsx("input",{type:"date",value:O.coverage_start_date||"",onChange:fe=>X({...O,coverage_start_date:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"}),v.jsx("div",{className:"mt-1 text-[11px] text-slate-500",children:"When did your coverage start?"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Owner Name"}),v.jsx("input",{value:O.ownerName,onChange:fe=>X({...O,ownerName:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Owner Address"}),v.jsx("input",{value:O.ownerAddress,onChange:fe=>X({...O,ownerAddress:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs",children:"Owner Phone"}),v.jsx("input",{value:O.ownerPhone,onChange:fe=>X({...O,ownerPhone:fe.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]})]}),v.jsxs("div",{className:"mt-3 flex items-center gap-3",children:[v.jsx("button",{type:"button",onClick:zn,className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm",children:"Save"}),v.jsx("button",{type:"button",onClick:()=>{if(!Y)return;const fe=f.find(Oe=>Oe.id===Y),ve=(fe==null?void 0:fe.name)||"this pet";if(!confirm(`⚠️ Delete ${ve}?

This will NOT delete claims for this pet, but you won't be able to file new claims.

This cannot be undone!`))return;const _e=f.filter(Oe=>Oe.id!==Y);p(_e),le&&bB(le,Y).catch(Oe=>{console.error("[deletePet] error",Oe)}),I(null),X(null)},className:"inline-flex items-center rounded-lg bg-rose-600 hover:bg-rose-700 text-white px-3 py-1.5 text-sm",children:"Delete"}),v.jsx("button",{type:"button",onClick:()=>{I(null),X(null)},className:"text-sm text-slate-600 dark:text-slate-300",children:"Cancel"})]})]})]},P.id))]})]}),Le==="app"&&v.jsxs("section",{className:"mx-auto max-w-3xl text-center mt-8 px-2",children:[v.jsx("h2",{className:"text-2xl font-semibold",children:"File Your Claim"}),v.jsx("div",{className:"mt-4",children:v.jsx("div",{className:["rounded-2xl border bg-white dark:bg-slate-900/60 shadow-sm p-6 sm:p-8 transition-colors",n?"border-emerald-400 ring-2 ring-emerald-400/60 dark:ring-emerald-400/50 bg-emerald-50/40 dark:bg-emerald-900/10":"border-slate-200 dark:border-slate-800"].join(" "),onDragEnter:Ni,onDragOver:dg,onDragLeave:_c,onDrop:fr,children:v.jsxs("div",{className:"flex flex-col items-center",children:[v.jsx("button",{type:"button",onClick:hf,className:"group relative w-full sm:w-auto h-16 rounded-xl border border-slate-300/70 dark:border-slate-700 bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-800 hover:from-white hover:to-white px-5 text-base sm:text-sm text-slate-800 dark:text-slate-100 shadow hover:shadow-lg transition",children:v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("svg",{className:"h-6 w-6 text-emerald-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[v.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),v.jsx("polyline",{points:"17 8 12 3 7 8"}),v.jsx("line",{x1:"12",x2:"12",y1:"3",y2:"15"})]}),v.jsx("span",{className:"font-medium",children:"Upload Vet Bill (PDF or Photo)"})]})}),v.jsx("p",{className:"mt-3 text-sm text-slate-500 dark:text-slate-400",children:"or drag & drop here"}),v.jsx("input",{ref:s,type:"file",accept:"image/*,application/pdf",onChange:ud,className:"sr-only"}),e&&v.jsxs("div",{className:"mt-6 w-full text-left",children:[v.jsx("div",{className:"flex items-start justify-between gap-4",children:v.jsxs("div",{className:"min-w-0",children:[v.jsx("p",{className:"text-sm font-medium truncate",children:e.file.name}),v.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:dd})]})}),e.objectUrl&&v.jsx("div",{className:"mt-4",children:v.jsx("img",{src:e.objectUrl,alt:"Selected preview",className:"max-h-80 w-full object-contain rounded-lg border border-slate-200 dark:border-slate-800",onLoad:()=>{e.objectUrl&&URL.revokeObjectURL(e.objectUrl)}})}),v.jsx("div",{className:"mt-5",children:v.jsxs("button",{type:"button",onClick:fg,disabled:i,className:"inline-flex items-center justify-center w-full h-14 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 text-base sm:text-sm font-medium disabled:opacity-60 disabled:cursor-not-allowed",children:[i&&v.jsxs("svg",{className:"mr-2 h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[v.jsx("circle",{cx:"12",cy:"12",r:"10",className:"opacity-25"}),v.jsx("path",{d:"M4 12a8 8 0 018-8",className:"opacity-75"})]}),"Process Bill"]})})]})]})})})]}),Le==="app"&&Fe&&v.jsx("section",{className:"mx-auto mt-8 max-w-3xl",children:v.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/60 shadow-sm p-5 sm:p-8",children:[v.jsx("h2",{className:"text-lg font-semibold",children:"Multiple Pets Detected"}),v.jsx("p",{className:"mt-2 text-sm text-slate-600 dark:text-slate-300",children:"We found charges for multiple pets on this bill:"}),v.jsx("ul",{className:"mt-2 text-sm list-disc pl-6 text-slate-700 dark:text-slate-200",children:Fe.pets.map((P,fe)=>v.jsxs("li",{children:[P.petName||`Pet ${fe+1}`," (",P.petSpecies||"Pet",") — ",P.subtotal||pf(P.lineItems)]},fe))}),v.jsx("p",{className:"mt-4 text-sm text-slate-600 dark:text-slate-300",children:"We'll create a separate claim for each pet."}),v.jsxs("div",{className:"mt-6 space-y-4",children:[v.jsx("p",{className:"text-sm font-medium",children:"Match each pet to your saved profiles (or add new ones):"}),Fe.pets.map((P,fe)=>v.jsx("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 p-3",children:v.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 justify-between",children:[v.jsxs("div",{className:"text-left",children:[v.jsx("div",{className:"text-sm font-medium",children:P.petName||`Pet ${fe+1}`}),v.jsx("div",{className:"text-xs text-slate-500",children:P.petSpecies||"Pet"})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsxs("select",{className:"rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",value:at[fe]||"",onChange:ve=>{const _e=[...at];_e[fe]=ve.target.value||null,Se(_e)},children:[v.jsx("option",{value:"",children:"Select saved pet…"}),f.map(ve=>v.jsxs("option",{value:ve.id,children:[ve.name," (",ve.species,")"]},ve.id))]}),!at[fe]&&v.jsx("button",{type:"button",className:"inline-flex items-center rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-xs hover:shadow",onClick:()=>{var Oe;Re(fe),j(!0);const ve=(P.petSpecies||"").toLowerCase(),_e=ve.includes("cat")?"cat":ve.includes("dog")?"dog":T.species;W(He=>({...He,name:P.petName||"",species:_e})),(Oe=$e.current)==null||Oe.scrollIntoView({behavior:"smooth"})},children:"+ Add New Pet"})]})]})},fe))]}),v.jsx("div",{className:"mt-6 flex justify-end",children:v.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-sm font-medium disabled:opacity-60 disabled:cursor-not-allowed",disabled:at.some(P=>!P),onClick:async()=>{const P=[];for(let fe=0;fe<Fe.pets.length;fe++){const ve=Fe.pets[fe],_e=at[fe],Oe=f.find(wn=>wn.id===_e)||null,He=ve.subtotal||pf(ve.lineItems),{filename:ct,blob:dt}=_$({clinicName:Fe.clinicName,clinicAddress:Fe.clinicAddress,dateOfService:Fe.dateOfService,diagnosis:Fe.diagnosis,petName:ve.petName,lineItems:ve.lineItems,subtotal:He,invoiceNumber:Fe.invoiceNumber},Oe);if(le)try{const wn=parseFloat(String(He).replace(/[^0-9.\-]/g,""))||null,nn=Number(Oe==null?void 0:Oe.filing_deadline_days)||90,$t=Fe.dateOfService?new Date(Fe.dateOfService):null,en=$t?new Date($t.getTime()):null;en&&en.setDate(en.getDate()+nn);const rs=await qE({user_id:le,pet_id:Oe?Oe.id:null,service_date:Fe.dateOfService||null,invoice_number:Fe.invoiceNumber||null,clinic_name:Fe.clinicName||null,clinic_address:Fe.clinicAddress||null,diagnosis:Fe.diagnosis||null,total_amount:wn,line_items:ve.lineItems,filing_status:"not_filed",filing_deadline_days:nn});rs!=null&&rs.id&&await mf(le,rs.id,dt)}catch(wn){console.error("[createClaim multi] error",wn)}const Je=URL.createObjectURL(dt),st=document.createElement("a");st.href=Je,st.download=ct,document.body.appendChild(st),st.click(),st.remove(),URL.revokeObjectURL(Je),P.push({name:ct,amount:He})}le&&Fo(le).then(Ke).catch(()=>{}),_t(!0),alert(`✓ ${P.length} claims generated and downloaded!
`+P.map(fe=>`- ${fe.name} (${fe.amount})`).join(`
`)+`

Email each claim to your insurance company.`)},children:"Generate Claims"})})]})}),c&&v.jsx("section",{className:"mx-auto mt-8 max-w-3xl",children:v.jsxs("div",{className:"rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900/60 shadow-sm p-5 sm:p-8",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("button",{type:"button",className:"h-11 inline-flex items-center rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 text-sm",onClick:()=>{u(null),Be(null),t(null),l(null),w(""),k(""),B("insured")},children:"← Cancel"}),v.jsx("h2",{className:"text-lg font-semibold",children:"Extracted Details"})]}),v.jsxs("div",{className:"mt-3 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"What was this visit for? (Visit Title)"}),v.jsx("input",{value:_,onChange:P=>k(P.target.value),placeholder:"e.g., Annual checkup, Emergency visit, Teeth cleaning",className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),(()=>{if(!c||!Array.isArray(c.lineItems))return null;const P=c.lineItems.map(_e=>Ac(_e.amount));return c.lineItems.length>0&&P.every(_e=>!Number.isFinite(_e)||_e===0)?v.jsxs("div",{className:"mt-3 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900",children:[v.jsx("div",{className:"font-semibold",children:"⚠️ NO PRICES FOUND"}),v.jsx("div",{className:"mt-1",children:"This appears to be a vaccination certificate or record, not an invoice."}),v.jsx("div",{className:"mt-1",children:"Please upload the actual bill/receipt with itemized charges and prices."}),v.jsx("div",{className:"mt-1 text-amber-800/80",children:"Insurance companies require invoices showing what you paid."})]}):null})(),v.jsx("p",{className:"mt-1 text-sm text-slate-500 dark:text-slate-400",children:"Review and edit any field if needed."}),v.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Clinic Name"}),v.jsx("input",{value:c.clinicName,onChange:P=>u({...c,clinicName:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Clinic Address"}),v.jsx("input",{value:c.clinicAddress,onChange:P=>u({...c,clinicAddress:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Pet Name"}),v.jsx("input",{value:c.petName,onChange:P=>u({...c,petName:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Date of Service"}),v.jsx("input",{value:c.dateOfService,onChange:P=>u({...c,dateOfService:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Invoice Number"}),v.jsx("input",{value:c.invoiceNumber||"",onChange:P=>u({...c,invoiceNumber:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Total Amount"}),v.jsx("input",{value:c.totalAmount,onChange:P=>u({...c,totalAmount:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Diagnosis / Reason"}),v.jsx("textarea",{value:c.diagnosis,onChange:P=>u({...c,diagnosis:P.target.value}),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",rows:3})]})]}),y&&v.jsxs("div",{className:"mt-6",children:[v.jsx("h3",{className:"text-sm font-semibold",children:"Pet Insurance"}),v.jsxs("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company"}),v.jsx("input",{value:y.insuranceCompany,readOnly:!0,className:"mt-1 w-full rounded-md border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/40 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Policy Number"}),v.jsx("input",{value:y.policyNumber,readOnly:!0,className:"mt-1 w-full rounded-md border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/40 px-3 py-2 text-sm"})]})]})]}),v.jsxs("div",{className:"mt-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h3",{className:"text-sm font-semibold",children:"Line Items"}),v.jsx("button",{type:"button",className:"text-sm text-emerald-700 dark:text-emerald-300 hover:underline",onClick:()=>u({...c,lineItems:[...c.lineItems,{description:"",amount:""}]}),children:"+ Add Item"})]}),v.jsx("div",{className:"mt-3 space-y-3",children:c.lineItems.map((P,fe)=>v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-3",children:[v.jsx("div",{className:"sm:col-span-8",children:v.jsx("input",{placeholder:"Description",value:P.description,onChange:ve=>{const _e=[...c.lineItems];_e[fe]={..._e[fe],description:ve.target.value},u({...c,lineItems:_e})},className:"w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})}),v.jsx("div",{className:"sm:col-span-3",children:v.jsx("input",{placeholder:"Amount",value:P.amount,onChange:ve=>{const _e=[...c.lineItems];_e[fe]={..._e[fe],amount:ve.target.value},u({...c,lineItems:_e})},className:"w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})}),v.jsx("div",{className:"sm:col-span-1 flex items-center",children:v.jsx("button",{type:"button",className:"text-slate-500 hover:text-rose-600 text-sm",onClick:()=>{const ve=c.lineItems.filter((_e,Oe)=>Oe!==fe);u({...c,lineItems:ve})},"aria-label":"Remove item",children:"✕"})})]},fe))})]}),v.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 dark:border-slate-800 bg-blue-50/60 dark:bg-blue-900/10 p-4",children:[v.jsxs("label",{htmlFor:"visit-notes",className:"block text-sm font-semibold mb-2",children:["📝 Visit Notes ",v.jsx("span",{className:"text-xs font-normal text-slate-500",children:"(Optional but recommended)"})]}),v.jsx("textarea",{id:"visit-notes",value:S,onChange:P=>w(P.target.value),placeholder:"What was discussed at this vet visit? (e.g., 'Annual checkup - vet noted minor eye redness from outdoor play, cleared up in 2 days')",rows:3,className:"w-full rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-2 text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),v.jsxs("p",{className:"mt-2 text-xs text-slate-600 dark:text-slate-400",children:["💡 ",v.jsx("strong",{children:"Why this matters:"})," Documenting what was discussed protects you from casual comments being misinterpreted later as pre-existing conditions."]})]}),C!=="not_insured"&&(()=>{const P=Number(y==null?void 0:y.filing_deadline_days)||90,fe=c.dateOfService?new Date(c.dateOfService):null,ve=fe?new Date(fe.getTime()):null;ve&&ve.setDate(ve.getDate()+P);const _e=new Date,Oe=ve?Math.ceil((ve.getTime()-_e.getTime())/(1e3*60*60*24)):null,He=Oe===null?{wrap:"bg-slate-50 border-slate-200",title:"text-slate-900"}:Oe>=60?{wrap:"bg-emerald-50 border-emerald-200",title:"text-emerald-900"}:Oe>=30?{wrap:"bg-yellow-50 border-yellow-200",title:"text-yellow-900"}:Oe>=15?{wrap:"bg-orange-50 border-orange-200",title:"text-orange-900"}:{wrap:"bg-rose-50 border-rose-200",title:"text-rose-900"};if(Oe!==null&&Oe<0){const ct=fe?Math.floor((_e.getTime()-fe.getTime())/864e5):0,dt=Math.floor(ct/365),Je=Math.max(1,Math.floor(ct%365/30)),st=dt>=1?dt===1?"over 1 year ago":`over ${dt} years ago`:`over ${Je} months ago`;return v.jsxs("div",{className:["mt-8 rounded-2xl border p-5 shadow-sm bg-rose-50 border-rose-200"].join(" "),children:[v.jsx("div",{className:"text-sm font-semibold text-rose-900",children:"⚠️ DEADLINE PASSED"}),v.jsxs("div",{className:"mt-2 text-sm text-rose-900",children:["This bill is from ",c.dateOfService||"—"," (",st,")."]}),v.jsx("div",{className:"mt-2 text-sm text-rose-900",children:"Most insurers won't accept claims this old."}),v.jsx("div",{className:"mt-1 text-xs text-rose-900/80",children:"Contact your insurance company to verify if you can still file."})]})}return v.jsxs("div",{className:["mt-8 rounded-2xl border p-5 shadow-sm",He.wrap].join(" "),children:[v.jsx("div",{className:["text-sm font-semibold flex items-center gap-2",He.title].join(" "),children:v.jsx("span",{children:"⏰ FILING DEADLINE REMINDER"})}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-600 dark:text-slate-400",children:"Service Date"}),v.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:c.dateOfService?new Date(c.dateOfService).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-600 dark:text-slate-400",children:"Insurance"}),v.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:y?y.insuranceCompany:"—"})]})]}),v.jsx("div",{className:"mt-3 text-sm",children:v.jsx("div",{className:"text-slate-700",children:"⚠️ Most insurers require filing within 60–180 days of service."})}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-600 dark:text-slate-400",children:"Estimated Deadline"}),v.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100",children:ve?ve.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"—"})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-600 dark:text-slate-400",children:"Days Remaining"}),v.jsx("div",{className:"font-bold text-slate-900 dark:text-slate-100 text-base",children:Oe===null?"—":`${Oe} days`})]})]}),v.jsx("div",{className:"mt-3 text-xs text-slate-600",children:"This is a general reminder. Always verify your specific policy deadline."})]})})(),v.jsxs("div",{className:"mt-6 rounded-xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-4",children:[v.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Expense Category"}),v.jsxs("div",{className:"flex flex-wrap gap-3 text-sm",children:[v.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[v.jsx("input",{type:"radio",name:"exp-cat",value:"insured",checked:C==="insured",onChange:()=>B("insured")}),v.jsx("span",{children:"Insured"})]}),v.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[v.jsx("input",{type:"radio",name:"exp-cat",value:"not_insured",checked:C==="not_insured",onChange:()=>B("not_insured")}),v.jsx("span",{children:"Not Insured"})]}),v.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer",children:[v.jsx("input",{type:"radio",name:"exp-cat",value:"maybe_insured",checked:C==="maybe_insured",onChange:()=>B("maybe_insured")}),v.jsx("span",{children:"Maybe Insured"})]})]})]}),v.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[v.jsx("button",{type:"button",className:"h-11 inline-flex items-center rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 text-sm",onClick:()=>{u(null),Be(null),t(null),l(null),w(""),k(""),B("insured")},children:"← Cancel"}),v.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 text-sm font-medium",onClick:async()=>{if(!y){ti(!0);return}const P=Number(y==null?void 0:y.filing_deadline_days)||90,fe=c.dateOfService?new Date(c.dateOfService):null,ve=fe?new Date(fe.getTime()):null;ve&&ve.setDate(ve.getDate()+P);let _e=null;if(le)try{const He=parseFloat(String(c.totalAmount).replace(/[^0-9.\-]/g,""))||null;_e=await qE({user_id:le,pet_id:y?y.id:null,service_date:c.dateOfService||null,invoice_number:c.invoiceNumber||null,clinic_name:c.clinicName||null,clinic_address:c.clinicAddress||null,visit_title:_||null,diagnosis:c.diagnosis||null,total_amount:He,line_items:c.lineItems,filing_status:"not_submitted",filing_deadline_days:P,visit_notes:S||null,expense_category:C})}catch(He){console.error("[createClaim single] error",He)}const Oe={claimId:(_e==null?void 0:_e.id)||null,petName:(y==null?void 0:y.name)||"Unknown",species:(y==null?void 0:y.species)||"",amount:Ac(String(c.totalAmount||"")),serviceDate:c.dateOfService||null,insurance:(y==null?void 0:y.insuranceCompany)||"",deadlineDate:ve?ve.toISOString().slice(0,10):null,deadlineDays:P};wc(Oe),og((_e==null?void 0:_e.id)||null),console.log("[LOOKS GOOD CLICKED] About to show medication modal",{claimId:_e==null?void 0:_e.id}),Zs(!0)},children:"Looks Good"})]})]})}),Le==="app"&&De.length>0&&v.jsxs("section",{className:"mx-auto mt-10 max-w-5xl",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Financial Summary"}),v.jsxs("div",{className:"text-sm",children:[v.jsx("label",{className:"mr-2 text-slate-600",children:"Show expenses for:"}),v.jsxs("select",{value:Mt,onChange:P=>pt(P.target.value),className:"rounded-md border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-2 py-1 text-sm",children:[v.jsx("option",{value:"all",children:"All Time"}),v.jsx("option",{value:"2025",children:"2025"}),v.jsx("option",{value:"2024",children:"2024"}),v.jsx("option",{value:"last12",children:"Last 12 Months"})]})]})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-emerald-200 bg-emerald-50 p-5 dark:border-emerald-900/50 dark:bg-emerald-900/10",children:[v.jsx("div",{className:"text-sm font-semibold",children:"💰 MONEY COMING BACK TO YOU"}),v.jsx("div",{className:"mt-2 text-3xl font-bold text-emerald-700",children:Ds(Fa.awaitingInsured)}),v.jsx("div",{className:"mt-1 text-xs text-emerald-800/80 dark:text-emerald-300",children:"Sum of approved claims awaiting reimbursement"})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-rose-200 bg-rose-50 p-5 dark:border-rose-900/50 dark:bg-rose-900/10",children:[v.jsx("div",{className:"text-sm font-semibold",children:"💸 YOUR ACTUAL COST"}),v.jsx("div",{className:"mt-2 text-3xl font-bold text-rose-700",children:Ds(Fa.outOfPocket)}),v.jsx("div",{className:"mt-1 text-xs text-rose-800/80 dark:text-rose-300",children:"Not insured + any denied claims"})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white p-5 dark:border-slate-800 dark:bg-slate-900",children:[v.jsx("div",{className:"text-sm font-semibold",children:Mt==="all"?"📊 ALL TIME TOTAL":Mt==="2025"?"📊 2025 TOTAL":Mt==="2024"?"📊 2024 TOTAL":"📊 LAST 12 MONTHS"}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Spent on all pets"}),v.jsx("div",{className:"text-2xl font-bold",children:Ds(Fa.periodSpent)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Reimbursed so far"}),v.jsx("div",{className:"text-2xl font-bold",children:Ds(Fa.periodReimbursed)})]}),v.jsxs("div",{children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Net cost to you"}),v.jsx("div",{className:"text-2xl font-bold",children:Ds(Fa.periodNet)})]})]})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 bg-white p-5 dark:border-slate-800 dark:bg-slate-900",children:[v.jsx("div",{className:"text-sm font-semibold",children:"🐕 PER-PET BREAKDOWN"}),v.jsx("div",{className:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(Fa.perPet).map(([P,fe])=>{const ve=f.find(Oe=>Oe.name===P),_e=(ve==null?void 0:ve.color)||((ve==null?void 0:ve.species)==="cat"?"#F97316":(ve==null?void 0:ve.species)==="dog"?"#3B82F6":"#6B7280");return v.jsxs("div",{className:"flex items-center justify-between text-sm",children:[v.jsxs("div",{className:"truncate flex items-center gap-2",children:[v.jsx("span",{className:"inline-block h-2 w-2 rounded-full",style:{backgroundColor:_e}}),P]}),v.jsxs("div",{className:"text-right",children:[v.jsx("div",{className:"font-semibold",children:Ds(fe.sum)}),v.jsxs("div",{className:"text-xs text-slate-500",children:[fe.count," visits"]})]})]},P)})})]})]}),Le==="app"&&v.jsx("section",{className:"mx-auto mt-10 max-w-5xl",children:v.jsx(S$,{userId:le})}),Le==="app"&&De.length>0&&v.jsxs("section",{className:"mx-auto mt-10 max-w-5xl",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Claims History"}),v.jsx("div",{className:"flex items-center gap-3",children:v.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-800 px-3 py-2 text-sm bg-white dark:bg-slate-900",children:[v.jsx("span",{className:"text-slate-500 mr-2",children:"Sort"}),v.jsxs("select",{value:Tt,onChange:P=>Vt(P.target.value),className:"bg-transparent outline-none",children:[v.jsx("option",{value:"urgent",children:"Urgency"}),v.jsx("option",{value:"date_newest",children:"Date (newest)"}),v.jsx("option",{value:"date_oldest",children:"Date (oldest)"}),v.jsx("option",{value:"amount_high",children:"Amount (high→low)"}),v.jsx("option",{value:"amount_low",children:"Amount (low→high)"}),v.jsx("option",{value:"pet",children:"Pet"}),v.jsx("option",{value:"status",children:"Status"})]})]})})]}),v.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-4 gap-4",children:[v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white dark:bg-slate-900",children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Total claims"}),v.jsx("div",{className:"text-lg font-semibold",children:Po.total})]}),v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white dark:bg-slate-900",children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Not yet filed"}),v.jsxs("div",{className:"text-lg font-semibold",children:[Po.notFiledCount," ",v.jsxs("span",{className:"text-sm text-slate-500",children:["(",Ds(Po.notFiledSum),")"]})]})]}),v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white dark:bg-slate-900",children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Filed / pending"}),v.jsx("div",{className:"text-lg font-semibold",children:Po.filedPending})]}),v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white dark:bg-slate-900",children:[v.jsx("div",{className:"text-xs text-slate-500",children:"Expiring soon (< 15 days)"}),v.jsx("div",{className:"text-lg font-semibold",children:Po.expiringSoon})]})]}),v.jsx("div",{ref:ze,className:"mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 w-full overflow-x-hidden",style:{overscrollBehaviorX:"none"},children:Ss.map(P=>{const fe=P.pets||{},ve=(fe==null?void 0:fe.color)||((fe==null?void 0:fe.species)==="cat"?"#F97316":(fe==null?void 0:fe.species)==="dog"?"#3B82F6":"#6B7280");ri(P);const _e=(()=>{const Je=Eo(P);if(!Je)return null;const st=new Date(Je.getTime());return st.setDate(st.getDate()+vf(P)),st})(),Oe=kc(P),He=Sc(P.filing_status),ct=String(P.expense_category||"insured")==="not_insured",dt=(()=>{const Je=P.expense_category||"insured";return Je==="insured"?{text:"Insured",cls:"bg-emerald-50 text-emerald-700 border border-emerald-200"}:Je==="not_insured"?{text:"Not Insured",cls:"bg-slate-100 text-slate-700 border border-slate-300"}:{text:"Maybe Insured",cls:"bg-amber-50 text-amber-700 border border-amber-200"}})();return v.jsxs("div",{className:"rounded-xl border border-slate-200 dark:border-slate-800 p-4 bg-white dark:bg-slate-900 shadow-sm min-h-[180px] w-full",style:{border:`2px solid ${ve}`,touchAction:"pan-y",overscrollBehaviorX:"none"},children:[v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-start gap-2",children:[v.jsx("div",{className:"h-8 w-8 rounded-full flex items-center justify-center",style:{backgroundColor:ve+"20"},children:v.jsx("span",{className:"text-slate-700",children:fe.species==="cat"?"🐱":"🐶"})}),v.jsx("div",{className:"min-w-0",children:v.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100 break-words line-clamp-2",children:`${fe.name||"Pet"} • ${P.visit_title&&String(P.visit_title)||P.diagnosis&&String(P.diagnosis)||""}`})})]}),v.jsxs("div",{className:"text-sm text-slate-600 dark:text-slate-400 truncate",children:[v.jsx("span",{className:"mr-1",children:"🏥"}),P.clinic_name||"—"]}),v.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[v.jsx("div",{className:`px-2 py-1 rounded-full text-xs whitespace-nowrap ${dt.cls}`,children:dt.text}),v.jsx("div",{className:`px-2 py-1 rounded-full text-xs whitespace-nowrap ${He.cls}`,children:He.text})]})]}),v.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-3 text-sm",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Service Date"}),v.jsx("div",{className:"font-medium",children:P.service_date||"—"})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("div",{className:"text-slate-500",children:"Amount"}),v.jsx("div",{className:"font-mono font-semibold",children:Ds(P.total_amount)}),String(P.filing_status||"").toLowerCase()==="paid"&&v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"mt-1 text-[11px]",children:v.jsx("span",{className:"inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700",children:(()=>{const Je=Number(P.total_amount||0),st=Number(P.reimbursed_amount||0),wn=Je>0?Math.round(st/Je*100):0;return`Claimed: ${Ds(Je)} → Received: ${Ds(st)} (${wn}%)`})()})}),P.paid_date&&v.jsx("div",{className:"mt-1 text-[11px]",children:v.jsx("span",{className:"inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-emerald-700",children:`Date Paid: ${new Date(P.paid_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}`})})]})]}),(()=>{const Je=String(P.filing_status||"").toLowerCase();return!!P.filed_date&&(Je==="filed"||Je==="paid")?v.jsxs("div",{className:"col-span-2 mt-1 text-[11px] text-slate-700 dark:text-slate-300 flex items-center gap-1",children:[v.jsx("span",{children:"📤"}),v.jsxs("span",{children:["Submitted: ",new Date(P.filed_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})]}):null})(),ct?v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Info"}),v.jsx("div",{className:"font-medium whitespace-nowrap overflow-hidden",children:"💰 Self-paid claim"})]}),v.jsx("div",{className:"text-right text-slate-400",children:"No deadline tracking"})]}):v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Deadline"}),v.jsx("div",{className:"font-medium whitespace-nowrap overflow-hidden",children:_e?_e.toISOString().slice(0,10):"—"})]}),v.jsx("div",{className:"text-right",children:v.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full ${Oe.cls}`,children:Oe.text})})]})]}),v.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-200 dark:border-slate-800 flex flex-wrap items-start sm:items-center justify-between gap-2",children:[ct?v.jsx("div",{className:"flex items-center gap-2",children:v.jsx("span",{className:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-1 text-xs text-slate-600",children:"⭕ Not insured - No filing required"})}):v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800",onClick:async()=>{try{const Je=new Date().toISOString().slice(0,10),wn=prompt("Enter filed date (YYYY-MM-DD):",Je)||Je;await Xf(P.id,{filing_status:"filed",filed_date:wn}),Ke(nn=>nn.map($t=>$t.id===P.id?{...$t,filing_status:"filed",filed_date:wn}:$t));try{alert("✓ Claim marked as submitted")}catch{}if(await new Promise(nn=>setTimeout(nn,700)),le){const nn=await Fo(le);Ke(nn)}}catch(Je){console.error("[mark filed] error",Je)}},children:"Mark as Submitted"}),v.jsxs("select",{className:"text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900",value:(()=>{const Je=String(P.filing_status||"not_submitted").toLowerCase();return Je==="filed"?"submitted":Je==="not_filed"?"not_submitted":Je})(),onChange:async Je=>{try{const st=Je.target.value;if(st==="paid"){Qs(P);const wn=P.total_amount&&Number.isFinite(Number(P.total_amount))?String(Number(P.total_amount).toFixed(2)):"";Fs(wn),On(new Date().toISOString().split("T")[0])}else{await Xf(P.id,{filing_status:st==="submitted"?"filed":st==="not_submitted"?"not_filed":st});try{alert("✓ Status updated")}catch{}await new Promise(wn=>setTimeout(wn,600)),le&&Fo(le).then(Ke)}}catch(st){console.error("[edit status] error",st)}},children:[v.jsx("option",{value:"not_submitted",children:"Not Submitted"}),v.jsx("option",{value:"submitted",children:"Submitted"}),v.jsx("option",{value:"approved",children:"Approved"}),v.jsx("option",{value:"paid",children:"Paid"}),v.jsx("option",{value:"denied",children:"Denied"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[P.pdf_path?v.jsx("a",{href:"#",onClick:async Je=>{Je.preventDefault();try{const{data:st}=await an.storage.from("claim-pdfs").createSignedUrl(P.pdf_path,60);st!=null&&st.signedUrl&&window.open(st.signedUrl,"_blank")}catch(st){console.error("[view pdf] error",st)}},className:"text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 shrink-0 whitespace-nowrap",children:"View PDF"}):v.jsx("span",{className:"text-xs text-slate-400",children:"No PDF stored"}),v.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded border border-rose-200 text-rose-700 hover:bg-rose-50 dark:border-rose-800 shrink-0 whitespace-nowrap",onClick:async()=>{if(confirm("Delete this claim?"))try{await C$(P.id),le&&Fo(le).then(Ke)}catch(Je){console.error("[delete claim] error",Je)}},children:"Delete"}),v.jsx("button",{type:"button",className:"text-xs px-2 py-1 rounded border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 shrink-0 whitespace-nowrap",onClick:()=>Bt(P),children:"Edit"})]})]})]},P.id)})}),Ss.length===0&&v.jsx("div",{className:"mt-6 rounded-xl border border-slate-200 dark:border-slate-800 p-6 text-center text-sm text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-900",children:"No claims yet. Process your first vet bill to get started!"})]}),Le==="app"&&v.jsxs("footer",{className:"mx-auto max-w-3xl text-center py-10 text-xs text-slate-500 dark:text-slate-400",children:["© ",new Date().getFullYear()," Pet Claim Helper"]})]}),ee&&v.jsx(L$,{userId:le,userEmail:re,onClose:()=>St(!1)}),aa&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>ti(!1),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-rose-200 bg-white p-6",onClick:P=>P.stopPropagation(),children:[v.jsx("div",{className:"text-lg font-semibold text-rose-700",children:"⚠️ Please Select a Pet"}),v.jsx("div",{className:"mt-2 text-sm text-rose-800",children:"You haven't selected a pet for this claim yet."}),v.jsx("div",{className:"mt-1 text-sm text-rose-800",children:"Please go back and click 'Use This Pet' for the pet you want to file a claim for."}),v.jsx("div",{className:"mt-4 flex justify-end",children:v.jsx("button",{className:"inline-flex items-center rounded-lg bg-rose-600 hover:bg-rose-700 text-white px-3 py-1.5 text-sm",onClick:()=>ti(!1),children:"Go Back"})})]})}),Zt&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>Bt(null),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-2xl rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-0 flex flex-col max-h-[85vh]",onClick:P=>P.stopPropagation(),children:[v.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-slate-200 dark:border-slate-800",children:[v.jsx("h3",{className:"text-lg font-semibold",children:"Edit Claim"}),v.jsx("button",{className:"text-sm",onClick:()=>Bt(null),children:"Close"})]}),["filed","paid"].includes(String(Zt.filing_status||"").toLowerCase())&&v.jsx("div",{className:"mx-5 mt-3 rounded-lg border border-amber-200 bg-amber-50 p-3 text-xs text-amber-900",children:"⚠️ This claim has been filed. Changes may require resubmitting to insurance."}),v.jsx("div",{className:"p-5 overflow-y-auto",children:v.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Pet"}),v.jsxs("select",{className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",value:Zr||"",onChange:P=>on(P.target.value),children:[v.jsx("option",{value:"",children:"—"}),f.map(P=>v.jsx("option",{value:P.id,children:P.name},P.id))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Service Date"}),v.jsx("input",{className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",value:bn,onChange:P=>ki(P.target.value)})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Visit Title"}),v.jsx("input",{className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",value:Pn,onChange:P=>ei(P.target.value),placeholder:"e.g., Annual checkup, Teeth cleaning"})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Diagnosis / Reason"}),v.jsx("input",{className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",value:Kt,onChange:P=>So(P.target.value)})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Visit Notes"}),v.jsx("textarea",{rows:3,className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",value:ra,onChange:P=>Ln(P.target.value)})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Line Items"}),v.jsx("button",{type:"button",className:"text-xs text-emerald-700",onClick:()=>Ht([...mt,{description:"",amount:""}]),children:"+ Add Item"})]}),v.jsx("div",{className:"mt-2 space-y-2",children:mt.map((P,fe)=>v.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[v.jsx("input",{className:"col-span-8 rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-2 py-1",placeholder:"Description",value:P.description,onChange:ve=>{const _e=[...mt];_e[fe]={..._e[fe],description:ve.target.value},Ht(_e)}}),v.jsx("input",{className:"col-span-3 rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-2 py-1",placeholder:"Amount",value:P.amount,onChange:ve=>{const _e=[...mt];_e[fe]={..._e[fe],amount:ve.target.value},Ht(_e)}}),v.jsx("button",{className:"col-span-1 text-xs",onClick:()=>{const ve=mt.filter((_e,Oe)=>Oe!==fe);Ht(ve)},children:"✕"})]},fe))})]}),v.jsxs("div",{className:"sm:col-span-2",children:[v.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Expense Category"}),v.jsxs("div",{className:"flex items-center gap-3",children:[v.jsxs("label",{className:"inline-flex items-center gap-1",children:[v.jsx("input",{type:"radio",name:"edit-exp",checked:ia==="insured",onChange:()=>Qn("insured")})," Insured"]}),v.jsxs("label",{className:"inline-flex items-center gap-1",children:[v.jsx("input",{type:"radio",name:"edit-exp",checked:ia==="not_insured",onChange:()=>Qn("not_insured")})," Not Insured"]}),v.jsxs("label",{className:"inline-flex items-center gap-1",children:[v.jsx("input",{type:"radio",name:"edit-exp",checked:ia==="maybe_insured",onChange:()=>Qn("maybe_insured")})," Maybe"]})]})]})]})}),v.jsxs("div",{className:"p-5 border-t border-slate-200 dark:border-slate-800 flex items-center justify-end gap-3",children:[v.jsx("button",{className:"text-sm",onClick:()=>Bt(null),children:"Cancel"}),v.jsx("button",{className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm",onClick:async()=>{if(Zt)try{if(await Xf(Zt.id,{pet_id:Zr||Zt.pet_id,service_date:bn||null,visit_title:Pn||null,diagnosis:Kt||null,visit_notes:ra||null,line_items:mt,expense_category:ia}),le){const P=await Fo(le);Ke(P)}Bt(null),alert("Claim updated")}catch(P){console.error("[update claim] error",P),alert("Error updating claim")}},children:"Save Changes"})]})]})}),lt&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>Qs(null),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-0",onClick:P=>P.stopPropagation(),children:[v.jsxs("div",{className:"p-5 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between",children:[v.jsx("h3",{className:"text-lg font-semibold",children:"Mark as Paid"}),v.jsx("button",{className:"text-sm",onClick:()=>Qs(null),children:"Close"})]}),v.jsxs("div",{className:"p-5 text-sm space-y-3",children:[v.jsxs("div",{children:[v.jsx("div",{className:"text-slate-500",children:"Claimed Amount"}),v.jsx("div",{className:"font-mono font-semibold",children:Ds(lt.total_amount)})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-slate-500",children:"Reimbursed Amount"}),v.jsx("input",{className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",placeholder:"0.00",value:ni,onChange:P=>Fs(P.target.value)})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-slate-500",children:"Date Received"}),v.jsx("input",{type:"date",value:$n,onChange:P=>On(P.target.value),max:new Date().toISOString().split("T")[0],placeholder:"YYYY-MM-DD",className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2"})]}),v.jsxs("div",{className:"pt-2 border-t border-slate-200 dark:border-slate-800 flex items-center justify-between",children:[v.jsx("div",{className:"text-slate-500",children:"Difference"}),v.jsx("div",{className:"font-mono font-semibold",children:(()=>{const P=Number(lt.total_amount||0),fe=Number(ni||0),ve=P-fe;return Ds(ve)})()})]})]}),v.jsxs("div",{className:"p-5 border-t border-slate-200 dark:border-slate-800 flex items-center justify-end gap-3",children:[v.jsx("button",{className:"text-sm",onClick:()=>Qs(null),children:"Cancel"}),v.jsx("button",{className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm",onClick:async()=>{try{const P=Number(ni);if(!Number.isFinite(P)||P<0){alert("Please enter a valid reimbursed amount");return}if(!$n){alert("Please select the date received");return}const fe=new Date($n).toISOString().slice(0,10);if(await Xf(lt.id,{filing_status:"paid",reimbursed_amount:P,paid_date:fe}),le){const ve=await Fo(le);Ke(ve)}Qs(null),Fs(""),On(new Date().toISOString().split("T")[0]),alert("Claim marked as paid")}catch(P){console.error("[mark paid] error",P),alert("Error saving paid status")}},children:"Save"})]})]})}),oa&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>Zs(!1),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:P=>P.stopPropagation(),children:[v.jsx("div",{className:"text-lg font-semibold",children:"Medications Prescribed?"}),v.jsx("div",{className:"mt-2 text-sm text-slate-700 dark:text-slate-300",children:"Were any medications prescribed during this vet visit?"}),v.jsxs("div",{className:"mt-5 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",onClick:()=>{Zs(!1),No&&ps(No)},children:"No"}),v.jsx("button",{type:"button",className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4",onClick:async()=>{try{if(Zs(!1),le&&y){const P=new Date().toISOString().slice(0,10),{data:fe,error:ve}=await an.from("medications").select("*").eq("user_id",le).eq("pet_id",y.id).lte("start_date",P).or(`end_date.is.null,end_date.gte.${P}`);if(ve)throw ve;Ma(Array.isArray(fe)?fe:[])}else Ma([]);gl([]),si(!0)}catch(P){console.error("[med question -> load meds] error",P),Ma([]),si(!0)}},children:"Yes"})]})]})}),la&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>si(!1),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:P=>P.stopPropagation(),children:[v.jsx("div",{className:"text-lg font-semibold",children:"Select Medications Prescribed"}),v.jsxs("div",{className:"mt-3 space-y-2 max-h-[50vh] overflow-y-auto",children:[ml.length===0&&v.jsx("div",{className:"text-sm text-slate-600",children:"No active medications found"}),ml.map(P=>v.jsxs("label",{className:"flex items-center gap-3 p-2 rounded-lg border border-slate-200 dark:border-slate-800",children:[v.jsx("input",{type:"checkbox",checked:ko.includes(P.id),onChange:fe=>{const ve=fe.target.checked;gl(_e=>ve?[..._e,P.id]:_e.filter(Oe=>Oe!==P.id))}}),v.jsxs("div",{className:"min-w-0",children:[v.jsx("div",{className:"text-sm font-medium",children:P.medication_name}),P.dosage&&v.jsx("div",{className:"text-xs text-slate-500",children:P.dosage})]})]},P.id))]}),v.jsx("div",{className:"mt-3",children:v.jsx("button",{type:"button",className:"w-full h-12 rounded-lg border border-slate-300 dark:border-slate-700",onClick:()=>uf(!0),children:"+ Add New Medication"})}),v.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[v.jsx("button",{type:"button",className:"h-12 rounded-lg border border-slate-300 dark:border-slate-700 px-4",onClick:()=>si(!1),children:"Cancel"}),v.jsx("button",{type:"button",className:"h-12 rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-4",onClick:async()=>{try{ad&&ko.length>0&&await Xf(ad,{medication_ids:ko}),si(!1),No&&ps(No)}catch(P){console.error("[med select -> link meds] error",P),si(!1),No&&ps(No)}},children:"Confirm"})]})]})}),od&&v.jsx(dj,{open:od,onClose:()=>uf(!1),onSaved:async()=>{try{if(le&&y){const P=new Date().toISOString().slice(0,10),{data:fe}=await an.from("medications").select("*").eq("user_id",le).eq("pet_id",y.id).lte("start_date",P).or(`end_date.is.null,end_date.gte.${P}`);Ma(Array.isArray(fe)?fe:[])}}catch{}},userId:le,pets:f,defaultPetId:(y==null?void 0:y.id)||null}),v.jsx(A$,{open:Oa,onClose:()=>{Mr(!1),le&&Tx(le).then(p).catch(()=>{})},userId:le||""}),Un&&v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>ps(null),children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-emerald-200 bg-white p-0 overflow-hidden",onClick:P=>P.stopPropagation(),children:[v.jsxs("div",{className:"p-6 bg-emerald-50 dark:bg-emerald-900/20 border-b border-emerald-200 dark:border-emerald-800 flex flex-col items-center text-center",children:[v.jsx("div",{className:"h-14 w-14 rounded-full bg-emerald-600 text-white flex items-center justify-center text-2xl shadow animate-pulse",children:"✓"}),v.jsx("div",{className:"mt-3 text-lg font-semibold text-emerald-800 dark:text-emerald-200",children:"Claim Saved Successfully!"}),v.jsx("div",{className:"mt-1 text-xs text-emerald-900/80 dark:text-emerald-300/80",children:"Your claim was saved. You can generate the PDF now."})]}),v.jsxs("div",{className:"p-6 text-sm",children:[v.jsxs("div",{className:"space-y-1",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Pet:"})," ",v.jsxs("span",{className:"text-slate-900 dark:text-slate-100 font-semibold",children:[Un.petName," (",Un.species,")"]})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Amount:"})," ",v.jsx("span",{className:"font-mono font-semibold text-slate-900 dark:text-slate-100",children:Ds(Un.amount||0)})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Service Date:"})," ",v.jsx("span",{className:"text-slate-900 dark:text-slate-100",children:Un.serviceDate||"—"})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Insurance:"})," ",v.jsx("span",{className:"text-slate-900 dark:text-slate-100",children:Un.insurance||"—"})]}),v.jsxs("div",{children:[v.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Filing Deadline:"})," ",v.jsxs("span",{className:"text-slate-900 dark:text-slate-100",children:[Un.deadlineDate||"—"," (",Un.deadlineDays," days)"]})]})]}),v.jsxs("div",{className:"mt-5 flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3",children:[v.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-1.5 text-sm w-full h-12 sm:w-auto sm:h-auto",onClick:()=>{ps(null),u(null),Be(null),t(null),l(null),w(""),k(""),B("insured"),_t(!1)},children:"File Another Claim"}),v.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 px-3 py-1.5 text-sm w-full h-12 sm:w-auto sm:h-auto",onClick:async()=>{ps(null),u(null),Be(null),t(null),l(null),w(""),k(""),B("insured");try{if(le){const P=await Fo(le);Ke(P)}}catch{}_t(!1)},children:"Done"}),v.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm w-full h-12 sm:w-auto sm:h-auto",onClick:async()=>{var P,fe;try{const ve=(Un==null?void 0:Un.claimId)||null;if(!le||!ve||!c||!y){ps(null),_t(!0),(P=ze.current)==null||P.scrollIntoView({behavior:"smooth"});return}Fo(le).then(Ke).catch(()=>{})}catch(ve){console.error("[view my claim -> generate pdf] error",ve)}finally{ps(null),_t(!0),(fe=ze.current)==null||fe.scrollIntoView({behavior:"smooth"})}},children:"View My Claim"})]})]})]})})]})}function P$({mode:s,onSwitch:e}){const[t,n]=xe.useState(""),[r,i]=xe.useState(""),[a,o]=xe.useState(!1),[l,c]=xe.useState(null),u=async f=>{f.preventDefault(),o(!0),c(null);try{if(s==="signup"){const{error:p}=await an.auth.signUp({email:t,password:r});if(p)throw p}else{const{error:p}=await an.auth.signInWithPassword({email:t,password:r});if(p)throw p}}catch(p){c((p==null?void 0:p.message)||"Authentication failed")}finally{o(!1)}};return v.jsxs("form",{onSubmit:u,className:"mt-2 space-y-3",children:[s==="signup"?v.jsxs("div",{className:"text-center text-sm text-slate-700 dark:text-slate-200 mb-2",children:[v.jsx("div",{className:"font-medium",children:"Welcome! Create your account"}),v.jsx("div",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:"• Save pets • Auto-fill claims • Access anywhere"})]}):v.jsx("div",{className:"text-center text-sm text-slate-700 dark:text-slate-200 mb-2",children:v.jsx("div",{className:"font-medium",children:"Welcome back!"})}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Email"}),v.jsx("input",{type:"email",value:t,onChange:f=>n(f.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs font-medium text-slate-600 dark:text-slate-300",children:"Password"}),v.jsx("input",{type:"password",value:r,onChange:f=>i(f.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",required:!0})]}),l&&v.jsx("p",{className:"text-xs text-rose-600",children:l}),v.jsx("button",{type:"submit",disabled:a,className:["w-full inline-flex items-center justify-center rounded-lg text-white px-4 py-2 text-sm font-medium disabled:opacity-60",s==="signup"?"bg-emerald-600 hover:bg-emerald-700":"bg-emerald-700 hover:bg-emerald-800"].join(" "),children:a?"Please wait…":s==="login"?"Log In":"Sign Up"})]})}function L$({userId:s,userEmail:e,onClose:t}){const[n,r]=xe.useState(e||"");return v.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t,children:v.jsxs("div",{className:"relative mx-4 w-full max-w-md rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-2xl",onClick:i=>i.stopPropagation(),children:[v.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Settings"}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"User ID"}),v.jsx("input",{type:"text",value:s||"",disabled:!0,className:"w-full px-3 py-2 border rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),v.jsx("input",{type:"email",value:n,onChange:i=>r(i.target.value),className:"w-full px-3 py-2 border rounded-lg"})]})]}),v.jsx("button",{onClick:t,className:"mt-6 w-full px-4 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-medium",children:"Close"})]})})}function T$({userId:s,userEmail:e,onClose:t,onDefaultExpenseChange:n,onDefaultPeriodChange:r}){const[i,a]=xe.useState(!1),[o,l]=xe.useState(""),[c,u]=xe.useState(""),[f,p]=xe.useState(""),[m,b]=xe.useState(!1),[y,S]=xe.useState(!1),[w,_]=xe.useState(!1),[k,C]=xe.useState("insured"),[B,F]=xe.useState("all"),[j,T]=xe.useState(""),[W,Y]=xe.useState(""),[I,O]=xe.useState("");xe.useEffect(()=>{s&&(async()=>{a(!0);try{const{data:ne,error:te}=await an.from("profiles").select("*").eq("id",s).single();if(te)throw te;ne&&(l(ne.full_name||""),u(ne.phone||""),p(ne.address||""),b(!!ne.email_reminders),S(!!ne.weekly_summaries),_(!!ne.deadline_alerts),C(ne.default_expense_category||"insured"),F(ne.default_time_period||"all"),ne.insurance_company&&(["Trupanion","Nationwide","Healthy Paws","Fetch"].includes(ne.insurance_company)?(T(ne.insurance_company),O(Number(ne.filing_deadline_days||90))):(T("Custom Insurance"),Y(ne.insurance_company),O(Number(ne.filing_deadline_days||90)))))}catch(ne){console.error("[settings load] error",ne)}finally{a(!1)}})()},[s]);const X=async()=>{if(s){a(!0);try{const{error:ne}=await an.from("profiles").upsert({id:s,email:e||"",full_name:o,phone:c,address:f});if(ne)throw ne;alert("Profile saved")}catch(ne){console.error("[save profile] error",ne),alert("Error saving profile")}finally{a(!1)}}},K=async()=>{if(s){a(!0);try{const{error:ne}=await an.from("profiles").update({email_reminders:m,weekly_summaries:y,deadline_alerts:w,default_expense_category:k,default_time_period:B,insurance_company:j==="Custom Insurance"?W||null:j||null,filing_deadline_days:j==="Custom Insurance"?Number(I)||null:90}).eq("id",s);if(ne)throw ne;n(k),r(B),alert("Preferences saved")}catch(ne){console.error("[save prefs] error",ne),alert("Error saving preferences")}finally{a(!1)}}};return v.jsxs("section",{className:"mx-auto max-w-3xl mt-6",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("h2",{className:"text-xl font-semibold",children:"Settings"}),v.jsx("button",{type:"button",onClick:t,className:"text-sm text-slate-600 dark:text-slate-300",children:"Close"})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-sm font-semibold",children:"Profile Information"}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Email"}),v.jsx("input",{value:e||"",readOnly:!0,className:"mt-1 w-full rounded-md border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/40 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Full Name"}),v.jsx("input",{value:o,onChange:ne=>l(ne.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Phone Number"}),v.jsx("input",{value:c,onChange:ne=>u(ne.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Address"}),v.jsx("textarea",{value:f,onChange:ne=>p(ne.target.value),rows:3,className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm"})]})]}),v.jsx("div",{className:"mt-3",children:v.jsx("button",{type:"button",onClick:X,disabled:i,className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm disabled:opacity-60",children:"Save Profile"})})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-sm font-semibold",children:"Email Notifications"}),v.jsxs("div",{className:"mt-3 space-y-2 text-sm",children:[v.jsxs("label",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"checkbox",checked:m,onChange:ne=>b(ne.target.checked)})," Email me deadline reminders"]}),v.jsxs("label",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"checkbox",checked:y,onChange:ne=>S(ne.target.checked)})," Email me weekly summaries"]}),v.jsxs("label",{className:"flex items-center gap-2",children:[v.jsx("input",{type:"checkbox",checked:w,onChange:ne=>_(ne.target.checked)})," Email me when claims are due"]}),v.jsx("div",{className:"text-xs text-slate-500",children:"Email notification features coming soon"})]})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-sm font-semibold",children:"Insurance Company Settings"}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Select Insurance"}),v.jsxs("select",{value:j,onChange:ne=>{const te=ne.target.value;T(te),te==="Custom Insurance"?O(""):te&&O(90)},className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2",children:[v.jsx("option",{value:"",children:"—"}),v.jsx("option",{value:"Trupanion",children:"Trupanion (90 days)"}),v.jsx("option",{value:"Nationwide",children:"Nationwide (90 days)"}),v.jsx("option",{value:"Healthy Paws",children:"Healthy Paws (90 days)"}),v.jsx("option",{value:"Fetch",children:"Fetch (90 days)"}),v.jsx("option",{value:"Custom Insurance",children:"Custom Insurance"})]})]}),j==="Custom Insurance"&&v.jsxs(v.Fragment,{children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Insurance Company Name"}),v.jsx("input",{value:W,onChange:ne=>Y(ne.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Filing Deadline (days)"}),v.jsx("input",{type:"number",min:1,value:I,onChange:ne=>O(ne.target.value===""?"":Number(ne.target.value)),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2"})]})]})]}),v.jsxs("div",{className:"mt-3 text-xs text-slate-500",children:[j&&j!=="Custom Insurance"&&v.jsxs("span",{children:[j," - Filing Deadline: 90 days"]}),j==="Custom Insurance"&&W&&I!==""&&v.jsxs("span",{children:[W," - Filing Deadline: ",I," days"]})]}),v.jsx("div",{className:"mt-3",children:v.jsx("button",{type:"button",onClick:K,disabled:i,className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm disabled:opacity-60",children:"Save Insurance Settings"})})]}),v.jsxs("div",{className:"mt-4 rounded-2xl border border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 p-5",children:[v.jsx("div",{className:"text-sm font-semibold",children:"Account Preferences"}),v.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Default expense category"}),v.jsxs("select",{value:k,onChange:ne=>C(ne.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"insured",children:"Insured"}),v.jsx("option",{value:"not_insured",children:"Not Insured"}),v.jsx("option",{value:"maybe_insured",children:"Maybe Insured"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-xs text-slate-500",children:"Default financial period"}),v.jsxs("select",{value:B,onChange:ne=>F(ne.target.value),className:"mt-1 w-full rounded-md border border-slate-300 dark:border-slate-700 bg-white/80 dark:bg-slate-900 px-3 py-2 text-sm",children:[v.jsx("option",{value:"all",children:"All Time"}),v.jsx("option",{value:"2025",children:"2025"}),v.jsx("option",{value:"2024",children:"2024"}),v.jsx("option",{value:"last12",children:"Last 12 Months"})]})]})]}),v.jsx("div",{className:"mt-3",children:v.jsx("button",{type:"button",onClick:K,disabled:i,className:"inline-flex items-center rounded-lg bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 text-sm disabled:opacity-60",children:"Save Preferences"})})]})]})}Ux.createRoot(document.getElementById("root")).render(v.jsx(pR.StrictMode,{children:v.jsx(E$,{})}));export{fn as _,Ia as c,Jj as g};
